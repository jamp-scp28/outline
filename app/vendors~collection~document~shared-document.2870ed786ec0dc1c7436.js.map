{"version":3,"sources":["webpack:///./node_modules/framer-motion/dist/es/utils/use-unmount-effect.js","webpack:///./node_modules/framer-motion/dist/es/components/AnimatePresence/PresenceChild.js","webpack:///./node_modules/framer-motion/dist/es/components/AnimatePresence/index.js","webpack:///./node_modules/framer-motion/dist/es/utils/use-force-update.js","webpack:///./node_modules/prosemirror-transform/dist/index.es.js","webpack:///./node_modules/core-js/modules/es.weak-map.js","webpack:///./node_modules/crypto-js/core.js","webpack:///./node_modules/orderedmap/index.es.js","webpack:///./node_modules/prosemirror-model/dist/index.es.js","webpack:///./node_modules/react-medium-image-zoom/lib/defaults.js","webpack:///./node_modules/react-medium-image-zoom/lib/ImageZoom.js","webpack:///./node_modules/react-medium-image-zoom/lib/Zoom.js","webpack:///./node_modules/prosemirror-state/dist/index.es.js","webpack:///./node_modules/prosemirror-view/dist/index.es.js","webpack:///./node_modules/react-medium-image-zoom/lib/index.js","webpack:///./node_modules/core-js/modules/esnext.weak-map.delete-all.js","webpack:///./node_modules/crypto-js/md5.js","webpack:///./node_modules/react-medium-image-zoom/lib/EventsWrapper.js","webpack:///./node_modules/core-js/modules/es.symbol.replace.js","webpack:///./node_modules/core-js/modules/es.promise.finally.js","webpack:///./node_modules/react-medium-image-zoom/lib/helpers.js","webpack:///./node_modules/react-medium-image-zoom/lib/Overlay.js","webpack:///./node_modules/core-js/internals/collection-weak.js","webpack:///./node_modules/react-medium-image-zoom/lib/keyboardEvents.js","webpack:///./node_modules/core-js/modules/es.array.last-index-of.js","webpack:///./node_modules/core-js/modules/es.string.fixed.js"],"names":["useUnmountEffect","callback","presenceId","getPresenceId","id","PresenceChild","_a","children","initial","isPresent","onExitComplete","custom","presenceAffectsLayout","presenceChildren","newChildrenMap","context","childId","set","allComplete","forEach","isComplete","register","delete","undefined","_","key","size","PresenceContext","Provider","value","Map","getChildKey","child","AnimatePresence","_b","exitBeforeEnter","_c","forceRender","useForceUpdate","unloadingRef","forcedRenderCount","setForcedRenderCount","current","layoutContext","SharedLayoutContext","forceUpdate","isInitialRender","filteredChildren","onlyElements","filtered","push","presentChildren","allChildren","exiting","Set","updateChildLookup","map","childrenToRender","presentKeys","targetKeys","numPresent","length","i","indexOf","add","get","insertionIndex","splice","removeIndex","findIndex","presentChild","has","factor16","Math","pow","recoverIndex","MapResult","pos","deleted","recover","this","StepMap","ranges","inverted","prototype","diff","index","recoverOffset","mapResult","assoc","_map","simple","oldIndex","newIndex","start","oldSize","newSize","end","result","touches","f","oldStart","newStart","invert","toString","JSON","stringify","offset","n","empty","Mapping","maps","mirror","from","to","TransformError","message","err","Error","call","__proto__","slice","copy","appendMap","mirrors","setMirror","appendMapping","mapping","startSize","mirr","getMirror","m","appendMappingInverted","totalSize","inverse","recoverables","rec","corr","Object","create","constructor","name","Transform","doc","steps","docs","prototypeAccessors","before","configurable","docChanged","mustOverride","step","object","maybeStep","failed","apply","addStep","getMap","defineProperties","stepsByID","Step","_doc","_mapping","merge","_other","toJSON","fromJSON","schema","json","stepType","RangeError","type","jsonID","stepClass","StepResult","ok","fail","fromReplace","replace","e","ReplaceStep","structure","contentBetween","max","other","openEnd","openStart","slice$1","content","append","ReplaceAroundStep","gapFrom","gapTo","insert","gap","inserted","insertAt","removeBetween","$from","resolve","dist","depth","indexAfter","node","childCount","next","maybeChild","isLeaf","firstChild","canCut","canReplace","liftTarget","range","parent","cutByIndex","startIndex","endIndex","$to","spec","isolating","findWrapping","nodeType","attrs","innerRange","around","findWrappingOutside","contentMatchAt","outer","canReplaceWith","inner","findWrappingInside","inside","contentMatch","innerMatch","matchType","validEnd","withAttrs","concat","canSplit","typesAfter","$pos","base","innerType","validContent","d","index$1","rest","after","replaceChild","baseType","canJoin","joinable","nodeBefore","nodeAfter","a","b","canAppend","joinPoint","dir","isTextblock","dropPoint","pass","bias","insertPos","mapFragment","fragment","mapped","isInline","fromArray","lift","target","gapStart","gapEnd","splitting","d$1","splitting$1","wrap","wrappers","setBlockType","this$1","mapFrom","nodesBetween","hasMarkup","canChangeType","clearIncompatible","startM","endM","nodeSize","marks","setNodeMarkup","nodeAt","newNode","replaceWith","split","typeAfter","join","AddMarkStep","mark","oldSlice","sharedDepth","allowsMarkType","addToSet","RemoveMarkStep","eq","min","markFromJSON","removeFromSet","replaceStep","fitsTrivially","Fitter","fit","addMark","removed","added","removing","adding","isInSet","newSet","s","removeMark","matched","toRemove","found","style","found$1","j","parentType","match","delSteps","cur","allowed","fill","fillBefore","i$1","unplaced","frontier","placed","prototypeAccessors$1","dropFromFragment","count","addToFragment","lastChild","contentAt","closeNodeStart","frag","matchFragment","contentAfterFits","open","compatibleContent","invalidMarks","allowsMarks","closeFragment","oldOpen","newOpen","first","coveredDepths","findFittable","placeNodes","openMore","dropNode","moveInline","mustMoveInline","placedSize","close","sliceDepth","frontierDepth","ref","inject","openAtEnd","closeFrontierNode","openFrontierNode","taken","ref$1","openEndCount","matches","allowedMarks","toEnd","i$2","level","top","findCloseLevel","scan","match$1","pop","replaceRange","deleteRange","targetDepths","preferredTarget","unshift","defining","preferredTargetIndex","leftNodes","preferredDepth","openDepth","targetDepth","expand","startSteps","replaceRangeWith","point","insertPoint","parentOffset","covered","last","InternalWeakMap","global","redefineAll","InternalMetadataModule","collection","collectionWeak","isObject","enforceIternalState","enforce","NATIVE_WEAK_MAP","IS_IE11","ActiveXObject","isExtensible","wrapper","init","WeakMap","arguments","$WeakMap","module","exports","getConstructor","REQUIRED","WeakMapPrototype","nativeDelete","nativeHas","nativeGet","nativeSet","state","frozen","CryptoJS","crypto","window","self","globalThis","msCrypto","cryptoSecureRandomInt","getRandomValues","Uint32Array","randomBytes","readInt32LE","F","obj","subtype","C","C_lib","lib","Base","extend","overrides","mixIn","hasOwnProperty","$super","instance","properties","propertyName","clone","WordArray","words","sigBytes","encoder","Hex","wordArray","thisWords","thatWords","thisSigBytes","thatSigBytes","clamp","thatByte","ceil","random","nBytes","C_enc","enc","hexChars","bite","parse","hexStr","hexStrLength","parseInt","substr","Latin1","latin1Chars","String","fromCharCode","latin1Str","latin1StrLength","charCodeAt","Utf8","decodeURIComponent","escape","utf8Str","unescape","encodeURIComponent","BufferedBlockAlgorithm","reset","_data","_nDataBytes","_append","data","_process","doFlush","processedWords","dataWords","dataSigBytes","blockSize","nBlocksReady","nWordsReady","_minBufferSize","nBytesReady","_doProcessBlock","C_algo","Hasher","cfg","_doReset","update","messageUpdate","finalize","_doFinalize","_createHelper","hasher","_createHmacHelper","HMAC","algo","OrderedMap","find","newKey","remove","addToStart","addToEnd","addBefore","place","without","prepend","subtract","prop","findDiffStart","childA","childB","sameMarkup","isText","text","findDiffEnd","posA","posB","iA","iB","same","minSize","Fragment","nodeStart","descendants","textBetween","blockSeparator","leafText","separated","isBlock","withText","cut","p","findDiffStart$1","findDiffEnd$1","otherPos","round","retIndex","curPos","toStringInner","Array","isArray","nodeFromJSON","array","joined","nodes","compareDeep","p$1","Mark","ReplaceError","excludes","rank","sameSet","setFrom","none","sort","Slice","removeRange","indexTo","offsetTo","insertInto","replaceOuter","prepareSliceForReplace","$along","extra","resolveNoCache","replaceThreeWay","replaceTwoWay","checkJoin","main","sub","$before","$after","addNode","addRange","$start","$end","textOffset","maxOpen","openIsolating","n$1","ResolvedPos","path","prototypeAccessors$2","resolveDepth","val","dOff","posAtIndex","tmp","inclusive","marksAcross","blockRange","pred","inlineContent","NodeRange","sameParent","str","rem","resolveCached","resolveCache","cached","resolveCachePos","resolveCacheSize","prototypeAccessors$1$1","emptyAttrs","Node","prototypeAccessors$3","textContent","isAtom","startPos","defaultAttrs","includeParents","replace$1","childAfter","childBefore","rangeHasMark","toDebugString","wrapMarks","replacement","one","two","check","TextNode","ContentMatch","wrapCache","prototypeAccessors$4","defaultType","edgeCount","string","nodeTypes","stream","TokenStream","expr","parseExpr","dfa","nfa","labeled","explore","nullFrom","states","out","term","known","states$1","cmp","connect","compile","edge","edges","exprs","reduce","loop","loop$1","next$1","next$2","checkForDeadEnds","work","dead","hasRequiredAttrs","compatible","seen","search","types","finished","tp","createAndFill","computed","computeWrapping","active","via","shift","reverse","inline","tokens","prototypeAccessors$1$2","parseExprSeq","eat","parseExprSubscript","parseExprAtom","test","resolveName","typeName","type$1","groups","parseExprRange","parseNum","Number","defaults","attrName","attr","hasDefault","default","computeAttrs","built","given","initAttrs","Attribute","tok","SyntaxError","NodeType","group","markSet","prototypeAccessors$5","whitespace","atom","code","isRequired","computeAttrs$1","createChecked","markType","topType","topNode","options","prototypeAccessors$1$3","MarkType","excluded","Schema","contentExprCache","prop$1","contentExpr","markExpr","gatherMarks","prop$2","excl","bind","topNodeType","wrappings","mark$1","text$1","DOMParser","rules","tags","styles","rule","tag","normalizeLists","some","r","dom","ParseContext","addAll","finish","parseSlice","matchTag","namespace","namespaceURI","matchesContext","getAttrs","matchStyle","schemaRules","priority","parseDOM","rules$1","name$1","fromSchema","domParser","blockTags","address","article","aside","blockquote","canvas","dd","div","dl","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","li","noscript","ol","output","pre","section","table","tfoot","ul","ignoreTags","head","script","title","listTags","wsOptionsFor","preserveWhitespace","OPT_PRESERVE_WS","NodeContext","pendingMarks","solid","activeMarks","stashMarks","exec","popFromStashMark","applyPending","nextType","pending","markMayApply","inlineContext","parentNode","nodeName","toLowerCase","parser","isOpen","topContext","topOptions","topMatch","findPositions","needsBlock","prototypeAccessors$6","currentPos","selector","msMatchesSelector","webkitMatchesSelector","mozMatchesSelector","v","returned","addDOM","addTextNode","getAttribute","readStyles","parseStyles","re","trim","addPendingMark","addElement","removePendingMark","nodeValue","domNodeBefore","previousSibling","insertNode","findInText","findInside","matchAfter","ruleID","normalizeList","prevItem","nextSibling","appendChild","ruleFromNode","ignore","ignoreFallback","skip","closeParent","sync","oldNeedsBlock","leafFallback","addElementByRule","consuming","ownerDocument","createTextNode","findPlace","continueAfter","enter","startIn","getContent","contentDOM","contentElement","querySelector","findAround","childNodes","findAtPoint","route","cx","enterInner","block","textblockFromContext","closeExtra","preserveWS","topOpen","contains","compareDocumentPosition","textNode","parts","option","useRoot","minDepth","part","$context","deflt","findSameMarkInSet","upto","lastIndexOf","stashMark","DOMSerializer","gatherToDOM","toDOM","document","serializeFragment","createDocumentFragment","keep","rendered","spanning","markDOM","serializeMark","serializeNodeInner","renderSpec","onContent","serializeNode","xmlNS","tagName","space","createElementNS","createElement","space$1","setAttributeNS","setAttribute","innerContent","domSerializer","nodesFromSchema","marksFromSchema","defineProperty","errors","controlled","uncontrolled","image","cursor","zoomImage","position","transition","transform","transformOrigin","willChange","zoomContainer","right","bottom","left","zIndex","overlay","backgroundColor","opacity","transitionDuration","_extends","assign","source","_createClass","props","descriptor","enumerable","writable","Constructor","protoProps","staticProps","_react","_react2","_interopRequireDefault","_propTypes","_defaults2","_helpers","_keyboardEvents","_EventsWrapper2","_Zoom2","__esModule","isControlled","isZoomed","ImageZoom","_Component","_classCallCheck","TypeError","_this","_possibleConstructorReturn","ReferenceError","getPrototypeOf","isDisabled","wasZoomed","src","prevSrc","isClosing","_handleKeyDown","_handleLoad","_handleLoadError","_handleUnzoom","_handleZoom","_inherits","subClass","superClass","setPrototypeOf","componentDidUpdate","prevProps","prevState","prevIsZoomed","portalInstance","unzoom","force","render","_this2","_props","defaultStyles","propsIsZoomed","shouldRespectMaxDimension","zoomMargin","_state","stateIsZoomed","tabIndex","_getImageStyle","onMouseDown","_preventFocus","onClick","onKeyDown","x","onLoad","onError","controlledEventFn","_getControlledEventFn","allowAccessibilityClose","_allowTabNavigation","onUnzoom","_checkShouldDisableComponent","_props2","isMaxDimension","setState","_props3","isZoomedP","_state2","isZoomedSt","isHidden","visibility","Function","isEnterOrSpaceBarKey","preventDefault","shouldHandleZoom","onZoom","allowRefocus","_this3","changes","shouldReplaceImage","focus","getDerivedStateFromProps","Component","propTypes","shape","alt","className","bool","func","_Overlay2","Zoom","hasLoaded","currentSrc","tmpSrc","_handleImageLoad","componentDidMount","_props$zoomImage","srcSet","fetchImage","setTimeout","_getZoomImageStyle","_getZoomContainerStyle","isVisible","TmpImg","img","imageOffset","getBoundingClientRect","width","height","naturalWidth","naturalHeight","viewportX","body","clientWidth","viewportY","innerHeight","zoomStyle","getMaxDimensionScale","getScale","number","_ref","_objectWithoutProperties","keys","getTmpStyle","tmpStyle","classesById","Selection","$anchor","$head","SelectionRange","anchor","tr","lastNode","lastParent","selectionToInsertionEnd","findFrom","textOnly","TextSelection","findSelectionIn","near","AllSelection","atStart","atEnd","cls","selectionClass","getBookmark","between","visible","$cursor","ensureMarks","TextBookmark","dPos","NodeSelection","NodeBookmark","isSelectable","selectable","sel","selection","setSelection","AllBookmark","startLen","_from","_to","_newFrom","newTo","Transaction","time","Date","now","curSelection","curSelectionFor","storedMarks","updated","meta","selectionSet","storedMarksSet","isGeneric","scrolledIntoView","setStoredMarks","addStoredMark","removeStoredMark","setTime","replaceSelection","replaceSelectionWith","inheritMarks","deleteSelection","insertText","setMeta","getMeta","scrollIntoView","FieldDesc","desc","baseFields","config","_marks","_old","prev","Configuration","plugins","fields","pluginsByKey","plugin","EditorState","applyTransaction","filterTransaction","rootTr","transactions","trs","newState","applyInner","haveNew","appendTransaction","oldState","newInstance","field","applyListeners","$config","reconfigure","pluginFields","addApplyListener","removeApplyListener","bindProps","Plugin","createKey","getState","PluginKey","navigator","ie_edge","userAgent","ie_upto10","ie_11up","ie","ie_version","documentMode","gecko","gecko_version","chrome","chrome_version","safari","vendor","ios","maxTouchPoints","mac","platform","android","webkit","documentElement","webkit_version","domIndex","assignedSlot","host","reusedRange","textRange","createRange","setEnd","setStart","isEquivalentPosition","off","targetNode","targetOff","scanFor","atomElements","hasBlockDesc","contentEditable","pmViewDesc","selectionCollapsed","domSel","collapsed","isCollapsed","rangeCount","getRangeAt","keyEvent","keyCode","event","createEvent","initEvent","windowRect","clientHeight","getSide","side","clientRect","rect","scaleX","offsetWidth","scaleY","offsetHeight","scrollRectIntoView","view","startDOM","scrollThreshold","someProp","scrollMargin","atTop","bounding","moveX","moveY","defaultView","scrollBy","startX","scrollLeft","startY","scrollTop","dX","dY","scrollStack","stack","restoreScrollStack","dTop","preventScrollSupported","findOffsetInNode","coords","closest","coordsClosest","dxClosest","rowBot","rowTop","childIndex","rects","getClientRects","dx","findOffsetInText","len","singleRect","inRect","elementFromPoint","element","box","startI","floor","posAtCoords","assign$1","caretPositionFromPoint","pos$1","offsetNode","caretRangeFromPoint","startContainer","startOffset","elt","root","draggable","targetKludge","box$1","posFromCaret","outside","docView","nearestDesc","posBefore","posAfter","posFromDOM","posFromElement","posAtStart","border","BIDI","coordsAtPos","domFromPos","supportEmptyRange","takeSide","flattenV","rectBefore","rectAfter","flattenH","before$1","after$1","ignoreForCoords","target$1","y","withFlushedState","viewState","activeElement","updateState","maybeRTL","cachedState","cachedDir","cachedResult","endOfTextblock","endOfTextblockVertical","nearest","boxes","endOfTextblockHorizontal","getSelection","modify","oldRange","oldNode","focusNode","oldOff","focusOffset","oldBidiLevel","caretBidiLevel","domAfterPos","removeAllRanges","ViewDesc","dirty","posAtEnd","contentLost","domAtom","matchesWidget","matchesMark","matchesNode","matchesHack","_nodeName","parseRule","stopEvent","destroy","posBeforeChild","localPosFromDOM","domBefore","domAfter","desc$1","search$1","onlyNodes","getDesc","nodeDOM","descAt","TrailingHackViewDesc","WidgetViewDesc","widget","prev$1","enter$1","parseRange","fromOffset","toOffset","childBase","emptyChildAt","j$1","anchorDOM","headDOM","brKludge","offset$1","anchorNode","anchorOffset","domSelExtended","collapse","DOMException","ignoreMutation","mutation","markDirty","startInside","endInside","markParentsDirty","nothing","raw","classList","stop","ignoreSelection","CompositionViewDesc","textDOM","mut","oldValue","MarkViewDesc","nodeViews","reparseInView","replaceNodes","NodeViewDesc","outerDeco","innerDeco","updateChildren","descObj","hasAttribute","applyOuterDeco","CustomNodeViewDesc","TextViewDesc","sameOuterDeco","composition","composing","localCompositionInfo","localComposition","compositionInChild","updater","ViewTreeUpdater","iterDeco","deco","onWidget","onNode","locals","forChild","decoIndex","restNode","parentIndex","widgets","compareSide","child$1","cutAt","i$3","filter","insideNode","syncToMarks","placeWidget","compIndex","findNodeMatch","findIndexWithChild","updateNodeAt","updateNextNode","addTextblockHacks","destroyRest","changed","protectLocalComposition","renderDescs","iosHacks","oldCSS","cssText","getComputedStyle","listStyle","nearbyTextNode","textPos","findTextInFragment","childStart","removeChild","compositionNodes","updateInner","updateOuterDeco","needsWrap","oldDOM","patchOuterDeco","computeOuterDeco","selectNode","deselectNode","removeAttribute","docViewDesc","pmIsDeco","inParent","trackWrites","parentDOM","descs","written","childDOM","rm","insertBefore","OuterDecoLevel","noDeco","class","outerDOM","prevComputed","curComputed","curDOM","patchAttributes","prevList","Boolean","curList","removeProperty","lockedNode","lock","preMatch","parentDesc","curDesc","descI","fI","selectionFromDOM","origin","inWidget","isOnEdge","selectionBetween","editorOwnsSelection","editable","hasFocus","hasSelection","selectionToDOM","syncNodeSelection","mouseDown","allowDefault","curSel","domObserver","currentSelection","delayedSelectionSync","setCurSelection","disconnectSelection","cursorWrapper","selectCursorWrapper","disabled","resetEditableFrom","resetEditableTo","brokenSelectBetweenUneditable","temporarilyEditableNear","resetEditable","removeClassOnSelectionChange","removeEventListener","hideSelectionGuard","addEventListener","connectSelection","destroyBetween","maxKeep","markDesc","targetDesc","domNode","nextDOM","addHackNode","setEditable","wasDraggable","lastSelectedViewDesc","clearNodeSelection","moveSelectionBlock","$side","dispatch","selectHorizontally","mods","nodePos","nodeLen","isIgnorable","skipIgnoredNodesLeft","moveNode","moveOffset","isBlockNode","setSelFocus","skipIgnoredNodesRight","selectVertically","beyond","stopNativeHorizontalDelete","nextNode","switchEditable","captureKeyDown","getMods","ctrlKey","metaKey","altKey","shiftKey","safariDownArrowBug","readDOMChange","typeOver","addedNodes","lastSelectionTime","lastSelectionOrigin","newSel","tr$1","shared","parseBetween","from_","to_","lastKeyCode","startDoc","editableContent","anchor$1","preferredPos","preferredSide","compare","lastKeyCodeTime","change","findDiff","endA","endB","lastIOSEnter","sel$1","resolveSelection","domChangeCount","nextSel","inlineChange","looksLikeJoin","old","$newStart","$newEnd","skipClosingAndOpening","$next","suppressSelectionUpdates","toB","lastAndroidDelete","markChange","$from1","chFrom","chTo","isMarkChange","curMarks","prevMarks","sel$2","parsedSel","fromEnd","mayOpen","serializeForClipboard","serializer","detachedDoc","wrapMap","parseFromClipboard","html","plainText","inCode","asText","parsed","readHTML","metas","firstTag","innerHTML","restoreReplacedSpaces","querySelectorAll","contextNode","sliceData","inlineParents","addContext","closeSlice","normalizeSiblings","lastWrap","inLast","addToSibling","closeRight","wrapped","withWrappers","node$1","sibling","closeRange","thead","tbody","caption","colgroup","col","td","th","_detachedDoc","implementation","createHTMLDocument","observeOptions","childList","characterData","characterDataOldValue","attributes","attributeOldValue","subtree","useCharData","SelectionState","DOMObserver","handleDOMChange","queue","flushingSoon","observer","MutationObserver","mutations","removedNodes","flushSoon","flush","onCharData","prevValue","onSelectionChange","suppressingSelectionUpdates","forceFlush","clearTimeout","observe","take","takeRecords","disconnect","hasFocusAndSelection","ignoreSelectionChange","container","commonAncestorContainer","result$1","registerMutation","brs","checkCSS","cssChecked","whiteSpace","console","attributeName","handlers","editHandlers","setSelectionOrigin","ensureListeners","currentHandlers","eventHandlers","runCustomHandler","handler","defaultPrevented","eventCoords","clientX","clientY","runHandlerOnContext","propName","updateSelection","focused","handleSingleClick","selectClickedNode","selectedNode","selectAt","selectClickedLeaf","handleDoubleClick","handleTripleClick","defaultTripleClick","button","forceDOMFlush","endComposition","keydown","inOrNearComposition","lastIOSEnterFallbackTimeout","keyup","keypress","charCode","selectNodeModifier","mousedown","flushed","lastClick","isNear","click","dy","done","MouseDown","targetPos","mightDrag","addAttr","setUneditable","up","move","abs","timeStamp","compositionEndedAt","buttons","touchdown","contextmenu","timeoutComposition","scheduleComposeEnd","delay","composingTimeout","clearComposition","timestampFromCustomEvent","compositionstart","compositionupdate","markCursor","compositionend","brokenClipboardAPI","doPaste","singleNode","sliceSingleNode","clipboardData","clearData","setData","captureCopy","selectNodeContents","blur","paste","getData","capturePaste","Dragging","dragCopyModifier","dragstart","dataTransfer","effectAllowed","dragging","dragend","dragover","dragenter","drop","eventPos","$mouse","isNode","beforeInsert","relatedTarget","beforeinput","inputType","compareObjs","WidgetType","noSpec","span","oldOffset","Decoration","valid","InlineType","inclusiveStart","inclusiveEnd","is","DecorationSet","local","decorations","buildTree","predicate","findInner","childOff","mapInner","newLocal","onRemove","mapChildren","oldChildren","oldEnd","newEnd","dSize","mustRebuild","fromLocal","toLocal","childOffset","childNode","mapAndGatherRemainingDecorations","gather","from$1","byPos","addInner","baseOffset","takeSpansForNode","moveSpans","withoutNulls","removeInner","span$1","dec","localSet","DecorationGroup","removeOverlap","localsInner","members","spans","hasNulls","localStart","working","insertAhead","viewDecorations","mappedDecos","member","sorted","EditorView","directPlugins","checkStateComponent","_root","mount","mounted","getEditable","updateCursorWrapper","buildNodeViews","computeDocDeco","initInput","eventBelongsToView","bubbles","prevDirectPlugins","pluginViews","updatePluginViews","isDestroyed","contenteditable","translate","handleDOMEvents","updateStateInner","setProps","reconfigured","redraw","updateSel","changedNodeViews","nA","nB","scroll","scrollToSelection","updateDoc","oldScrollPos","overflowAnchor","storeScrollPos","refDOM","refTop","localRect","forceSelUpdate","selectionContextChanged","sel1","sel2","chromeKludge","anchorInRightPlace","resetScrollPos","newRefTop","destroyPluginViews","pluginView","plugin$1","focusPreventScroll","setActive","stored","preventScroll","posAtCoords$1","coordsAtPos$1","domAtPos","posAtDOM","endOfTextblock$1","destroyInput","dispatchEvent","dispatchEvent$1","dispatchTransaction","_ImageZoom2","$","IS_PURE","collectionDeleteAll","proto","real","forced","deleteAll","T","sin","MD5","_hash","M","offset_i","M_offset_i","H","M_offset_0","M_offset_1","M_offset_2","M_offset_3","M_offset_4","M_offset_5","M_offset_6","M_offset_7","M_offset_8","M_offset_9","M_offset_10","M_offset_11","M_offset_12","M_offset_13","M_offset_14","M_offset_15","c","FF","GG","HH","II","nBitsTotal","nBitsLeft","nBitsTotalH","nBitsTotalL","hash","H_i","t","HmacMD5","_reactDom","EventsWrapper","portal","createPortalContainer","_handleScroll","_handleResize","_handleTouchStart","_handleTouchMove","_handleTouchEnd","pageYOffset","loadTimeout","componentWillUnmount","removePortalContainer","createPortal","_cloneChild","cloneElement","Children","only","isTabKey","unzoomForEnterOrSpace","unzoomForEscape","isEscapeKey","yTouchPosition","getControlledEventFn","defineWellKnownSymbol","NativePromise","fails","getBuiltIn","speciesConstructor","promiseResolve","redefine","then","onFinally","isFunction","cb","sizes","Image","srcset","innerWidth","_ref2","scale","ratio","Overlay","_PureComponent","isMounted","_getStyle","PureComponent","getWeakData","anObject","anInstance","iterate","ArrayIterationModule","$has","InternalStateModule","setInternalState","internalStateGetterFor","getterFor","uncaughtFrozenStore","store","UncaughtFrozenStore","entries","findUncaughtFrozen","it","entry","CONSTRUCTOR_NAME","IS_MAP","ADDER","that","iterable","AS_ENTRIES","getInternalState","define","enterKey","isKey","isSpaceBarKey","createHTML","forcedStringHTMLMethod","fixed"],"mappings":"yIAAA,iEAEA,SAASA,iBAAiBC,GACtB,OAAO,qBAAU,WAAc,OAAO,WAAc,OAAOA,OAAkB,M,wJCE7EC,EAAa,EACjB,SAASC,gBACL,IAAIC,EAAKF,EAET,OADAA,IACOE,EAEX,IAAIC,cAAgB,SAAUC,GAC1B,IAAIC,EAAWD,EAAGC,SAAUC,EAAUF,EAAGE,QAASC,EAAYH,EAAGG,UAAWC,EAAiBJ,EAAGI,eAAgBC,EAASL,EAAGK,OAAQC,EAAwBN,EAAGM,sBAC3JC,EAAmB,YAAYC,gBAC/BV,EAAK,YAAYD,eACjBY,EAAU,mBAAQ,WAAc,MAAO,CACvCX,GAAIA,EACJI,QAASA,EACTC,UAAWA,EACXE,OAAQA,EACRD,eAAgB,SAAUM,GACtBH,EAAiBI,IAAID,GAAS,GAC9B,IAAIE,GAAc,EAClBL,EAAiBM,SAAQ,SAAUC,GAC1BA,IACDF,GAAc,MAEtBA,IAAgBR,SAAgEA,MAEpFW,SAAU,SAAUL,GAEhB,OADAH,EAAiBI,IAAID,GAAS,GACvB,WAAc,OAAOH,EAAiBS,OAAON,QAQ5DJ,OAAwBW,EAAY,CAACd,IAWrC,OAVA,mBAAQ,WACJI,EAAiBM,SAAQ,SAAUK,EAAGC,GAAO,OAAOZ,EAAiBI,IAAIQ,GAAK,QAC/E,CAAChB,IAKJ,aAAgB,YACXA,IAAcI,EAAiBa,OAAShB,SAAgEA,OAC1G,CAACD,IACI,gBAAoBkB,EAAA,EAAgBC,SAAU,CAAEC,MAAOd,GAAWR,IAE9E,SAASO,iBACL,OAAO,IAAIgB,I,gBC9Cf,SAASC,YAAYC,GACjB,OAAOA,EAAMP,KAAO,GAsFxB,IAAIQ,gBAAkB,SAAU3B,GAC5B,IAAIC,EAAWD,EAAGC,SAAUI,EAASL,EAAGK,OAAQuB,EAAK5B,EAAGE,QAASA,OAAiB,IAAP0B,GAAuBA,EAAIxB,EAAiBJ,EAAGI,eAAgByB,EAAkB7B,EAAG6B,gBAAiBC,EAAK9B,EAAGM,sBAAuBA,OAA+B,IAAPwB,GAAuBA,EAG1PC,EC9FR,SAASC,iBACL,IAAIC,EAAe,kBAAO,GACtBjC,EAAK,YAAO,mBAAS,GAAI,GAAIkC,EAAoBlC,EAAG,GAAImC,EAAuBnC,EAAG,GAEtF,OADA,aAAiB,WAAc,OAAQiC,EAAaG,SAAU,KACvD,uBAAY,YACdH,EAAaG,SAAWD,EAAqBD,EAAoB,KACnE,CAACA,IDwFcF,GACdK,EAAgB,qBAAWC,EAAA,GAC3B,YAAeD,KACfN,EAAcM,EAAcE,aAEhC,IAAIC,EAAkB,kBAAO,GAEzBC,EAlFR,SAASC,aAAazC,GAClB,IAAI0C,EAAW,GAMf,OAJA,WAAS9B,QAAQZ,GAAU,SAAUyB,GAC7B,yBAAeA,IACfiB,EAASC,KAAKlB,MAEfiB,EA2EgBD,CAAazC,GAGhC4C,EAAkB,iBAAOJ,GAEzBK,EAAc,iBAAO,IAAItB,KACxBY,QAEDW,EAAU,iBAAO,IAAIC,KAAOZ,QAIhC,GA3GJ,SAASa,kBAAkBhD,EAAU6C,GAEjC7C,EAASY,SAAQ,SAAUa,GACvB,IAAIP,EAAMM,YAAYC,GAOtBoB,EAAYnC,IAAIQ,EAAKO,MA8FzBuB,CAAkBR,EAAkBK,GAGhCN,EAAgBJ,QAEhB,OADAI,EAAgBJ,SAAU,EAClB,gBAAoB,WAAgB,KAAMK,EAAiBS,KAAI,SAAUxB,GAAS,OAAQ,gBAAoB3B,cAAe,CAAEoB,IAAKM,YAAYC,GAAQvB,WAAW,EAAMD,UAASA,QAAUe,EAAmBX,sBAAuBA,GAAyBoB,OAU3Q,IAPA,IAAIyB,EAAmB,YAAc,GAAI,YAAOV,IAG5CW,EAAcP,EAAgBT,QAAQc,IAAIzB,aAC1C4B,EAAaZ,EAAiBS,IAAIzB,aAElC6B,EAAaF,EAAYG,OACpBC,EAAI,EAAGA,EAAIF,EAAYE,IAAK,CACjC,IAAIrC,EAAMiC,EAAYI,IACW,IAA7BH,EAAWI,QAAQtC,GACnB4B,EAAQW,IAAIvC,GAIZ4B,EAAQ/B,OAAOG,GA6CvB,OAxCIU,GAAmBkB,EAAQ3B,OAC3B+B,EAAmB,IAIvBJ,EAAQlC,SAAQ,SAAUM,GAEtB,IAAiC,IAA7BkC,EAAWI,QAAQtC,GAAvB,CAEA,IAAIO,EAAQoB,EAAYa,IAAIxC,GAC5B,GAAKO,EAAL,CAEA,IAAIkC,EAAiBR,EAAYK,QAAQtC,GAczCgC,EAAiBU,OAAOD,EAAgB,EAAG,gBAAoB7D,cAAe,CAAEoB,IAAKM,YAAYC,GAAQvB,WAAW,EAAOC,eAb9G,WACT0C,EAAY9B,OAAOG,GACnB4B,EAAQ/B,OAAOG,GAEf,IAAI2C,EAAcjB,EAAgBT,QAAQ2B,WAAU,SAAUC,GAAgB,OAAOA,EAAa7C,MAAQA,KAC1G0B,EAAgBT,QAAQyB,OAAOC,EAAa,GAEvCf,EAAQ3B,OACTyB,EAAgBT,QAAUK,EAC1BV,IACA3B,GAAkBA,MAGyHC,OAAQA,EAAQC,sBAAuBA,GAAyBoB,SAIvNyB,EAAmBA,EAAiBD,KAAI,SAAUxB,GAC9C,IAAIP,EAAMO,EAAMP,IAChB,OAAO4B,EAAQkB,IAAI9C,GAAO,EAAW,gBAAoBpB,cAAe,CAAEoB,IAAKM,YAAYC,GAAQvB,WAAW,EAAMG,sBAAuBA,GAAyBoB,MAExKmB,EAAgBT,QAAUe,EAMlB,gBAAoB,WAAgB,KAAMJ,EAAQ3B,KACpD+B,EACAA,EAAiBD,KAAI,SAAUxB,GAAS,OAAO,uBAAaA,S,kCEvLtE,icA+BIwC,EAAWC,KAAKC,IAAI,EAAG,IAG3B,SAASC,aAAa9C,GAAS,OAJjB,MAIwBA,EAKtC,IAAI+C,EAAY,SAASA,UAAUC,EAAKC,EAASC,QAC9B,IAAZD,IAAqBA,GAAU,QACnB,IAAZC,IAAqBA,EAAU,MAGpCC,KAAKH,IAAMA,EAGXG,KAAKF,QAAUA,EACfE,KAAKD,QAAUA,GAQbE,EAAU,SAASA,QAAQC,EAAQC,QACnB,IAAbA,IAAsBA,GAAW,GAEtCH,KAAKE,OAASA,EACdF,KAAKG,SAAWA,GAGlBF,EAAQG,UAAUL,QAAU,SAASA,QAASlD,GAC5C,IAAIwD,EAAO,EAAGC,EAAQX,aAAa9C,GACnC,IAAKmD,KAAKG,SAAY,IAAK,IAAIrB,EAAI,EAAGA,EAAIwB,EAAOxB,IAC7CuB,GAAQL,KAAKE,OAAW,EAAJpB,EAAQ,GAAKkB,KAAKE,OAAW,EAAJpB,EAAQ,GACzD,OAAOkB,KAAKE,OAAe,EAARI,GAAaD,EAhClC,SAASE,cAAc1D,GAAS,OAAQA,GAL1B,MAKmCA,IAAoB2C,EAgC5Be,CAAc1D,IAIvDoD,EAAQG,UAAUI,UAAY,SAASA,UAAWX,EAAKY,GAEtD,YADgB,IAAVA,IAAmBA,EAAQ,GAC1BT,KAAKU,KAAKb,EAAKY,GAAO,IAG9BR,EAAQG,UAAU5B,IAAM,SAASA,IAAKqB,EAAKY,GAE1C,YADgB,IAAVA,IAAmBA,EAAQ,GAC1BT,KAAKU,KAAKb,EAAKY,GAAO,IAE9BR,EAAQG,UAAUM,KAAO,SAASA,KAAMb,EAAKY,EAAOE,GAElD,IADA,IAAIN,EAAO,EAAGO,EAAWZ,KAAKG,SAAW,EAAI,EAAGU,EAAWb,KAAKG,SAAW,EAAI,EACtErB,EAAI,EAAGA,EAAIkB,KAAKE,OAAOrB,OAAQC,GAAK,EAAG,CAC9C,IAAIgC,EAAQd,KAAKE,OAAOpB,IAAMkB,KAAKG,SAAWE,EAAO,GACrD,GAAIS,EAAQjB,EAAO,MACnB,IAAIkB,EAAUf,KAAKE,OAAOpB,EAAI8B,GAAWI,EAAUhB,KAAKE,OAAOpB,EAAI+B,GAAWI,EAAMH,EAAQC,EAC5F,GAAIlB,GAAOoB,EAAK,CACd,IACIC,EAASJ,EAAQT,IADTU,EAAkBlB,GAAOiB,GAAS,EAAIjB,GAAOoB,EAAM,EAAIR,EAA7CA,GACc,EAAI,EAAIO,GAC5C,GAAIL,EAAU,OAAOO,EACrB,IAAInB,EAAsBjB,EAAI,GAAGe,EAAMiB,GAzDiBtB,EA0DxD,OAAO,IAAII,EAAUsB,EAAQT,EAAQ,EAAIZ,GAAOiB,EAAQjB,GAAOoB,EAAKlB,GAEtEM,GAAQW,EAAUD,EAEpB,OAAOJ,EAASd,EAAMQ,EAAO,IAAIT,EAAUC,EAAMQ,IAGnDJ,EAAQG,UAAUe,QAAU,SAASA,QAAStB,EAAKE,GAGjD,IAFA,IAAIM,EAAO,EAAGC,EAAQX,aAAaI,GAC/Ba,EAAWZ,KAAKG,SAAW,EAAI,EAAGU,EAAWb,KAAKG,SAAW,EAAI,EAC5DrB,EAAI,EAAGA,EAAIkB,KAAKE,OAAOrB,OAAQC,GAAK,EAAG,CAC9C,IAAIgC,EAAQd,KAAKE,OAAOpB,IAAMkB,KAAKG,SAAWE,EAAO,GACrD,GAAIS,EAAQjB,EAAO,MACnB,IAAIkB,EAAUf,KAAKE,OAAOpB,EAAI8B,GAC9B,GAAIf,GAD2CiB,EAAQC,GACrCjC,GAAa,EAARwB,EAAa,OAAO,EAC3CD,GAAQL,KAAKE,OAAOpB,EAAI+B,GAAYE,EAEtC,OAAO,GAMTd,EAAQG,UAAUjE,QAAU,SAASA,QAASiF,GAE5C,IADA,IAAIR,EAAWZ,KAAKG,SAAW,EAAI,EAAGU,EAAWb,KAAKG,SAAW,EAAI,EAC5DrB,EAAI,EAAGuB,EAAO,EAAGvB,EAAIkB,KAAKE,OAAOrB,OAAQC,GAAK,EAAG,CACxD,IAAIgC,EAAQd,KAAKE,OAAOpB,GAAIuC,EAAWP,GAASd,KAAKG,SAAWE,EAAO,GAAIiB,EAAWR,GAASd,KAAKG,SAAW,EAAIE,GAC/GU,EAAUf,KAAKE,OAAOpB,EAAI8B,GAAWI,EAAUhB,KAAKE,OAAOpB,EAAI+B,GACnEO,EAAEC,EAAUA,EAAWN,EAASO,EAAUA,EAAWN,GACrDX,GAAQW,EAAUD,IAOtBd,EAAQG,UAAUmB,OAAS,SAASA,SAClC,OAAO,IAAItB,EAAQD,KAAKE,QAASF,KAAKG,WAGxCF,EAAQG,UAAUoB,SAAW,SAASA,WACpC,OAAQxB,KAAKG,SAAW,IAAM,IAAMsB,KAAKC,UAAU1B,KAAKE,SAO1DD,EAAQ0B,OAAS,SAASA,OAAQC,GAChC,OAAY,GAALA,EAAS3B,EAAQ4B,MAAQ,IAAI5B,EAAQ2B,EAAI,EAAI,CAAC,GAAIA,EAAG,GAAK,CAAC,EAAG,EAAGA,KAG1E3B,EAAQ4B,MAAQ,IAAI5B,EAAQ,IAS5B,IAAI6B,EAAU,SAASA,QAAQC,EAAMC,EAAQC,EAAMC,GAGjDlC,KAAK+B,KAAOA,GAAQ,GAIpB/B,KAAKiC,KAAOA,GAAQ,EAGpBjC,KAAKkC,GAAW,MAANA,EAAalC,KAAK+B,KAAKlD,OAASqD,EAC1ClC,KAAKgC,OAASA,GAmHhB,SAASG,eAAeC,GACtB,IAAIC,EAAMC,MAAMC,KAAKvC,KAAMoC,GAE3B,OADAC,EAAIG,UAAYL,eAAe/B,UACxBiC,EAjHTP,EAAQ1B,UAAUqC,MAAQ,SAASA,MAAOR,EAAMC,GAI9C,YAHgB,IAATD,IAAkBA,EAAO,QAClB,IAAPC,IAAgBA,EAAKlC,KAAK+B,KAAKlD,QAE/B,IAAIiD,EAAQ9B,KAAK+B,KAAM/B,KAAKgC,OAAQC,EAAMC,IAGnDJ,EAAQ1B,UAAUsC,KAAO,SAASA,OAChC,OAAO,IAAIZ,EAAQ9B,KAAK+B,KAAKU,QAASzC,KAAKgC,QAAUhC,KAAKgC,OAAOS,QAASzC,KAAKiC,KAAMjC,KAAKkC,KAO5FJ,EAAQ1B,UAAUuC,UAAY,SAASA,UAAWnE,EAAKoE,GACrD5C,KAAKkC,GAAKlC,KAAK+B,KAAK7D,KAAKM,GACV,MAAXoE,GAAmB5C,KAAK6C,UAAU7C,KAAK+B,KAAKlD,OAAS,EAAG+D,IAM9Dd,EAAQ1B,UAAU0C,cAAgB,SAASA,cAAeC,GACxD,IAAK,IAAIjE,EAAI,EAAGkE,EAAYhD,KAAK+B,KAAKlD,OAAQC,EAAIiE,EAAQhB,KAAKlD,OAAQC,IAAK,CAC1E,IAAImE,EAAOF,EAAQG,UAAUpE,GAC7BkB,KAAK2C,UAAUI,EAAQhB,KAAKjD,GAAY,MAARmE,GAAgBA,EAAOnE,EAAIkE,EAAYC,EAAO,QAQlFnB,EAAQ1B,UAAU8C,UAAY,SAASA,UAAWtB,GAChD,GAAI5B,KAAKgC,OAAU,IAAK,IAAIlD,EAAI,EAAGA,EAAIkB,KAAKgC,OAAOnD,OAAQC,IACvD,GAAIkB,KAAKgC,OAAOlD,IAAM8C,EAAK,OAAO5B,KAAKgC,OAAOlD,GAAKA,EAAI,GAAK,EAAI,KAGtEgD,EAAQ1B,UAAUyC,UAAY,SAASA,UAAWjB,EAAGuB,GAC9CnD,KAAKgC,SAAUhC,KAAKgC,OAAS,IAClChC,KAAKgC,OAAO9D,KAAK0D,EAAGuB,IAKtBrB,EAAQ1B,UAAUgD,sBAAwB,SAASA,sBAAuBL,GACxE,IAAK,IAAIjE,EAAIiE,EAAQhB,KAAKlD,OAAS,EAAGwE,EAAYrD,KAAK+B,KAAKlD,OAASkE,EAAQhB,KAAKlD,OAAQC,GAAK,EAAGA,IAAK,CACrG,IAAImE,EAAOF,EAAQG,UAAUpE,GAC7BkB,KAAK2C,UAAUI,EAAQhB,KAAKjD,GAAGyC,SAAkB,MAAR0B,GAAgBA,EAAOnE,EAAIuE,EAAYJ,EAAO,EAAI,QAM/FnB,EAAQ1B,UAAUmB,OAAS,SAASA,SAClC,IAAI+B,EAAU,IAAIxB,EAElB,OADAwB,EAAQF,sBAAsBpD,MACvBsD,GAKTxB,EAAQ1B,UAAU5B,IAAM,SAASA,IAAKqB,EAAKY,GAGzC,QAFiB,IAAVA,IAAmBA,EAAQ,GAE9BT,KAAKgC,OAAU,OAAOhC,KAAKU,KAAKb,EAAKY,GAAO,GAChD,IAAK,IAAI3B,EAAIkB,KAAKiC,KAAMnD,EAAIkB,KAAKkC,GAAIpD,IACjCe,EAAMG,KAAK+B,KAAKjD,GAAGN,IAAIqB,EAAKY,GAChC,OAAOZ,GAMTiC,EAAQ1B,UAAUI,UAAY,SAASA,UAAWX,EAAKY,GAEtD,YADgB,IAAVA,IAAmBA,EAAQ,GAC1BT,KAAKU,KAAKb,EAAKY,GAAO,IAE9BqB,EAAQ1B,UAAUM,KAAO,SAASA,KAAMb,EAAKY,EAAOE,GAGlD,IAFA,IAAIb,GAAU,EAAOyD,EAAe,KAE3BzE,EAAIkB,KAAKiC,KAAMnD,EAAIkB,KAAKkC,GAAIpD,IAAK,CACxC,IAAIN,EAAMwB,KAAK+B,KAAKjD,GAAI0E,EAAMD,GAAgBA,EAAazE,GAC3D,GAAW,MAAP0E,GAAehF,EAAI2C,QAAQtB,EAAK2D,GAClC3D,EAAMrB,EAAIuB,QAAQyD,OADpB,CAKA,IAAItC,EAAS1C,EAAIgC,UAAUX,EAAKY,GAChC,GAAsB,MAAlBS,EAAOnB,QAAiB,CAC1B,IAAI0D,EAAOzD,KAAKkD,UAAUpE,GAC1B,GAAY,MAAR2E,GAAgBA,EAAO3E,GAAK2E,EAAOzD,KAAKkC,GAAI,CAC9C,GAAIhB,EAAOpB,QAAS,CAClBhB,EAAI2E,EACJ5D,EAAMG,KAAK+B,KAAK0B,GAAM1D,QAAQmB,EAAOnB,SACrC,UAETwD,IAAiBA,EAAeG,OAAOC,OAAO,QAAQF,GAAQvC,EAAOnB,SAK9DmB,EAAOpB,UAAWA,GAAU,GAChCD,EAAMqB,EAAOrB,KAGf,OAAOc,EAASd,EAAM,IAAID,EAAUC,EAAKC,IAS3CqC,eAAe/B,UAAYsD,OAAOC,OAAOrB,MAAMlC,WAC/C+B,eAAe/B,UAAUwD,YAAczB,eACvCA,eAAe/B,UAAUyD,KAAO,iBAOhC,IAAIC,EAAY,SAASA,UAAUC,GAIjC/D,KAAK+D,IAAMA,EAGX/D,KAAKgE,MAAQ,GAGbhE,KAAKiE,KAAO,GAGZjE,KAAK+C,QAAU,IAAIjB,GAGjBoC,EAAqB,CAAEC,OAAQ,CAAEC,cAAc,GAAOC,WAAY,CAAED,cAAc,IAuCtF,SAASE,eAAiB,MAAM,IAAIhC,MAAM,eApC1C4B,EAAmBC,OAAOlF,IAAM,WAAc,OAAOe,KAAKiE,KAAKpF,OAASmB,KAAKiE,KAAK,GAAKjE,KAAK+D,KAK5FD,EAAU1D,UAAUmE,KAAO,SAASA,KAAMC,GACxC,IAAItD,EAASlB,KAAKyE,UAAUD,GAC5B,GAAItD,EAAOwD,OAAU,MAAM,IAAIvC,eAAejB,EAAOwD,QACrD,OAAO1E,MAMT8D,EAAU1D,UAAUqE,UAAY,SAASA,UAAWF,GAClD,IAAIrD,EAASqD,EAAKI,MAAM3E,KAAK+D,KAE7B,OADK7C,EAAOwD,QAAU1E,KAAK4E,QAAQL,EAAMrD,EAAO6C,KACzC7C,GAMTgD,EAAmBG,WAAWpF,IAAM,WAClC,OAAOe,KAAKgE,MAAMnF,OAAS,GAG7BiF,EAAU1D,UAAUwE,QAAU,SAASA,QAASL,EAAMR,GACpD/D,KAAKiE,KAAK/F,KAAK8B,KAAK+D,KACpB/D,KAAKgE,MAAM9F,KAAKqG,GAChBvE,KAAK+C,QAAQJ,UAAU4B,EAAKM,UAC5B7E,KAAK+D,IAAMA,GAGbL,OAAOoB,iBAAkBhB,EAAU1D,UAAW8D,GAI9C,IAAIa,EAAYrB,OAAOC,OAAO,MAW1BqB,EAAO,SAASA,SAEpBA,EAAK5E,UAAUuE,MAAQ,SAASA,MAAOM,GAAQ,OAAOX,gBAMtDU,EAAK5E,UAAUyE,OAAS,SAASA,SAAY,OAAO5E,EAAQ4B,OAK5DmD,EAAK5E,UAAUmB,OAAS,SAASA,OAAQ0D,GAAQ,OAAOX,gBAMxDU,EAAK5E,UAAU5B,IAAM,SAASA,IAAK0G,GAAY,OAAOZ,gBAMtDU,EAAK5E,UAAU+E,MAAQ,SAASA,MAAOC,GAAU,OAAO,MAOxDJ,EAAK5E,UAAUiF,OAAS,SAASA,SAAY,OAAOf,gBAKpDU,EAAKM,SAAW,SAASA,SAAUC,EAAQC,GACzC,IAAKA,IAASA,EAAKC,SAAY,MAAM,IAAIC,WAAW,mCACpD,IAAIC,EAAOZ,EAAUS,EAAKC,UAC1B,IAAKE,EAAQ,MAAM,IAAID,WAAY,gBAAmBF,EAAa,SAAI,YACvE,OAAOG,EAAKL,SAASC,EAAQC,IAQ/BR,EAAKY,OAAS,SAASA,OAAQxK,EAAIyK,GACjC,GAAIzK,KAAM2J,EAAa,MAAM,IAAIW,WAAW,iCAAmCtK,GAG/E,OAFA2J,EAAU3J,GAAMyK,EAChBA,EAAUzF,UAAUwF,OAASxK,EACtByK,GAKT,IAAIC,EAAa,SAASA,WAAW/B,EAAKW,GAExC1E,KAAK+D,IAAMA,EAEX/D,KAAK0E,OAASA,GAKhBoB,EAAWC,GAAK,SAASA,GAAIhC,GAAO,OAAO,IAAI+B,EAAW/B,EAAK,OAI/D+B,EAAWE,KAAO,SAASA,KAAM5D,GAAW,OAAO,IAAI0D,EAAW,KAAM1D,IAMxE0D,EAAWG,YAAc,SAASA,YAAalC,EAAK9B,EAAMC,EAAIO,GAC5D,IACE,OAAOqD,EAAWC,GAAGhC,EAAImC,QAAQjE,EAAMC,EAAIO,IAC3C,MAAO0D,GACP,GAAIA,aAAa,eAAgB,OAAOL,EAAWE,KAAKG,EAAE/D,SAC1D,MAAM+D,IAKV,IAAIC,EAA4B,SAAUpB,GACxC,SAASoB,YAAYnE,EAAMC,EAAIO,EAAO4D,GACpCrB,EAAKzC,KAAKvC,MACVA,KAAKiC,KAAOA,EACZjC,KAAKkC,GAAKA,EACVlC,KAAKyC,MAAQA,EACbzC,KAAKqG,YAAcA,EAwDrB,OArDKrB,IAAOoB,YAAY5D,UAAYwC,GACpCoB,YAAYhG,UAAYsD,OAAOC,OAAQqB,GAAQA,EAAK5E,WACpDgG,YAAYhG,UAAUwD,YAAcwC,YAEpCA,YAAYhG,UAAUuE,MAAQ,SAASA,MAAOZ,GAC5C,OAAI/D,KAAKqG,WAAaC,eAAevC,EAAK/D,KAAKiC,KAAMjC,KAAKkC,IAC/C4D,EAAWE,KAAK,6CACpBF,EAAWG,YAAYlC,EAAK/D,KAAKiC,KAAMjC,KAAKkC,GAAIlC,KAAKyC,QAG9D2D,YAAYhG,UAAUyE,OAAS,SAASA,SACtC,OAAO,IAAI5E,EAAQ,CAACD,KAAKiC,KAAMjC,KAAKkC,GAAKlC,KAAKiC,KAAMjC,KAAKyC,MAAM/F,QAGjE0J,YAAYhG,UAAUmB,OAAS,SAASA,OAAQwC,GAC9C,OAAO,IAAIqC,YAAYpG,KAAKiC,KAAMjC,KAAKiC,KAAOjC,KAAKyC,MAAM/F,KAAMqH,EAAItB,MAAMzC,KAAKiC,KAAMjC,KAAKkC,MAG3FkE,YAAYhG,UAAU5B,IAAM,SAASA,IAAKuE,GACxC,IAAId,EAAOc,EAAQvC,UAAUR,KAAKiC,KAAM,GAAIC,EAAKa,EAAQvC,UAAUR,KAAKkC,IAAK,GAC7E,OAAID,EAAKnC,SAAWoC,EAAGpC,QAAkB,KAClC,IAAIsG,YAAYnE,EAAKpC,IAAKJ,KAAK8G,IAAItE,EAAKpC,IAAKqC,EAAGrC,KAAMG,KAAKyC,QAGpE2D,YAAYhG,UAAU+E,MAAQ,SAASA,MAAOqB,GAC5C,KAAMA,aAAiBJ,cAAgBI,EAAMH,WAAarG,KAAKqG,UAAa,OAAO,KAEnF,GAAIrG,KAAKiC,KAAOjC,KAAKyC,MAAM/F,MAAQ8J,EAAMvE,MAASjC,KAAKyC,MAAMgE,SAAYD,EAAM/D,MAAMiE,UAI9E,IAAIF,EAAMtE,IAAMlC,KAAKiC,MAASjC,KAAKyC,MAAMiE,WAAcF,EAAM/D,MAAMgE,QAKxE,OAAO,KAJP,IAAIE,EAAU3G,KAAKyC,MAAM/F,KAAO8J,EAAM/D,MAAM/F,MAAQ,EAAI,QAAMmF,MACxD,IAAI,QAAM2E,EAAM/D,MAAMmE,QAAQC,OAAO7G,KAAKyC,MAAMmE,SAAUJ,EAAM/D,MAAMiE,UAAW1G,KAAKyC,MAAMgE,SAClG,OAAO,IAAIL,YAAYI,EAAMvE,KAAMjC,KAAKkC,GAAIyE,EAAS3G,KAAKqG,WAN1D,IAAI5D,EAAQzC,KAAKyC,MAAM/F,KAAO8J,EAAM/D,MAAM/F,MAAQ,EAAI,QAAMmF,MACtD,IAAI,QAAM7B,KAAKyC,MAAMmE,QAAQC,OAAOL,EAAM/D,MAAMmE,SAAU5G,KAAKyC,MAAMiE,UAAWF,EAAM/D,MAAMgE,SAClG,OAAO,IAAIL,YAAYpG,KAAKiC,KAAMjC,KAAKkC,IAAMsE,EAAMtE,GAAKsE,EAAMvE,MAAOQ,EAAOzC,KAAKqG,YAUrFD,YAAYhG,UAAUiF,OAAS,SAASA,SACtC,IAAIG,EAAO,CAACC,SAAU,UAAWxD,KAAMjC,KAAKiC,KAAMC,GAAIlC,KAAKkC,IAG3D,OAFIlC,KAAKyC,MAAM/F,OAAQ8I,EAAK/C,MAAQzC,KAAKyC,MAAM4C,UAC3CrF,KAAKqG,YAAab,EAAKa,WAAY,GAChCb,GAGTY,YAAYd,SAAW,SAASA,SAAUC,EAAQC,GAChD,GAAwB,iBAAbA,EAAKvD,MAAsC,iBAAXuD,EAAKtD,GAC5C,MAAM,IAAIwD,WAAW,0CACzB,OAAO,IAAIU,YAAYZ,EAAKvD,KAAMuD,EAAKtD,GAAI,QAAMoD,SAASC,EAAQC,EAAK/C,SAAU+C,EAAKa,YAGjFD,YA9DsB,CA+D7BpB,GAEFA,EAAKY,OAAO,UAAWQ,GAKvB,IAAIU,EAAkC,SAAU9B,GAC9C,SAAS8B,kBAAkB7E,EAAMC,EAAI6E,EAASC,EAAOvE,EAAOwE,EAAQZ,GAClErB,EAAKzC,KAAKvC,MACVA,KAAKiC,KAAOA,EACZjC,KAAKkC,GAAKA,EACVlC,KAAK+G,QAAUA,EACf/G,KAAKgH,MAAQA,EACbhH,KAAKyC,MAAQA,EACbzC,KAAKiH,OAASA,EACdjH,KAAKqG,YAAcA,EAwDrB,OArDKrB,IAAO8B,kBAAkBtE,UAAYwC,GAC1C8B,kBAAkB1G,UAAYsD,OAAOC,OAAQqB,GAAQA,EAAK5E,WAC1D0G,kBAAkB1G,UAAUwD,YAAckD,kBAE1CA,kBAAkB1G,UAAUuE,MAAQ,SAASA,MAAOZ,GAClD,GAAI/D,KAAKqG,YAAcC,eAAevC,EAAK/D,KAAKiC,KAAMjC,KAAK+G,UACpCT,eAAevC,EAAK/D,KAAKgH,MAAOhH,KAAKkC,KACxD,OAAO4D,EAAWE,KAAK,iDAE3B,IAAIkB,EAAMnD,EAAItB,MAAMzC,KAAK+G,QAAS/G,KAAKgH,OACvC,GAAIE,EAAIR,WAAaQ,EAAIT,QACrB,OAAOX,EAAWE,KAAK,2BAC3B,IAAImB,EAAWnH,KAAKyC,MAAM2E,SAASpH,KAAKiH,OAAQC,EAAIN,SACpD,OAAKO,EACErB,EAAWG,YAAYlC,EAAK/D,KAAKiC,KAAMjC,KAAKkC,GAAIiF,GAD/BrB,EAAWE,KAAK,gCAI1Cc,kBAAkB1G,UAAUyE,OAAS,SAASA,SAC5C,OAAO,IAAI5E,EAAQ,CAACD,KAAKiC,KAAMjC,KAAK+G,QAAU/G,KAAKiC,KAAMjC,KAAKiH,OAC1CjH,KAAKgH,MAAOhH,KAAKkC,GAAKlC,KAAKgH,MAAOhH,KAAKyC,MAAM/F,KAAOsD,KAAKiH,UAG/EH,kBAAkB1G,UAAUmB,OAAS,SAASA,OAAQwC,GACpD,IAAImD,EAAMlH,KAAKgH,MAAQhH,KAAK+G,QAC5B,OAAO,IAAID,kBAAkB9G,KAAKiC,KAAMjC,KAAKiC,KAAOjC,KAAKyC,MAAM/F,KAAOwK,EACzClH,KAAKiC,KAAOjC,KAAKiH,OAAQjH,KAAKiC,KAAOjC,KAAKiH,OAASC,EACnDnD,EAAItB,MAAMzC,KAAKiC,KAAMjC,KAAKkC,IAAImF,cAAcrH,KAAK+G,QAAU/G,KAAKiC,KAAMjC,KAAKgH,MAAQhH,KAAKiC,MACxFjC,KAAK+G,QAAU/G,KAAKiC,KAAMjC,KAAKqG,YAG9DS,kBAAkB1G,UAAU5B,IAAM,SAASA,IAAKuE,GAC9C,IAAId,EAAOc,EAAQvC,UAAUR,KAAKiC,KAAM,GAAIC,EAAKa,EAAQvC,UAAUR,KAAKkC,IAAK,GACzE6E,EAAUhE,EAAQvE,IAAIwB,KAAK+G,SAAU,GAAIC,EAAQjE,EAAQvE,IAAIwB,KAAKgH,MAAO,GAC7E,OAAK/E,EAAKnC,SAAWoC,EAAGpC,SAAYiH,EAAU9E,EAAKpC,KAAOmH,EAAQ9E,EAAGrC,IAAc,KAC5E,IAAIiH,kBAAkB7E,EAAKpC,IAAKqC,EAAGrC,IAAKkH,EAASC,EAAOhH,KAAKyC,MAAOzC,KAAKiH,OAAQjH,KAAKqG,YAG/FS,kBAAkB1G,UAAUiF,OAAS,SAASA,SAC5C,IAAIG,EAAO,CAACC,SAAU,gBAAiBxD,KAAMjC,KAAKiC,KAAMC,GAAIlC,KAAKkC,GACrD6E,QAAS/G,KAAK+G,QAASC,MAAOhH,KAAKgH,MAAOC,OAAQjH,KAAKiH,QAGnE,OAFIjH,KAAKyC,MAAM/F,OAAQ8I,EAAK/C,MAAQzC,KAAKyC,MAAM4C,UAC3CrF,KAAKqG,YAAab,EAAKa,WAAY,GAChCb,GAGTsB,kBAAkBxB,SAAW,SAASA,SAAUC,EAAQC,GACtD,GAAwB,iBAAbA,EAAKvD,MAAsC,iBAAXuD,EAAKtD,IACrB,iBAAhBsD,EAAKuB,SAA4C,iBAAdvB,EAAKwB,OAA2C,iBAAfxB,EAAKyB,OAChF,MAAM,IAAIvB,WAAW,gDACzB,OAAO,IAAIoB,kBAAkBtB,EAAKvD,KAAMuD,EAAKtD,GAAIsD,EAAKuB,QAASvB,EAAKwB,MACvC,QAAM1B,SAASC,EAAQC,EAAK/C,OAAQ+C,EAAKyB,SAAUzB,EAAKa,YAGhFS,kBAjE4B,CAkEnC9B,GAIF,SAASsB,eAAevC,EAAK9B,EAAMC,GAEjC,IADA,IAAIoF,EAAQvD,EAAIwD,QAAQtF,GAAOuF,EAAOtF,EAAKD,EAAMwF,EAAQH,EAAMG,MACxDD,EAAO,GAAKC,EAAQ,GAAKH,EAAMI,WAAWD,IAAUH,EAAMK,KAAKF,GAAOG,YAC3EH,IACAD,IAEF,GAAIA,EAAO,EAET,IADA,IAAIK,EAAOP,EAAMK,KAAKF,GAAOK,WAAWR,EAAMI,WAAWD,IAClDD,EAAO,GAAG,CACf,IAAKK,GAAQA,EAAKE,OAAU,OAAO,EACnCF,EAAOA,EAAKG,WACZR,IAGJ,OAAO,EAGT,SAASS,OAAON,EAAM7G,EAAOG,GAC3B,OAAiB,GAATH,GAAc6G,EAAKO,WAAWpH,EAAO6G,EAAKC,eAC/C3G,GAAO0G,EAAKC,YAAcD,EAAKO,WAAW,EAAGjH,IAOlD,SAASkH,WAAWC,GAGlB,IAFA,IACIxB,EADSwB,EAAMC,OACEzB,QAAQ0B,WAAWF,EAAMG,WAAYH,EAAMI,UACvDf,EAAQW,EAAMX,SAAUA,EAAO,CACtC,IAAIE,EAAOS,EAAMd,MAAMK,KAAKF,GACxBnH,EAAQ8H,EAAMd,MAAMhH,MAAMmH,GAAQe,EAAWJ,EAAMK,IAAIf,WAAWD,GACtE,GAAIA,EAAQW,EAAMX,OAASE,EAAKO,WAAW5H,EAAOkI,EAAU5B,GACxD,OAAOa,EACX,GAAa,GAATA,GAAcE,EAAKhC,KAAK+C,KAAKC,YAAcV,OAAON,EAAMrH,EAAOkI,GAAa,OAiDpF,SAASI,aAAaR,EAAOS,EAAUC,EAAOC,QACxB,IAAfA,IAAwBA,EAAaX,GAE1C,IAAIY,EAQN,SAASC,oBAAoBb,EAAOzC,GAClC,IAAI0C,EAASD,EAAMC,OACfE,EAAaH,EAAMG,WACnBC,EAAWJ,EAAMI,SACjBQ,EAASX,EAAOa,eAAeX,GAAYK,aAAajD,GAC5D,IAAKqD,EAAU,OAAO,KACtB,IAAIG,EAAQH,EAAOnK,OAASmK,EAAO,GAAKrD,EACxC,OAAO0C,EAAOe,eAAeb,EAAYC,EAAUW,GAASH,EAAS,KAfxDC,CAAoBb,EAAOS,GACpCQ,EAAQL,GAiBd,SAASM,mBAAmBlB,EAAOzC,GACjC,IAAI0C,EAASD,EAAMC,OACfE,EAAaH,EAAMG,WACnBC,EAAWJ,EAAMI,SACjBa,EAAQhB,EAAOrL,MAAMuL,GACrBgB,EAAS5D,EAAK6D,aAAaZ,aAAaS,EAAM1D,MAClD,IAAK4D,EAAU,OAAO,KAGtB,IAFA,IACIE,GADWF,EAAO1K,OAAS0K,EAAOA,EAAO1K,OAAS,GAAK8G,GACjC6D,aACjB1K,EAAIyJ,EAAYkB,GAAc3K,EAAI0J,EAAU1J,IACjD2K,EAAaA,EAAWC,UAAUrB,EAAOrL,MAAM8B,GAAG6G,MACtD,IAAK8D,IAAeA,EAAWE,SAAY,OAAO,KAClD,OAAOJ,EA7BeD,CAAmBP,EAAYF,GACrD,OAAKQ,EACEL,EAAOxK,IAAIoL,WAAWC,OAAO,CAAClE,KAAMkD,EAAUC,MAAOA,IAAQe,OAAOR,EAAM7K,IAAIoL,YADhE,KAIvB,SAASA,UAAUjE,GAAQ,MAAO,CAACA,KAAMA,EAAMmD,MAAO,MAwFtD,SAASgB,SAAS/F,EAAKlE,EAAK4H,EAAOsC,QAClB,IAAVtC,IAAmBA,EAAQ,GAEhC,IAAIuC,EAAOjG,EAAIwD,QAAQ1H,GAAMoK,EAAOD,EAAKvC,MAAQA,EAC7CyC,EAAaH,GAAcA,EAAWA,EAAWlL,OAAS,IAAOmL,EAAK3B,OAC1E,GAAI4B,EAAO,GAAKD,EAAK3B,OAAO1C,KAAK+C,KAAKC,YACjCqB,EAAK3B,OAAOH,WAAW8B,EAAK1J,QAAS0J,EAAK3B,OAAOT,cACjDsC,EAAUvE,KAAKwE,aAAaH,EAAK3B,OAAOzB,QAAQ0B,WAAW0B,EAAK1J,QAAS0J,EAAK3B,OAAOT,aACtF,OAAO,EACX,IAAK,IAAIwC,EAAIJ,EAAKvC,MAAQ,EAAG3I,EAAI2I,EAAQ,EAAG2C,EAAIH,EAAMG,IAAKtL,IAAK,CAC9D,IAAI6I,EAAOqC,EAAKrC,KAAKyC,GAAIC,EAAUL,EAAK1J,MAAM8J,GAC9C,GAAIzC,EAAKhC,KAAK+C,KAAKC,UAAa,OAAO,EACvC,IAAI2B,EAAO3C,EAAKf,QAAQ0B,WAAW+B,EAAS1C,EAAKC,YAC7C2C,EAASR,GAAcA,EAAWjL,IAAO6I,EAE7C,GADI4C,GAAS5C,IAAQ2C,EAAOA,EAAKE,aAAa,EAAGD,EAAM5E,KAAKhC,OAAO4G,EAAMzB,UACpEnB,EAAKO,WAAWmC,EAAU,EAAG1C,EAAKC,cAAgB2C,EAAM5E,KAAKwE,aAAaG,GAC3E,OAAO,EAEb,IAAIhK,EAAQ0J,EAAKtC,WAAWuC,GACxBQ,EAAWV,GAAcA,EAAW,GACxC,OAAOC,EAAKrC,KAAKsC,GAAMb,eAAe9I,EAAOA,EAAOmK,EAAWA,EAAS9E,KAAOqE,EAAKrC,KAAKsC,EAAO,GAAGtE,MAwBrG,SAAS+E,QAAQ3G,EAAKlE,GACpB,IAAImK,EAAOjG,EAAIwD,QAAQ1H,GAAMS,EAAQ0J,EAAK1J,QAC1C,OAAOqK,SAASX,EAAKY,WAAYZ,EAAKa,YACpCb,EAAK3B,OAAOH,WAAW5H,EAAOA,EAAQ,GAG1C,SAASqK,SAASG,EAAGC,GACnB,OAAOD,GAAKC,IAAMD,EAAE/C,QAAU+C,EAAEE,UAAUD,GAO5C,SAASE,UAAUlH,EAAKlE,EAAKqL,QACd,IAARA,IAAiBA,GAAO,GAG7B,IADA,IAAIlB,EAAOjG,EAAIwD,QAAQ1H,GACduK,EAAIJ,EAAKvC,OAAQ2C,IAAK,CAC7B,IAAIjG,OAAS,EAAUoG,OAAQ,EAAUjK,EAAQ0J,EAAK1J,MAAM8J,GAY5D,GAXIA,GAAKJ,EAAKvC,OACZtD,EAAS6F,EAAKY,WACdL,EAAQP,EAAKa,WACJK,EAAM,GACf/G,EAAS6F,EAAKrC,KAAKyC,EAAI,GACvB9J,IACAiK,EAAQP,EAAKrC,KAAKyC,GAAGtC,WAAWxH,KAEhC6D,EAAS6F,EAAKrC,KAAKyC,GAAGtC,WAAWxH,EAAQ,GACzCiK,EAAQP,EAAKrC,KAAKyC,EAAI,IAEpBjG,IAAWA,EAAOgH,aAAeR,SAASxG,EAAQoG,IAClDP,EAAKrC,KAAKyC,GAAGlC,WAAW5H,EAAOA,EAAQ,GAAM,OAAOT,EACxD,GAAS,GAALuK,EAAU,MACdvK,EAAMqL,EAAM,EAAIlB,EAAK7F,OAAOiG,GAAKJ,EAAKO,MAAMH,IA0ChD,SAASgB,UAAUrH,EAAKlE,EAAK4C,GAC3B,IAAIuH,EAAOjG,EAAIwD,QAAQ1H,GACvB,IAAK4C,EAAMmE,QAAQlK,KAAQ,OAAOmD,EAElC,IADA,IAAI+G,EAAUnE,EAAMmE,QACX9H,EAAI,EAAGA,EAAI2D,EAAMiE,UAAW5H,IAAO8H,EAAUA,EAAQoB,WAAWpB,QACzE,IAAK,IAAIyE,EAAO,EAAGA,IAA4B,GAAnB5I,EAAMiE,WAAkBjE,EAAM/F,KAAO,EAAI,GAAI2O,IACvE,IAAK,IAAIjB,EAAIJ,EAAKvC,MAAO2C,GAAK,EAAGA,IAAK,CACpC,IAAIkB,EAAOlB,GAAKJ,EAAKvC,MAAQ,EAAIuC,EAAKnK,MAAQmK,EAAKlJ,MAAMsJ,EAAI,GAAKJ,EAAK/I,IAAImJ,EAAI,IAAM,GAAK,EAAI,EAC1FmB,EAAYvB,EAAK1J,MAAM8J,IAAMkB,EAAO,EAAI,EAAI,GAChD,GAAY,GAARD,EACErB,EAAKrC,KAAKyC,GAAGlC,WAAWqD,EAAWA,EAAW3E,GAC9CoD,EAAKrC,KAAKyC,GAAGlB,eAAeqC,GAAW3C,aAAahC,EAAQoB,WAAWrC,MACzE,OAAe,GAAR2F,EAAYtB,EAAKnK,IAAMyL,EAAO,EAAItB,EAAK7F,OAAOiG,EAAI,GAAKJ,EAAKO,MAAMH,EAAI,GAGrF,OAAO,KAGT,SAASoB,YAAYC,EAAUrK,EAAGiH,GAEhC,IADA,IAAIqD,EAAS,GACJ5M,EAAI,EAAGA,EAAI2M,EAAS7D,WAAY9I,IAAK,CAC5C,IAAI9B,EAAQyO,EAASzO,MAAM8B,GACvB9B,EAAM4J,QAAQlK,OAAQM,EAAQA,EAAM0F,KAAK8I,YAAYxO,EAAM4J,QAASxF,EAAGpE,KACvEA,EAAM2O,WAAY3O,EAAQoE,EAAEpE,EAAOqL,EAAQvJ,IAC/C4M,EAAOxN,KAAKlB,GAEd,OAAO,WAAS4O,UAAUF,GAxU5B1G,EAAKY,OAAO,gBAAiBkB,GA8C7BhD,EAAU1D,UAAUyL,KAAO,SAASzD,EAAO0D,GASzC,IARA,IAAIxE,EAAQc,EAAMd,MACdmB,EAAML,EAAMK,IACZhB,EAAQW,EAAMX,MAEdsE,EAAWzE,EAAMnD,OAAOsD,EAAQ,GAAIuE,EAASvD,EAAI8B,MAAM9C,EAAQ,GAC/D3G,EAAQiL,EAAU9K,EAAM+K,EAExB7H,EAAS,WAAStC,MAAO6E,EAAY,EAChC0D,EAAI3C,EAAOwE,GAAY,EAAO7B,EAAI0B,EAAQ1B,IAC3C6B,GAAa3E,EAAMhH,MAAM8J,GAAK,GAClC6B,GAAY,EACZ9H,EAAS,WAASlC,KAAKqF,EAAMK,KAAKyC,GAAG1H,KAAKyB,IAC1CuC,KAEA5F,IAGJ,IADA,IAAIyJ,EAAQ,WAAS1I,MAAO4E,EAAU,EAC7ByF,EAAMzE,EAAO0E,GAAc,EAAOD,EAAMJ,EAAQI,IACjDC,GAAe1D,EAAI8B,MAAM2B,EAAM,GAAKzD,EAAIxH,IAAIiL,IAChDC,GAAc,EACd5B,EAAQ,WAAStI,KAAKwG,EAAId,KAAKuE,GAAKxJ,KAAK6H,IACzC9D,KAEAxF,IAGJ,OAAOjB,KAAKuE,KAAK,IAAIuC,EAAkBhG,EAAOG,EAAK8K,EAAUC,EACtB,IAAI,QAAM7H,EAAO0C,OAAO0D,GAAQ7D,EAAWD,GAC3CtC,EAAOzH,KAAOgK,GAAW,KAkDlE5C,EAAU1D,UAAUgM,KAAO,SAAShE,EAAOiE,GAEzC,IADA,IAAIzF,EAAU,WAAS/E,MACd/C,EAAIuN,EAASxN,OAAS,EAAGC,GAAK,EAAGA,IACtC8H,EAAU,WAAS3E,KAAKoK,EAASvN,GAAG6G,KAAKhC,OAAO0I,EAASvN,GAAGgK,MAAOlC,IAEvE,IAAI9F,EAAQsH,EAAMtH,MAAOG,EAAMmH,EAAMnH,IACrC,OAAOjB,KAAKuE,KAAK,IAAIuC,EAAkBhG,EAAOG,EAAKH,EAAOG,EAAK,IAAI,QAAM2F,EAAS,EAAG,GAAIyF,EAASxN,QAAQ,KAM5GiF,EAAU1D,UAAUkM,aAAe,SAASrK,EAAMC,EAAIyD,EAAMmD,GAC1D,IAAIyD,EAASvM,KAGb,QAFY,IAAPkC,IAAgBA,EAAKD,IAErB0D,EAAKwF,YAAe,MAAM,IAAIzF,WAAW,oDAC9C,IAAI8G,EAAUxM,KAAKgE,MAAMnF,OAYzB,OAXAmB,KAAK+D,IAAI0I,aAAaxK,EAAMC,GAAI,SAAUyF,EAAM9H,GAC9C,GAAI8H,EAAKwD,cAAgBxD,EAAK+E,UAAU/G,EAAMmD,IAalD,SAAS6D,cAAc5I,EAAKlE,EAAK8F,GAC/B,IAAIqE,EAAOjG,EAAIwD,QAAQ1H,GAAMS,EAAQ0J,EAAK1J,QAC1C,OAAO0J,EAAK3B,OAAOe,eAAe9I,EAAOA,EAAQ,EAAGqF,GAfMgH,CAAcJ,EAAOxI,IAAKwI,EAAOxJ,QAAQN,MAAM+J,GAAShO,IAAIqB,GAAM8F,GAAO,CAE/H4G,EAAOK,kBAAkBL,EAAOxJ,QAAQN,MAAM+J,GAAShO,IAAIqB,EAAK,GAAI8F,GACpE,IAAI5C,EAAUwJ,EAAOxJ,QAAQN,MAAM+J,GAC/BK,EAAS9J,EAAQvE,IAAIqB,EAAK,GAAIiN,EAAO/J,EAAQvE,IAAIqB,EAAM8H,EAAKoF,SAAU,GAG1E,OAFAR,EAAOhI,KAAK,IAAIuC,EAAkB+F,EAAQC,EAAMD,EAAS,EAAGC,EAAO,EACnC,IAAI,QAAM,WAAS7K,KAAK0D,EAAKhC,OAAOmF,EAAO,KAAMnB,EAAKqF,QAAS,EAAG,GAAI,GAAG,KAClG,MAGJhN,MAWT8D,EAAU1D,UAAU6M,cAAgB,SAASpN,EAAK8F,EAAMmD,EAAOkE,GAC7D,IAAIrF,EAAO3H,KAAK+D,IAAImJ,OAAOrN,GAC3B,IAAK8H,EAAQ,MAAM,IAAIjC,WAAW,6BAC7BC,IAAQA,EAAOgC,EAAKhC,MACzB,IAAIwH,EAAUxH,EAAKhC,OAAOmF,EAAO,KAAMkE,GAASrF,EAAKqF,OACrD,GAAIrF,EAAKI,OACL,OAAO/H,KAAKoN,YAAYvN,EAAKA,EAAM8H,EAAKoF,SAAUI,GAEtD,IAAKxH,EAAKwE,aAAaxC,EAAKf,SACxB,MAAM,IAAIlB,WAAW,iCAAmCC,EAAK9B,MAEjE,OAAO7D,KAAKuE,KAAK,IAAIuC,EAAkBjH,EAAKA,EAAM8H,EAAKoF,SAAUlN,EAAM,EAAGA,EAAM8H,EAAKoF,SAAW,EACzD,IAAI,QAAM,WAAS9K,KAAKkL,GAAU,EAAG,GAAI,GAAG,KAkCrFrJ,EAAU1D,UAAUiN,MAAQ,SAASxN,EAAK4H,EAAOsC,QAChC,IAAVtC,IAAmBA,EAAQ,GAGhC,IADA,IAAIuC,EAAOhK,KAAK+D,IAAIwD,QAAQ1H,GAAMsE,EAAS,WAAStC,MAAO0I,EAAQ,WAAS1I,MACnEuI,EAAIJ,EAAKvC,MAAOtB,EAAI6D,EAAKvC,MAAQA,EAAO3I,EAAI2I,EAAQ,EAAG2C,EAAIjE,EAAGiE,IAAKtL,IAAK,CAC/EqF,EAAS,WAASlC,KAAK+H,EAAKrC,KAAKyC,GAAG1H,KAAKyB,IACzC,IAAImJ,EAAYvD,GAAcA,EAAWjL,GACzCyL,EAAQ,WAAStI,KAAKqL,EAAYA,EAAU3H,KAAKhC,OAAO2J,EAAUxE,MAAOyB,GAASP,EAAKrC,KAAKyC,GAAG1H,KAAK6H,IAEtG,OAAOvK,KAAKuE,KAAK,IAAI6B,EAAYvG,EAAKA,EAAK,IAAI,QAAMsE,EAAO0C,OAAO0D,GAAQ9C,EAAOA,IAAQ,KA+C5F3D,EAAU1D,UAAUmN,KAAO,SAAS1N,EAAK4H,QACxB,IAAVA,IAAmBA,EAAQ,GAEhC,IAAIlD,EAAO,IAAI6B,EAAYvG,EAAM4H,EAAO5H,EAAM4H,EAAO,QAAM5F,OAAO,GAClE,OAAO7B,KAAKuE,KAAKA,IA6DnB,IAAIiJ,EAA4B,SAAUxI,GACxC,SAASwI,YAAYvL,EAAMC,EAAIuL,GAC7BzI,EAAKzC,KAAKvC,MACVA,KAAKiC,KAAOA,EACZjC,KAAKkC,GAAKA,EACVlC,KAAKyN,KAAOA,EAgDd,OA7CKzI,IAAOwI,YAAYhL,UAAYwC,GACpCwI,YAAYpN,UAAYsD,OAAOC,OAAQqB,GAAQA,EAAK5E,WACpDoN,YAAYpN,UAAUwD,YAAc4J,YAEpCA,YAAYpN,UAAUuE,MAAQ,SAASA,MAAOZ,GAC5C,IAAIwI,EAASvM,KAET0N,EAAW3J,EAAItB,MAAMzC,KAAKiC,KAAMjC,KAAKkC,IAAKoF,EAAQvD,EAAIwD,QAAQvH,KAAKiC,MACnEoG,EAASf,EAAMK,KAAKL,EAAMqG,YAAY3N,KAAKkC,KAC3CO,EAAQ,IAAI,QAAM+I,YAAYkC,EAAS9G,SAAS,SAAUe,EAAMU,GAClE,OAAKA,EAAO1C,KAAKiI,eAAerB,EAAOkB,KAAK9H,MACrCgC,EAAK8F,KAAKlB,EAAOkB,KAAKI,SAASlG,EAAKqF,QADiBrF,IAE3DU,GAASqF,EAAShH,UAAWgH,EAASjH,SACzC,OAAOX,EAAWG,YAAYlC,EAAK/D,KAAKiC,KAAMjC,KAAKkC,GAAIO,IAGzD+K,YAAYpN,UAAUmB,OAAS,SAASA,SACtC,OAAO,IAAIuM,EAAe9N,KAAKiC,KAAMjC,KAAKkC,GAAIlC,KAAKyN,OAGrDD,YAAYpN,UAAU5B,IAAM,SAASA,IAAKuE,GACxC,IAAId,EAAOc,EAAQvC,UAAUR,KAAKiC,KAAM,GAAIC,EAAKa,EAAQvC,UAAUR,KAAKkC,IAAK,GAC7E,OAAID,EAAKnC,SAAWoC,EAAGpC,SAAWmC,EAAKpC,KAAOqC,EAAGrC,IAAc,KACxD,IAAI2N,YAAYvL,EAAKpC,IAAKqC,EAAGrC,IAAKG,KAAKyN,OAGhDD,YAAYpN,UAAU+E,MAAQ,SAASA,MAAOqB,GAC5C,GAAIA,aAAiBgH,aACjBhH,EAAMiH,KAAKM,GAAG/N,KAAKyN,OACnBzN,KAAKiC,MAAQuE,EAAMtE,IAAMlC,KAAKkC,IAAMsE,EAAMvE,KAC1C,OAAO,IAAIuL,YAAY/N,KAAKuO,IAAIhO,KAAKiC,KAAMuE,EAAMvE,MAC5BxC,KAAK8G,IAAIvG,KAAKkC,GAAIsE,EAAMtE,IAAKlC,KAAKyN,OAG7DD,YAAYpN,UAAUiF,OAAS,SAASA,SACtC,MAAO,CAACI,SAAU,UAAWgI,KAAMzN,KAAKyN,KAAKpI,SACrCpD,KAAMjC,KAAKiC,KAAMC,GAAIlC,KAAKkC,KAGpCsL,YAAYlI,SAAW,SAASA,SAAUC,EAAQC,GAChD,GAAwB,iBAAbA,EAAKvD,MAAsC,iBAAXuD,EAAKtD,GAC5C,MAAM,IAAIwD,WAAW,0CACzB,OAAO,IAAI8H,YAAYhI,EAAKvD,KAAMuD,EAAKtD,GAAIqD,EAAO0I,aAAazI,EAAKiI,QAG/DD,YArDsB,CAsD7BxI,GAEFA,EAAKY,OAAO,UAAW4H,GAGvB,IAAIM,EAA+B,SAAU9I,GAC3C,SAAS8I,eAAe7L,EAAMC,EAAIuL,GAChCzI,EAAKzC,KAAKvC,MACVA,KAAKiC,KAAOA,EACZjC,KAAKkC,GAAKA,EACVlC,KAAKyN,KAAOA,EA8Cd,OA3CKzI,IAAO8I,eAAetL,UAAYwC,GACvC8I,eAAe1N,UAAYsD,OAAOC,OAAQqB,GAAQA,EAAK5E,WACvD0N,eAAe1N,UAAUwD,YAAckK,eAEvCA,eAAe1N,UAAUuE,MAAQ,SAASA,MAAOZ,GAC/C,IAAIwI,EAASvM,KAET0N,EAAW3J,EAAItB,MAAMzC,KAAKiC,KAAMjC,KAAKkC,IACrCO,EAAQ,IAAI,QAAM+I,YAAYkC,EAAS9G,SAAS,SAAUe,GAC5D,OAAOA,EAAK8F,KAAKlB,EAAOkB,KAAKS,cAAcvG,EAAKqF,WAC9CU,EAAShH,UAAWgH,EAASjH,SACjC,OAAOX,EAAWG,YAAYlC,EAAK/D,KAAKiC,KAAMjC,KAAKkC,GAAIO,IAGzDqL,eAAe1N,UAAUmB,OAAS,SAASA,SACzC,OAAO,IAAIiM,EAAYxN,KAAKiC,KAAMjC,KAAKkC,GAAIlC,KAAKyN,OAGlDK,eAAe1N,UAAU5B,IAAM,SAASA,IAAKuE,GAC3C,IAAId,EAAOc,EAAQvC,UAAUR,KAAKiC,KAAM,GAAIC,EAAKa,EAAQvC,UAAUR,KAAKkC,IAAK,GAC7E,OAAID,EAAKnC,SAAWoC,EAAGpC,SAAWmC,EAAKpC,KAAOqC,EAAGrC,IAAc,KACxD,IAAIiO,eAAe7L,EAAKpC,IAAKqC,EAAGrC,IAAKG,KAAKyN,OAGnDK,eAAe1N,UAAU+E,MAAQ,SAASA,MAAOqB,GAC/C,GAAIA,aAAiBsH,gBACjBtH,EAAMiH,KAAKM,GAAG/N,KAAKyN,OACnBzN,KAAKiC,MAAQuE,EAAMtE,IAAMlC,KAAKkC,IAAMsE,EAAMvE,KAC1C,OAAO,IAAI6L,eAAerO,KAAKuO,IAAIhO,KAAKiC,KAAMuE,EAAMvE,MAC5BxC,KAAK8G,IAAIvG,KAAKkC,GAAIsE,EAAMtE,IAAKlC,KAAKyN,OAGhEK,eAAe1N,UAAUiF,OAAS,SAASA,SACzC,MAAO,CAACI,SAAU,aAAcgI,KAAMzN,KAAKyN,KAAKpI,SACxCpD,KAAMjC,KAAKiC,KAAMC,GAAIlC,KAAKkC,KAGpC4L,eAAexI,SAAW,SAASA,SAAUC,EAAQC,GACnD,GAAwB,iBAAbA,EAAKvD,MAAsC,iBAAXuD,EAAKtD,GAC5C,MAAM,IAAIwD,WAAW,6CACzB,OAAO,IAAIoI,eAAetI,EAAKvD,KAAMuD,EAAKtD,GAAIqD,EAAO0I,aAAazI,EAAKiI,QAGlEK,eAnDyB,CAoDhC9I,GAoHF,SAASmJ,YAAYpK,EAAK9B,EAAMC,EAAIO,GAIlC,QAHY,IAAPP,IAAgBA,EAAKD,QACX,IAAVQ,IAAmBA,EAAQ,QAAMZ,OAElCI,GAAQC,IAAOO,EAAM/F,KAAQ,OAAO,KAExC,IAAI4K,EAAQvD,EAAIwD,QAAQtF,GAAOwG,EAAM1E,EAAIwD,QAAQrF,GAEjD,OAAIkM,cAAc9G,EAAOmB,EAAKhG,GAAiB,IAAI2D,EAAYnE,EAAMC,EAAIO,GAClE,IAAI4L,EAAO/G,EAAOmB,EAAKhG,GAAO6L,MAkCvC,SAASF,cAAc9G,EAAOmB,EAAKhG,GACjC,OAAQA,EAAMiE,YAAcjE,EAAMgE,SAAWa,EAAMxG,SAAW2H,EAAI3H,SAChEwG,EAAMe,OAAOH,WAAWZ,EAAMhH,QAASmI,EAAInI,QAASmC,EAAMmE,SA/J9D5B,EAAKY,OAAO,aAAckI,GAI1BhK,EAAU1D,UAAUmO,QAAU,SAAStM,EAAMC,EAAIuL,GAC/C,IAAIlB,EAASvM,KAETwO,EAAU,GAAIC,EAAQ,GAAIC,EAAW,KAAMC,EAAS,KA0BxD,OAzBA3O,KAAK+D,IAAI0I,aAAaxK,EAAMC,GAAI,SAAUyF,EAAM9H,EAAKwI,GACnD,GAAKV,EAAKgE,SAAV,CACA,IAAIqB,EAAQrF,EAAKqF,MACjB,IAAKS,EAAKmB,QAAQ5B,IAAU3E,EAAO1C,KAAKiI,eAAeH,EAAK9H,MAAO,CAIjE,IAHA,IAAI7E,EAAQrB,KAAK8G,IAAI1G,EAAKoC,GAAOhB,EAAMxB,KAAKuO,IAAInO,EAAM8H,EAAKoF,SAAU7K,GACjE2M,EAASpB,EAAKI,SAASb,GAElBlO,EAAI,EAAGA,EAAIkO,EAAMnO,OAAQC,IAC3BkO,EAAMlO,GAAG8P,QAAQC,KAChBH,GAAYA,EAASxM,IAAMpB,GAAS4N,EAASjB,KAAKM,GAAGf,EAAMlO,IAC3D4P,EAASxM,GAAKjB,EAEduN,EAAQtQ,KAAKwQ,EAAW,IAAIZ,EAAehN,EAAOG,EAAK+L,EAAMlO,MAIjE6P,GAAUA,EAAOzM,IAAMpB,EACvB6N,EAAOzM,GAAKjB,EAEZwN,EAAMvQ,KAAKyQ,EAAS,IAAInB,EAAY1M,EAAOG,EAAKwM,SAIxDe,EAAQrS,SAAQ,SAAU2S,GAAK,OAAOvC,EAAOhI,KAAKuK,MAClDL,EAAMtS,SAAQ,SAAU2S,GAAK,OAAOvC,EAAOhI,KAAKuK,MACzC9O,MAQT8D,EAAU1D,UAAU2O,WAAa,SAAS9M,EAAMC,EAAIuL,GAClD,IAAIlB,EAASvM,UACC,IAATyN,IAAkBA,EAAO,MAE9B,IAAIuB,EAAU,GAAIzK,EAAO,EA+BzB,OA9BAvE,KAAK+D,IAAI0I,aAAaxK,EAAMC,GAAI,SAAUyF,EAAM9H,GAC9C,GAAK8H,EAAKgE,SAAV,CACApH,IACA,IAAI0K,EAAW,KACf,GAAIxB,aAAgB,WAAU,CAC5B,IAAIyB,EAAQzB,EAAKmB,QAAQjH,EAAKqF,OAC1BkC,IAASD,EAAW,CAACC,SAChBzB,EACLA,EAAKmB,QAAQjH,EAAKqF,SAAUiC,EAAW,CAACxB,IAE5CwB,EAAWtH,EAAKqF,MAElB,GAAIiC,GAAYA,EAASpQ,OAEvB,IADA,IAAIoC,EAAMxB,KAAKuO,IAAInO,EAAM8H,EAAKoF,SAAU7K,GAC/BpD,EAAI,EAAGA,EAAImQ,EAASpQ,OAAQC,IAAK,CAExC,IADA,IAAIqQ,EAAQF,EAASnQ,GAAIsQ,OAAU,EAC1BC,EAAI,EAAGA,EAAIL,EAAQnQ,OAAQwQ,IAAK,CACvC,IAAIlM,EAAI6L,EAAQK,GACZlM,EAAEoB,MAAQA,EAAO,GAAK4K,EAAMpB,GAAGiB,EAAQK,GAAGF,SAAUC,EAAUjM,GAEhEiM,GACFA,EAAQlN,GAAKjB,EACbmO,EAAQ7K,KAAOA,GAEfyK,EAAQ9Q,KAAK,CAACiR,MAAOA,EAAOlN,KAAMxC,KAAK8G,IAAI1G,EAAKoC,GAAOC,GAAIjB,EAAKsD,KAAMA,SAK9EyK,EAAQ7S,SAAQ,SAAUgH,GAAK,OAAOoJ,EAAOhI,KAAK,IAAIuJ,EAAe3K,EAAElB,KAAMkB,EAAEjB,GAAIiB,EAAEgM,WAC9EnP,MAQT8D,EAAU1D,UAAUwM,kBAAoB,SAAS/M,EAAKyP,EAAYC,QACjD,IAAVA,IAAmBA,EAAQD,EAAW9F,cAI3C,IAFA,IAAI7B,EAAO3H,KAAK+D,IAAImJ,OAAOrN,GACvB2P,EAAW,GAAIC,EAAM5P,EAAM,EACtBf,EAAI,EAAGA,EAAI6I,EAAKC,WAAY9I,IAAK,CACxC,IAAI9B,EAAQ2K,EAAK3K,MAAM8B,GAAImC,EAAMwO,EAAMzS,EAAM+P,SACzC2C,EAAUH,EAAM7F,UAAU1M,EAAM2I,KAAM3I,EAAM8L,OAChD,GAAK4G,EAEE,CACLH,EAAQG,EACR,IAAK,IAAIL,EAAI,EAAGA,EAAIrS,EAAMgQ,MAAMnO,OAAQwQ,IAAYC,EAAW1B,eAAe5Q,EAAMgQ,MAAMqC,GAAG1J,OACzF3F,KAAKuE,KAAK,IAAIuJ,EAAe2B,EAAKxO,EAAKjE,EAAMgQ,MAAMqC,UAJvDG,EAAStR,KAAK,IAAIkI,EAAYqJ,EAAKxO,EAAK,QAAMY,QAMhD4N,EAAMxO,EAER,IAAKsO,EAAM5F,SAAU,CACnB,IAAIgG,EAAOJ,EAAMK,WAAW,WAAS/N,OAAO,GAC5C7B,KAAKkG,QAAQuJ,EAAKA,EAAK,IAAI,QAAME,EAAM,EAAG,IAE5C,IAAK,IAAIE,EAAML,EAAS3Q,OAAS,EAAGgR,GAAO,EAAGA,IAAS7P,KAAKuE,KAAKiL,EAASK,IAC1E,OAAO7P,MAuBT8D,EAAU1D,UAAU8F,QAAU,SAASjE,EAAMC,EAAIO,QACnC,IAAPP,IAAgBA,EAAKD,QACX,IAAVQ,IAAmBA,EAAQ,QAAMZ,OAEtC,IAAI0C,EAAO4J,YAAYnO,KAAK+D,IAAK9B,EAAMC,EAAIO,GAE3C,OADI8B,GAAQvE,KAAKuE,KAAKA,GACfvE,MAMT8D,EAAU1D,UAAUgN,YAAc,SAASnL,EAAMC,EAAI0E,GACnD,OAAO5G,KAAKkG,QAAQjE,EAAMC,EAAI,IAAI,QAAM,WAASD,KAAK2E,GAAU,EAAG,KAKrE9C,EAAU1D,UAAU9D,OAAS,SAAS2F,EAAMC,GAC1C,OAAOlC,KAAKkG,QAAQjE,EAAMC,EAAI,QAAML,QAKtCiC,EAAU1D,UAAU6G,OAAS,SAASpH,EAAK+G,GACzC,OAAO5G,KAAKoN,YAAYvN,EAAKA,EAAK+G,IA4BpC,IAAIyH,EAAS,SAASA,OAAO/G,EAAOmB,EAAKhG,GACvCzC,KAAKyI,IAAMA,EACXzI,KAAKsH,MAAQA,EACbtH,KAAK8P,SAAWrN,EAEhBzC,KAAK+P,SAAW,GAChB,IAAK,IAAIjR,EAAI,EAAGA,GAAKwI,EAAMG,MAAO3I,IAAK,CACrC,IAAI6I,EAAOL,EAAMK,KAAK7I,GACtBkB,KAAK+P,SAAS7R,KAAK,CACjByH,KAAMgC,EAAKhC,KACX4J,MAAO5H,EAAKuB,eAAe5B,EAAMI,WAAW5I,MAIhDkB,KAAKgQ,OAAS,WAASnO,MACvB,IAAK,IAAIgO,EAAMvI,EAAMG,MAAOoI,EAAM,EAAGA,IACjC7P,KAAKgQ,OAAS,WAAS/N,KAAKqF,EAAMK,KAAKkI,GAAKnN,KAAK1C,KAAKgQ,UAGxDC,EAAuB,CAAExI,MAAO,CAAErD,cAAc,IAiOpD,SAAS8L,iBAAiBzE,EAAUhE,EAAO0I,GACzC,OAAa,GAAT1I,EAAqBgE,EAASnD,WAAW6H,GACtC1E,EAASjB,aAAa,EAAGiB,EAASzD,WAAWtF,KAAKwN,iBAAiBzE,EAASzD,WAAWpB,QAASa,EAAQ,EAAG0I,KAGpH,SAASC,cAAc3E,EAAUhE,EAAOb,GACtC,OAAa,GAATa,EAAqBgE,EAAS5E,OAAOD,GAClC6E,EAASjB,aAAaiB,EAAS7D,WAAa,EACtB6D,EAAS4E,UAAU3N,KAAK0N,cAAc3E,EAAS4E,UAAUzJ,QAASa,EAAQ,EAAGb,KAG5G,SAAS0J,UAAU7E,EAAUhE,GAC3B,IAAK,IAAI3I,EAAI,EAAGA,EAAI2I,EAAO3I,IAAO2M,EAAWA,EAASzD,WAAWpB,QACjE,OAAO6E,EAGT,SAAS8E,eAAe5I,EAAMjB,EAAWD,GACvC,GAAIC,GAAa,EAAK,OAAOiB,EAC7B,IAAI6I,EAAO7I,EAAKf,QAOhB,OANIF,EAAY,IACZ8J,EAAOA,EAAKhG,aAAa,EAAG+F,eAAeC,EAAKxI,WAAYtB,EAAY,EAAsB,GAAnB8J,EAAK5I,WAAkBnB,EAAU,EAAI,KAChHC,EAAY,IACd8J,EAAO7I,EAAKhC,KAAK6D,aAAaoG,WAAWY,GAAM3J,OAAO2J,GAClD/J,GAAW,IAAK+J,EAAOA,EAAK3J,OAAOc,EAAKhC,KAAK6D,aAAaiH,cAAcD,GAAMZ,WAAW,WAAS/N,OAAO,MAExG8F,EAAKjF,KAAK8N,GAGnB,SAASE,iBAAiBjI,EAAKhB,EAAO9B,EAAM4J,EAAOoB,GACjD,IAAIhJ,EAAOc,EAAId,KAAKF,GAAQnH,EAAQqQ,EAAOlI,EAAIf,WAAWD,GAASgB,EAAInI,MAAMmH,GAC7E,GAAInH,GAASqH,EAAKC,aAAejC,EAAKiL,kBAAkBjJ,EAAKhC,MAAS,OAAO,KAC7E,IAAI2I,EAAMiB,EAAMK,WAAWjI,EAAKf,SAAS,EAAMtG,GAC/C,OAAOgO,IAGT,SAASuC,aAAalL,EAAM8F,EAAU3K,GACpC,IAAK,IAAIhC,EAAIgC,EAAOhC,EAAI2M,EAAS7D,WAAY9I,IACzC,IAAK6G,EAAKmL,YAAYrF,EAASzO,MAAM8B,GAAGkO,OAAU,OAAO,EAC7D,OAAO,EANQ6D,CAAalL,EAAMgC,EAAKf,QAAStG,GAASgO,EAAM,KAiGjE,SAASyC,cAActF,EAAUhE,EAAOuJ,EAASC,EAAS5I,GACxD,GAAIZ,EAAQuJ,EAAS,CACnB,IAAIE,EAAQzF,EAASzD,WACrByD,EAAWA,EAASjB,aAAa,EAAG0G,EAAMxO,KAAKqO,cAAcG,EAAMtK,QAASa,EAAQ,EAAGuJ,EAASC,EAASC,KAE3G,GAAIzJ,EAAQwJ,EAAS,CACnB,IAAI1B,EAAQlH,EAAOa,eAAe,GAC9BpI,EAAQyO,EAAMK,WAAWnE,GAAU5E,OAAO4E,GAC9CA,EAAW3K,EAAM+F,OAAO0I,EAAMkB,cAAc3P,GAAO8O,WAAW,WAAS/N,OAAO,IAEhF,OAAO4J,EA0CT,SAAS0F,cAAc7J,EAAOmB,GAE5B,IADA,IAAIvH,EAAS,GACJkJ,EADmB3K,KAAKuO,IAAI1G,EAAMG,MAAOgB,EAAIhB,OAC/B2C,GAAK,EAAGA,IAAK,CAClC,IAAItJ,EAAQwG,EAAMxG,MAAMsJ,GACxB,GAAItJ,EAAQwG,EAAMzH,KAAOyH,EAAMG,MAAQ2C,IACnC3B,EAAIxH,IAAImJ,GAAK3B,EAAI5I,KAAO4I,EAAIhB,MAAQ2C,IACpC9C,EAAMK,KAAKyC,GAAGzE,KAAK+C,KAAKC,WACxBF,EAAId,KAAKyC,GAAGzE,KAAK+C,KAAKC,UAAa,MACnC7H,GAAS2H,EAAI3H,MAAMsJ,IAAMlJ,EAAOhD,KAAKkM,GAE3C,OAAOlJ,EA9ZT+O,EAAqBxI,MAAMxI,IAAM,WAAc,OAAOe,KAAK+P,SAASlR,OAAS,GAE7EwP,EAAOjO,UAAUkO,IAAM,SAASA,MAI9B,KAAOtO,KAAK8P,SAASpT,MAAM,CACzB,IAAI4R,IAAMtO,KAAKoR,eACX9C,IAAOtO,KAAKqR,WAAW/C,KACpBtO,KAAKsR,YAActR,KAAKuR,WAOjC,IAAIC,EAAaxR,KAAKyR,iBAAkBC,EAAa1R,KAAKgQ,OAAOtT,KAAOsD,KAAKyH,MAAQzH,KAAKsH,MAAMG,MAC5FH,EAAQtH,KAAKsH,MAAOmB,EAAM+I,EAAa,EAAIxR,KAAKyI,IAAMnB,EAAMvD,IAAIwD,QAAQiK,GAC5E,GAAIxR,KAAK2R,MAAMlJ,GAAM,CAEnB,IADA,IAAI7B,EAAU5G,KAAKgQ,OAAQtJ,EAAYY,EAAMG,MAAOhB,EAAUgC,EAAIhB,MAC3Df,GAAaD,GAAiC,GAAtBG,EAAQgB,YACrChB,EAAUA,EAAQoB,WAAWpB,QAC7BF,IAAaD,IAEf,IAAIhE,EAAQ,IAAI,QAAMmE,EAASF,EAAWD,GAC1C,GAAI+K,GAAc,EACd,OAAO,IAAI1K,EAAkBQ,EAAMzH,IAAK2R,EAAYxR,KAAKyI,IAAI5I,IAAKG,KAAKyI,IAAIxH,MAAOwB,EAAOiP,GAC7F,GAAIjP,EAAM/F,MAAQ4K,EAAMzH,KAAOG,KAAKyI,IAAI5I,IACpC,OAAO,IAAIuG,EAAYkB,EAAMzH,IAAK4I,EAAI5I,IAAK4C,GAEjD,OAAO,MAMT4L,EAAOjO,UAAUgR,aAAe,SAASA,eAGvC,IAAK,IAAI/F,EAAO,EAAGA,GAAQ,EAAGA,IAC5B,IAAK,IAAIuG,EAAa5R,KAAK8P,SAASpJ,UAAWkL,GAAc,EAAGA,IAS9D,IARA,IAAyBvJ,OAAS,EAO9B6I,GANAU,GACFvJ,EAASiI,UAAUtQ,KAAK8P,SAASlJ,QAASgL,EAAa,GAAG5J,YACxCpB,QAEP5G,KAAK8P,SAASlJ,SAENoB,WACZ6J,EAAgB7R,KAAKyH,MAAOoK,GAAiB,EAAGA,IAAiB,CACxE,IAAIC,EAAM9R,KAAK+P,SAAS8B,GAClBlM,EAAOmM,EAAInM,KACX4J,EAAQuC,EAAIvC,MACZnD,OAAO,EAAU2F,OAAS,EAIhC,GAAY,GAAR1G,IAAc6F,EAAQ3B,EAAM7F,UAAUwH,EAAMvL,QAAUoM,EAASxC,EAAMK,WAAW,WAAS3N,KAAKiP,IAAQ,IACtFvL,EAAKiL,kBAAkBvI,EAAO1C,OAC9C,MAAO,CAACiM,WAAYA,EAAYC,cAAeA,EAAexJ,OAAQA,EAAQ0J,OAAQA,GAGrF,GAAY,GAAR1G,GAAa6F,IAAU9E,EAAOmD,EAAM3G,aAAasI,EAAMvL,OAC5D,MAAO,CAACiM,WAAYA,EAAYC,cAAeA,EAAexJ,OAAQA,EAAQ+D,KAAMA,GAGxF,GAAI/D,GAAUkH,EAAM7F,UAAUrB,EAAO1C,MAAS,QAMtD0I,EAAOjO,UAAUkR,SAAW,SAASA,WACnC,IAAIQ,EAAM9R,KAAK8P,SACTlJ,EAAUkL,EAAIlL,QACdF,EAAYoL,EAAIpL,UAChBD,EAAUqL,EAAIrL,QAChB4C,EAAQiH,UAAU1J,EAASF,GAC/B,SAAK2C,EAAMzB,YAAcyB,EAAMrB,WAAWD,UAC1C/H,KAAK8P,SAAW,IAAI,QAAMlJ,EAASF,EAAY,EACrBjH,KAAK8G,IAAIE,EAAS4C,EAAM3M,KAAOgK,GAAaE,EAAQlK,KAAO+J,EAAUC,EAAY,EAAI,KACxG,IAGT2H,EAAOjO,UAAUmR,SAAW,SAASA,WACnC,IAAIO,EAAM9R,KAAK8P,SACTlJ,EAAUkL,EAAIlL,QACdF,EAAYoL,EAAIpL,UAChBD,EAAUqL,EAAIrL,QAChB4C,EAAQiH,UAAU1J,EAASF,GAC/B,GAAI2C,EAAMzB,YAAc,GAAKlB,EAAY,EAAG,CAC1C,IAAIsL,EAAYpL,EAAQlK,KAAOgK,GAAaA,EAAY2C,EAAM3M,KAC9DsD,KAAK8P,SAAW,IAAI,QAAMI,iBAAiBtJ,EAASF,EAAY,EAAG,GAAIA,EAAY,EACzDsL,EAAYtL,EAAY,EAAID,QAEtDzG,KAAK8P,SAAW,IAAI,QAAMI,iBAAiBtJ,EAASF,EAAW,GAAIA,EAAWD,IAQlF4H,EAAOjO,UAAUiR,WAAa,SAASA,WAAYS,GAOjD,IANE,IAAIF,EAAaE,EAAIF,WACjBC,EAAgBC,EAAID,cACpBxJ,EAASyJ,EAAIzJ,OACb0J,EAASD,EAAIC,OACb3F,EAAO0F,EAAI1F,KAEVpM,KAAKyH,MAAQoK,GAAiB7R,KAAKiS,oBAC1C,GAAI7F,EAAQ,IAAK,IAAItN,EAAI,EAAGA,EAAIsN,EAAKvN,OAAQC,IAAOkB,KAAKkS,iBAAiB9F,EAAKtN,IAE/E,IAAI2D,EAAQzC,KAAK8P,SAAUrE,EAAWpD,EAASA,EAAOzB,QAAUnE,EAAMmE,QAClEF,EAAYjE,EAAMiE,UAAYkL,EAC9BO,EAAQ,EAAGnT,EAAM,GACjBoT,EAAQpS,KAAK+P,SAAS8B,GACpBtC,EAAQ6C,EAAM7C,MACd5J,EAAOyM,EAAMzM,KACnB,GAAIoM,EAAQ,CACV,IAAK,IAAIlC,EAAM,EAAGA,EAAMkC,EAAOnK,WAAYiI,IAAS7Q,EAAId,KAAK6T,EAAO/U,MAAM6S,IAC1EN,EAAQA,EAAMkB,cAAcsB,GAQ9B,IAHA,IAAIM,EAAgB5G,EAAS/O,KAAOkV,GAAenP,EAAMmE,QAAQlK,KAAO+F,EAAMgE,SAGvE0L,EAAQ1G,EAAS7D,YAAY,CAClC,IAAIC,EAAO4D,EAASzO,MAAMmV,GAAQG,EAAU/C,EAAM7F,UAAU7B,EAAKlC,MACjE,IAAK2M,EAAW,SAChBH,EACY,GAAkB,GAAbzL,GAAkBmB,EAAKjB,QAAQlK,QAC9C6S,EAAQ+C,EACRtT,EAAId,KAAKqS,eAAe1I,EAAK4F,KAAK9H,EAAK4M,aAAa1K,EAAKmF,QAAkB,GAATmF,EAAazL,EAAY,EACnEyL,GAAS1G,EAAS7D,WAAayK,GAAgB,KAG3E,IAAIG,EAAQL,GAAS1G,EAAS7D,WACzB4K,IAASH,GAAgB,GAI1BG,GAASH,EAAe,GAAKhK,GAAUA,EAAO1C,MAAQ3F,KAAK+P,SAAS/P,KAAKyH,OAAO9B,KAAQ3F,KAAKiS,oBAC1FjS,KAAK+P,SAAS8B,GAAetC,MAAQA,EAG5C,IAAK,IAAIkD,EAAM,EAAGhD,EAAMhE,EAAUgH,EAAMJ,EAAcI,IAAO,CAC3D,IAAI9K,EAAO8H,EAAIY,UACfrQ,KAAK+P,SAAS7R,KAAK,CAACyH,KAAMgC,EAAKhC,KAAM4J,MAAO5H,EAAKuB,eAAevB,EAAKC,cACrE6H,EAAM9H,EAAKf,QAMb5G,KAAK8P,SAAY0C,EACC,GAAdZ,EAAkB,QAAM/P,MACxB,IAAI,QAAMqO,iBAAiBzN,EAAMmE,QAASgL,EAAa,EAAG,GAChDA,EAAa,EAAGS,EAAe,EAAI5P,EAAMgE,QAAUmL,EAAa,GAHrD,IAAI,QAAM1B,iBAAiBzN,EAAMmE,QAASgL,EAAYO,GAAQ1P,EAAMiE,UAAWjE,EAAMgE,SAI9GzG,KAAKgQ,OAASI,cAAcpQ,KAAKgQ,OAAQ6B,EAAe,WAAS5P,KAAKjD,KAGxEqP,EAAOjO,UAAUqR,eAAiB,SAASA,iBACzC,IAAKzR,KAAKyI,IAAIJ,OAAO8C,YAAe,OAAQ,EAC5C,IAAqCuH,EAAjCC,EAAM3S,KAAK+P,SAAS/P,KAAKyH,OAC7B,IAAKkL,EAAIhN,KAAKwF,cAAgBuF,iBAAiB1Q,KAAKyI,IAAKzI,KAAKyI,IAAIhB,MAAOkL,EAAIhN,KAAMgN,EAAIpD,OAAO,IACzFvP,KAAKyI,IAAIhB,OAASzH,KAAKyH,QAAUiL,EAAQ1S,KAAK4S,eAAe5S,KAAKyI,OAASiK,EAAMjL,OAASzH,KAAKyH,MAAU,OAAQ,EAKtH,IAHA,IACMA,EADIzH,KAAKyI,IACGhB,MACZ8C,EAAQvK,KAAKyI,IAAI8B,MAAM9C,GACtBA,EAAQ,GAAK8C,GAASvK,KAAKyI,IAAIxH,MAAMwG,MAAY8C,EACxD,OAAOA,GAGT8D,EAAOjO,UAAUwS,eAAiB,SAASA,eAAgBnK,GACzDoK,EAAM,IAAK,IAAI/T,EAAIW,KAAKuO,IAAIhO,KAAKyH,MAAOgB,EAAIhB,OAAQ3I,GAAK,EAAGA,IAAK,CAC/D,IAAIgT,EAAM9R,KAAK+P,SAASjR,GAClByQ,EAAQuC,EAAIvC,MAEdjB,EAAMoC,iBAAiBjI,EAAK3J,EADnBgT,EAAInM,KACwB4J,GAAO,GAChD,GAAKjB,EAAL,CACA,IAAK,IAAIlE,EAAItL,EAAI,EAAGsL,GAAK,EAAGA,IAAK,CAC/B,IAAIgI,EAAQpS,KAAK+P,SAAS3F,GACpB0I,EAAUV,EAAM7C,MAElB+C,EAAU5B,iBAAiBjI,EAAK2B,EADrBgI,EAAMzM,KAC0BmN,GAAS,GACxD,IAAKR,GAAWA,EAAQ1K,WAAc,SAASiL,EAEjD,MAAO,CAACpL,MAAO3I,EAAGwP,IAAKA,MAI3BD,EAAOjO,UAAUuR,MAAQ,SAASA,MAAOlJ,GACvC,IAAIkJ,MAAQ3R,KAAK4S,eAAenK,GAChC,IAAKkJ,MAAS,OAAO,EAErB,KAAO3R,KAAKyH,MAAQkK,MAAMlK,OAASzH,KAAKiS,oBACpCN,MAAMrD,IAAI1G,aAAc5H,KAAKgQ,OAASI,cAAcpQ,KAAKgQ,OAAQ2B,MAAMlK,MAAOkK,MAAMrD,MACxF,IAAK,IAAIlE,EAAIuH,MAAMlK,MAAQ,EAAG2C,GAAK3B,EAAIhB,MAAO2C,IAAK,CACjD,IAAIzC,EAAOc,EAAId,KAAKyC,GAAIpL,EAAM2I,EAAKhC,KAAK6D,aAAaoG,WAAWjI,EAAKf,SAAS,EAAM6B,EAAInI,MAAM8J,IAC9FpK,KAAKkS,iBAAiBvK,EAAKhC,KAAMgC,EAAKmB,MAAO9J,GAE/C,OAAO,GAGTqP,EAAOjO,UAAU8R,iBAAmB,SAASA,iBAAkBvM,EAAMmD,EAAOlC,GAC1E,IAAI+L,EAAM3S,KAAK+P,SAAS/P,KAAKyH,OAC7BkL,EAAIpD,MAAQoD,EAAIpD,MAAM7F,UAAU/D,GAChC3F,KAAKgQ,OAASI,cAAcpQ,KAAKgQ,OAAQhQ,KAAKyH,MAAO,WAASxF,KAAK0D,EAAKhC,OAAOmF,EAAOlC,KACtF5G,KAAK+P,SAAS7R,KAAK,CAACyH,KAAMA,EAAM4J,MAAO5J,EAAK6D,gBAG9C6E,EAAOjO,UAAU6R,kBAAoB,SAASA,oBAC5C,IACIjT,EADOgB,KAAK+P,SAASgD,MACVxD,MAAMK,WAAW,WAAS/N,OAAO,GAC5C7C,EAAI4I,aAAc5H,KAAKgQ,OAASI,cAAcpQ,KAAKgQ,OAAQhQ,KAAK+P,SAASlR,OAAQG,KAGvF0E,OAAOoB,iBAAkBuJ,EAAOjO,UAAW6P,GA2D3CnM,EAAU1D,UAAU4S,aAAe,SAAS/Q,EAAMC,EAAIO,GACpD,IAAKA,EAAM/F,KAAQ,OAAOsD,KAAKiT,YAAYhR,EAAMC,GAEjD,IAAIoF,EAAQtH,KAAK+D,IAAIwD,QAAQtF,GAAOwG,EAAMzI,KAAK+D,IAAIwD,QAAQrF,GAC3D,GAAIkM,cAAc9G,EAAOmB,EAAKhG,GAC1B,OAAOzC,KAAKuE,KAAK,IAAI6B,EAAYnE,EAAMC,EAAIO,IAE/C,IAAIyQ,EAAe/B,cAAc7J,EAAOtH,KAAK+D,IAAIwD,QAAQrF,IAEZ,GAAzCgR,EAAaA,EAAarU,OAAS,IAAWqU,EAAaH,MAG/D,IAAII,IAAoB7L,EAAMG,MAAQ,GACtCyL,EAAaE,QAAQD,GAKrB,IAAK,IAAI/I,EAAI9C,EAAMG,MAAO5H,EAAMyH,EAAMzH,IAAM,EAAGuK,EAAI,EAAGA,IAAKvK,IAAO,CAChE,IAAI6I,EAAOpB,EAAMK,KAAKyC,GAAGzE,KAAK+C,KAC9B,GAAIA,EAAK2K,UAAY3K,EAAKC,UAAa,MACnCuK,EAAanU,QAAQqL,IAAM,EAAK+I,EAAkB/I,EAC7C9C,EAAMnD,OAAOiG,IAAMvK,GAAOqT,EAAa/T,OAAO,EAAG,GAAIiL,GAOhE,IAHA,IAAIkJ,EAAuBJ,EAAanU,QAAQoU,GAE5CI,EAAY,GAAIC,EAAiB/Q,EAAMiE,UAClCE,EAAUnE,EAAMmE,QAAS9H,EAAI,GAAIA,IAAK,CAC7C,IAAI6I,EAAOf,EAAQoB,WAEnB,GADAuL,EAAUrV,KAAKyJ,GACX7I,GAAK2D,EAAMiE,UAAa,MAC5BE,EAAUe,EAAKf,QAIb4M,EAAiB,GAAKD,EAAUC,EAAiB,GAAG7N,KAAK+C,KAAK2K,UAC9D/L,EAAMK,KAAK2L,GAAsB3N,MAAQ4N,EAAUC,EAAiB,GAAG7N,KACvE6N,GAAkB,EACbA,GAAkB,GAAKD,EAAUC,EAAiB,GAAGrI,aAAeoI,EAAUC,EAAiB,GAAG7N,KAAK+C,KAAK2K,UAC5G/L,EAAMK,KAAK2L,GAAsB3N,MAAQ4N,EAAUC,EAAiB,GAAG7N,OAC5E6N,GAAkB,GAEtB,IAAK,IAAInE,EAAI5M,EAAMiE,UAAW2I,GAAK,EAAGA,IAAK,CACzC,IAAIoE,GAAapE,EAAImE,EAAiB,IAAM/Q,EAAMiE,UAAY,GAC1DO,EAASsM,EAAUE,GACvB,GAAKxM,EACL,IAAK,IAAI4I,EAAM,EAAGA,EAAMqD,EAAarU,OAAQgR,IAAO,CAGlD,IAAI6D,EAAcR,GAAcrD,EAAMyD,GAAwBJ,EAAarU,QAAS8U,GAAS,EACzFD,EAAc,IAAKC,GAAS,EAAOD,GAAeA,GACtD,IAAIrL,EAASf,EAAMK,KAAK+L,EAAc,GAAIpT,EAAQgH,EAAMhH,MAAMoT,EAAc,GAC5E,GAAIrL,EAAOe,eAAe9I,EAAOA,EAAO2G,EAAOtB,KAAMsB,EAAO+F,OACxD,OAAOhN,KAAKkG,QAAQoB,EAAMnD,OAAOuP,GAAcC,EAASlL,EAAI8B,MAAMmJ,GAAexR,EAC/D,IAAI,QAAM6O,cAActO,EAAMmE,QAAS,EAAGnE,EAAMiE,UAAW+M,GACjDA,EAAWhR,EAAMgE,WAKrD,IADA,IAAImN,EAAa5T,KAAKgE,MAAMnF,OACnB4T,EAAMS,EAAarU,OAAS,EAAG4T,GAAO,IAC7CzS,KAAKkG,QAAQjE,EAAMC,EAAIO,KACnBzC,KAAKgE,MAAMnF,OAAS+U,IAFwBnB,IAAO,CAGvD,IAAIhL,EAAQyL,EAAaT,GACrBA,EAAM,IACVxQ,EAAOqF,EAAMnD,OAAOsD,GAAQvF,EAAKuG,EAAI8B,MAAM9C,IAE7C,OAAOzH,MAwBT8D,EAAU1D,UAAUyT,iBAAmB,SAAS5R,EAAMC,EAAIyF,GACxD,IAAKA,EAAKgE,UAAY1J,GAAQC,GAAMlC,KAAK+D,IAAIwD,QAAQtF,GAAMoG,OAAOzB,QAAQlK,KAAM,CAC9E,IAAIoX,EAxuBR,SAASC,YAAYhQ,EAAKlE,EAAKgJ,GAC7B,IAAImB,EAAOjG,EAAIwD,QAAQ1H,GACvB,GAAImK,EAAK3B,OAAOe,eAAeY,EAAK1J,QAAS0J,EAAK1J,QAASuI,GAAa,OAAOhJ,EAE/E,GAAyB,GAArBmK,EAAKgK,aACL,IAAK,IAAI5J,EAAIJ,EAAKvC,MAAQ,EAAG2C,GAAK,EAAGA,IAAK,CAC1C,IAAI9J,EAAQ0J,EAAK1J,MAAM8J,GACvB,GAAIJ,EAAKrC,KAAKyC,GAAGhB,eAAe9I,EAAOA,EAAOuI,GAAa,OAAOmB,EAAK7F,OAAOiG,EAAI,GAClF,GAAI9J,EAAQ,EAAK,OAAO,KAE5B,GAAI0J,EAAKgK,cAAgBhK,EAAK3B,OAAOzB,QAAQlK,KACzC,IAAK,IAAIwP,EAAMlC,EAAKvC,MAAQ,EAAGyE,GAAO,EAAGA,IAAO,CAChD,IAAI7B,EAAUL,EAAKtC,WAAWwE,GAC9B,GAAIlC,EAAKrC,KAAKuE,GAAK9C,eAAeiB,EAASA,EAASxB,GAAa,OAAOmB,EAAKO,MAAM2B,EAAM,GACzF,GAAI7B,EAAUL,EAAKrC,KAAKuE,GAAKtE,WAAc,OAAO,MA0tBxCmM,CAAY/T,KAAK+D,IAAK9B,EAAM0F,EAAKhC,MAChC,MAATmO,IAAiB7R,EAAOC,EAAK4R,GAEnC,OAAO9T,KAAKgT,aAAa/Q,EAAMC,EAAI,IAAI,QAAM,WAASD,KAAK0F,GAAO,EAAG,KAMvE7D,EAAU1D,UAAU6S,YAAc,SAAShR,EAAMC,GAG/C,IAFA,IAAIoF,EAAQtH,KAAK+D,IAAIwD,QAAQtF,GAAOwG,EAAMzI,KAAK+D,IAAIwD,QAAQrF,GACvD+R,EAAU9C,cAAc7J,EAAOmB,GAC1B3J,EAAI,EAAGA,EAAImV,EAAQpV,OAAQC,IAAK,CACvC,IAAI2I,EAAQwM,EAAQnV,GAAIoV,EAAOpV,GAAKmV,EAAQpV,OAAS,EACrD,GAAKqV,GAAiB,GAATzM,GAAeH,EAAMK,KAAKF,GAAO9B,KAAK6D,aAAaG,SAC5D,OAAO3J,KAAK1D,OAAOgL,EAAMxG,MAAM2G,GAAQgB,EAAIxH,IAAIwG,IACnD,GAAIA,EAAQ,IAAMyM,GAAQ5M,EAAMK,KAAKF,EAAQ,GAAGS,WAAWZ,EAAMhH,MAAMmH,EAAQ,GAAIgB,EAAIf,WAAWD,EAAQ,KACtG,OAAOzH,KAAK1D,OAAOgL,EAAMnD,OAAOsD,GAAQgB,EAAI8B,MAAM9C,IAExD,IAAK,IAAI2C,EAAI,EAAGA,GAAK9C,EAAMG,OAAS2C,GAAK3B,EAAIhB,MAAO2C,IAClD,GAAInI,EAAOqF,EAAMxG,MAAMsJ,IAAM9C,EAAMG,MAAQ2C,GAAKlI,EAAKoF,EAAMrG,IAAImJ,IAAM3B,EAAIxH,IAAImJ,GAAKlI,GAAMuG,EAAIhB,MAAQ2C,EAChG,OAAOpK,KAAK1D,OAAOgL,EAAMnD,OAAOiG,GAAIlI,GAE1C,OAAOlC,KAAK1D,OAAO2F,EAAMC,K,kCC/lD3B,IAYIiS,EAZAC,EAAS,EAAQ,QACjBC,EAAc,EAAQ,QACtBC,EAAyB,EAAQ,QACjCC,EAAa,EAAQ,QACrBC,EAAiB,EAAQ,QACzBC,EAAW,EAAQ,QACnBC,EAAsB,EAAQ,QAA+BC,QAC7DC,EAAkB,EAAQ,QAE1BC,GAAWT,EAAOU,eAAiB,kBAAmBV,EAEtDW,EAAerR,OAAOqR,aAGtBC,QAAU,SAAUC,GACtB,OAAO,SAASC,UACd,OAAOD,EAAKjV,KAAMmV,UAAUtW,OAASsW,UAAU,QAAK5Y,KAMpD6Y,EAAWC,EAAOC,QAAUf,EAAW,UAAWS,QAASR,GAK/D,GAAII,GAAmBC,EAAS,CAC9BV,EAAkBK,EAAee,eAAeP,QAAS,WAAW,GACpEV,EAAuBkB,UAAW,EAClC,IAAIC,EAAmBL,EAAShV,UAC5BsV,EAAeD,EAAyB,OACxCE,EAAYF,EAAiBlW,IAC7BqW,EAAYH,EAAiBxW,IAC7B4W,EAAYJ,EAAiBxZ,IACjCoY,EAAYoB,EAAkB,CAC5B,OAAU,SAAUhZ,GAClB,GAAIgY,EAAShY,KAASsY,EAAatY,GAAM,CACvC,IAAIqZ,EAAQpB,EAAoB1U,MAEhC,OADK8V,EAAMC,SAAQD,EAAMC,OAAS,IAAI5B,GAC/BuB,EAAanT,KAAKvC,KAAMvD,IAAQqZ,EAAMC,OAAe,OAAEtZ,GAC9D,OAAOiZ,EAAanT,KAAKvC,KAAMvD,IAEnC8C,IAAK,SAASA,IAAI9C,GAChB,GAAIgY,EAAShY,KAASsY,EAAatY,GAAM,CACvC,IAAIqZ,EAAQpB,EAAoB1U,MAEhC,OADK8V,EAAMC,SAAQD,EAAMC,OAAS,IAAI5B,GAC/BwB,EAAUpT,KAAKvC,KAAMvD,IAAQqZ,EAAMC,OAAOxW,IAAI9C,GACrD,OAAOkZ,EAAUpT,KAAKvC,KAAMvD,IAEhCwC,IAAK,SAASA,IAAIxC,GAChB,GAAIgY,EAAShY,KAASsY,EAAatY,GAAM,CACvC,IAAIqZ,EAAQpB,EAAoB1U,MAEhC,OADK8V,EAAMC,SAAQD,EAAMC,OAAS,IAAI5B,GAC/BwB,EAAUpT,KAAKvC,KAAMvD,GAAOmZ,EAAUrT,KAAKvC,KAAMvD,GAAOqZ,EAAMC,OAAO9W,IAAIxC,GAChF,OAAOmZ,EAAUrT,KAAKvC,KAAMvD,IAEhCR,IAAK,SAASA,IAAIQ,EAAKI,GACrB,GAAI4X,EAAShY,KAASsY,EAAatY,GAAM,CACvC,IAAIqZ,EAAQpB,EAAoB1U,MAC3B8V,EAAMC,SAAQD,EAAMC,OAAS,IAAI5B,GACtCwB,EAAUpT,KAAKvC,KAAMvD,GAAOoZ,EAAUtT,KAAKvC,KAAMvD,EAAKI,GAASiZ,EAAMC,OAAO9Z,IAAIQ,EAAKI,QAChFgZ,EAAUtT,KAAKvC,KAAMvD,EAAKI,GACjC,OAAOmD,U,sBChEb,YAAE,IAoBGgW,EAjBHX,EAAOC,SAiBJU,EAAWA,GAAa,SAAUvW,EAAMlD,GAExC,IAAI0Z,EA4BJ,GAzBsB,oBAAXC,QAA0BA,OAAOD,SACxCA,EAASC,OAAOD,QAIA,oBAATE,MAAwBA,KAAKF,SACpCA,EAASE,KAAKF,QAIQ,oBAAfG,YAA8BA,WAAWH,SAChDA,EAASG,WAAWH,SAInBA,GAA4B,oBAAXC,QAA0BA,OAAOG,WACnDJ,EAASC,OAAOG,WAIfJ,QAA4B,IAAX7B,GAA0BA,EAAO6B,SACnDA,EAAS7B,EAAO6B,SAIfA,EACD,IACIA,EAAS,EAAQ,GACnB,MAAO5T,IAQb,IAAIiU,sBAAwB,WACxB,GAAIL,EAAQ,CAER,GAAsC,mBAA3BA,EAAOM,gBACd,IACI,OAAON,EAAOM,gBAAgB,IAAIC,YAAY,IAAI,GACpD,MAAOnU,IAIb,GAAkC,mBAAvB4T,EAAOQ,YACd,IACI,OAAOR,EAAOQ,YAAY,GAAGC,cAC/B,MAAOrU,KAIjB,MAAM,IAAIC,MAAM,wEAOhBqB,EAASD,OAAOC,QAAW,WAC3B,SAASgT,KAET,OAAO,SAAUC,GACb,IAAIC,EAQJ,OANAF,EAAEvW,UAAYwW,EAEdC,EAAU,IAAIF,EAEdA,EAAEvW,UAAY,KAEPyW,GAZe,GAmB1BC,EAAI,GAKJC,EAAQD,EAAEE,IAAM,GAKhBC,EAAOF,EAAME,KAGN,CAmBHC,OAAQ,SAAUC,GAEd,IAAIN,EAAUlT,EAAO3D,MAoBrB,OAjBImX,GACAN,EAAQO,MAAMD,GAIbN,EAAQQ,eAAe,SAAWrX,KAAKiV,OAAS4B,EAAQ5B,OACzD4B,EAAQ5B,KAAO,WACX4B,EAAQS,OAAOrC,KAAKtQ,MAAM3E,KAAMmV,aAKxC0B,EAAQ5B,KAAK7U,UAAYyW,EAGzBA,EAAQS,OAAStX,KAEV6W,GAeXlT,OAAQ,WACJ,IAAI4T,EAAWvX,KAAKkX,SAGpB,OAFAK,EAAStC,KAAKtQ,MAAM4S,EAAUpC,WAEvBoC,GAeXtC,KAAM,aAcNmC,MAAO,SAAUI,GACb,IAAK,IAAIC,KAAgBD,EACjBA,EAAWH,eAAeI,KAC1BzX,KAAKyX,GAAgBD,EAAWC,IAKpCD,EAAWH,eAAe,cAC1BrX,KAAKwB,SAAWgW,EAAWhW,WAanCkW,MAAO,WACH,OAAO1X,KAAKiV,KAAK7U,UAAU8W,OAAOlX,QAW1C2X,EAAYZ,EAAMY,UAAYV,EAAKC,OAAO,CAa1CjC,KAAM,SAAU2C,EAAOC,GACnBD,EAAQ5X,KAAK4X,MAAQA,GAAS,GAG1B5X,KAAK6X,SADLA,GAAYtb,EACIsb,EAEe,EAAfD,EAAM/Y,QAiB9B2C,SAAU,SAAUsW,GAChB,OAAQA,GAAWC,GAAKrW,UAAU1B,OActC6J,OAAQ,SAAUmO,GAEd,IAAIC,EAAYjY,KAAK4X,MACjBM,EAAYF,EAAUJ,MACtBO,EAAenY,KAAK6X,SACpBO,EAAeJ,EAAUH,SAM7B,GAHA7X,KAAKqY,QAGDF,EAAe,EAEf,IAAK,IAAIrZ,EAAI,EAAGA,EAAIsZ,EAActZ,IAAK,CACnC,IAAIwZ,EAAYJ,EAAUpZ,IAAM,KAAQ,GAAMA,EAAI,EAAK,EAAM,IAC7DmZ,EAAWE,EAAerZ,IAAO,IAAMwZ,GAAa,IAAOH,EAAerZ,GAAK,EAAK,OAIxF,IAAK,IAAIuQ,EAAI,EAAGA,EAAI+I,EAAc/I,GAAK,EACnC4I,EAAWE,EAAe9I,IAAO,GAAK6I,EAAU7I,IAAM,GAM9D,OAHArP,KAAK6X,UAAYO,EAGVpY,MAUXqY,MAAO,WAEH,IAAIT,EAAQ5X,KAAK4X,MACbC,EAAW7X,KAAK6X,SAGpBD,EAAMC,IAAa,IAAM,YAAe,GAAMA,EAAW,EAAK,EAC9DD,EAAM/Y,OAASY,EAAK8Y,KAAKV,EAAW,IAYxCH,MAAO,WACH,IAAIA,EAAQT,EAAKS,MAAMnV,KAAKvC,MAG5B,OAFA0X,EAAME,MAAQ5X,KAAK4X,MAAMnV,MAAM,GAExBiV,GAgBXc,OAAQ,SAAUC,GAGd,IAFA,IAAIb,EAAQ,GAEH9Y,EAAI,EAAGA,EAAI2Z,EAAQ3Z,GAAK,EAC7B8Y,EAAM1Z,KAAKoY,yBAGf,OAAO,IAAIqB,EAAU1C,KAAK2C,EAAOa,MAOrCC,EAAQ5B,EAAE6B,IAAM,GAKhBZ,EAAMW,EAAMX,IAAM,CAclBrW,UAAW,SAAUsW,GAOjB,IALA,IAAIJ,EAAQI,EAAUJ,MAClBC,EAAWG,EAAUH,SAGrBe,EAAW,GACN9Z,EAAI,EAAGA,EAAI+Y,EAAU/Y,IAAK,CAC/B,IAAI+Z,EAAQjB,EAAM9Y,IAAM,KAAQ,GAAMA,EAAI,EAAK,EAAM,IACrD8Z,EAAS1a,MAAM2a,IAAS,GAAGrX,SAAS,KACpCoX,EAAS1a,MAAa,GAAP2a,GAAarX,SAAS,KAGzC,OAAOoX,EAASrL,KAAK,KAgBzBuL,MAAO,SAAUC,GAMb,IAJA,IAAIC,EAAeD,EAAOla,OAGtB+Y,EAAQ,GACH9Y,EAAI,EAAGA,EAAIka,EAAcla,GAAK,EACnC8Y,EAAM9Y,IAAM,IAAMma,SAASF,EAAOG,OAAOpa,EAAG,GAAI,KAAQ,GAAMA,EAAI,EAAK,EAG3E,OAAO,IAAI6Y,EAAU1C,KAAK2C,EAAOoB,EAAe,KAOpDG,EAAST,EAAMS,OAAS,CAcxBzX,UAAW,SAAUsW,GAOjB,IALA,IAAIJ,EAAQI,EAAUJ,MAClBC,EAAWG,EAAUH,SAGrBuB,EAAc,GACTta,EAAI,EAAGA,EAAI+Y,EAAU/Y,IAAK,CAC/B,IAAI+Z,EAAQjB,EAAM9Y,IAAM,KAAQ,GAAMA,EAAI,EAAK,EAAM,IACrDsa,EAAYlb,KAAKmb,OAAOC,aAAaT,IAGzC,OAAOO,EAAY7L,KAAK,KAgB5BuL,MAAO,SAAUS,GAMb,IAJA,IAAIC,EAAkBD,EAAU1a,OAG5B+Y,EAAQ,GACH9Y,EAAI,EAAGA,EAAI0a,EAAiB1a,IACjC8Y,EAAM9Y,IAAM,KAAiC,IAA1Bya,EAAUE,WAAW3a,KAAe,GAAMA,EAAI,EAAK,EAG1E,OAAO,IAAI6Y,EAAU1C,KAAK2C,EAAO4B,KAOrCE,EAAOhB,EAAMgB,KAAO,CAcpBhY,UAAW,SAAUsW,GACjB,IACI,OAAO2B,mBAAmBC,OAAOT,EAAOzX,UAAUsW,KACpD,MAAO7R,GACL,MAAM,IAAI7D,MAAM,0BAiBxBwW,MAAO,SAAUe,GACb,OAAOV,EAAOL,MAAMgB,SAASC,mBAAmBF,OAWpDG,EAAyBjD,EAAMiD,uBAAyB/C,EAAKC,OAAO,CAQpE+C,MAAO,WAEHja,KAAKka,MAAQ,IAAIvC,EAAU1C,KAC3BjV,KAAKma,YAAc,GAavBC,QAAS,SAAUC,GAEI,iBAARA,IACPA,EAAOX,EAAKZ,MAAMuB,IAItBra,KAAKka,MAAMrQ,OAAOwQ,GAClBra,KAAKma,aAAeE,EAAKxC,UAiB7ByC,SAAU,SAAUC,GAChB,IAAIC,EAGAH,EAAOra,KAAKka,MACZO,EAAYJ,EAAKzC,MACjB8C,EAAeL,EAAKxC,SACpB8C,EAAY3a,KAAK2a,UAIjBC,EAAeF,GAHc,EAAZC,GAcjBE,GARAD,EAFAL,EAEe9a,EAAK8Y,KAAKqC,GAIVnb,EAAK8G,KAAoB,EAAfqU,GAAoB5a,KAAK8a,eAAgB,IAIrCH,EAG7BI,EAActb,EAAKuO,IAAkB,EAAd6M,EAAiBH,GAG5C,GAAIG,EAAa,CACb,IAAK,IAAIlZ,EAAS,EAAGA,EAASkZ,EAAalZ,GAAUgZ,EAEjD3a,KAAKgb,gBAAgBP,EAAW9Y,GAIpC6Y,EAAiBC,EAAUtb,OAAO,EAAG0b,GACrCR,EAAKxC,UAAYkD,EAIrB,OAAO,IAAIpD,EAAU1C,KAAKuF,EAAgBO,IAY9CrD,MAAO,WACH,IAAIA,EAAQT,EAAKS,MAAMnV,KAAKvC,MAG5B,OAFA0X,EAAMwC,MAAQla,KAAKka,MAAMxC,QAElBA,GAGXoD,eAAgB,IA2IhBG,GAnISlE,EAAMmE,OAASlB,EAAuB9C,OAAO,CAItDiE,IAAKlE,EAAKC,SAWVjC,KAAM,SAAUkG,GAEZnb,KAAKmb,IAAMnb,KAAKmb,IAAIjE,OAAOiE,GAG3Bnb,KAAKia,SAUTA,MAAO,WAEHD,EAAuBC,MAAM1X,KAAKvC,MAGlCA,KAAKob,YAeTC,OAAQ,SAAUC,GAQd,OANAtb,KAAKoa,QAAQkB,GAGbtb,KAAKsa,WAGEta,MAiBXub,SAAU,SAAUD,GAShB,OAPIA,GACAtb,KAAKoa,QAAQkB,GAINtb,KAAKwb,eAKpBb,UAAW,GAeXc,cAAe,SAAUC,GACrB,OAAO,SAAUtZ,EAAS+Y,GACtB,OAAO,IAAIO,EAAOzG,KAAKkG,GAAKI,SAASnZ,KAiB7CuZ,kBAAmB,SAAUD,GACzB,OAAO,SAAUtZ,EAAS3F,GACtB,OAAO,IAAIwe,EAAOW,KAAK3G,KAAKyG,EAAQjf,GAAK8e,SAASnZ,OAQjD0U,EAAE+E,KAAO,IAEtB,OAAO/E,EA5wBgB,CA6wBzBrX,MAGKuW,K,wDClyBR,SAAS8F,WAAWlV,GAClB5G,KAAK4G,QAAUA,E,4iBAGjBkV,WAAW1b,UAAY,CACrBwD,YAAakY,WAEbC,KAAM,SAAStf,GACb,IAAK,IAAIqC,EAAI,EAAGA,EAAIkB,KAAK4G,QAAQ/H,OAAQC,GAAK,EAC5C,GAAIkB,KAAK4G,QAAQ9H,KAAOrC,EAAK,OAAOqC,EACtC,OAAQ,GAMVG,IAAK,SAASxC,GACZ,IAAIyS,EAAQlP,KAAK+b,KAAKtf,GACtB,OAAiB,GAAVyS,OAAc3S,EAAYyD,KAAK4G,QAAQsI,EAAQ,IAOxDmM,OAAQ,SAAS5e,EAAKI,EAAOmf,GAC3B,IAAI7F,EAAO6F,GAAUA,GAAUvf,EAAMuD,KAAKic,OAAOD,GAAUhc,KACvDkP,EAAQiH,EAAK4F,KAAKtf,GAAMmK,EAAUuP,EAAKvP,QAAQnE,QAOnD,OANc,GAAVyM,EACFtI,EAAQ1I,KAAK8d,GAAUvf,EAAKI,IAE5B+J,EAAQsI,EAAQ,GAAKrS,EACjBmf,IAAQpV,EAAQsI,GAAS8M,IAExB,IAAIF,WAAWlV,IAKxBqV,OAAQ,SAASxf,GACf,IAAIyS,EAAQlP,KAAK+b,KAAKtf,GACtB,IAAc,GAAVyS,EAAa,OAAOlP,KACxB,IAAI4G,EAAU5G,KAAK4G,QAAQnE,QAE3B,OADAmE,EAAQzH,OAAO+P,EAAO,GACf,IAAI4M,WAAWlV,IAKxBsV,WAAY,SAASzf,EAAKI,GACxB,OAAO,IAAIif,WAAW,CAACrf,EAAKI,GAAOgN,OAAO7J,KAAKic,OAAOxf,GAAKmK,WAK7DuV,SAAU,SAAS1f,EAAKI,GACtB,IAAI+J,EAAU5G,KAAKic,OAAOxf,GAAKmK,QAAQnE,QAEvC,OADAmE,EAAQ1I,KAAKzB,EAAKI,GACX,IAAIif,WAAWlV,IAMxBwV,UAAW,SAASC,EAAO5f,EAAKI,GAC9B,IAAIyf,EAAUtc,KAAKic,OAAOxf,GAAMmK,EAAU0V,EAAQ1V,QAAQnE,QACtDyM,EAAQoN,EAAQP,KAAKM,GAEzB,OADAzV,EAAQzH,QAAiB,GAAV+P,EAActI,EAAQ/H,OAASqQ,EAAO,EAAGzS,EAAKI,GACtD,IAAIif,WAAWlV,IAMxBzK,QAAS,SAASiF,GAChB,IAAK,IAAItC,EAAI,EAAGA,EAAIkB,KAAK4G,QAAQ/H,OAAQC,GAAK,EAC5CsC,EAAEpB,KAAK4G,QAAQ9H,GAAIkB,KAAK4G,QAAQ9H,EAAI,KAMxCyd,QAAS,SAAS/d,GAEhB,OADAA,EAAMsd,WAAW7Z,KAAKzD,IACb9B,KACF,IAAIof,WAAWtd,EAAIoI,QAAQiD,OAAO7J,KAAKwc,SAAShe,GAAKoI,UADtC5G,MAOxB6G,OAAQ,SAASrI,GAEf,OADAA,EAAMsd,WAAW7Z,KAAKzD,IACb9B,KACF,IAAIof,WAAW9b,KAAKwc,SAAShe,GAAKoI,QAAQiD,OAAOrL,EAAIoI,UADtC5G,MAOxBwc,SAAU,SAAShe,GACjB,IAAI0C,EAASlB,KACbxB,EAAMsd,WAAW7Z,KAAKzD,GACtB,IAAK,IAAIM,EAAI,EAAGA,EAAIN,EAAIoI,QAAQ/H,OAAQC,GAAK,EAC3CoC,EAASA,EAAO+a,OAAOzd,EAAIoI,QAAQ9H,IACrC,OAAOoC,GAKT,WACE,OAAOlB,KAAK4G,QAAQ/H,QAAU,IAQlCid,WAAW7Z,KAAO,SAASpF,GACzB,GAAIA,aAAiBif,WAAY,OAAOjf,EACxC,IAAI+J,EAAU,GACd,GAAI/J,EAAO,IAAK,IAAI4f,KAAQ5f,EAAO+J,EAAQ1I,KAAKue,EAAM5f,EAAM4f,IAC5D,OAAO,IAAIX,WAAWlV,IAGxB,IAEe,EAFEkV,WC9HjB,SAASY,cAAc5R,EAAGC,EAAGlL,GAC3B,IAAK,IAAIf,EAAI,GAAIA,IAAK,CACpB,GAAIA,GAAKgM,EAAElD,YAAc9I,GAAKiM,EAAEnD,WAC5B,OAAOkD,EAAElD,YAAcmD,EAAEnD,WAAa,KAAO/H,EAEjD,IAAI8c,EAAS7R,EAAE9N,MAAM8B,GAAI8d,EAAS7R,EAAE/N,MAAM8B,GAC1C,GAAI6d,GAAUC,EAAd,CAEA,IAAKD,EAAOE,WAAWD,GAAW,OAAO/c,EAEzC,GAAI8c,EAAOG,QAAUH,EAAOI,MAAQH,EAAOG,KAAM,CAC/C,IAAK,IAAI1N,EAAI,EAAGsN,EAAOI,KAAK1N,IAAMuN,EAAOG,KAAK1N,GAAIA,IAC9CxP,IACJ,OAAOA,EAET,GAAI8c,EAAO/V,QAAQlK,MAAQkgB,EAAOhW,QAAQlK,KAAM,CAC9C,IAAI2M,EAAQqT,cAAcC,EAAO/V,QAASgW,EAAOhW,QAAS/G,EAAM,GAChE,GAAa,MAATwJ,EAAiB,OAAOA,EAE9BxJ,GAAO8c,EAAO5P,cAbUlN,GAAO8c,EAAO5P,UAiB1C,SAASiQ,YAAYlS,EAAGC,EAAGkS,EAAMC,GAC/B,IAAK,IAAIC,EAAKrS,EAAElD,WAAYwV,EAAKrS,EAAEnD,aAAc,CAC/C,GAAU,GAANuV,GAAiB,GAANC,EACX,OAAOD,GAAMC,EAAK,KAAO,CAACtS,EAAGmS,EAAMlS,EAAGmS,GAE1C,IAAIP,EAAS7R,EAAE9N,QAAQmgB,GAAKP,EAAS7R,EAAE/N,QAAQogB,GAAK1gB,EAAOigB,EAAO5P,SAClE,GAAI4P,GAAUC,EAAd,CAKA,IAAKD,EAAOE,WAAWD,GAAW,MAAO,CAAC9R,EAAGmS,EAAMlS,EAAGmS,GAEtD,GAAIP,EAAOG,QAAUH,EAAOI,MAAQH,EAAOG,KAAM,CAE/C,IADA,IAAIM,EAAO,EAAGC,EAAU7d,KAAKuO,IAAI2O,EAAOI,KAAKle,OAAQ+d,EAAOG,KAAKle,QAC1Dwe,EAAOC,GAAWX,EAAOI,KAAKJ,EAAOI,KAAKle,OAASwe,EAAO,IAAMT,EAAOG,KAAKH,EAAOG,KAAKle,OAASwe,EAAO,IAC7GA,IAAQJ,IAAQC,IAElB,MAAO,CAACpS,EAAGmS,EAAMlS,EAAGmS,GAEtB,GAAIP,EAAO/V,QAAQlK,MAAQkgB,EAAOhW,QAAQlK,KAAM,CAC9C,IAAI2M,EAAQ2T,YAAYL,EAAO/V,QAASgW,EAAOhW,QAASqW,EAAO,EAAGC,EAAO,GACzE,GAAI7T,EAAS,OAAOA,EAEtB4T,GAAQvgB,EAAMwgB,GAAQxgB,OAjBpBugB,GAAQvgB,EAAMwgB,GAAQxgB,GA0B5B,IAAI6gB,EAAW,SAASA,SAAS3W,EAASlK,GAMxC,GALAsD,KAAK4G,QAAUA,EAIf5G,KAAKtD,KAAOA,GAAQ,EACR,MAARA,EAAgB,IAAK,IAAIoC,EAAI,EAAGA,EAAI8H,EAAQ/H,OAAQC,IACpDkB,KAAKtD,MAAQkK,EAAQ9H,GAAGiO,UAG1B7I,EAAqB,CAAE8D,WAAY,CAAE5D,cAAc,GAAOiM,UAAW,CAAEjM,cAAc,GAAOwD,WAAY,CAAExD,cAAc,IAM5HmZ,EAASnd,UAAUqM,aAAe,SAASA,aAAcxK,EAAMC,EAAId,EAAGoc,EAAWnV,QAC1D,IAAdmV,IAAuBA,EAAY,GAE1C,IAAK,IAAI1e,EAAI,EAAGe,EAAM,EAAGA,EAAMqC,EAAIpD,IAAK,CACtC,IAAI9B,EAAQgD,KAAK4G,QAAQ9H,GAAImC,EAAMpB,EAAM7C,EAAM+P,SAC/C,GAAI9L,EAAMgB,IAAiD,IAAzCb,EAAEpE,EAAOwgB,EAAY3d,EAAKwI,EAAQvJ,IAAgB9B,EAAM4J,QAAQlK,KAAM,CACtF,IAAIoE,EAAQjB,EAAM,EAClB7C,EAAMyP,aAAahN,KAAK8G,IAAI,EAAGtE,EAAOnB,GACnBrB,KAAKuO,IAAIhR,EAAM4J,QAAQlK,KAAMwF,EAAKpB,GAClCM,EAAGoc,EAAY1c,GAEpCjB,EAAMoB,IAOVsc,EAASnd,UAAUqd,YAAc,SAASA,YAAarc,GACrDpB,KAAKyM,aAAa,EAAGzM,KAAKtD,KAAM0E,IAMlCmc,EAASnd,UAAUsd,YAAc,SAASA,YAAazb,EAAMC,EAAIyb,EAAgBC,GAC/E,IAAIb,EAAO,GAAIc,GAAY,EAa3B,OAZA7d,KAAKyM,aAAaxK,EAAMC,GAAI,SAAUyF,EAAM9H,GACtC8H,EAAKmV,QACPC,GAAQpV,EAAKoV,KAAKta,MAAMhD,KAAK8G,IAAItE,EAAMpC,GAAOA,EAAKqC,EAAKrC,GACxDge,GAAaF,GACJhW,EAAKI,QAAU6V,GACxBb,GAA4B,mBAAba,EAA0BA,EAASjW,GAAOiW,EACzDC,GAAaF,IACHE,GAAalW,EAAKmW,UAC5Bf,GAAQY,EACRE,GAAY,KAEb,GACId,GAMTQ,EAASnd,UAAUyG,OAAS,SAASA,OAAQL,GAC3C,IAAKA,EAAM9J,KAAQ,OAAOsD,KAC1B,IAAKA,KAAKtD,KAAQ,OAAO8J,EACzB,IAAI0N,EAAOlU,KAAKqQ,UAAWa,EAAQ1K,EAAMwB,WAAYpB,EAAU5G,KAAK4G,QAAQnE,QAAS3D,EAAI,EAKzF,IAJIoV,EAAK4I,QAAU5I,EAAK2I,WAAW3L,KACjCtK,EAAQA,EAAQ/H,OAAS,GAAKqV,EAAK6J,SAAS7J,EAAK6I,KAAO7L,EAAM6L,MAC9Dje,EAAI,GAECA,EAAI0H,EAAMI,QAAQ/H,OAAQC,IAAO8H,EAAQ1I,KAAKsI,EAAMI,QAAQ9H,IACnE,OAAO,IAAIye,EAAS3W,EAAS5G,KAAKtD,KAAO8J,EAAM9J,OAKjD6gB,EAASnd,UAAU4d,IAAM,SAASA,IAAK/b,EAAMC,GAE3C,GADU,MAANA,IAAcA,EAAKlC,KAAKtD,MAChB,GAARuF,GAAaC,GAAMlC,KAAKtD,KAAQ,OAAOsD,KAC3C,IAAIkB,EAAS,GAAIxE,EAAO,EACxB,GAAIwF,EAAKD,EAAQ,IAAK,IAAInD,EAAI,EAAGe,EAAM,EAAGA,EAAMqC,EAAIpD,IAAK,CACvD,IAAI9B,EAAQgD,KAAK4G,QAAQ9H,GAAImC,EAAMpB,EAAM7C,EAAM+P,SAC3C9L,EAAMgB,KACJpC,EAAMoC,GAAQhB,EAAMiB,KAElBlF,EADAA,EAAM8f,OACE9f,EAAMghB,IAAIve,KAAK8G,IAAI,EAAGtE,EAAOpC,GAAMJ,KAAKuO,IAAIhR,EAAM+f,KAAKle,OAAQqD,EAAKrC,IAEpE7C,EAAMghB,IAAIve,KAAK8G,IAAI,EAAGtE,EAAOpC,EAAM,GAAIJ,KAAKuO,IAAIhR,EAAM4J,QAAQlK,KAAMwF,EAAKrC,EAAM,KAE7FqB,EAAOhD,KAAKlB,GACZN,GAAQM,EAAM+P,UAEhBlN,EAAMoB,EAER,OAAO,IAAIsc,EAASrc,EAAQxE,IAG9B6gB,EAASnd,UAAUkI,WAAa,SAASA,WAAYrG,EAAMC,GACzD,OAAID,GAAQC,EAAaqb,EAAS1b,MACtB,GAARI,GAAaC,GAAMlC,KAAK4G,QAAQ/H,OAAiBmB,KAC9C,IAAIud,EAASvd,KAAK4G,QAAQnE,MAAMR,EAAMC,KAM/Cqb,EAASnd,UAAUoK,aAAe,SAASA,aAAclK,EAAOqH,GAC9D,IAAIjK,EAAUsC,KAAK4G,QAAQtG,GAC3B,GAAI5C,GAAWiK,EAAQ,OAAO3H,KAC9B,IAAI0C,EAAO1C,KAAK4G,QAAQnE,QACpB/F,EAAOsD,KAAKtD,KAAOiL,EAAKoF,SAAWrP,EAAQqP,SAE/C,OADArK,EAAKpC,GAASqH,EACP,IAAI4V,EAAS7a,EAAMhG,IAM5B6gB,EAASnd,UAAU8b,WAAa,SAASA,WAAYvU,GACnD,OAAO,IAAI4V,EAAS,CAAC5V,GAAMkC,OAAO7J,KAAK4G,SAAU5G,KAAKtD,KAAOiL,EAAKoF,WAMpEwQ,EAASnd,UAAU+b,SAAW,SAASA,SAAUxU,GAC/C,OAAO,IAAI4V,EAASvd,KAAK4G,QAAQiD,OAAOlC,GAAO3H,KAAKtD,KAAOiL,EAAKoF,WAKlEwQ,EAASnd,UAAU2N,GAAK,SAASA,GAAIvH,GACnC,GAAIxG,KAAK4G,QAAQ/H,QAAU2H,EAAMI,QAAQ/H,OAAU,OAAO,EAC1D,IAAK,IAAIC,EAAI,EAAGA,EAAIkB,KAAK4G,QAAQ/H,OAAQC,IACrC,IAAKkB,KAAK4G,QAAQ9H,GAAGiP,GAAGvH,EAAMI,QAAQ9H,IAAO,OAAO,EACxD,OAAO,GAKToF,EAAmB8D,WAAW/I,IAAM,WAAc,OAAOe,KAAK4G,QAAQ/H,OAASmB,KAAK4G,QAAQ,GAAK,MAIjG1C,EAAmBmM,UAAUpR,IAAM,WAAc,OAAOe,KAAK4G,QAAQ/H,OAASmB,KAAK4G,QAAQ5G,KAAK4G,QAAQ/H,OAAS,GAAK,MAItHqF,EAAmB0D,WAAW3I,IAAM,WAAc,OAAOe,KAAK4G,QAAQ/H,QAKtE0e,EAASnd,UAAUpD,MAAQ,SAASA,MAAOsD,GACzC,IAAI4O,EAAQlP,KAAK4G,QAAQtG,GACzB,IAAK4O,EAAS,MAAM,IAAIxJ,WAAW,SAAWpF,EAAQ,qBAAuBN,MAC7E,OAAOkP,GAKTqO,EAASnd,UAAU0H,WAAa,SAASA,WAAYxH,GACnD,OAAON,KAAK4G,QAAQtG,IAMtBid,EAASnd,UAAUjE,QAAU,SAASA,QAASiF,GAC7C,IAAK,IAAItC,EAAI,EAAGmf,EAAI,EAAGnf,EAAIkB,KAAK4G,QAAQ/H,OAAQC,IAAK,CACnD,IAAI9B,EAAQgD,KAAK4G,QAAQ9H,GACzBsC,EAAEpE,EAAOihB,EAAGnf,GACZmf,GAAKjhB,EAAM+P,WAOfwQ,EAASnd,UAAUsc,cAAgB,SAASwB,gBAAiB1X,EAAO3G,GAGlE,YAFe,IAARA,IAAiBA,EAAM,GAEvB6c,cAAc1c,KAAMwG,EAAO3G,IAQpC0d,EAASnd,UAAU4c,YAAc,SAASmB,cAAe3X,EAAO3G,EAAKue,GAInE,YAHe,IAARve,IAAiBA,EAAMG,KAAKtD,WACf,IAAb0hB,IAAsBA,EAAW5X,EAAM9J,MAEvCsgB,YAAYhd,KAAMwG,EAAO3G,EAAKue,IAOvCb,EAASnd,UAAUf,UAAY,SAASA,UAAWQ,EAAKwe,GAGtD,QAFiB,IAAVA,IAAmBA,GAAS,GAExB,GAAPxe,EAAY,OAAOye,SAAS,EAAGze,GACnC,GAAIA,GAAOG,KAAKtD,KAAQ,OAAO4hB,SAASte,KAAK4G,QAAQ/H,OAAQgB,GAC7D,GAAIA,EAAMG,KAAKtD,MAAQmD,EAAM,EAAK,MAAM,IAAI6F,WAAY,YAAc7F,EAAM,yBAA2B,KAAS,KAChH,IAAK,IAAIf,EAAI,EAAGyf,EAAS,GAAIzf,IAAK,CAChC,IAAyBmC,EAAMsd,EAArBve,KAAKhD,MAAM8B,GAAuBiO,SAC5C,GAAI9L,GAAOpB,EACT,OAAIoB,GAAOpB,GAAOwe,EAAQ,EAAYC,SAASxf,EAAI,EAAGmC,GAC/Cqd,SAASxf,EAAGyf,GAErBA,EAAStd,IAMbsc,EAASnd,UAAUoB,SAAW,SAASA,WAAc,MAAO,IAAMxB,KAAKwe,gBAAkB,KAEzFjB,EAASnd,UAAUoe,cAAgB,SAASA,gBAAmB,OAAOxe,KAAK4G,QAAQ2G,KAAK,OAIxFgQ,EAASnd,UAAUiF,OAAS,SAASA,SACnC,OAAOrF,KAAK4G,QAAQ/H,OAASmB,KAAK4G,QAAQpI,KAAI,SAAUoD,GAAK,OAAOA,EAAEyD,YAAe,MAKvFkY,EAASjY,SAAW,SAASA,SAAUC,EAAQ1I,GAC7C,IAAKA,EAAS,OAAO0gB,EAAS1b,MAC9B,IAAK4c,MAAMC,QAAQ7hB,GAAU,MAAM,IAAI6I,WAAW,uCAClD,OAAO,IAAI6X,EAAS1gB,EAAM2B,IAAI+G,EAAOoZ,gBAMvCpB,EAAS3R,UAAY,SAASA,UAAWgT,GACvC,IAAKA,EAAM/f,OAAU,OAAO0e,EAAS1b,MAErC,IADA,IAAIgd,EAAQniB,EAAO,EACVoC,EAAI,EAAGA,EAAI8f,EAAM/f,OAAQC,IAAK,CACrC,IAAI6I,EAAOiX,EAAM9f,GACjBpC,GAAQiL,EAAKoF,SACTjO,GAAK6I,EAAKmV,QAAU8B,EAAM9f,EAAI,GAAG+d,WAAWlV,IACzCkX,IAAUA,EAASD,EAAMnc,MAAM,EAAG3D,IACvC+f,EAAOA,EAAOhgB,OAAS,GAAK8I,EAAKoW,SAASc,EAAOA,EAAOhgB,OAAS,GAAGke,KAAOpV,EAAKoV,OACvE8B,GACTA,EAAO3gB,KAAKyJ,GAGhB,OAAO,IAAI4V,EAASsB,GAAUD,EAAOliB,IAQvC6gB,EAAStb,KAAO,SAASA,KAAM6c,GAC7B,IAAKA,EAAS,OAAOvB,EAAS1b,MAC9B,GAAIid,aAAiBvB,EAAY,OAAOuB,EACxC,GAAIL,MAAMC,QAAQI,GAAU,OAAO9e,KAAK4L,UAAUkT,GAClD,GAAIA,EAAMhW,MAAS,OAAO,IAAIyU,EAAS,CAACuB,GAAQA,EAAM/R,UACtD,MAAM,IAAIrH,WAAW,mBAAqBoZ,EAAQ,kBAC5BA,EAAMrS,aAAe,mEAAqE,MAGlH/I,OAAOoB,iBAAkByY,EAASnd,UAAW8D,GAE7C,IAAIgL,EAAQ,CAAC5O,MAAO,EAAGqB,OAAQ,GAC/B,SAAS2c,SAAShe,EAAOqB,GAGvB,OAFAuN,EAAM5O,MAAQA,EACd4O,EAAMvN,OAASA,EACRuN,EAST,SAAS6P,YAAYjU,EAAGC,GACtB,GAAID,IAAMC,EAAK,OAAO,EACtB,IAAMD,GAAiB,iBAALA,IACZC,GAAiB,iBAALA,EAAkB,OAAO,EAC3C,IAAI6T,EAAQH,MAAMC,QAAQ5T,GAC1B,GAAI2T,MAAMC,QAAQ3T,IAAM6T,EAAS,OAAO,EACxC,GAAIA,EAAO,CACT,GAAI9T,EAAEjM,QAAUkM,EAAElM,OAAU,OAAO,EACnC,IAAK,IAAIC,EAAI,EAAGA,EAAIgM,EAAEjM,OAAQC,IAAO,IAAKigB,YAAYjU,EAAEhM,GAAIiM,EAAEjM,IAAO,OAAO,MACvE,CACL,IAAK,IAAImf,KAAKnT,EAAK,KAAMmT,KAAKlT,KAAOgU,YAAYjU,EAAEmT,GAAIlT,EAAEkT,IAAO,OAAO,EACvE,IAAK,IAAIe,KAAOjU,EAAK,KAAMiU,KAAOlU,GAAM,OAAO,EAEjD,OAAO,EAfTyS,EAAS1b,MAAQ,IAAI0b,EAAS,GAAI,GAwBlC,IAAI0B,EAAO,SAASA,KAAKtZ,EAAMmD,GAG7B9I,KAAK2F,KAAOA,EAGZ3F,KAAK8I,MAAQA,GAyGf,SAASoW,aAAa9c,GACpB,IAAIC,EAAMC,MAAMC,KAAKvC,KAAMoC,GAE3B,OADAC,EAAIG,UAAY0c,aAAa9e,UACtBiC,EAnGT4c,EAAK7e,UAAUyN,SAAW,SAASA,SAAU5R,GAE3C,IADA,IAAIyG,EAAMsN,GAAS,EACVlR,EAAI,EAAGA,EAAI7C,EAAI4C,OAAQC,IAAK,CACnC,IAAI0H,EAAQvK,EAAI6C,GAChB,GAAIkB,KAAK+N,GAAGvH,GAAU,OAAOvK,EAC7B,GAAI+D,KAAK2F,KAAKwZ,SAAS3Y,EAAMb,MACtBjD,IAAQA,EAAOzG,EAAIwG,MAAM,EAAG3D,QAC5B,IAAI0H,EAAMb,KAAKwZ,SAASnf,KAAK2F,MAClC,OAAO1J,GAEF+T,GAAUxJ,EAAMb,KAAKyZ,KAAOpf,KAAK2F,KAAKyZ,OACpC1c,IAAQA,EAAOzG,EAAIwG,MAAM,EAAG3D,IACjC4D,EAAKxE,KAAK8B,MACVgQ,GAAS,GAEPtN,GAAQA,EAAKxE,KAAKsI,IAK1B,OAFK9D,IAAQA,EAAOzG,EAAIwG,SACnBuN,GAAUtN,EAAKxE,KAAK8B,MAClB0C,GAMTuc,EAAK7e,UAAU8N,cAAgB,SAASA,cAAejS,GACrD,IAAK,IAAI6C,EAAI,EAAGA,EAAI7C,EAAI4C,OAAQC,IAC5B,GAAIkB,KAAK+N,GAAG9R,EAAI6C,IACd,OAAO7C,EAAIwG,MAAM,EAAG3D,GAAG+K,OAAO5N,EAAIwG,MAAM3D,EAAI,IAClD,OAAO7C,GAKTgjB,EAAK7e,UAAUwO,QAAU,SAASA,QAAS3S,GACzC,IAAK,IAAI6C,EAAI,EAAGA,EAAI7C,EAAI4C,OAAQC,IAC5B,GAAIkB,KAAK+N,GAAG9R,EAAI6C,IAAO,OAAO,EAClC,OAAO,GAMTmgB,EAAK7e,UAAU2N,GAAK,SAASA,GAAIvH,GAC/B,OAAOxG,MAAQwG,GACZxG,KAAK2F,MAAQa,EAAMb,MAAQoZ,YAAY/e,KAAK8I,MAAOtC,EAAMsC,QAK9DmW,EAAK7e,UAAUiF,OAAS,SAASA,SAC/B,IAAIuR,EAAM,CAACjR,KAAM3F,KAAK2F,KAAK9B,MAC3B,IAAK,IAAIrH,KAAKwD,KAAK8I,MAAO,CACxB8N,EAAI9N,MAAQ9I,KAAK8I,MACjB,MAEF,OAAO8N,GAITqI,EAAK3Z,SAAW,SAASA,SAAUC,EAAQC,GACzC,IAAKA,EAAQ,MAAM,IAAIE,WAAW,mCAClC,IAAIC,EAAOJ,EAAOyH,MAAMxH,EAAKG,MAC7B,IAAKA,EAAQ,MAAM,IAAID,WAAY,yBAA4BF,EAAS,KAAI,mBAC5E,OAAOG,EAAKhC,OAAO6B,EAAKsD,QAK1BmW,EAAKI,QAAU,SAASA,QAASvU,EAAGC,GAClC,GAAID,GAAKC,EAAK,OAAO,EACrB,GAAID,EAAEjM,QAAUkM,EAAElM,OAAU,OAAO,EACnC,IAAK,IAAIC,EAAI,EAAGA,EAAIgM,EAAEjM,OAAQC,IAC1B,IAAKgM,EAAEhM,GAAGiP,GAAGhD,EAAEjM,IAAO,OAAO,EACjC,OAAO,GAMTmgB,EAAKK,QAAU,SAASA,QAAStS,GAC/B,IAAKA,GAAyB,GAAhBA,EAAMnO,OAAe,OAAOogB,EAAKM,KAC/C,GAAIvS,aAAiBiS,EAAQ,MAAO,CAACjS,GACrC,IAAItK,EAAOsK,EAAMvK,QAEjB,OADAC,EAAK8c,MAAK,SAAU1U,EAAGC,GAAK,OAAOD,EAAEnF,KAAKyZ,KAAOrU,EAAEpF,KAAKyZ,QACjD1c,GAITuc,EAAKM,KAAO,GAYZL,aAAa9e,UAAYsD,OAAOC,OAAOrB,MAAMlC,WAC7C8e,aAAa9e,UAAUwD,YAAcsb,aACrCA,aAAa9e,UAAUyD,KAAO,eAK9B,IAAI4b,EAAQ,SAASA,MAAM7Y,EAASF,EAAWD,GAE7CzG,KAAK4G,QAAUA,EAEf5G,KAAK0G,UAAYA,EAEjB1G,KAAKyG,QAAUA,GAGbwJ,EAAuB,CAAEvT,KAAM,CAAE0H,cAAc,IA6DnD,SAASsb,YAAY9Y,EAAS3E,EAAMC,GAClC,IAAI4P,EAAMlL,EAAQvH,UAAU4C,GACxB3B,EAAQwR,EAAIxR,MACZqB,EAASmQ,EAAInQ,OACb3E,EAAQ4J,EAAQkB,WAAWxH,GAC3B8R,EAAQxL,EAAQvH,UAAU6C,GAC1Byd,EAAUvN,EAAM9R,MAChBsf,EAAWxN,EAAMzQ,OACrB,GAAIA,GAAUM,GAAQjF,EAAM8f,OAAQ,CAClC,GAAI8C,GAAY1d,IAAO0E,EAAQ5J,MAAM2iB,GAAS7C,OAAU,MAAM,IAAIpX,WAAW,2BAC7E,OAAOkB,EAAQoX,IAAI,EAAG/b,GAAM4E,OAAOD,EAAQoX,IAAI9b,IAEjD,GAAI5B,GAASqf,EAAW,MAAM,IAAIja,WAAW,2BAC7C,OAAOkB,EAAQ4D,aAAalK,EAAOtD,EAAM0F,KAAKgd,YAAY1iB,EAAM4J,QAAS3E,EAAON,EAAS,EAAGO,EAAKP,EAAS,KAG5G,SAASke,WAAWjZ,EAASY,EAAMP,EAAQoB,GACzC,IAAIyJ,EAAMlL,EAAQvH,UAAUmI,GACxBlH,EAAQwR,EAAIxR,MACZqB,EAASmQ,EAAInQ,OACb3E,EAAQ4J,EAAQkB,WAAWxH,GAC/B,GAAIqB,GAAU6F,GAAQxK,EAAM8f,OAC1B,OAAIzU,IAAWA,EAAOH,WAAW5H,EAAOA,EAAO2G,GAAkB,KAC1DL,EAAQoX,IAAI,EAAGxW,GAAMX,OAAOI,GAAQJ,OAAOD,EAAQoX,IAAIxW,IAEhE,IAAI6B,EAAQwW,WAAW7iB,EAAM4J,QAASY,EAAO7F,EAAS,EAAGsF,GACzD,OAAOoC,GAASzC,EAAQ4D,aAAalK,EAAOtD,EAAM0F,KAAK2G,IAOzD,SAASnD,QAAQoB,EAAOmB,EAAKhG,GAC3B,GAAIA,EAAMiE,UAAYY,EAAMG,MACxB,MAAM,IAAIyX,aAAa,mDAC3B,GAAI5X,EAAMG,MAAQhF,EAAMiE,WAAa+B,EAAIhB,MAAQhF,EAAMgE,QACnD,MAAM,IAAIyY,aAAa,4BAC3B,OAAOY,aAAaxY,EAAOmB,EAAKhG,EAAO,GAGzC,SAASqd,aAAaxY,EAAOmB,EAAKhG,EAAOgF,GACvC,IAAInH,EAAQgH,EAAMhH,MAAMmH,GAAQE,EAAOL,EAAMK,KAAKF,GAClD,GAAInH,GAASmI,EAAInI,MAAMmH,IAAUA,EAAQH,EAAMG,MAAQhF,EAAMiE,UAAW,CACtE,IAAI2C,EAAQyW,aAAaxY,EAAOmB,EAAKhG,EAAOgF,EAAQ,GACpD,OAAOE,EAAKjF,KAAKiF,EAAKf,QAAQ4D,aAAalK,EAAO+I,IAC7C,GAAK5G,EAAMmE,QAAQlK,KAEnB,IAAK+F,EAAMiE,WAAcjE,EAAMgE,SAAWa,EAAMG,OAASA,GAASgB,EAAIhB,OAASA,EAG/E,CACL,IAAIqK,EAgFR,SAASiO,uBAAuBtd,EAAOud,GAGrC,IAFA,IAAIC,EAAQD,EAAOvY,MAAQhF,EAAMiE,UAC7BiB,EADiDqY,EAAOrY,KAAKsY,GAC/Cvd,KAAKD,EAAMmE,SACpB9H,EAAImhB,EAAQ,EAAGnhB,GAAK,EAAGA,IAC5B6I,EAAOqY,EAAOrY,KAAK7I,GAAG4D,KAAK6a,EAAStb,KAAK0F,IAC7C,MAAO,CAAC7G,MAAO6G,EAAKuY,eAAezd,EAAMiE,UAAYuZ,GAC7Chf,IAAK0G,EAAKuY,eAAevY,EAAKf,QAAQlK,KAAO+F,EAAMgE,QAAUwZ,IAtFzDF,CAAuBtd,EAAO6E,GAGxC,OAAO,eAAMK,EAAMwY,gBAAgB7Y,EAFvBwK,EAAIhR,MACNgR,EAAI7Q,IACwCwH,EAAKhB,IAN3D,IAAIY,EAASf,EAAMe,OAAQzB,EAAUyB,EAAOzB,QAC5C,OAAO,eAAMyB,EAAQzB,EAAQoX,IAAI,EAAG1W,EAAM0M,cAAcnN,OAAOpE,EAAMmE,SAASC,OAAOD,EAAQoX,IAAIvV,EAAIuL,gBAHrG,OAAO,eAAMrM,EAAMyY,cAAc9Y,EAAOmB,EAAKhB,IAYjD,SAAS4Y,UAAUC,EAAMC,GACvB,IAAKA,EAAI5a,KAAKiL,kBAAkB0P,EAAK3a,MACjC,MAAM,IAAIuZ,aAAa,eAAiBqB,EAAI5a,KAAK9B,KAAO,SAAWyc,EAAK3a,KAAK9B,MAGnF,SAAS8G,SAAS6V,EAASC,EAAQhZ,GACjC,IAAIE,EAAO6Y,EAAQ7Y,KAAKF,GAExB,OADA4Y,UAAU1Y,EAAM8Y,EAAO9Y,KAAKF,IACrBE,EAGT,SAAS+Y,QAAQ1jB,EAAO8O,GACtB,IAAIoI,EAAOpI,EAAOjN,OAAS,EACvBqV,GAAQ,GAAKlX,EAAM8f,QAAU9f,EAAM6f,WAAW/Q,EAAOoI,IACrDpI,EAAOoI,GAAQlX,EAAM+gB,SAASjS,EAAOoI,GAAM6I,KAAO/f,EAAM+f,MAExDjR,EAAO5N,KAAKlB,GAGlB,SAAS2jB,SAASC,EAAQC,EAAMpZ,EAAOqE,GACrC,IAAInE,GAAQkZ,GAAQD,GAAQjZ,KAAKF,GAC7Bc,EAAa,EAAGC,EAAWqY,EAAOA,EAAKvgB,MAAMmH,GAASE,EAAKC,WAC3DgZ,IACFrY,EAAaqY,EAAOtgB,MAAMmH,GACtBmZ,EAAOnZ,MAAQA,EACjBc,IACSqY,EAAOE,aAChBJ,QAAQE,EAAO/V,UAAWiB,GAC1BvD,MAGJ,IAAK,IAAIzJ,EAAIyJ,EAAYzJ,EAAI0J,EAAU1J,IAAO4hB,QAAQ/Y,EAAK3K,MAAM8B,GAAIgN,GACjE+U,GAAQA,EAAKpZ,OAASA,GAASoZ,EAAKC,YACpCJ,QAAQG,EAAKjW,WAAYkB,GAG/B,SAAS,eAAMnE,EAAMf,GACnB,IAAKe,EAAKhC,KAAKwE,aAAavD,GACxB,MAAM,IAAIsY,aAAa,4BAA8BvX,EAAKhC,KAAK9B,MACnE,OAAO8D,EAAKjF,KAAKkE,GAGnB,SAASuZ,gBAAgB7Y,EAAOsZ,EAAQC,EAAMpY,EAAKhB,GACjD,IAAIf,EAAYY,EAAMG,MAAQA,GAASkD,SAASrD,EAAOsZ,EAAQnZ,EAAQ,GACnEhB,EAAUgC,EAAIhB,MAAQA,GAASkD,SAASkW,EAAMpY,EAAKhB,EAAQ,GAE3Db,EAAU,GAad,OAZA+Z,SAAS,KAAMrZ,EAAOG,EAAOb,GACzBF,GAAaD,GAAWma,EAAOtgB,MAAMmH,IAAUoZ,EAAKvgB,MAAMmH,IAC5D4Y,UAAU3Z,EAAWD,GACrBia,QAAQ,eAAMha,EAAWyZ,gBAAgB7Y,EAAOsZ,EAAQC,EAAMpY,EAAKhB,EAAQ,IAAKb,KAE5EF,GACAga,QAAQ,eAAMha,EAAW0Z,cAAc9Y,EAAOsZ,EAAQnZ,EAAQ,IAAKb,GACvE+Z,SAASC,EAAQC,EAAMpZ,EAAOb,GAC1BH,GACAia,QAAQ,eAAMja,EAAS2Z,cAAcS,EAAMpY,EAAKhB,EAAQ,IAAKb,IAEnE+Z,SAASlY,EAAK,KAAMhB,EAAOb,GACpB,IAAI2W,EAAS3W,GAGtB,SAASwZ,cAAc9Y,EAAOmB,EAAKhB,GACjC,IAAIb,EAAU,IACd+Z,SAAS,KAAMrZ,EAAOG,EAAOb,GACzBU,EAAMG,MAAQA,IAEhBiZ,QAAQ,eADG/V,SAASrD,EAAOmB,EAAKhB,EAAQ,GACpB2Y,cAAc9Y,EAAOmB,EAAKhB,EAAQ,IAAKb,GAG7D,OADA+Z,SAASlY,EAAK,KAAMhB,EAAOb,GACpB,IAAI2W,EAAS3W,GA1LtBqJ,EAAqBvT,KAAKuC,IAAM,WAC9B,OAAOe,KAAK4G,QAAQlK,KAAOsD,KAAK0G,UAAY1G,KAAKyG,SAGnDgZ,EAAMrf,UAAUgH,SAAW,SAASA,SAAUvH,EAAK4L,GACjD,IAAI7E,EAAUiZ,WAAW7f,KAAK4G,QAAS/G,EAAMG,KAAK0G,UAAW+E,EAAU,MACvE,OAAO7E,GAAW,IAAI6Y,EAAM7Y,EAAS5G,KAAK0G,UAAW1G,KAAKyG,UAG5DgZ,EAAMrf,UAAUiH,cAAgB,SAASA,cAAepF,EAAMC,GAC5D,OAAO,IAAIud,EAAMC,YAAY1f,KAAK4G,QAAS3E,EAAOjC,KAAK0G,UAAWxE,EAAKlC,KAAK0G,WAAY1G,KAAK0G,UAAW1G,KAAKyG,UAK/GgZ,EAAMrf,UAAU2N,GAAK,SAASA,GAAIvH,GAChC,OAAOxG,KAAK4G,QAAQmH,GAAGvH,EAAMI,UAAY5G,KAAK0G,WAAaF,EAAME,WAAa1G,KAAKyG,SAAWD,EAAMC,SAGtGgZ,EAAMrf,UAAUoB,SAAW,SAASA,WAClC,OAAOxB,KAAK4G,QAAU,IAAM5G,KAAK0G,UAAY,IAAM1G,KAAKyG,QAAU,KAKpEgZ,EAAMrf,UAAUiF,OAAS,SAASA,SAChC,IAAKrF,KAAK4G,QAAQlK,KAAQ,OAAO,KACjC,IAAI8I,EAAO,CAACoB,QAAS5G,KAAK4G,QAAQvB,UAGlC,OAFIrF,KAAK0G,UAAY,IAAKlB,EAAKkB,UAAY1G,KAAK0G,WAC5C1G,KAAKyG,QAAU,IAAKjB,EAAKiB,QAAUzG,KAAKyG,SACrCjB,GAKTia,EAAMna,SAAW,SAASA,SAAUC,EAAQC,GAC1C,IAAKA,EAAQ,OAAOia,EAAM5d,MAC1B,IAAI6E,EAAYlB,EAAKkB,WAAa,EAAGD,EAAUjB,EAAKiB,SAAW,EAC/D,GAAwB,iBAAbC,GAA2C,iBAAXD,EACvC,MAAM,IAAIf,WAAW,oCACzB,OAAO,IAAI+Z,EAAMlC,EAASjY,SAASC,EAAQC,EAAKoB,SAAUF,EAAWD,IAMvEgZ,EAAMsB,QAAU,SAASA,QAAStV,EAAUuV,QACjB,IAAlBA,IAA2BA,GAAc,GAGhD,IADA,IAAIta,EAAY,EAAGD,EAAU,EACpB7E,EAAI6J,EAASzD,WAAYpG,IAAMA,EAAEmG,SAAWiZ,IAAkBpf,EAAE+D,KAAK+C,KAAKC,WAAY/G,EAAIA,EAAEoG,WAActB,IACnH,IAAK,IAAIua,EAAMxV,EAAS4E,UAAW4Q,IAAQA,EAAIlZ,SAAWiZ,IAAkBC,EAAItb,KAAK+C,KAAKC,WAAYsY,EAAMA,EAAI5Q,UAAa5J,IAC7H,OAAO,IAAIgZ,EAAMhU,EAAU/E,EAAWD,IAGxC/C,OAAOoB,iBAAkB2a,EAAMrf,UAAW6P,GAiC1CwP,EAAM5d,MAAQ,IAAI4d,EAAMlC,EAAS1b,MAAO,EAAG,GAsH3C,IAAIqf,EAAc,SAASA,YAAYrhB,EAAKshB,EAAMnN,GAEhDhU,KAAKH,IAAMA,EACXG,KAAKmhB,KAAOA,EAKZnhB,KAAKyH,MAAQ0Z,EAAKtiB,OAAS,EAAI,EAE/BmB,KAAKgU,aAAeA,GAGlBoN,EAAuB,CAAE/Y,OAAQ,CAAEjE,cAAc,GAAOL,IAAK,CAAEK,cAAc,GAAO0c,WAAY,CAAE1c,cAAc,GAAOyG,UAAW,CAAEzG,cAAc,GAAOwG,WAAY,CAAExG,cAAc,IAEzL8c,EAAY9gB,UAAUihB,aAAe,SAASA,aAAcC,GAC1D,OAAW,MAAPA,EAAsBthB,KAAKyH,MAC3B6Z,EAAM,EAAYthB,KAAKyH,MAAQ6Z,EAC5BA,GAOTF,EAAqB/Y,OAAOpJ,IAAM,WAAc,OAAOe,KAAK2H,KAAK3H,KAAKyH,QAItE2Z,EAAqBrd,IAAI9E,IAAM,WAAc,OAAOe,KAAK2H,KAAK,IAK9DuZ,EAAY9gB,UAAUuH,KAAO,SAASA,KAAMF,GAAS,OAAOzH,KAAKmhB,KAAgC,EAA3BnhB,KAAKqhB,aAAa5Z,KAMxFyZ,EAAY9gB,UAAUE,MAAQ,SAASA,MAAOmH,GAAS,OAAOzH,KAAKmhB,KAAgC,EAA3BnhB,KAAKqhB,aAAa5Z,GAAa,IAKvGyZ,EAAY9gB,UAAUsH,WAAa,SAASA,WAAYD,GAEtD,OADAA,EAAQzH,KAAKqhB,aAAa5Z,GACnBzH,KAAKM,MAAMmH,IAAUA,GAASzH,KAAKyH,OAAUzH,KAAK8gB,WAAiB,EAAJ,IAMxEI,EAAY9gB,UAAUU,MAAQ,SAASA,MAAO2G,GAE5C,OAAgB,IADhBA,EAAQzH,KAAKqhB,aAAa5Z,IACN,EAAIzH,KAAKmhB,KAAa,EAAR1Z,EAAY,GAAK,GAMrDyZ,EAAY9gB,UAAUa,IAAM,SAASA,IAAKwG,GAExC,OADAA,EAAQzH,KAAKqhB,aAAa5Z,GACnBzH,KAAKc,MAAM2G,GAASzH,KAAK2H,KAAKF,GAAOb,QAAQlK,MAOtDwkB,EAAY9gB,UAAU+D,OAAS,SAASA,OAAQsD,GAE9C,KADAA,EAAQzH,KAAKqhB,aAAa5Z,IACZ,MAAM,IAAI/B,WAAW,kDACnC,OAAO+B,GAASzH,KAAKyH,MAAQ,EAAIzH,KAAKH,IAAMG,KAAKmhB,KAAa,EAAR1Z,EAAY,IAMpEyZ,EAAY9gB,UAAUmK,MAAQ,SAASA,MAAO9C,GAE5C,KADAA,EAAQzH,KAAKqhB,aAAa5Z,IACZ,MAAM,IAAI/B,WAAW,iDACnC,OAAO+B,GAASzH,KAAKyH,MAAQ,EAAIzH,KAAKH,IAAMG,KAAKmhB,KAAa,EAAR1Z,EAAY,GAAKzH,KAAKmhB,KAAa,EAAR1Z,GAAWsF,UAO9FqU,EAAqBN,WAAW7hB,IAAM,WAAc,OAAOe,KAAKH,IAAMG,KAAKmhB,KAAKnhB,KAAKmhB,KAAKtiB,OAAS,IAMnGuiB,EAAqBvW,UAAU5L,IAAM,WACnC,IAAIoJ,EAASrI,KAAKqI,OAAQ/H,EAAQN,KAAKM,MAAMN,KAAKyH,OAClD,GAAInH,GAAS+H,EAAOT,WAAc,OAAO,KACzC,IAAI2Z,EAAOvhB,KAAKH,IAAMG,KAAKmhB,KAAKnhB,KAAKmhB,KAAKtiB,OAAS,GAAI7B,EAAQqL,EAAOrL,MAAMsD,GAC5E,OAAOihB,EAAOlZ,EAAOrL,MAAMsD,GAAO0d,IAAIuD,GAAQvkB,GAOhDokB,EAAqBxW,WAAW3L,IAAM,WACpC,IAAIqB,EAAQN,KAAKM,MAAMN,KAAKyH,OACxB8Z,EAAOvhB,KAAKH,IAAMG,KAAKmhB,KAAKnhB,KAAKmhB,KAAKtiB,OAAS,GACnD,OAAI0iB,EAAevhB,KAAKqI,OAAOrL,MAAMsD,GAAO0d,IAAI,EAAGuD,GACnC,GAATjhB,EAAa,KAAON,KAAKqI,OAAOrL,MAAMsD,EAAQ,IAMvD4gB,EAAY9gB,UAAUohB,WAAa,SAASA,WAAYlhB,EAAOmH,GAC7DA,EAAQzH,KAAKqhB,aAAa5Z,GAE1B,IADA,IAAIE,EAAO3H,KAAKmhB,KAAa,EAAR1Z,GAAY5H,EAAe,GAAT4H,EAAa,EAAIzH,KAAKmhB,KAAa,EAAR1Z,EAAY,GAAK,EAC1E3I,EAAI,EAAGA,EAAIwB,EAAOxB,IAAOe,GAAO8H,EAAK3K,MAAM8B,GAAGiO,SACvD,OAAOlN,GAQTqhB,EAAY9gB,UAAU4M,MAAQ,SAASA,QACrC,IAAI3E,EAASrI,KAAKqI,OAAQ/H,EAAQN,KAAKM,QAGvC,GAA2B,GAAvB+H,EAAOzB,QAAQlK,KAAa,OAAOuiB,EAAKM,KAG5C,GAAIvf,KAAK8gB,WAAc,OAAOzY,EAAOrL,MAAMsD,GAAO0M,MAElD,IAAIsT,EAAOjY,EAAOP,WAAWxH,EAAQ,GAAIkG,EAAQ6B,EAAOP,WAAWxH,GAGnE,IAAKggB,EAAM,CAAE,IAAImB,EAAMnB,EAAMA,EAAO9Z,EAAOA,EAAQib,EAKnD,IADA,IAAIzU,MAAQsT,EAAKtT,MACRlO,EAAI,EAAGA,EAAIkO,MAAMnO,OAAQC,KACO,IAAjCkO,MAAMlO,GAAG6G,KAAK+C,KAAKgZ,WAAyBlb,GAAUwG,MAAMlO,GAAG8P,QAAQpI,EAAMwG,SAC/EA,MAAQA,MAAMlO,KAAKoP,cAAclB,QAEvC,OAAOA,OAUTkU,EAAY9gB,UAAUuhB,YAAc,SAASA,YAAad,GACxD,IAAItW,EAAQvK,KAAKqI,OAAOP,WAAW9H,KAAKM,SACxC,IAAKiK,IAAUA,EAAMoB,SAAY,OAAO,KAGxC,IADA,IAAIqB,EAAQzC,EAAMyC,MAAOnF,EAAOgZ,EAAKxY,OAAOP,WAAW+Y,EAAKvgB,SACnDxB,EAAI,EAAGA,EAAIkO,EAAMnO,OAAQC,KACO,IAAjCkO,EAAMlO,GAAG6G,KAAK+C,KAAKgZ,WAAyB7Z,GAASmF,EAAMlO,GAAG8P,QAAQ/G,EAAKmF,SAC7EA,EAAQA,EAAMlO,KAAKoP,cAAclB,IACvC,OAAOA,GAMTkU,EAAY9gB,UAAUuN,YAAc,SAASA,YAAa9N,GACxD,IAAK,IAAI4H,EAAQzH,KAAKyH,MAAOA,EAAQ,EAAGA,IACpC,GAAIzH,KAAKc,MAAM2G,IAAU5H,GAAOG,KAAKiB,IAAIwG,IAAU5H,EAAO,OAAO4H,EACrE,OAAO,GAWTyZ,EAAY9gB,UAAUwhB,WAAa,SAASA,WAAYpb,EAAOqb,GAG7D,QAFiB,IAAVrb,IAAmBA,EAAQxG,MAE9BwG,EAAM3G,IAAMG,KAAKH,IAAO,OAAO2G,EAAMob,WAAW5hB,MACpD,IAAK,IAAIoK,EAAIpK,KAAKyH,OAASzH,KAAKqI,OAAOyZ,eAAiB9hB,KAAKH,KAAO2G,EAAM3G,IAAM,EAAI,GAAIuK,GAAK,EAAGA,IAC5F,GAAI5D,EAAM3G,KAAOG,KAAKiB,IAAImJ,MAAQyX,GAAQA,EAAK7hB,KAAK2H,KAAKyC,KACvD,OAAO,IAAI2X,EAAU/hB,KAAMwG,EAAO4D,IAK1C8W,EAAY9gB,UAAU4hB,WAAa,SAASA,WAAYxb,GACtD,OAAOxG,KAAKH,IAAMG,KAAKgU,cAAgBxN,EAAM3G,IAAM2G,EAAMwN,cAK3DkN,EAAY9gB,UAAUmG,IAAM,SAASA,IAAKC,GACxC,OAAOA,EAAM3G,IAAMG,KAAKH,IAAM2G,EAAQxG,MAKxCkhB,EAAY9gB,UAAU4N,IAAM,SAASA,IAAKxH,GACxC,OAAOA,EAAM3G,IAAMG,KAAKH,IAAM2G,EAAQxG,MAGxCkhB,EAAY9gB,UAAUoB,SAAW,SAASA,WAExC,IADA,IAAIygB,EAAM,GACDnjB,EAAI,EAAGA,GAAKkB,KAAKyH,MAAO3I,IAC7BmjB,IAAQA,EAAM,IAAM,IAAMjiB,KAAK2H,KAAK7I,GAAG6G,KAAK9B,KAAO,IAAM7D,KAAKM,MAAMxB,EAAI,GAC5E,OAAOmjB,EAAM,IAAMjiB,KAAKgU,cAG1BkN,EAAY3Z,QAAU,SAASA,QAASxD,EAAKlE,GAC3C,KAAMA,GAAO,GAAKA,GAAOkE,EAAI6C,QAAQlK,MAAS,MAAM,IAAIgJ,WAAW,YAAc7F,EAAM,iBAGvF,IAFA,IAAIshB,EAAO,GACPrgB,EAAQ,EAAGkT,EAAenU,EACrB8H,EAAO5D,IAAO,CACrB,IAAI+N,EAAMnK,EAAKf,QAAQvH,UAAU2U,GAC3B1T,EAAQwR,EAAIxR,MACZqB,EAASmQ,EAAInQ,OACfugB,EAAMlO,EAAerS,EAEzB,GADAwf,EAAKjjB,KAAKyJ,EAAMrH,EAAOQ,EAAQa,IAC1BugB,EAAO,MAEZ,IADAva,EAAOA,EAAK3K,MAAMsD,IACTwc,OAAU,MACnB9I,EAAekO,EAAM,EACrBphB,GAASa,EAAS,EAEpB,OAAO,IAAIuf,EAAYrhB,EAAKshB,EAAMnN,IAGpCkN,EAAYiB,cAAgB,SAASA,cAAepe,EAAKlE,GACvD,IAAK,IAAIf,EAAI,EAAGA,EAAIsjB,EAAavjB,OAAQC,IAAK,CAC5C,IAAIujB,EAASD,EAAatjB,GAC1B,GAAIujB,EAAOxiB,KAAOA,GAAOwiB,EAAOte,KAAOA,EAAO,OAAOse,EAEvD,IAAInhB,EAASkhB,EAAaE,GAAmBpB,EAAY3Z,QAAQxD,EAAKlE,GAEtE,OADAyiB,GAAmBA,EAAkB,GAAKC,EACnCrhB,GAGTwC,OAAOoB,iBAAkBoc,EAAY9gB,UAAWghB,GAEhD,IAAIgB,EAAe,GAAIE,EAAkB,EAAGC,EAAmB,GAI3DR,EAAY,SAASA,UAAUza,EAAOmB,EAAKhB,GAM7CzH,KAAKsH,MAAQA,EAGbtH,KAAKyI,IAAMA,EAEXzI,KAAKyH,MAAQA,GAGX+a,EAAyB,CAAE1hB,MAAO,CAAEsD,cAAc,GAAOnD,IAAK,CAAEmD,cAAc,GAAOiE,OAAQ,CAAEjE,cAAc,GAAOmE,WAAY,CAAEnE,cAAc,GAAOoE,SAAU,CAAEpE,cAAc,IAGrLoe,EAAuB1hB,MAAM7B,IAAM,WAAc,OAAOe,KAAKsH,MAAMnD,OAAOnE,KAAKyH,MAAQ,IAEvF+a,EAAuBvhB,IAAIhC,IAAM,WAAc,OAAOe,KAAKyI,IAAI8B,MAAMvK,KAAKyH,MAAQ,IAGlF+a,EAAuBna,OAAOpJ,IAAM,WAAc,OAAOe,KAAKsH,MAAMK,KAAK3H,KAAKyH,QAE9E+a,EAAuBja,WAAWtJ,IAAM,WAAc,OAAOe,KAAKsH,MAAMhH,MAAMN,KAAKyH,QAEnF+a,EAAuBha,SAASvJ,IAAM,WAAc,OAAOe,KAAKyI,IAAIf,WAAW1H,KAAKyH,QAEpF/D,OAAOoB,iBAAkBid,EAAU3hB,UAAWoiB,GAE9C,IAAIC,EAAa/e,OAAOC,OAAO,MAc3B+e,EAAO,SAASA,KAAK/c,EAAMmD,EAAOlC,EAASoG,GAG7ChN,KAAK2F,KAAOA,EAMZ3F,KAAK8I,MAAQA,EAIb9I,KAAK4G,QAAUA,GAAW2W,EAAS1b,MAKnC7B,KAAKgN,MAAQA,GAASiS,EAAKM,MAGzBoD,EAAuB,CAAE5V,SAAU,CAAE3I,cAAc,GAAOwD,WAAY,CAAExD,cAAc,GAAOwe,YAAa,CAAExe,cAAc,GAAO4D,WAAY,CAAE5D,cAAc,GAAOiM,UAAW,CAAEjM,cAAc,GAAO0Z,QAAS,CAAE1Z,cAAc,GAAO+G,YAAa,CAAE/G,cAAc,GAAO0d,cAAe,CAAE1d,cAAc,GAAOuH,SAAU,CAAEvH,cAAc,GAAO0Y,OAAQ,CAAE1Y,cAAc,GAAO2D,OAAQ,CAAE3D,cAAc,GAAOye,OAAQ,CAAEze,cAAc,IAW3aue,EAAqB5V,SAAS9N,IAAM,WAAc,OAAOe,KAAK+H,OAAS,EAAI,EAAI/H,KAAK4G,QAAQlK,MAI5FimB,EAAqB/a,WAAW3I,IAAM,WAAc,OAAOe,KAAK4G,QAAQgB,YAKxE8a,EAAKtiB,UAAUpD,MAAQ,SAASA,MAAOsD,GAAS,OAAON,KAAK4G,QAAQ5J,MAAMsD,IAI1EoiB,EAAKtiB,UAAU0H,WAAa,SAASA,WAAYxH,GAAS,OAAON,KAAK4G,QAAQkB,WAAWxH,IAKzFoiB,EAAKtiB,UAAUjE,QAAU,SAASA,QAASiF,GAAKpB,KAAK4G,QAAQzK,QAAQiF,IAUrEshB,EAAKtiB,UAAUqM,aAAe,SAASA,aAAcxK,EAAMC,EAAId,EAAG0hB,QAC5C,IAAbA,IAAsBA,EAAW,GAExC9iB,KAAK4G,QAAQ6F,aAAaxK,EAAMC,EAAId,EAAG0hB,EAAU9iB,OAMnD0iB,EAAKtiB,UAAUqd,YAAc,SAASA,YAAarc,GACjDpB,KAAKyM,aAAa,EAAGzM,KAAK4G,QAAQlK,KAAM0E,IAM1CuhB,EAAqBC,YAAY3jB,IAAM,WAAc,OAAOe,KAAK0d,YAAY,EAAG1d,KAAK4G,QAAQlK,KAAM,KAOnGgmB,EAAKtiB,UAAUsd,YAAc,SAASA,YAAazb,EAAMC,EAAIyb,EAAgBC,GAC3E,OAAO5d,KAAK4G,QAAQ8W,YAAYzb,EAAMC,EAAIyb,EAAgBC,IAM5D+E,EAAqB3a,WAAW/I,IAAM,WAAc,OAAOe,KAAK4G,QAAQoB,YAKxE2a,EAAqBtS,UAAUpR,IAAM,WAAc,OAAOe,KAAK4G,QAAQyJ,WAIvEqS,EAAKtiB,UAAU2N,GAAK,SAASA,GAAIvH,GAC/B,OAAOxG,MAAQwG,GAAUxG,KAAK6c,WAAWrW,IAAUxG,KAAK4G,QAAQmH,GAAGvH,EAAMI,UAM3E8b,EAAKtiB,UAAUyc,WAAa,SAASA,WAAYrW,GAC/C,OAAOxG,KAAK0M,UAAUlG,EAAMb,KAAMa,EAAMsC,MAAOtC,EAAMwG,QAMvD0V,EAAKtiB,UAAUsM,UAAY,SAASA,UAAW/G,EAAMmD,EAAOkE,GAC1D,OAAOhN,KAAK2F,MAAQA,GAClBoZ,YAAY/e,KAAK8I,MAAOA,GAASnD,EAAKod,cAAgBN,IACtDxD,EAAKI,QAAQrf,KAAKgN,MAAOA,GAASiS,EAAKM,OAM3CmD,EAAKtiB,UAAUsC,KAAO,SAASA,KAAMkE,GAGnC,YAFmB,IAAZA,IAAqBA,EAAU,MAElCA,GAAW5G,KAAK4G,QAAkB5G,KAC/B,IAAIA,KAAK4D,YAAY5D,KAAK2F,KAAM3F,KAAK8I,MAAOlC,EAAS5G,KAAKgN,QAMnE0V,EAAKtiB,UAAUqN,KAAO,SAASA,KAAMT,GACnC,OAAOA,GAAShN,KAAKgN,MAAQhN,KAAO,IAAIA,KAAK4D,YAAY5D,KAAK2F,KAAM3F,KAAK8I,MAAO9I,KAAK4G,QAASoG,IAOhG0V,EAAKtiB,UAAU4d,IAAM,SAASA,IAAK/b,EAAMC,GACvC,OAAY,GAARD,GAAaC,GAAMlC,KAAK4G,QAAQlK,KAAesD,KAC5CA,KAAK0C,KAAK1C,KAAK4G,QAAQoX,IAAI/b,EAAMC,KAM1CwgB,EAAKtiB,UAAUqC,MAAQ,SAASA,MAAOR,EAAMC,EAAI8gB,GAI/C,QAHc,IAAP9gB,IAAgBA,EAAKlC,KAAK4G,QAAQlK,WACf,IAAnBsmB,IAA4BA,GAAiB,GAEhD/gB,GAAQC,EAAM,OAAOud,EAAM5d,MAE/B,IAAIyF,EAAQtH,KAAKuH,QAAQtF,GAAOwG,EAAMzI,KAAKuH,QAAQrF,GAC/CuF,EAAQub,EAAiB,EAAI1b,EAAMqG,YAAYzL,GAC/CpB,EAAQwG,EAAMxG,MAAM2G,GACpBb,EADmCU,EAAMK,KAAKF,GAC/Bb,QAAQoX,IAAI1W,EAAMzH,IAAMiB,EAAO2H,EAAI5I,IAAMiB,GAC5D,OAAO,IAAI2e,EAAM7Y,EAASU,EAAMG,MAAQA,EAAOgB,EAAIhB,MAAQA,IAU7Dib,EAAKtiB,UAAU8F,QAAU,SAAS+c,UAAWhhB,EAAMC,EAAIO,GACrD,OAAOyD,QAAQlG,KAAKuH,QAAQtF,GAAOjC,KAAKuH,QAAQrF,GAAKO,IAKvDigB,EAAKtiB,UAAU8M,OAAS,SAASA,OAAQrN,GACvC,IAAK,IAAI8H,EAAO3H,OAAQ,CACtB,IAAI8R,EAAMnK,EAAKf,QAAQvH,UAAUQ,GAC3BS,EAAQwR,EAAIxR,MACZqB,EAASmQ,EAAInQ,OAEnB,KADAgG,EAAOA,EAAKG,WAAWxH,IACV,OAAO,KACpB,GAAIqB,GAAU9B,GAAO8H,EAAKmV,OAAU,OAAOnV,EAC3C9H,GAAO8B,EAAS,IAQpB+gB,EAAKtiB,UAAU8iB,WAAa,SAASA,WAAYrjB,GAC/C,IAAIiS,EAAM9R,KAAK4G,QAAQvH,UAAUQ,GAC3BS,EAAQwR,EAAIxR,MACZqB,EAASmQ,EAAInQ,OACnB,MAAO,CAACgG,KAAM3H,KAAK4G,QAAQkB,WAAWxH,GAAQA,MAAOA,EAAOqB,OAAQA,IAOtE+gB,EAAKtiB,UAAU+iB,YAAc,SAASA,YAAatjB,GACjD,GAAW,GAAPA,EAAY,MAAO,CAAC8H,KAAM,KAAMrH,MAAO,EAAGqB,OAAQ,GACtD,IAAImQ,EAAM9R,KAAK4G,QAAQvH,UAAUQ,GAC3BS,EAAQwR,EAAIxR,MACZqB,EAASmQ,EAAInQ,OACnB,GAAIA,EAAS9B,EAAO,MAAO,CAAC8H,KAAM3H,KAAK4G,QAAQ5J,MAAMsD,GAAQA,MAAOA,EAAOqB,OAAQA,GACnF,IAAIgG,EAAO3H,KAAK4G,QAAQ5J,MAAMsD,EAAQ,GACtC,MAAO,CAACqH,KAAMA,EAAMrH,MAAOA,EAAQ,EAAGqB,OAAQA,EAASgG,EAAKoF,WAM9D2V,EAAKtiB,UAAUmH,QAAU,SAASA,QAAS1H,GAAO,OAAOqhB,EAAYiB,cAAcniB,KAAMH,IAEzF6iB,EAAKtiB,UAAU8f,eAAiB,SAASA,eAAgBrgB,GAAO,OAAOqhB,EAAY3Z,QAAQvH,KAAMH,IAKjG6iB,EAAKtiB,UAAUgjB,aAAe,SAASA,aAAcnhB,EAAMC,EAAIyD,GAC7D,IAAIuJ,GAAQ,EAKZ,OAJIhN,EAAKD,GAAQjC,KAAKyM,aAAaxK,EAAMC,GAAI,SAAUyF,GAErD,OADIhC,EAAKiJ,QAAQjH,EAAKqF,SAAUkC,GAAQ,IAChCA,KAEHA,GAKTyT,EAAqB7E,QAAQ7e,IAAM,WAAc,OAAOe,KAAK2F,KAAKmY,SAKlE6E,EAAqBxX,YAAYlM,IAAM,WAAc,OAAOe,KAAK2F,KAAKwF,aAItEwX,EAAqBb,cAAc7iB,IAAM,WAAc,OAAOe,KAAK2F,KAAKmc,eAKxEa,EAAqBhX,SAAS1M,IAAM,WAAc,OAAOe,KAAK2F,KAAKgG,UAInEgX,EAAqB7F,OAAO7d,IAAM,WAAc,OAAOe,KAAK2F,KAAKmX,QAIjE6F,EAAqB5a,OAAO9I,IAAM,WAAc,OAAOe,KAAK2F,KAAKoC,QAQjE4a,EAAqBE,OAAO5jB,IAAM,WAAc,OAAOe,KAAK2F,KAAKkd,QAKjEH,EAAKtiB,UAAUoB,SAAW,SAASA,WACjC,GAAIxB,KAAK2F,KAAK+C,KAAK2a,cAAiB,OAAOrjB,KAAK2F,KAAK+C,KAAK2a,cAAcrjB,MACxE,IAAI6D,EAAO7D,KAAK2F,KAAK9B,KAGrB,OAFI7D,KAAK4G,QAAQlK,OACbmH,GAAQ,IAAM7D,KAAK4G,QAAQ4X,gBAAkB,KAC1C8E,UAAUtjB,KAAKgN,MAAOnJ,IAK/B6e,EAAKtiB,UAAU8I,eAAiB,SAASA,eAAgB5I,GACvD,IAAIiP,EAAQvP,KAAK2F,KAAK6D,aAAaiH,cAAczQ,KAAK4G,QAAS,EAAGtG,GAClE,IAAKiP,EAAS,MAAM,IAAIjN,MAAM,wDAC9B,OAAOiN,GASTmT,EAAKtiB,UAAU8H,WAAa,SAASA,WAAYjG,EAAMC,EAAIqhB,EAAaziB,EAAOG,QACtD,IAAhBsiB,IAAyBA,EAAchG,EAAS1b,YACtC,IAAVf,IAAmBA,EAAQ,QACnB,IAARG,IAAiBA,EAAMsiB,EAAY3b,YAE1C,IAAI4b,EAAMxjB,KAAKkJ,eAAejH,GAAMwO,cAAc8S,EAAaziB,EAAOG,GAClEwiB,EAAMD,GAAOA,EAAI/S,cAAczQ,KAAK4G,QAAS1E,GACjD,IAAKuhB,IAAQA,EAAI9Z,SAAY,OAAO,EACpC,IAAK,IAAI7K,EAAIgC,EAAOhC,EAAImC,EAAKnC,IAAO,IAAKkB,KAAK2F,KAAKmL,YAAYyS,EAAYvmB,MAAM8B,GAAGkO,OAAU,OAAO,EACrG,OAAO,GAMT0V,EAAKtiB,UAAUgJ,eAAiB,SAASA,eAAgBnH,EAAMC,EAAIyD,EAAMqH,GACvE,GAAIA,IAAUhN,KAAK2F,KAAKmL,YAAY9D,GAAU,OAAO,EACrD,IAAIlM,EAAQd,KAAKkJ,eAAejH,GAAMyH,UAAU/D,GAC5C1E,EAAMH,GAASA,EAAM2P,cAAczQ,KAAK4G,QAAS1E,GACrD,QAAOjB,GAAMA,EAAI0I,UAQnB+Y,EAAKtiB,UAAU4K,UAAY,SAASA,UAAWxE,GAC7C,OAAIA,EAAMI,QAAQlK,KAAesD,KAAKkI,WAAWlI,KAAK4H,WAAY5H,KAAK4H,WAAYpB,EAAMI,SAC3E5G,KAAK2F,KAAKiL,kBAAkBpK,EAAMb,OAMlD+c,EAAKtiB,UAAUsjB,MAAQ,SAASA,QAC9B,IAAK1jB,KAAK2F,KAAKwE,aAAanK,KAAK4G,SAC7B,MAAM,IAAIlB,WAAY,4BAA+B1F,KAAK2F,KAAS,KAAI,KAAQ3F,KAAK4G,QAAQpF,WAAWiB,MAAM,EAAG,KAEpH,IADA,IAAIC,EAAOuc,EAAKM,KACPzgB,EAAI,EAAGA,EAAIkB,KAAKgN,MAAMnO,OAAQC,IAAO4D,EAAO1C,KAAKgN,MAAMlO,GAAG+O,SAASnL,GAC5E,IAAKuc,EAAKI,QAAQ3c,EAAM1C,KAAKgN,OACzB,MAAM,IAAItH,WAAY,wCAA2C1F,KAAK2F,KAAS,KAAI,KAAQ3F,KAAKgN,MAAMxO,KAAI,SAAU2E,GAAK,OAAOA,EAAEwC,KAAK9B,SAC3I7D,KAAK4G,QAAQzK,SAAQ,SAAUwL,GAAQ,OAAOA,EAAK+b,YAKrDhB,EAAKtiB,UAAUiF,OAAS,SAASA,SAC/B,IAAIuR,EAAM,CAACjR,KAAM3F,KAAK2F,KAAK9B,MAC3B,IAAK,IAAIrH,KAAKwD,KAAK8I,MAAO,CACxB8N,EAAI9N,MAAQ9I,KAAK8I,MACjB,MAMF,OAJI9I,KAAK4G,QAAQlK,OACbka,EAAIhQ,QAAU5G,KAAK4G,QAAQvB,UAC3BrF,KAAKgN,MAAMnO,SACX+X,EAAI5J,MAAQhN,KAAKgN,MAAMxO,KAAI,SAAUoD,GAAK,OAAOA,EAAEyD,aAChDuR,GAKT8L,EAAKpd,SAAW,SAASA,SAAUC,EAAQC,GACzC,IAAKA,EAAQ,MAAM,IAAIE,WAAW,mCAClC,IAAIsH,EAAQ,KACZ,GAAIxH,EAAKwH,MAAO,CACd,IAAKyR,MAAMC,QAAQlZ,EAAKwH,OAAU,MAAM,IAAItH,WAAW,uCACvDsH,EAAQxH,EAAKwH,MAAMxO,IAAI+G,EAAO0I,cAEhC,GAAiB,QAAbzI,EAAKG,KAAgB,CACvB,GAAwB,iBAAbH,EAAKuX,KAAoB,MAAM,IAAIrX,WAAW,6BACzD,OAAOH,EAAOwX,KAAKvX,EAAKuX,KAAM/P,GAEhC,IAAIpG,EAAU2W,EAASjY,SAASC,EAAQC,EAAKoB,SAC7C,OAAOrB,EAAOsD,SAASrD,EAAKG,MAAMhC,OAAO6B,EAAKsD,MAAOlC,EAASoG,IAGhEtJ,OAAOoB,iBAAkB4d,EAAKtiB,UAAWuiB,GAEzC,IAAIgB,EAAyB,SAAUjB,GACrC,SAASiB,SAAShe,EAAMmD,EAAOlC,EAASoG,GAGtC,GAFA0V,EAAKngB,KAAKvC,KAAM2F,EAAMmD,EAAO,KAAMkE,IAE9BpG,EAAW,MAAM,IAAIlB,WAAW,oCAErC1F,KAAK+c,KAAOnW,EAGT8b,IAAOiB,SAASnhB,UAAYkgB,GACjCiB,SAASvjB,UAAYsD,OAAOC,OAAQ+e,GAAQA,EAAKtiB,WACjDujB,SAASvjB,UAAUwD,YAAc+f,SAEjC,IAAI1T,EAAuB,CAAE2S,YAAa,CAAExe,cAAc,GAAO2I,SAAU,CAAE3I,cAAc,IA0C3F,OAxCAuf,SAASvjB,UAAUoB,SAAW,SAASA,WACrC,OAAIxB,KAAK2F,KAAK+C,KAAK2a,cAAwBrjB,KAAK2F,KAAK+C,KAAK2a,cAAcrjB,MACjEsjB,UAAUtjB,KAAKgN,MAAOvL,KAAKC,UAAU1B,KAAK+c,QAGnD9M,EAAqB2S,YAAY3jB,IAAM,WAAc,OAAOe,KAAK+c,MAEjE4G,SAASvjB,UAAUsd,YAAc,SAASA,YAAazb,EAAMC,GAAM,OAAOlC,KAAK+c,KAAKta,MAAMR,EAAMC,IAEhG+N,EAAqBlD,SAAS9N,IAAM,WAAc,OAAOe,KAAK+c,KAAKle,QAEnE8kB,SAASvjB,UAAUqN,KAAO,SAASA,KAAMT,GACvC,OAAOA,GAAShN,KAAKgN,MAAQhN,KAAO,IAAI2jB,SAAS3jB,KAAK2F,KAAM3F,KAAK8I,MAAO9I,KAAK+c,KAAM/P,IAGrF2W,SAASvjB,UAAU2d,SAAW,SAASA,SAAUhB,GAC/C,OAAIA,GAAQ/c,KAAK+c,KAAe/c,KACzB,IAAI2jB,SAAS3jB,KAAK2F,KAAM3F,KAAK8I,MAAOiU,EAAM/c,KAAKgN,QAGxD2W,SAASvjB,UAAU4d,IAAM,SAASA,IAAK/b,EAAMC,GAI3C,YAHc,IAATD,IAAkBA,EAAO,QAClB,IAAPC,IAAgBA,EAAKlC,KAAK+c,KAAKle,QAExB,GAARoD,GAAaC,GAAMlC,KAAK+c,KAAKle,OAAiBmB,KAC3CA,KAAK+d,SAAS/d,KAAK+c,KAAKta,MAAMR,EAAMC,KAG7CyhB,SAASvjB,UAAU2N,GAAK,SAASA,GAAIvH,GACnC,OAAOxG,KAAK6c,WAAWrW,IAAUxG,KAAK+c,MAAQvW,EAAMuW,MAGtD4G,SAASvjB,UAAUiF,OAAS,SAASA,SACnC,IAAI4E,EAAOyY,EAAKtiB,UAAUiF,OAAO9C,KAAKvC,MAEtC,OADAiK,EAAK8S,KAAO/c,KAAK+c,KACV9S,GAGTvG,OAAOoB,iBAAkB6e,SAASvjB,UAAW6P,GAEtC0T,SAvDmB,CAwD1BjB,GAEF,SAASY,UAAUtW,EAAOiV,GACxB,IAAK,IAAInjB,EAAIkO,EAAMnO,OAAS,EAAGC,GAAK,EAAGA,IACnCmjB,EAAMjV,EAAMlO,GAAG6G,KAAK9B,KAAO,IAAMoe,EAAM,IAC3C,OAAOA,EAOT,IAAI2B,EAAe,SAASA,aAAaja,GAGvC3J,KAAK2J,SAAWA,EAChB3J,KAAK6H,KAAO,GACZ7H,KAAK6jB,UAAY,IAGfC,EAAuB,CAAEhC,cAAe,CAAE1d,cAAc,GAAO2f,YAAa,CAAE3f,cAAc,GAAO4f,UAAW,CAAE5f,cAAc,IAElIwf,EAAa9K,MAAQ,SAASA,MAAOmL,EAAQC,GAC3C,IAAIC,EAAS,IAAIC,EAAYH,EAAQC,GACrC,GAAmB,MAAfC,EAAOtc,KAAgB,OAAO+b,EAAa/hB,MAC/C,IAAIwiB,EAAOC,UAAUH,GACjBA,EAAOtc,MAAQsc,EAAO9hB,IAAI,4BAC9B,IAAIkN,EAuVN,SAASgV,IAAIC,GACX,IAAIC,EAAU/gB,OAAOC,OAAO,MAC5B,OAAO+gB,QAAQC,SAASH,EAAK,IAE7B,SAASE,QAAQE,GACf,IAAIC,EAAM,GACVD,EAAOzoB,SAAQ,SAAUwL,GACvB6c,EAAI7c,GAAMxL,SAAQ,SAAU2V,GAC1B,IAAIgT,EAAOhT,EAAIgT,KACX5iB,EAAK4P,EAAI5P,GAEb,GAAK4iB,EAAL,CACA,IAAIC,EAAQF,EAAI9lB,QAAQ+lB,GAAO7oB,EAAM8oB,GAAS,GAAKF,EAAIE,EAAQ,GAC/DJ,SAASH,EAAKtiB,GAAI/F,SAAQ,SAAUwL,GAC7B1L,GAAO4oB,EAAI3mB,KAAK4mB,EAAM7oB,EAAM,KACP,GAAtBA,EAAI8C,QAAQ4I,IAAe1L,EAAIiC,KAAKyJ,aAK9C,IADA,IAAImO,EAAQ2O,EAAQG,EAAOrX,KAAK,MAAQ,IAAIqW,EAAagB,EAAO7lB,QAAQylB,EAAI3lB,OAAS,IAAM,GAClFC,EAAI,EAAGA,EAAI+lB,EAAIhmB,OAAQC,GAAK,EAAG,CACtC,IAAIkmB,EAAWH,EAAI/lB,EAAI,GAAG0gB,KAAKyF,KAC/BnP,EAAMjO,KAAK3J,KAAK2mB,EAAI/lB,GAAI2lB,EAAQO,EAASzX,KAAK,OAASmX,QAAQM,IAEjE,OAAOlP,GA/WGyO,CAkQd,SAASC,IAAIH,GACX,IAAIG,EAAM,CAAC,IAEX,OADAU,QAAQC,QAAQd,EAAM,GAAI1c,QACnB6c,EAEP,SAAS7c,OAAS,OAAO6c,EAAItmB,KAAK,IAAM,EACxC,SAASknB,KAAKnjB,EAAMC,EAAI4iB,GACtB,IAAIM,EAAO,CAACN,KAAMA,EAAM5iB,GAAIA,GAE5B,OADAsiB,EAAIviB,GAAM/D,KAAKknB,GACRA,EAET,SAASF,QAAQG,EAAOnjB,GAAMmjB,EAAMlpB,SAAQ,SAAUipB,GAAQ,OAAOA,EAAKljB,GAAKA,KAE/E,SAASijB,QAAQd,EAAMpiB,GACrB,GAAiB,UAAboiB,EAAK1e,KACP,OAAO0e,EAAKiB,MAAMC,QAAO,SAAUV,EAAKR,GAAQ,OAAOQ,EAAIhb,OAAOsb,QAAQd,EAAMpiB,MAAW,IACtF,GAAiB,OAAboiB,EAAK1e,KACd,IAAK,IAAI7G,EAAI,GAAIA,IAAK,CACpB,IAAI+I,EAAOsd,QAAQd,EAAKiB,MAAMxmB,GAAImD,GAClC,GAAInD,GAAKulB,EAAKiB,MAAMzmB,OAAS,EAAK,OAAOgJ,EACzCqd,QAAQrd,EAAM5F,EAAO0F,YAElB,IAAiB,QAAb0c,EAAK1e,KAAgB,CAC9B,IAAI6f,EAAO7d,OAGX,OAFAyd,KAAKnjB,EAAMujB,GACXN,QAAQC,QAAQd,EAAKA,KAAMmB,GAAOA,GAC3B,CAACJ,KAAKI,IACR,GAAiB,QAAbnB,EAAK1e,KAAgB,CAC9B,IAAI8f,EAAS9d,OAGb,OAFAud,QAAQC,QAAQd,EAAKA,KAAMpiB,GAAOwjB,GAClCP,QAAQC,QAAQd,EAAKA,KAAMoB,GAASA,GAC7B,CAACL,KAAKK,IACR,GAAiB,OAAbpB,EAAK1e,KACd,MAAO,CAACyf,KAAKnjB,IAAO4H,OAAOsb,QAAQd,EAAKA,KAAMpiB,IACzC,GAAiB,SAAboiB,EAAK1e,KAAiB,CAE/B,IADA,IAAI8J,EAAMxN,EACD4N,EAAM,EAAGA,EAAMwU,EAAKrW,IAAK6B,IAAO,CACvC,IAAI6V,EAAS/d,OACbud,QAAQC,QAAQd,EAAKA,KAAM5U,GAAMiW,GACjCjW,EAAMiW,EAER,IAAiB,GAAbrB,EAAK9d,IACP2e,QAAQC,QAAQd,EAAKA,KAAM5U,GAAMA,QAEjC,IAAK,IAAIgD,EAAM4R,EAAKrW,IAAKyE,EAAM4R,EAAK9d,IAAKkM,IAAO,CAC9C,IAAIkT,EAAShe,OACbyd,KAAK3V,EAAKkW,GACVT,QAAQC,QAAQd,EAAKA,KAAM5U,GAAMkW,GACjClW,EAAMkW,EAGV,MAAO,CAACP,KAAK3V,IACR,GAAiB,QAAb4U,EAAK1e,KACd,MAAO,CAACyf,KAAKnjB,EAAM,KAAMoiB,EAAKxnB,UAvTlB2nB,CAAIH,IAEpB,OAiXF,SAASuB,iBAAiBrW,EAAO4U,GAC/B,IAAK,IAAIrlB,EAAI,EAAG+mB,EAAO,CAACtW,GAAQzQ,EAAI+mB,EAAKhnB,OAAQC,IAAK,CAEpD,IADA,IAAIgX,EAAQ+P,EAAK/mB,GAAIgnB,GAAQhQ,EAAMnM,SAAUmV,EAAQ,GAC5CzP,EAAI,EAAGA,EAAIyG,EAAMjO,KAAKhJ,OAAQwQ,GAAK,EAAG,CAC7C,IAAI1H,EAAOmO,EAAMjO,KAAKwH,GAAIxH,EAAOiO,EAAMjO,KAAKwH,EAAI,GAChDyP,EAAM5gB,KAAKyJ,EAAK9D,OACZiiB,GAAUne,EAAKmV,QAAUnV,EAAKoe,qBAAuBD,GAAO,IACrC,GAAvBD,EAAK9mB,QAAQ8I,IAAege,EAAK3nB,KAAK2J,GAExCie,GAAQ3B,EAAO9hB,IAAI,+BAAiCyc,EAAMvR,KAAK,MAAQ,mFA3X7EqY,CAAiBrW,EAAO4U,GACjB5U,GAMTqU,EAAaxjB,UAAUsJ,UAAY,SAASA,UAAW/D,GACrD,IAAK,IAAI7G,EAAI,EAAGA,EAAIkB,KAAK6H,KAAKhJ,OAAQC,GAAK,EACvC,GAAIkB,KAAK6H,KAAK/I,IAAM6G,EAAQ,OAAO3F,KAAK6H,KAAK/I,EAAI,GACrD,OAAO,MAMT8kB,EAAaxjB,UAAUqQ,cAAgB,SAASA,cAAeD,EAAM1P,EAAOG,QACzD,IAAVH,IAAmBA,EAAQ,QACnB,IAARG,IAAiBA,EAAMuP,EAAK5I,YAGnC,IADA,IAAI6H,EAAMzP,KACDlB,EAAIgC,EAAO2O,GAAO3Q,EAAImC,EAAKnC,IAChC2Q,EAAMA,EAAI/F,UAAU8G,EAAKxT,MAAM8B,GAAG6G,MACtC,OAAO8J,GAGTqU,EAAqBhC,cAAc7iB,IAAM,WACvC,IAAIiS,EAAQlR,KAAK6H,KAAK,GACtB,QAAOqJ,GAAQA,EAAMvF,UAMvBmY,EAAqBC,YAAY9kB,IAAM,WACrC,IAAK,IAAIH,EAAI,EAAGA,EAAIkB,KAAK6H,KAAKhJ,OAAQC,GAAK,EAAG,CAC5C,IAAI6G,EAAO3F,KAAK6H,KAAK/I,GACrB,IAAM6G,EAAKmX,SAAUnX,EAAKogB,mBAAuB,OAAOpgB,IAI5Die,EAAaxjB,UAAU4lB,WAAa,SAASA,WAAYxf,GACvD,IAAK,IAAI1H,EAAI,EAAGA,EAAIkB,KAAK6H,KAAKhJ,OAAQC,GAAK,EACvC,IAAK,IAAIuQ,EAAI,EAAGA,EAAI7I,EAAMqB,KAAKhJ,OAAQwQ,GAAK,EAC1C,GAAIrP,KAAK6H,KAAK/I,IAAM0H,EAAMqB,KAAKwH,GAAM,OAAO,EAClD,OAAO,GAUTuU,EAAaxjB,UAAUwP,WAAa,SAASA,WAAYrF,EAAOiI,EAAOjK,QACpD,IAAViK,IAAmBA,GAAQ,QACZ,IAAfjK,IAAwBA,EAAa,GAE5C,IAAI0d,EAAO,CAACjmB,MAgBZ,OAfA,SAASkmB,OAAO3W,EAAO4W,GACrB,IAAIC,EAAW7W,EAAMkB,cAAclG,EAAOhC,GAC1C,GAAI6d,KAAc5T,GAAS4T,EAASzc,UAChC,OAAO4T,EAAStb,KAAKkkB,EAAM3nB,KAAI,SAAU6nB,GAAM,OAAOA,EAAGC,oBAE7D,IAAK,IAAIxnB,EAAI,EAAGA,EAAIyQ,EAAM1H,KAAKhJ,OAAQC,GAAK,EAAG,CAC7C,IAAI6G,EAAO4J,EAAM1H,KAAK/I,GAAI+I,EAAO0H,EAAM1H,KAAK/I,EAAI,GAChD,IAAM6G,EAAKmX,SAAUnX,EAAKogB,qBAA8C,GAAvBE,EAAKlnB,QAAQ8I,GAAa,CACzEoe,EAAK/nB,KAAK2J,GACV,IAAIqH,EAAQgX,OAAOre,EAAMse,EAAMtc,OAAOlE,IACtC,GAAIuJ,EAAS,OAAOA,IAKnBgX,CAAOlmB,KAAM,KAQtB4jB,EAAaxjB,UAAUwI,aAAe,SAASA,aAAckD,GAC3D,IAAK,IAAIhN,EAAI,EAAGA,EAAIkB,KAAK6jB,UAAUhlB,OAAQC,GAAK,EAC5C,GAAIkB,KAAK6jB,UAAU/kB,IAAMgN,EAAU,OAAO9L,KAAK6jB,UAAU/kB,EAAI,GACjE,IAAIynB,EAAWvmB,KAAKwmB,gBAAgB1a,GAEpC,OADA9L,KAAK6jB,UAAU3lB,KAAK4N,EAAQya,GACrBA,GAGT3C,EAAaxjB,UAAUomB,gBAAkB,SAASA,gBAAiB1a,GAEjE,IADA,IAAIma,EAAOviB,OAAOC,OAAO,MAAO8iB,EAAS,CAAC,CAAClX,MAAOvP,KAAM2F,KAAM,KAAM+gB,IAAK,OAClED,EAAO5nB,QAAQ,CACpB,IAAInB,EAAU+oB,EAAOE,QAASpX,EAAQ7R,EAAQ6R,MAC9C,GAAIA,EAAM7F,UAAUoC,GAAS,CAE3B,IADA,IAAI5K,EAAS,GACJ0V,EAAMlZ,EAASkZ,EAAIjR,KAAMiR,EAAMA,EAAI8P,IACxCxlB,EAAOhD,KAAK0Y,EAAIjR,MACpB,OAAOzE,EAAO0lB,UAEhB,IAAK,IAAI9nB,EAAI,EAAGA,EAAIyQ,EAAM1H,KAAKhJ,OAAQC,GAAK,EAAG,CAC7C,IAAI6G,EAAO4J,EAAM1H,KAAK/I,GACjB6G,EAAKoC,QAAWpC,EAAKogB,oBAAwBpgB,EAAK9B,QAAQoiB,GAAWvoB,EAAQiI,OAAQ4J,EAAM1H,KAAK/I,EAAI,GAAG6K,WAC1G8c,EAAOvoB,KAAK,CAACqR,MAAO5J,EAAK6D,aAAc7D,KAAMA,EAAM+gB,IAAKhpB,IACxDuoB,EAAKtgB,EAAK9B,OAAQ,MAS1BigB,EAAqBE,UAAU/kB,IAAM,WACnC,OAAOe,KAAK6H,KAAKhJ,QAAU,GAM7B+kB,EAAaxjB,UAAUglB,KAAO,SAASA,KAAMxjB,GAC3C,IAAI9C,EAAI8C,GAAK,EACb,GAAI9C,GAAKkB,KAAK6H,KAAKhJ,OAAU,MAAM,IAAI6G,WAAY,cAAgB9D,EAAI,iCACvE,MAAO,CAAC+D,KAAM3F,KAAK6H,KAAK/I,GAAI+I,KAAM7H,KAAK6H,KAAK/I,EAAI,KAGlD8kB,EAAaxjB,UAAUoB,SAAW,SAASA,WACzC,IAAIykB,EAAO,GAOX,OANA,SAASpT,KAAK1P,GACZ8iB,EAAK/nB,KAAKiF,GACV,IAAK,IAAIrE,EAAI,EAAGA,EAAIqE,EAAE0E,KAAKhJ,OAAQC,GAAK,GACJ,GAA5BmnB,EAAKlnB,QAAQoE,EAAE0E,KAAK/I,KAAa+T,KAAK1P,EAAE0E,KAAK/I,IAEvD+T,CAAK7S,MACEimB,EAAKznB,KAAI,SAAU2E,EAAGrE,GAE3B,IADA,IAAI+lB,EAAM/lB,GAAKqE,EAAEwG,SAAW,IAAM,KAAO,IAChCkG,EAAM,EAAGA,EAAM1M,EAAE0E,KAAKhJ,OAAQgR,GAAO,EAC1CgV,IAAQhV,EAAM,KAAO,IAAM1M,EAAE0E,KAAKgI,GAAKhM,KAAO,KAAOoiB,EAAKlnB,QAAQoE,EAAE0E,KAAKgI,EAAM,IACnF,OAAOgV,KACNtX,KAAK,OAGV7J,OAAOoB,iBAAkB8e,EAAaxjB,UAAW0jB,GAEjDF,EAAa/hB,MAAQ,IAAI+hB,GAAa,GAEtC,IAAIQ,EAAc,SAASA,YAAYH,EAAQC,GAC7ClkB,KAAKikB,OAASA,EACdjkB,KAAKkkB,UAAYA,EACjBlkB,KAAK6mB,OAAS,KACd7mB,KAAKH,IAAM,EACXG,KAAK8mB,OAAS7C,EAAO5W,MAAM,kBACgB,IAAvCrN,KAAK8mB,OAAO9mB,KAAK8mB,OAAOjoB,OAAS,IAAYmB,KAAK8mB,OAAO/T,MACvC,IAAlB/S,KAAK8mB,OAAO,IAAY9mB,KAAK8mB,OAAOH,SAGtCI,EAAyB,CAAElf,KAAM,CAAEzD,cAAc,IAUrD,SAASkgB,UAAUH,GACjB,IAAImB,EAAQ,GACZ,GAAKA,EAAMpnB,KAAK8oB,aAAa7C,UACtBA,EAAO8C,IAAI,MAClB,OAAuB,GAAhB3B,EAAMzmB,OAAcymB,EAAM,GAAK,CAAC3f,KAAM,SAAU2f,MAAOA,GAGhE,SAAS0B,aAAa7C,GACpB,IAAImB,EAAQ,GACZ,GAAKA,EAAMpnB,KAAKgpB,mBAAmB/C,UAC5BA,EAAOtc,MAAuB,KAAfsc,EAAOtc,MAA8B,KAAfsc,EAAOtc,MACnD,OAAuB,GAAhByd,EAAMzmB,OAAcymB,EAAM,GAAK,CAAC3f,KAAM,MAAO2f,MAAOA,GAG7D,SAAS4B,mBAAmB/C,GAE1B,IADA,IAAIE,EA4CN,SAAS8C,cAAchD,GACrB,GAAIA,EAAO8C,IAAI,KAAM,CACnB,IAAI5C,EAAOC,UAAUH,GAErB,OADKA,EAAO8C,IAAI,MAAQ9C,EAAO9hB,IAAI,yBAC5BgiB,EACF,IAAK,KAAK+C,KAAKjD,EAAOtc,MAAO,CAClC,IAAIyd,EAlBR,SAAS+B,YAAYlD,EAAQtgB,GAC3B,IAAIsiB,EAAQhC,EAAOD,UAAWve,EAAOwgB,EAAMtiB,GAC3C,GAAI8B,EAAQ,MAAO,CAACA,GACpB,IAAIzE,EAAS,GACb,IAAK,IAAIomB,KAAYnB,EAAO,CAC1B,IAAIoB,EAASpB,EAAMmB,GACfC,EAAOC,OAAOzoB,QAAQ8E,IAAS,GAAK3C,EAAOhD,KAAKqpB,GAEjC,GAAjBrmB,EAAOrC,QAAeslB,EAAO9hB,IAAI,0BAA4BwB,EAAO,WACxE,OAAO3C,EASOmmB,CAAYlD,EAAQA,EAAOtc,MAAMrJ,KAAI,SAAUmH,GAGzD,OAFqB,MAAjBwe,EAAO0C,OAAkB1C,EAAO0C,OAASlhB,EAAKgG,SACzCwY,EAAO0C,QAAUlhB,EAAKgG,UAAYwY,EAAO9hB,IAAI,mCAC/C,CAACsD,KAAM,OAAQ9I,MAAO8I,MAG/B,OADAwe,EAAOtkB,MACgB,GAAhBylB,EAAMzmB,OAAcymB,EAAM,GAAK,CAAC3f,KAAM,SAAU2f,MAAOA,GAE9DnB,EAAO9hB,IAAI,qBAAuB8hB,EAAOtc,KAAO,KA1DvCsf,CAAchD,KAEvB,GAAIA,EAAO8C,IAAI,KACX5C,EAAO,CAAC1e,KAAM,OAAQ0e,KAAMA,QAC3B,GAAIF,EAAO8C,IAAI,KAChB5C,EAAO,CAAC1e,KAAM,OAAQ0e,KAAMA,QAC3B,GAAIF,EAAO8C,IAAI,KAChB5C,EAAO,CAAC1e,KAAM,MAAO0e,KAAMA,OAC1B,KAAIF,EAAO8C,IAAI,KAEb,MADH5C,EAAOoD,eAAetD,EAAQE,GAGpC,OAAOA,EAGT,SAASqD,SAASvD,GACZ,KAAKiD,KAAKjD,EAAOtc,OAASsc,EAAO9hB,IAAI,yBAA2B8hB,EAAOtc,KAAO,KAClF,IAAI3G,EAASymB,OAAOxD,EAAOtc,MAE3B,OADAsc,EAAOtkB,MACAqB,EAGT,SAASumB,eAAetD,EAAQE,GAC9B,IAAIrW,EAAM0Z,SAASvD,GAAS5d,EAAMyH,EAMlC,OALImW,EAAO8C,IAAI,OACa1gB,EAAP,KAAf4d,EAAOtc,KAAqB6f,SAASvD,IAC3B,GAEXA,EAAO8C,IAAI,MAAQ9C,EAAO9hB,IAAI,yBAC5B,CAACsD,KAAM,QAASqI,IAAKA,EAAKzH,IAAKA,EAAK8d,KAAMA,GAwGnD,SAASY,IAAIna,EAAGC,GAAK,OAAOA,EAAID,EAKhC,SAAS6Z,SAASH,EAAK7c,GACrB,IAAIzG,EAAS,GAEb,OAEA,SAAS2R,KAAKlL,GACZ,IAAI0d,EAAQb,EAAI7c,GAChB,GAAoB,GAAhB0d,EAAMxmB,SAAgBwmB,EAAM,GAAGP,KAAQ,OAAOjS,KAAKwS,EAAM,GAAGnjB,IAChEhB,EAAOhD,KAAKyJ,GACZ,IAAK,IAAI7I,EAAI,EAAGA,EAAIumB,EAAMxmB,OAAQC,IAAK,CACrC,IAAIgT,EAAMuT,EAAMvmB,GACZgmB,EAAOhT,EAAIgT,KACX5iB,EAAK4P,EAAI5P,GACR4iB,IAA+B,GAAvB5jB,EAAOnC,QAAQmD,IAAa2Q,KAAK3Q,IAXlD2Q,CAAKlL,GACEzG,EAAOse,KAAKyF,KAgErB,SAASlC,aAAaja,GACpB,IAAI8e,EAAWlkB,OAAOC,OAAO,MAC7B,IAAK,IAAIkkB,KAAY/e,EAAO,CAC1B,IAAIgf,EAAOhf,EAAM+e,GACjB,IAAKC,EAAKC,WAAc,OAAO,KAC/BH,EAASC,GAAYC,EAAKE,QAE5B,OAAOJ,EAGT,SAASK,aAAanf,EAAOjM,GAC3B,IAAIqrB,EAAQxkB,OAAOC,OAAO,MAC1B,IAAK,IAAIE,KAAQiF,EAAO,CACtB,IAAIqf,EAAQtrB,GAASA,EAAMgH,GAC3B,QAActH,IAAV4rB,EAAqB,CACvB,IAAIL,EAAOhf,EAAMjF,GACjB,IAAIikB,EAAKC,WACF,MAAM,IAAIriB,WAAW,mCAAqC7B,GAD1CskB,EAAQL,EAAKE,QAGtCE,EAAMrkB,GAAQskB,EAEhB,OAAOD,EAGT,SAASE,UAAUtf,GACjB,IAAI5H,EAASwC,OAAOC,OAAO,MAC3B,GAAImF,EAAS,IAAK,IAAIjF,KAAQiF,EAAS5H,EAAO2C,GAAQ,IAAIwkB,EAAUvf,EAAMjF,IAC1E,OAAO3C,EA/PT6lB,EAAuBlf,KAAK5I,IAAM,WAAc,OAAOe,KAAK8mB,OAAO9mB,KAAKH,MAExEukB,EAAYhkB,UAAU6mB,IAAM,SAASA,IAAKqB,GAAO,OAAOtoB,KAAK6H,MAAQygB,IAAQtoB,KAAKH,QAAS,IAE3FukB,EAAYhkB,UAAUiC,IAAM,SAASA,IAAK4f,GAAO,MAAM,IAAIsG,YAAYtG,EAAM,4BAA8BjiB,KAAKikB,OAAS,OAEzHvgB,OAAOoB,iBAAkBsf,EAAYhkB,UAAW2mB,GAgQhD,IAAIyB,EAAW,SAASA,SAAS3kB,EAAM0B,EAAQmD,GAG7C1I,KAAK6D,KAAOA,EAIZ7D,KAAKuF,OAASA,EAIdvF,KAAK0I,KAAOA,EAEZ1I,KAAKwnB,OAAS9e,EAAK+f,MAAQ/f,EAAK+f,MAAMpb,MAAM,KAAO,GACnDrN,KAAK8I,MAAQsf,UAAU1f,EAAKI,OAE5B9I,KAAK+iB,aAAeA,aAAa/iB,KAAK8I,OAItC9I,KAAKwJ,aAAe,KAKpBxJ,KAAK0oB,QAAU,KAIf1oB,KAAK8hB,cAAgB,KAIrB9hB,KAAK8d,UAAYpV,EAAKme,QAAkB,QAARhjB,GAIhC7D,KAAK8c,OAAiB,QAARjZ,GAGZ8kB,EAAuB,CAAEhd,SAAU,CAAEvH,cAAc,GAAO+G,YAAa,CAAE/G,cAAc,GAAO2D,OAAQ,CAAE3D,cAAc,GAAOye,OAAQ,CAAEze,cAAc,GAAOwkB,WAAY,CAAExkB,cAAc,IAI5LukB,EAAqBhd,SAAS1M,IAAM,WAAc,OAAQe,KAAK8d,SAK/D6K,EAAqBxd,YAAYlM,IAAM,WAAc,OAAOe,KAAK8d,SAAW9d,KAAK8hB,eAIjF6G,EAAqB5gB,OAAO9I,IAAM,WAAc,OAAOe,KAAKwJ,cAAgBoa,EAAa/hB,OAKzF8mB,EAAqB9F,OAAO5jB,IAAM,WAAc,OAAOe,KAAK+H,QAAU/H,KAAK0I,KAAKmgB,MAIhFF,EAAqBC,WAAW3pB,IAAM,WAAc,OAAOe,KAAK0I,KAAKkgB,aAAe5oB,KAAK0I,KAAKogB,KAAO,MAAQ,WAI7GN,EAASpoB,UAAU2lB,iBAAmB,SAASA,mBAC7C,IAAK,IAAInkB,KAAK5B,KAAK8I,MAAS,GAAI9I,KAAK8I,MAAMlH,GAAGmnB,WAAc,OAAO,EACnE,OAAO,GAGTP,EAASpoB,UAAUwQ,kBAAoB,SAASA,kBAAmBpK,GACjE,OAAOxG,MAAQwG,GAASxG,KAAKwJ,aAAawc,WAAWxf,EAAMgD,eAG7Dgf,EAASpoB,UAAU6nB,aAAe,SAASe,eAAgBlgB,GACzD,OAAKA,GAAS9I,KAAK+iB,aAAuB/iB,KAAK+iB,aACjCkF,aAAajoB,KAAK8I,MAAOA,IAUzC0f,EAASpoB,UAAUuD,OAAS,SAASA,OAAQmF,EAAOlC,EAASoG,GAC3D,GAAIhN,KAAK8c,OAAU,MAAM,IAAIxa,MAAM,8CACnC,OAAO,IAAIogB,EAAK1iB,KAAMA,KAAKioB,aAAanf,GAAQyU,EAAStb,KAAK2E,GAAUqY,EAAKK,QAAQtS,KAOvFwb,EAASpoB,UAAU6oB,cAAgB,SAASA,cAAengB,EAAOlC,EAASoG,GAEzE,GADApG,EAAU2W,EAAStb,KAAK2E,IACnB5G,KAAKmK,aAAavD,GACnB,MAAM,IAAIlB,WAAW,4BAA8B1F,KAAK6D,MAC5D,OAAO,IAAI6e,EAAK1iB,KAAMA,KAAKioB,aAAanf,GAAQlC,EAASqY,EAAKK,QAAQtS,KAUxEwb,EAASpoB,UAAUkmB,cAAgB,SAASA,cAAexd,EAAOlC,EAASoG,GAGzE,GAFAlE,EAAQ9I,KAAKioB,aAAanf,IAC1BlC,EAAU2W,EAAStb,KAAK2E,IACZlK,KAAM,CAChB,IAAIyH,EAASnE,KAAKwJ,aAAaoG,WAAWhJ,GAC1C,IAAKzC,EAAU,OAAO,KACtByC,EAAUzC,EAAO0C,OAAOD,GAE1B,IAAI2D,EAAQvK,KAAKwJ,aAAaiH,cAAc7J,GAASgJ,WAAW2N,EAAS1b,OAAO,GAChF,OAAK0I,EACE,IAAImY,EAAK1iB,KAAM8I,EAAOlC,EAAQC,OAAO0D,GAAQ0U,EAAKK,QAAQtS,IAD5C,MAOvBwb,EAASpoB,UAAU+J,aAAe,SAASA,aAAcvD,GACvD,IAAI1F,EAASlB,KAAKwJ,aAAaiH,cAAc7J,GAC7C,IAAK1F,IAAWA,EAAOyI,SAAY,OAAO,EAC1C,IAAK,IAAI7K,EAAI,EAAGA,EAAI8H,EAAQgB,WAAY9I,IACpC,IAAKkB,KAAK8Q,YAAYlK,EAAQ5J,MAAM8B,GAAGkO,OAAU,OAAO,EAC5D,OAAO,GAKTwb,EAASpoB,UAAUwN,eAAiB,SAASA,eAAgBsb,GAC3D,OAAuB,MAAhBlpB,KAAK0oB,SAAmB1oB,KAAK0oB,QAAQ3pB,QAAQmqB,IAAa,GAKnEV,EAASpoB,UAAU0Q,YAAc,SAASA,YAAa9D,GACrD,GAAoB,MAAhBhN,KAAK0oB,QAAmB,OAAO,EACnC,IAAK,IAAI5pB,EAAI,EAAGA,EAAIkO,EAAMnO,OAAQC,IAAO,IAAKkB,KAAK4N,eAAeZ,EAAMlO,GAAG6G,MAAS,OAAO,EAC3F,OAAO,GAKT6iB,EAASpoB,UAAUmS,aAAe,SAASA,aAAcvF,GACvD,GAAoB,MAAhBhN,KAAK0oB,QAAmB,OAAO1b,EAEnC,IADA,IAAItK,EACK5D,EAAI,EAAGA,EAAIkO,EAAMnO,OAAQC,IAC3BkB,KAAK4N,eAAeZ,EAAMlO,GAAG6G,MAEvBjD,GACTA,EAAKxE,KAAK8O,EAAMlO,IAFX4D,IAAQA,EAAOsK,EAAMvK,MAAM,EAAG3D,IAKvC,OAAQ4D,EAAeA,EAAK7D,OAAS6D,EAAOuc,EAAKpd,MAAlCmL,GAGjBwb,EAASrD,QAAU,SAASA,QAASrG,EAAOvZ,GAC1C,IAAIrE,EAASwC,OAAOC,OAAO,MAC3Bmb,EAAM3iB,SAAQ,SAAU0H,EAAM6E,GAAQ,OAAOxH,EAAO2C,GAAQ,IAAI2kB,EAAS3kB,EAAM0B,EAAQmD,MAEvF,IAAIygB,EAAU5jB,EAAOmD,KAAK0gB,SAAW,MACrC,IAAKloB,EAAOioB,GAAY,MAAM,IAAIzjB,WAAW,yCAA2CyjB,EAAU,MAClG,IAAKjoB,EAAO6b,KAAQ,MAAM,IAAIrX,WAAW,oCACzC,IAAK,IAAIlJ,KAAK0E,EAAO6b,KAAKjU,MAAS,MAAM,IAAIpD,WAAW,iDAExD,OAAOxE,GAGTwC,OAAOoB,iBAAkB0jB,EAASpoB,UAAWuoB,GAI7C,IAAIN,EAAY,SAASA,UAAUgB,GACjCrpB,KAAK+nB,WAAarkB,OAAOtD,UAAUiX,eAAe9U,KAAK8mB,EAAS,WAChErpB,KAAKgoB,QAAUqB,EAAQrB,SAGrBsB,EAAyB,CAAEP,WAAY,CAAE3kB,cAAc,IAE3DklB,EAAuBP,WAAW9pB,IAAM,WACtC,OAAQe,KAAK+nB,YAGfrkB,OAAOoB,iBAAkBujB,EAAUjoB,UAAWkpB,GAQ9C,IAAIC,EAAW,SAASA,SAAS1lB,EAAMub,EAAM7Z,EAAQmD,GAGnD1I,KAAK6D,KAAOA,EAIZ7D,KAAKuF,OAASA,EAIdvF,KAAK0I,KAAOA,EAEZ1I,KAAK8I,MAAQsf,UAAU1f,EAAKI,OAE5B9I,KAAKof,KAAOA,EACZpf,KAAKwpB,SAAW,KAChB,IAAI5B,EAAW7E,aAAa/iB,KAAK8I,OACjC9I,KAAKuX,SAAWqQ,GAAY,IAAI3I,EAAKjf,KAAM4nB,IAO7C2B,EAASnpB,UAAUuD,OAAS,SAASA,OAAQmF,GAC3C,OAAKA,GAAS9I,KAAKuX,SAAmBvX,KAAKuX,SACpC,IAAI0H,EAAKjf,KAAMioB,aAAajoB,KAAK8I,MAAOA,KAGjDygB,EAASpE,QAAU,SAASA,QAASnY,EAAOzH,GAC1C,IAAIrE,EAASwC,OAAOC,OAAO,MAAOyb,EAAO,EAEzC,OADApS,EAAM7Q,SAAQ,SAAU0H,EAAM6E,GAAQ,OAAOxH,EAAO2C,GAAQ,IAAI0lB,EAAS1lB,EAAMub,IAAQ7Z,EAAQmD,MACxFxH,GAMTqoB,EAASnpB,UAAU8N,cAAgB,SAASA,cAAejS,GACzD,IAAK,IAAI6C,EAAI,EAAGA,EAAI7C,EAAI4C,OAAQC,IAAW7C,EAAI6C,GAAG6G,MAAQ3F,OACxD/D,EAAMA,EAAIwG,MAAM,EAAG3D,GAAG+K,OAAO5N,EAAIwG,MAAM3D,EAAI,IAC3CA,KAEF,OAAO7C,GAKTstB,EAASnpB,UAAUwO,QAAU,SAASA,QAAS3S,GAC7C,IAAK,IAAI6C,EAAI,EAAGA,EAAI7C,EAAI4C,OAAQC,IAC5B,GAAI7C,EAAI6C,GAAG6G,MAAQ3F,KAAQ,OAAO/D,EAAI6C,IAM5CyqB,EAASnpB,UAAU+e,SAAW,SAASA,SAAU3Y,GAC/C,OAAOxG,KAAKwpB,SAASzqB,QAAQyH,IAAU,GAmLzC,IAAI,EAAS,SAASijB,OAAO/gB,GAQ3B,IAAK,IAAI+T,KADTzc,KAAK0I,KAAO,GACKA,EAAQ1I,KAAK0I,KAAK+T,GAAQ/T,EAAK+T,GAChDzc,KAAK0I,KAAKoW,MAAQ,EAAW7c,KAAKyG,EAAKoW,OACvC9e,KAAK0I,KAAKsE,MAAQ,EAAW/K,KAAKyG,EAAKsE,OAIvChN,KAAK8e,MAAQ0J,EAASrD,QAAQnlB,KAAK0I,KAAKoW,MAAO9e,MAI/CA,KAAKgN,MAAQuc,EAASpE,QAAQnlB,KAAK0I,KAAKsE,MAAOhN,MAE/C,IAAI0pB,EAAmBhmB,OAAOC,OAAO,MACrC,IAAK,IAAIgmB,KAAU3pB,KAAK8e,MAAO,CAC7B,GAAI6K,KAAU3pB,KAAKgN,MACf,MAAM,IAAItH,WAAWikB,EAAS,sCAClC,IAAIhkB,EAAO3F,KAAK8e,MAAM6K,GAASC,EAAcjkB,EAAK+C,KAAK9B,SAAW,GAAIijB,EAAWlkB,EAAK+C,KAAKsE,MAC3FrH,EAAK6D,aAAekgB,EAAiBE,KAClCF,EAAiBE,GAAehG,EAAa9K,MAAM8Q,EAAa5pB,KAAK8e,QACxEnZ,EAAKmc,cAAgBnc,EAAK6D,aAAasY,cACvCnc,EAAK+iB,QAAsB,KAAZmB,EAAkB,KAC/BA,EAAWC,YAAY9pB,KAAM6pB,EAASxc,MAAM,MAChC,IAAZwc,GAAmBlkB,EAAKmc,cAAqB,KAAL,GAE5C,IAAK,IAAIiI,KAAU/pB,KAAKgN,MAAO,CAC7B,IAAIua,EAASvnB,KAAKgN,MAAM+c,GAASC,EAAOzC,EAAO7e,KAAKyW,SACpDoI,EAAOiC,SAAmB,MAARQ,EAAe,CAACzC,GAAkB,IAARyC,EAAa,GAAKF,YAAY9pB,KAAMgqB,EAAK3c,MAAM,MAG7FrN,KAAK2e,aAAe3e,KAAK2e,aAAasL,KAAKjqB,MAC3CA,KAAKiO,aAAejO,KAAKiO,aAAagc,KAAKjqB,MAK3CA,KAAKkqB,YAAclqB,KAAK8e,MAAM9e,KAAK0I,KAAK0gB,SAAW,OAMnDppB,KAAKqiB,OAAS3e,OAAOC,OAAO,MAC5B3D,KAAKqiB,OAAO8H,UAAYzmB,OAAOC,OAAO,OAsDxC,SAASmmB,YAAYvkB,EAAQyH,GAE3B,IADA,IAAIkC,EAAQ,GACHpQ,EAAI,EAAGA,EAAIkO,EAAMnO,OAAQC,IAAK,CACrC,IAAI+E,EAAOmJ,EAAMlO,GAAI2O,EAAOlI,EAAOyH,MAAMnJ,GAAOkC,EAAK0H,EACrD,GAAIA,EACFyB,EAAMhR,KAAKuP,QAEX,IAAK,IAAIgP,KAAQlX,EAAOyH,MAAO,CAC7B,IAAIod,EAAS7kB,EAAOyH,MAAMyP,IACd,KAAR5Y,GAAgBumB,EAAO1hB,KAAK+f,OAAS2B,EAAO1hB,KAAK+f,MAAMpb,MAAM,KAAKtO,QAAQ8E,IAAS,IACnFqL,EAAMhR,KAAK6H,EAAKqkB,GAGxB,IAAKrkB,EAAM,MAAM,IAAIwiB,YAAY,uBAAyBvb,EAAMlO,GAAK,KAEvE,OAAOoQ,EA7DT,EAAO9O,UAAUuH,KAAO,SAASA,KAAMhC,EAAMmD,EAAOlC,EAASoG,GAC3D,GAAmB,iBAARrH,EACPA,EAAO3F,KAAK6I,SAASlD,OACpB,MAAMA,aAAgB6iB,GACvB,MAAM,IAAI9iB,WAAW,sBAAwBC,GAC5C,GAAIA,EAAKJ,QAAUvF,KACpB,MAAM,IAAI0F,WAAW,yCAA2CC,EAAK9B,KAAO,KAEhF,OAAO8B,EAAKsjB,cAAcngB,EAAOlC,EAASoG,IAM5C,EAAO5M,UAAU2c,KAAO,SAASA,KAAMsN,EAAQrd,GAC7C,IAAIrH,EAAO3F,KAAK8e,MAAM/B,KACtB,OAAO,IAAI4G,EAAShe,EAAMA,EAAKod,aAAcsH,EAAQpL,EAAKK,QAAQtS,KAKpE,EAAO5M,UAAUqN,KAAO,SAASA,KAAM9H,EAAMmD,GAE3C,MADmB,iBAARnD,IAAoBA,EAAO3F,KAAKgN,MAAMrH,IAC1CA,EAAKhC,OAAOmF,IAMrB,EAAO1I,UAAUue,aAAe,SAASA,aAAcnZ,GACrD,OAAOkd,EAAKpd,SAAStF,KAAMwF,IAM7B,EAAOpF,UAAU6N,aAAe,SAASA,aAAczI,GACrD,OAAOyZ,EAAK3Z,SAAStF,KAAMwF,IAG7B,EAAOpF,UAAUyI,SAAW,SAASA,SAAUhF,GAC7C,IAAIqL,EAAQlP,KAAK8e,MAAMjb,GACvB,IAAKqL,EAAS,MAAM,IAAIxJ,WAAW,sBAAwB7B,GAC3D,OAAOqL,GAuKT,IAAIob,EAAY,SAASA,UAAU/kB,EAAQglB,GACzC,IAAIhe,EAASvM,KAIbA,KAAKuF,OAASA,EAIdvF,KAAKuqB,MAAQA,EACbvqB,KAAKwqB,KAAO,GACZxqB,KAAKyqB,OAAS,GAEdF,EAAMpuB,SAAQ,SAAUuuB,GAClBA,EAAKC,IAAOpe,EAAOie,KAAKtsB,KAAKwsB,GACxBA,EAAKvb,OAAS5C,EAAOke,OAAOvsB,KAAKwsB,MAI5C1qB,KAAK4qB,gBAAkB5qB,KAAKwqB,KAAKK,MAAK,SAAUC,GAC9C,IAAK,aAAa1D,KAAK0D,EAAEH,OAASG,EAAEnjB,KAAQ,OAAO,EACnD,IAAIA,EAAOpC,EAAOuZ,MAAMgM,EAAEnjB,MAC1B,OAAOA,EAAK6B,aAAaE,UAAU/B,OAMvC2iB,EAAUlqB,UAAU0Y,MAAQ,SAASA,MAAOiS,EAAK1B,QAC5B,IAAZA,IAAqBA,EAAU,IAEtC,IAAIttB,EAAU,IAAIivB,EAAahrB,KAAMqpB,GAAS,GAE9C,OADAttB,EAAQkvB,OAAOF,EAAK,KAAM1B,EAAQpnB,KAAMonB,EAAQnnB,IACzCnG,EAAQmvB,UAUjBZ,EAAUlqB,UAAU+qB,WAAa,SAASA,WAAYJ,EAAK1B,QACtC,IAAZA,IAAqBA,EAAU,IAEtC,IAAIttB,EAAU,IAAIivB,EAAahrB,KAAMqpB,GAAS,GAE9C,OADAttB,EAAQkvB,OAAOF,EAAK,KAAM1B,EAAQpnB,KAAMonB,EAAQnnB,IACzCud,EAAMsB,QAAQhlB,EAAQmvB,WAG/BZ,EAAUlqB,UAAUgrB,SAAW,SAASA,SAAUL,EAAKhvB,EAASwO,GAC9D,IAAK,IAAIzL,EAAIyL,EAAQvK,KAAKwqB,KAAKzrB,QAAQwL,GAAS,EAAI,EAAGzL,EAAIkB,KAAKwqB,KAAK3rB,OAAQC,IAAK,CAChF,IAAI4rB,EAAO1qB,KAAKwqB,KAAK1rB,GACrB,GAAIwT,QAAQyY,EAAKL,EAAKC,YACEpuB,IAAnBmuB,EAAKW,WAA2BN,EAAIO,cAAgBZ,EAAKW,cACxDX,EAAK3uB,SAAWA,EAAQwvB,eAAeb,EAAK3uB,UAAW,CAC3D,GAAI2uB,EAAKc,SAAU,CACjB,IAAItqB,EAASwpB,EAAKc,SAAST,GAC3B,IAAe,IAAX7pB,EAAoB,SACxBwpB,EAAK5hB,MAAQ5H,EAEf,OAAOwpB,KAKbJ,EAAUlqB,UAAUqrB,WAAa,SAASA,WAAYhP,EAAM5f,EAAOd,EAASwO,GAC1E,IAAK,IAAIzL,EAAIyL,EAAQvK,KAAKyqB,OAAO1rB,QAAQwL,GAAS,EAAI,EAAGzL,EAAIkB,KAAKyqB,OAAO5rB,OAAQC,IAAK,CACpF,IAAI4rB,EAAO1qB,KAAKyqB,OAAO3rB,GACvB,KAAgC,GAA5B4rB,EAAKvb,MAAMpQ,QAAQ0d,IACnBiO,EAAK3uB,UAAYA,EAAQwvB,eAAeb,EAAK3uB,UAI7C2uB,EAAKvb,MAAMtQ,OAAS4d,EAAK5d,SACc,IAAtC6rB,EAAKvb,MAAMsK,WAAWgD,EAAK5d,SAAiB6rB,EAAKvb,MAAM1M,MAAMga,EAAK5d,OAAS,IAAMhC,IANtF,CAQA,GAAI6tB,EAAKc,SAAU,CACjB,IAAItqB,EAASwpB,EAAKc,SAAS3uB,GAC3B,IAAe,IAAXqE,EAAoB,SACxBwpB,EAAK5hB,MAAQ5H,EAEf,OAAOwpB,KAKXJ,EAAUoB,YAAc,SAASA,YAAanmB,GAC5C,IAAIrE,EAAS,GACb,SAAS+F,OAAOyjB,GAEd,IADA,IAAIiB,EAA4B,MAAjBjB,EAAKiB,SAAmB,GAAKjB,EAAKiB,SAAU7sB,EAAI,EACxDA,EAAIoC,EAAOrC,OAAQC,IAAK,CAC7B,IAAI+I,EAAO3G,EAAOpC,GAClB,IADsD,MAAjB+I,EAAK8jB,SAAmB,GAAK9jB,EAAK8jB,UACpDA,EAAY,MAEjCzqB,EAAO/B,OAAOL,EAAG,EAAG4rB,GAGtB,IAAIlF,KAAO,SAAW3hB,GACpB,IAAI0mB,EAAQhlB,EAAOyH,MAAMnJ,GAAM6E,KAAKkjB,SAChCrB,GAASA,EAAMpuB,SAAQ,SAAUuuB,GACnCzjB,OAAOyjB,EAAOhoB,KAAKgoB,IACnBA,EAAKjd,KAAO5J,MAId,IAAK,IAAIA,KAAQ0B,EAAOyH,MAAOwY,KAAM3hB,GACvC,IACMgoB,EAOJ,IAAK,IAAIC,KAAUvmB,EAAOuZ,MAPtB+M,YAAUtmB,EAAOuZ,MAAMgN,GAAQpjB,KAAKkjB,WACzBC,EAAQ1vB,SAAQ,SAAUuuB,GACvCzjB,OAAOyjB,EAAOhoB,KAAKgoB,IACnBA,EAAK/iB,KAAOmkB,KAKhB,OAAO5qB,GAOTopB,EAAUyB,WAAa,SAASA,WAAYxmB,GAC1C,OAAOA,EAAO8c,OAAO2J,YAClBzmB,EAAO8c,OAAO2J,UAAY,IAAI1B,EAAU/kB,EAAQ+kB,EAAUoB,YAAYnmB,MAI3E,IAAI0mB,EAAY,CACdC,SAAS,EAAMC,SAAS,EAAMC,OAAO,EAAMC,YAAY,EAAMC,QAAQ,EACrEC,IAAI,EAAMC,KAAK,EAAMC,IAAI,EAAMC,UAAU,EAAMC,YAAY,EAAMC,QAAQ,EACzEC,QAAQ,EAAMC,MAAM,EAAMC,IAAI,EAAMC,IAAI,EAAMC,IAAI,EAAMC,IAAI,EAAMC,IAAI,EACtEC,IAAI,EAAMC,QAAQ,EAAMC,QAAQ,EAAMC,IAAI,EAAMC,IAAI,EAAMC,UAAU,EAAMC,IAAI,EAC9EC,QAAQ,EAAM1P,GAAG,EAAM2P,KAAK,EAAMC,SAAS,EAAMC,OAAO,EAAMC,OAAO,EAAMC,IAAI,GAI7EC,EAAa,CACfC,MAAM,EAAMT,UAAU,EAAMjpB,QAAQ,EAAM2pB,QAAQ,EAAMhf,OAAO,EAAMif,OAAO,GAI1EC,EAAW,CAACX,IAAI,EAAMM,IAAI,GAK9B,SAASM,aAAa3oB,EAAM4oB,EAAoBtkB,GAC9C,OAA0B,MAAtBskB,GAAsCA,EAHtB,EAG6D,IACvD,SAAvBA,EAJ2C,EAIY,GACnD5oB,GAA2B,OAAnBA,EAAKijB,WAAsB4F,GAAgD,EAAPvkB,EAGrF,IAAIwkB,EAAc,SAASA,YAAY9oB,EAAMmD,EAAOkE,EAAO0hB,EAAcC,EAAOpf,EAAO8Z,GACrFrpB,KAAK2F,KAAOA,EACZ3F,KAAK8I,MAAQA,EACb9I,KAAK2uB,MAAQA,EACb3uB,KAAKuP,MAAQA,IAZoD,EAY1C8Z,EAA0B,KAAO1jB,EAAK6D,cAC7DxJ,KAAKqpB,QAAUA,EACfrpB,KAAK4G,QAAU,GAEf5G,KAAKgN,MAAQA,EAEbhN,KAAK4uB,YAAc3P,EAAKM,KAExBvf,KAAK0uB,aAAeA,EAEpB1uB,KAAK6uB,WAAa,IAGpBJ,EAAYruB,UAAUwI,aAAe,SAASA,aAAcjB,GAC1D,IAAK3H,KAAKuP,MAAO,CACf,IAAKvP,KAAK2F,KAAQ,MAAO,GACzB,IAAIgK,EAAO3P,KAAK2F,KAAK6D,aAAaoG,WAAW2N,EAAStb,KAAK0F,IAC3D,IAAIgI,EAEG,CACL,IAAoCvD,EAAhCtL,EAAQd,KAAK2F,KAAK6D,aACtB,OAAI4C,EAAOtL,EAAM8H,aAAajB,EAAKhC,QACjC3F,KAAKuP,MAAQzO,EACNsL,GAEA,KAPTpM,KAAKuP,MAAQvP,KAAK2F,KAAK6D,aAAaiH,cAAcd,GAWtD,OAAO3P,KAAKuP,MAAM3G,aAAajB,EAAKhC,OAGtC8oB,EAAYruB,UAAU8qB,OAAS,SAASA,OAAQzkB,GAC9C,KA7CoB,EA6CdzG,KAAKqpB,SAA4B,CACrC,IAAkDlmB,EAA9C+Q,EAAOlU,KAAK4G,QAAQ5G,KAAK4G,QAAQ/H,OAAS,GAC1CqV,GAAQA,EAAK4I,SAAW3Z,EAAI,oBAAoB2rB,KAAK5a,EAAK6I,SACxD7I,EAAK6I,KAAKle,QAAUsE,EAAE,GAAGtE,OAAUmB,KAAK4G,QAAQmM,MAC7C/S,KAAK4G,QAAQ5G,KAAK4G,QAAQ/H,OAAS,GAAKqV,EAAK6J,SAAS7J,EAAK6I,KAAKta,MAAM,EAAGyR,EAAK6I,KAAKle,OAASsE,EAAE,GAAGtE,UAG5G,IAAI+H,EAAU2W,EAAStb,KAAKjC,KAAK4G,SAGjC,OAFKH,GAAWzG,KAAKuP,QACjB3I,EAAUA,EAAQC,OAAO7G,KAAKuP,MAAMK,WAAW2N,EAAS1b,OAAO,KAC5D7B,KAAK2F,KAAO3F,KAAK2F,KAAKhC,OAAO3D,KAAK8I,MAAOlC,EAAS5G,KAAKgN,OAASpG,GAGzE6nB,EAAYruB,UAAU2uB,iBAAmB,SAASA,iBAAkBthB,GAClE,IAAK,IAAI3O,EAAIkB,KAAK6uB,WAAWhwB,OAAS,EAAGC,GAAK,EAAGA,IAC7C,GAAI2O,EAAKM,GAAG/N,KAAK6uB,WAAW/vB,IAAO,OAAOkB,KAAK6uB,WAAW1vB,OAAOL,EAAG,GAAG,IAG7E2vB,EAAYruB,UAAU4uB,aAAe,SAASA,aAAcC,GAC1D,IAAK,IAAInwB,EAAI,EAAGowB,EAAUlvB,KAAK0uB,aAAc5vB,EAAIowB,EAAQrwB,OAAQC,IAAK,CACpE,IAAI2O,EAAOyhB,EAAQpwB,IACdkB,KAAK2F,KAAO3F,KAAK2F,KAAKiI,eAAeH,EAAK9H,MAAQwpB,aAAa1hB,EAAK9H,KAAMspB,MAC1ExhB,EAAKmB,QAAQ5O,KAAK4uB,eACrB5uB,KAAK4uB,YAAcnhB,EAAKI,SAAS7N,KAAK4uB,aACtC5uB,KAAK0uB,aAAejhB,EAAKS,cAAclO,KAAK0uB,iBAKlDD,EAAYruB,UAAUgvB,cAAgB,SAASA,cAAeznB,GAC5D,OAAI3H,KAAK2F,KAAe3F,KAAK2F,KAAKmc,cAC9B9hB,KAAK4G,QAAQ/H,OAAiBmB,KAAK4G,QAAQ,GAAG+E,SAC3ChE,EAAK0nB,aAAepD,EAAU5U,eAAe1P,EAAK0nB,WAAWC,SAASC,gBAG/E,IAAIvE,EAAe,SAASA,aAAawE,EAAQnG,EAAS1Y,GAExD3Q,KAAKwvB,OAASA,EAEdxvB,KAAKqpB,QAAUA,EACfrpB,KAAKyvB,OAAS9e,EACd,IAA+B+e,EAA3BtG,EAAUC,EAAQD,QAClBuG,EAAarB,aAAa,KAAMjF,EAAQkF,mBAAoB,IAAM5d,EAvFL,EAuF4B,GAEzF+e,EADAtG,EACa,IAAIqF,EAAYrF,EAAQzjB,KAAMyjB,EAAQtgB,MAAOmW,EAAKM,KAAMN,EAAKM,MAAM,EACrD8J,EAAQuG,UAAYxG,EAAQzjB,KAAK6D,aAAcmmB,GAE7D,IAAIlB,EADZ9d,EACwB,KAEA6e,EAAOjqB,OAAO2kB,YAFR,KAAMjL,EAAKM,KAAMN,EAAKM,MAAM,EAAM,KAAMoQ,GAG/E3vB,KAAK8e,MAAQ,CAAC4Q,GAEd1vB,KAAK2Q,KAAO,EACZ3Q,KAAK+b,KAAOsN,EAAQwG,cACpB7vB,KAAK8vB,YAAa,GAGhBC,EAAuB,CAAEpd,IAAK,CAAEvO,cAAc,GAAO4rB,WAAY,CAAE5rB,cAAc,IAwYrF,SAASkO,QAAQyY,EAAKkF,GACpB,OAAQlF,EAAIzY,SAAWyY,EAAImF,mBAAqBnF,EAAIoF,uBAAyBpF,EAAIqF,oBAAoB7tB,KAAKwoB,EAAKkF,GAWjH,SAASvtB,KAAKkU,GACZ,IAAIlU,EAAO,GACX,IAAK,IAAI+Z,KAAQ7F,EAAOlU,EAAK+Z,GAAQ7F,EAAI6F,GACzC,OAAO/Z,EAMT,SAASysB,aAAajG,EAAUrgB,GAC9B,IAAIiW,EAAQjW,EAAStD,OAAOuZ,MACxB0G,KAAO,SAAW3hB,GACpB,IAAIwE,EAASyW,EAAMjb,GACnB,GAAKwE,EAAOuF,eAAesb,GAA3B,CACA,IAAIjD,EAAO,GAAIpT,KAAO,SAAUtD,GAC9B0W,EAAK/nB,KAAKqR,GACV,IAAK,IAAIzQ,EAAI,EAAGA,EAAIyQ,EAAMyU,UAAWllB,IAAK,CACxC,IAAIgT,EAAMvC,EAAM6V,KAAKtmB,GACjB6G,EAAOmM,EAAInM,KACXkC,EAAOiK,EAAIjK,KACf,GAAIlC,GAAQkD,EAAY,OAAO,EAC/B,GAAIod,EAAKlnB,QAAQ8I,GAAQ,GAAKgL,KAAKhL,GAAS,OAAO,IAGvD,OAAIgL,KAAKxK,EAAOmB,cAAwB,CAAE6mB,GAAG,QAA7C,IAGF,IAAK,IAAIxsB,KAAQib,EAAO,CACtB,IAAIwR,EAAW9K,KAAM3hB,GAErB,GAAKysB,EAAW,OAAOA,EAASD,GAhbpCN,EAAqBpd,IAAI1T,IAAM,WAC7B,OAAOe,KAAK8e,MAAM9e,KAAK2Q,OAOzBqa,EAAa5qB,UAAUmwB,OAAS,SAASA,OAAQxF,GAC/C,GAAoB,GAAhBA,EAAIliB,SACN7I,KAAKwwB,YAAYzF,QACZ,GAAoB,GAAhBA,EAAIliB,SAAe,CAC5B,IAAIsG,EAAQ4b,EAAI0F,aAAa,SACzBzjB,EAAQmC,EAAQnP,KAAK0wB,WA+X7B,SAASC,YAAYxhB,GACnB,IAAuChM,EAAnCytB,EAAK,6BAAiC1vB,EAAS,GACnD,KAAOiC,EAAIytB,EAAG9B,KAAK3f,IAAUjO,EAAOhD,KAAKiF,EAAE,GAAIA,EAAE,GAAG0tB,QACpD,OAAO3vB,EAlY+ByvB,CAAYxhB,IAAU,KAAMwD,EAAM3S,KAAK2S,IAC3E,GAAa,MAAT3F,EAAiB,IAAK,IAAIlO,EAAI,EAAGA,EAAIkO,EAAMnO,OAAQC,IAAOkB,KAAK8wB,eAAe9jB,EAAMlO,IAExF,GADAkB,KAAK+wB,WAAWhG,GACH,MAAT/d,EAAiB,IAAK,IAAI6C,EAAM,EAAGA,EAAM7C,EAAMnO,OAAQgR,IAAS7P,KAAKgxB,kBAAkBhkB,EAAM6C,GAAM8C,KAI3GqY,EAAa5qB,UAAUowB,YAAc,SAASA,YAAazF,GACzD,IAAIluB,EAAQkuB,EAAIkG,UACZte,EAAM3S,KAAK2S,IACf,GA/H8C,EA+H1CA,EAAI0W,SACJ1W,EAAIyc,cAAcrE,IAClB,mBAAmB3D,KAAKvqB,GAAQ,CAClC,GAlIkB,EAkIZ8V,EAAI0W,QAgBRxsB,EAlJ0C,EA+I/B8V,EAAI0W,QAGPxsB,EAAMqJ,QAAQ,SAAU,MAFxBrJ,EAAMqJ,QAAQ,YAAa,UATnC,GAJArJ,EAAQA,EAAMqJ,QAAQ,oBAAqB,KAIvC,mBAAmBkhB,KAAKvqB,IAAUmD,KAAK2Q,MAAQ3Q,KAAK8e,MAAMjgB,OAAS,EAAG,CACxE,IAAI+L,EAAa+H,EAAI/L,QAAQ+L,EAAI/L,QAAQ/H,OAAS,GAC9CqyB,EAAgBnG,EAAIoG,kBACnBvmB,GACAsmB,GAA2C,MAA1BA,EAAc5B,UAC/B1kB,EAAWkS,QAAU,mBAAmBsK,KAAKxc,EAAWmS,SACzDlgB,EAAQA,EAAM4F,MAAM,IAOxB5F,GAASmD,KAAKoxB,WAAWpxB,KAAKwvB,OAAOjqB,OAAOwX,KAAKlgB,IACrDmD,KAAKqxB,WAAWtG,QAEhB/qB,KAAKsxB,WAAWvG,IAOpBC,EAAa5qB,UAAU2wB,WAAa,SAASA,WAAYhG,EAAKwG,GAC5D,IAAuCC,EAAnC3tB,EAAOknB,EAAIuE,SAASC,cACpBlB,EAAShX,eAAexT,IAAS7D,KAAKwvB,OAAO5E,gBA+TnD,SAAS6G,cAAc1G,GACrB,IAAK,IAAI/tB,EAAQ+tB,EAAI/iB,WAAY0pB,EAAW,KAAM10B,EAAOA,EAAQA,EAAM20B,YAAa,CAClF,IAAI9tB,EAAyB,GAAlB7G,EAAM6L,SAAgB7L,EAAMsyB,SAASC,cAAgB,KAC5D1rB,GAAQwqB,EAAShX,eAAexT,IAAS6tB,GAC3CA,EAASE,YAAY50B,GACrBA,EAAQ00B,GACS,MAAR7tB,EACT6tB,EAAW10B,EACF6G,IACT6tB,EAAW,OAxUoDD,CAAc1G,GACjF,IAAIL,EAAQ1qB,KAAKqpB,QAAQwI,cAAgB7xB,KAAKqpB,QAAQwI,aAAa9G,KAC9DyG,EAASxxB,KAAKwvB,OAAOpE,SAASL,EAAK/qB,KAAMuxB,IAC9C,GAAI7G,EAAOA,EAAKoH,OAAS7D,EAAW5W,eAAexT,GACjD7D,KAAKsxB,WAAWvG,GAChB/qB,KAAK+xB,eAAehH,QACf,IAAKL,GAAQA,EAAKsH,MAAQtH,EAAKuH,YAAa,CAC7CvH,GAAQA,EAAKuH,YAAejyB,KAAK2Q,KAAOlR,KAAK8G,IAAI,EAAGvG,KAAK2Q,KAAO,GAC3D+Z,GAAQA,EAAKsH,KAAKnpB,WAAYkiB,EAAML,EAAKsH,MAClD,IAAIE,EAAMvf,EAAM3S,KAAK2S,IAAKwf,EAAgBnyB,KAAK8vB,WAC/C,GAAI7D,EAAU5U,eAAexT,GAC3BquB,GAAO,EACFvf,EAAIhN,OAAQ3F,KAAK8vB,YAAa,QAC9B,IAAK/E,EAAI/iB,WAEd,YADAhI,KAAKoyB,aAAarH,GAGpB/qB,KAAKirB,OAAOF,GACRmH,GAAQlyB,KAAKkyB,KAAKvf,GACtB3S,KAAK8vB,WAAaqC,OAElBnyB,KAAKqyB,iBAAiBtH,EAAKL,GAAyB,IAAnBA,EAAK4H,UAAsBd,EAAS,OAKzExG,EAAa5qB,UAAUgyB,aAAe,SAASA,aAAcrH,GACvC,MAAhBA,EAAIuE,UAAoBtvB,KAAK2S,IAAIhN,MAAQ3F,KAAK2S,IAAIhN,KAAKmc,eACvD9hB,KAAKwwB,YAAYzF,EAAIwH,cAAcC,eAAe,QAIxDxH,EAAa5qB,UAAU2xB,eAAiB,SAASA,eAAgBhH,GAE3C,MAAhBA,EAAIuE,UAAsBtvB,KAAK2S,IAAIhN,MAAS3F,KAAK2S,IAAIhN,KAAKmc,eAC1D9hB,KAAKyyB,UAAUzyB,KAAKwvB,OAAOjqB,OAAOwX,KAAK,OAM7CiO,EAAa5qB,UAAUswB,WAAa,SAASA,WAAYjG,GACvD,IAAIzd,EAAQiS,EAAKM,KACjBpQ,EAAO,IAAK,IAAIrQ,EAAI,EAAGA,EAAI2rB,EAAO5rB,OAAQC,GAAK,EAC7C,IAAK,IAAIyL,EAAQ,OAAQ,CACvB,IAAImgB,EAAO1qB,KAAKwvB,OAAO/D,WAAWhB,EAAO3rB,GAAI2rB,EAAO3rB,EAAI,GAAIkB,KAAMuK,GAClE,IAAKmgB,EAAQ,SAASvb,EACtB,GAAIub,EAAKoH,OAAU,OAAO,KAE1B,GADA9kB,EAAQhN,KAAKwvB,OAAOjqB,OAAOyH,MAAM0d,EAAKjd,MAAM9J,OAAO+mB,EAAK5hB,OAAO+E,SAASb,IACjD,IAAnB0d,EAAK4H,UACF,MADyB/nB,EAAQmgB,EAI5C,OAAO1d,GAOTge,EAAa5qB,UAAUiyB,iBAAmB,SAASA,iBAAkBtH,EAAKL,EAAMgI,GAC5E,IAEER,EAAMrpB,EAAoB4E,EAFxBlB,EAASvM,KAGX0qB,EAAK/iB,MACPkB,EAAW7I,KAAKwvB,OAAOjqB,OAAOuZ,MAAM4L,EAAK/iB,OAC3BI,OAEF/H,KAAKoxB,WAAWvoB,EAASlF,OAAO+mB,EAAK5hB,SAC/C9I,KAAKoyB,aAAarH,GAFlBmH,EAAOlyB,KAAK2yB,MAAM9pB,EAAU6hB,EAAK5hB,MAAO4hB,EAAK6D,qBAM/C9gB,EADWzN,KAAKwvB,OAAOjqB,OAAOyH,MAAM0d,EAAKjd,MACzB9J,OAAO+mB,EAAK5hB,OAC5B9I,KAAK8wB,eAAerjB,IAEtB,IAAImlB,EAAU5yB,KAAK2S,IAEnB,GAAI9J,GAAYA,EAASd,OACvB/H,KAAKsxB,WAAWvG,QACX,GAAI2H,EACT1yB,KAAK+wB,WAAWhG,EAAK2H,QAChB,GAAIhI,EAAKmI,WACd7yB,KAAKsxB,WAAWvG,GAChBL,EAAKmI,WAAW9H,EAAK/qB,KAAKwvB,OAAOjqB,QAAQpJ,SAAQ,SAAUwL,GAAQ,OAAO4E,EAAO6kB,WAAWzpB,UACvF,CACL,IAAImrB,EAAapI,EAAKqI,eACG,iBAAdD,EAA0BA,EAAa/H,EAAIiI,cAAcF,GACtC,mBAAdA,IAA4BA,EAAaA,EAAW/H,IAC/D+H,IAAcA,EAAa/H,GAChC/qB,KAAKizB,WAAWlI,EAAK+H,GAAY,GACjC9yB,KAAKirB,OAAO6H,EAAYZ,GAEtBA,IAAQlyB,KAAKkyB,KAAKU,GAAU5yB,KAAK2Q,QACjClD,GAAQzN,KAAKgxB,kBAAkBvjB,EAAMmlB,IAO3C5H,EAAa5qB,UAAU6qB,OAAS,SAASA,OAAQ5iB,EAAQ6pB,EAAM3pB,EAAYC,GAEzE,IADA,IAAIlI,EAAQiI,GAAc,EACjBwiB,EAAMxiB,EAAaF,EAAO6qB,WAAW3qB,GAAcF,EAAOL,WAC1D/G,EAAkB,MAAZuH,EAAmB,KAAOH,EAAO6qB,WAAW1qB,GACtDuiB,GAAO9pB,EAAK8pB,EAAMA,EAAI4G,cAAerxB,EACxCN,KAAKmzB,YAAY9qB,EAAQ/H,GACzBN,KAAKuwB,OAAOxF,GACRmH,GAAQjG,EAAU5U,eAAe0T,EAAIuE,SAASC,gBAC9CvvB,KAAKkyB,KAAKA,GAEhBlyB,KAAKmzB,YAAY9qB,EAAQ/H,IAM3B0qB,EAAa5qB,UAAUqyB,UAAY,SAASA,UAAW9qB,GAErD,IADA,IAAIyrB,EAAOlB,EACFzqB,EAAQzH,KAAK2Q,KAAMlJ,GAAS,EAAGA,IAAS,CAC/C,IAAI4rB,EAAKrzB,KAAK8e,MAAMrX,GAChByH,EAAQmkB,EAAGzqB,aAAajB,GAC5B,GAAIuH,KAAWkkB,GAASA,EAAMv0B,OAASqQ,EAAMrQ,UAC3Cu0B,EAAQlkB,EACRgjB,EAAOmB,GACFnkB,EAAMrQ,QAAU,MAEvB,GAAIw0B,EAAG1E,MAAS,MAElB,IAAKyE,EAAS,OAAO,EACrBpzB,KAAKkyB,KAAKA,GACV,IAAK,IAAIpzB,EAAI,EAAGA,EAAIs0B,EAAMv0B,OAAQC,IAC9BkB,KAAKszB,WAAWF,EAAMt0B,GAAI,MAAM,GACpC,OAAO,GAKTksB,EAAa5qB,UAAUgxB,WAAa,SAASA,WAAYzpB,GACvD,GAAIA,EAAKgE,UAAY3L,KAAK8vB,aAAe9vB,KAAK2S,IAAIhN,KAAM,CACtD,IAAI4tB,EAAQvzB,KAAKwzB,uBACbD,GAASvzB,KAAKszB,WAAWC,GAE/B,GAAIvzB,KAAKyyB,UAAU9qB,GAAO,CACxB3H,KAAKyzB,aACL,IAAI9gB,EAAM3S,KAAK2S,IACfA,EAAIqc,aAAarnB,EAAKhC,MAClBgN,EAAIpD,QAASoD,EAAIpD,MAAQoD,EAAIpD,MAAM7F,UAAU/B,EAAKhC,OAEtD,IADA,IAAIqH,EAAQ2F,EAAIic,YACP9vB,EAAI,EAAGA,EAAI6I,EAAKqF,MAAMnO,OAAQC,IAC9B6T,EAAIhN,OAAQgN,EAAIhN,KAAKiI,eAAejG,EAAKqF,MAAMlO,GAAG6G,QACrDqH,EAAQrF,EAAKqF,MAAMlO,GAAG+O,SAASb,IAErC,OADA2F,EAAI/L,QAAQ1I,KAAKyJ,EAAK8F,KAAKT,KACpB,EAET,OAAO,GAMTge,EAAa5qB,UAAUuyB,MAAQ,SAASA,MAAOhtB,EAAMmD,EAAO4qB,GAC1D,IAAI3tB,EAAK/F,KAAKyyB,UAAU9sB,EAAKhC,OAAOmF,IAEpC,OADI/C,GAAM/F,KAAKszB,WAAW3tB,EAAMmD,GAAO,EAAM4qB,GACtC3tB,GAITilB,EAAa5qB,UAAUkzB,WAAa,SAASA,WAAY3tB,EAAMmD,EAAO6lB,EAAO+E,GAC3E1zB,KAAKyzB,aACL,IAAI9gB,EAAM3S,KAAK2S,IACfA,EAAIqc,aAAarpB,GACjBgN,EAAIpD,MAAQoD,EAAIpD,OAASoD,EAAIpD,MAAM7F,UAAU/D,EAAMmD,GACnD,IAAIugB,EAAUiF,aAAa3oB,EAAM+tB,EAAY/gB,EAAI0W,SA7UgB,EA8U5D1W,EAAI0W,SAAkD,GAAtB1W,EAAI/L,QAAQ/H,SAAewqB,GA9UC,GA+UjErpB,KAAK8e,MAAM5gB,KAAK,IAAIuwB,EAAY9oB,EAAMmD,EAAO6J,EAAIic,YAAajc,EAAI+b,aAAcC,EAAO,KAAMtF,IAC7FrpB,KAAK2Q,QAKPqa,EAAa5qB,UAAUqzB,WAAa,SAASA,WAAYhtB,GACvD,IAAI3H,EAAIkB,KAAK8e,MAAMjgB,OAAS,EAC5B,GAAIC,EAAIkB,KAAK2Q,KAAM,CACjB,KAAO7R,EAAIkB,KAAK2Q,KAAM7R,IAAOkB,KAAK8e,MAAMhgB,EAAI,GAAG8H,QAAQ1I,KAAK8B,KAAK8e,MAAMhgB,GAAGosB,OAAOzkB,IACjFzG,KAAK8e,MAAMjgB,OAASmB,KAAK2Q,KAAO,IAIpCqa,EAAa5qB,UAAU8qB,OAAS,SAASA,SAGvC,OAFAlrB,KAAK2Q,KAAO,EACZ3Q,KAAKyzB,WAAWzzB,KAAKyvB,QACdzvB,KAAK8e,MAAM,GAAGoM,OAAOlrB,KAAKyvB,QAAUzvB,KAAKqpB,QAAQsK,UAG1D3I,EAAa5qB,UAAU8xB,KAAO,SAASA,KAAMhwB,GAC3C,IAAK,IAAIpD,EAAIkB,KAAK2Q,KAAM7R,GAAK,EAAGA,IAAO,GAAIkB,KAAK8e,MAAMhgB,IAAMoD,EAE1D,YADAlC,KAAK2Q,KAAO7R,IAKhBixB,EAAqBC,WAAW/wB,IAAM,WACpCe,KAAKyzB,aAEL,IADA,IAAI5zB,EAAM,EACDf,EAAIkB,KAAK2Q,KAAM7R,GAAK,EAAGA,IAAK,CAEnC,IADA,IAAI8H,EAAU5G,KAAK8e,MAAMhgB,GAAG8H,QACnByI,EAAIzI,EAAQ/H,OAAS,EAAGwQ,GAAK,EAAGA,IACrCxP,GAAO+G,EAAQyI,GAAGtC,SAClBjO,GAAKe,IAEX,OAAOA,GAGTmrB,EAAa5qB,UAAU+yB,YAAc,SAASA,YAAa9qB,EAAQ1G,GACjE,GAAI3B,KAAK+b,KAAQ,IAAK,IAAIjd,EAAI,EAAGA,EAAIkB,KAAK+b,KAAKld,OAAQC,IACjDkB,KAAK+b,KAAKjd,GAAG6I,MAAQU,GAAUrI,KAAK+b,KAAKjd,GAAG6C,QAAUA,IACtD3B,KAAK+b,KAAKjd,GAAGe,IAAMG,KAAKgwB,aAIhChF,EAAa5qB,UAAUkxB,WAAa,SAASA,WAAYjpB,GACvD,GAAIrI,KAAK+b,KAAQ,IAAK,IAAIjd,EAAI,EAAGA,EAAIkB,KAAK+b,KAAKld,OAAQC,IAC7B,MAApBkB,KAAK+b,KAAKjd,GAAGe,KAAkC,GAAnBwI,EAAOQ,UAAiBR,EAAOurB,SAAS5zB,KAAK+b,KAAKjd,GAAG6I,QACjF3H,KAAK+b,KAAKjd,GAAGe,IAAMG,KAAKgwB,aAIhChF,EAAa5qB,UAAU6yB,WAAa,SAASA,WAAY5qB,EAAQzB,EAASzC,GACxE,GAAIkE,GAAUzB,GAAW5G,KAAK+b,KAAQ,IAAK,IAAIjd,EAAI,EAAGA,EAAIkB,KAAK+b,KAAKld,OAAQC,IAAK,CAC/E,GAAwB,MAApBkB,KAAK+b,KAAKjd,GAAGe,KAAkC,GAAnBwI,EAAOQ,UAAiBR,EAAOurB,SAAS5zB,KAAK+b,KAAKjd,GAAG6I,MACzEf,EAAQitB,wBAAwB7zB,KAAK+b,KAAKjd,GAAG6I,OAC5CxD,EAAS,EAAI,KACpBnE,KAAK+b,KAAKjd,GAAGe,IAAMG,KAAKgwB,cAKlChF,EAAa5qB,UAAUixB,WAAa,SAASA,WAAYyC,GACvD,GAAI9zB,KAAK+b,KAAQ,IAAK,IAAIjd,EAAI,EAAGA,EAAIkB,KAAK+b,KAAKld,OAAQC,IACjDkB,KAAK+b,KAAKjd,GAAG6I,MAAQmsB,IACrB9zB,KAAK+b,KAAKjd,GAAGe,IAAMG,KAAKgwB,YAAc8D,EAAS7C,UAAUpyB,OAASmB,KAAK+b,KAAKjd,GAAG6C,UAOvFqpB,EAAa5qB,UAAUmrB,eAAiB,SAASA,eAAgBxvB,GAC7D,IAAIwQ,EAASvM,KAEf,GAAIjE,EAAQgD,QAAQ,MAAQ,EACxB,OAAOhD,EAAQsR,MAAM,YAAYwd,KAAK7qB,KAAKurB,eAAgBvrB,MAE/D,IAAI+zB,EAAQh4B,EAAQsR,MAAM,KACtB2mB,EAASh0B,KAAKqpB,QAAQttB,QACtBk4B,IAAWj0B,KAAKyvB,QAAYuE,GAAUA,EAAO3rB,OAAO1C,MAAQ3F,KAAK8e,MAAM,GAAGnZ,MAC1EuuB,IAAaF,EAASA,EAAOvsB,MAAQ,EAAI,IAAMwsB,EAAU,EAAI,GAC7D1kB,MAAQ,SAAUzQ,EAAG2I,GACvB,KAAO3I,GAAK,EAAGA,IAAK,CAClB,IAAIq1B,EAAOJ,EAAMj1B,GACjB,GAAY,IAARq1B,EAAY,CACd,GAAIr1B,GAAKi1B,EAAMl1B,OAAS,GAAU,GAALC,EAAU,SACvC,KAAO2I,GAASysB,EAAUzsB,IACtB,GAAI8H,MAAMzQ,EAAI,EAAG2I,GAAU,OAAO,EACtC,OAAO,EAEP,IAAII,EAAOJ,EAAQ,GAAe,GAATA,GAAcwsB,EAAW1nB,EAAOuS,MAAMrX,GAAO9B,KAChEquB,GAAUvsB,GAASysB,EAAWF,EAAOrsB,KAAKF,EAAQysB,GAAUvuB,KAC5D,KACN,IAAKkC,GAASA,EAAKhE,MAAQswB,IAAsC,GAA9BtsB,EAAK2f,OAAOzoB,QAAQo1B,GACnD,OAAO,EACX1sB,IAGJ,OAAO,GAET,OAAO8H,MAAMwkB,EAAMl1B,OAAS,EAAGmB,KAAK2Q,OAGtCqa,EAAa5qB,UAAUozB,qBAAuB,SAASA,uBACrD,IAAIY,EAAWp0B,KAAKqpB,QAAQttB,QAC5B,GAAIq4B,EAAY,IAAK,IAAIhqB,EAAIgqB,EAAS3sB,MAAO2C,GAAK,EAAGA,IAAK,CACxD,IAAIiqB,EAAQD,EAASzsB,KAAKyC,GAAGlB,eAAekrB,EAAS1sB,WAAW0C,IAAI2Z,YACpE,GAAIsQ,GAASA,EAAMlpB,aAAekpB,EAAMtR,aAAgB,OAAOsR,EAEjE,IAAK,IAAIxwB,KAAQ7D,KAAKwvB,OAAOjqB,OAAOuZ,MAAO,CACzC,IAAInZ,EAAO3F,KAAKwvB,OAAOjqB,OAAOuZ,MAAMjb,GACpC,GAAI8B,EAAKwF,aAAexF,EAAKod,aAAgB,OAAOpd,IAIxDqlB,EAAa5qB,UAAU0wB,eAAiB,SAASA,eAAgBrjB,GAC/D,IAAIyB,EAuFN,SAASolB,kBAAkB7mB,EAAMxR,GAC/B,IAAK,IAAI6C,EAAI,EAAGA,EAAI7C,EAAI4C,OAAQC,IAC9B,GAAI2O,EAAKM,GAAG9R,EAAI6C,IAAO,OAAO7C,EAAI6C,GAzFxBw1B,CAAkB7mB,EAAMzN,KAAK2S,IAAI+b,cACzCxf,GAASlP,KAAK2S,IAAIkc,WAAW3wB,KAAKgR,GACtClP,KAAK2S,IAAI+b,aAAejhB,EAAKI,SAAS7N,KAAK2S,IAAI+b,eAGjD1D,EAAa5qB,UAAU4wB,kBAAoB,SAASA,kBAAmBvjB,EAAM8mB,GAC3E,IAAK,IAAI9sB,EAAQzH,KAAK2Q,KAAMlJ,GAAS,EAAGA,IAAS,CAC/C,IAAIiL,EAAQ1S,KAAK8e,MAAMrX,GAEvB,GADYiL,EAAMgc,aAAa8F,YAAY/mB,IAC9B,EACXiF,EAAMgc,aAAejhB,EAAKS,cAAcwE,EAAMgc,kBACzC,CACLhc,EAAMkc,YAAcnhB,EAAKS,cAAcwE,EAAMkc,aAC7C,IAAI6F,EAAY/hB,EAAMqc,iBAAiBthB,GACnCgnB,GAAa/hB,EAAM/M,MAAQ+M,EAAM/M,KAAKiI,eAAe6mB,EAAU9uB,QAC/D+M,EAAMkc,YAAc6F,EAAU5mB,SAAS6E,EAAMkc,cAEnD,GAAIlc,GAAS6hB,EAAQ,QAIzB7wB,OAAOoB,iBAAkBkmB,EAAa5qB,UAAW2vB,GA4FjD,IAAI2E,EAAgB,SAASA,cAAc5V,EAAO9R,GAGhDhN,KAAK8e,MAAQA,GAAS,GAGtB9e,KAAKgN,MAAQA,GAAS,IAiKxB,SAAS2nB,YAAY/d,GACnB,IAAI1V,EAAS,GACb,IAAK,IAAI2C,KAAQ+S,EAAK,CACpB,IAAIge,EAAQhe,EAAI/S,GAAM6E,KAAKksB,MACvBA,IAAS1zB,EAAO2C,GAAQ+wB,GAE9B,OAAO1zB,EAGT,SAAS6C,IAAIslB,GAEX,OAAOA,EAAQwL,UAAY3e,OAAO2e,SApKpCH,EAAct0B,UAAU00B,kBAAoB,SAASA,kBAAmBrpB,EAAU4d,EAASvd,GACvF,IAAIS,EAASvM,UACI,IAAZqpB,IAAqBA,EAAU,IAEjCvd,IAAUA,EAAS/H,IAAIslB,GAAS0L,0BAErC,IAAIpiB,EAAM7G,EAAQ2a,EAAS,KA4B3B,OA3BAhb,EAAStP,SAAQ,SAAUwL,GACzB,GAAI8e,GAAU9e,EAAKqF,MAAMnO,OAAQ,CAC1B4nB,IAAUA,EAAS,IAExB,IADA,IAAIuO,EAAO,EAAGC,EAAW,EAClBD,EAAOvO,EAAO5nB,QAAUo2B,EAAWttB,EAAKqF,MAAMnO,QAAQ,CAC3D,IAAIgJ,EAAOF,EAAKqF,MAAMioB,GACtB,GAAK1oB,EAAOS,MAAMnF,EAAKlC,KAAK9B,MAA5B,CACA,IAAKgE,EAAKkG,GAAG0Y,EAAOuO,MAAsC,IAA5BntB,EAAKlC,KAAK+C,KAAKwsB,SAAsB,MACnEF,GAAQ,EAAGC,SAF0BA,IAIvC,KAAOD,EAAOvO,EAAO5nB,QACnB8T,EAAM8T,EAAO1T,MACb0T,EAAO1T,MAET,KAAOkiB,EAAWttB,EAAKqF,MAAMnO,QAAQ,CACnC,IAAIG,EAAM2I,EAAKqF,MAAMioB,KACjBE,EAAU5oB,EAAO6oB,cAAcp2B,EAAK2I,EAAKgE,SAAU0d,GACnD8L,IACF1O,EAAOvoB,KAAKc,EAAK2T,GACjBA,EAAIif,YAAYuD,EAAQpK,KACxBpY,EAAMwiB,EAAQrC,YAAcqC,EAAQpK,MAI1CpY,EAAIif,YAAYrlB,EAAO8oB,mBAAmB1tB,EAAM0hB,OAG3Cvd,GAGT4oB,EAAct0B,UAAUi1B,mBAAqB,SAASA,mBAAoB1tB,EAAM0hB,QAC3D,IAAZA,IAAqBA,EAAU,IAEtC,IAAIvX,EACA4iB,EAAcY,WAAWvxB,IAAIslB,GAAUrpB,KAAK8e,MAAMnX,EAAKhC,KAAK9B,MAAM8D,IAChEojB,EAAMjZ,EAAIiZ,IACV+H,EAAahhB,EAAIghB,WACvB,GAAIA,EAAY,CACd,GAAInrB,EAAKI,OACL,MAAM,IAAIrC,WAAW,gDACrB2jB,EAAQkM,UACRlM,EAAQkM,UAAU5tB,EAAMmrB,EAAYzJ,GAEpCrpB,KAAK80B,kBAAkBntB,EAAKf,QAASyiB,EAASyJ,GAEpD,OAAO/H,GAST2J,EAAct0B,UAAUo1B,cAAgB,SAASA,cAAe7tB,EAAM0hB,QACjD,IAAZA,IAAqBA,EAAU,IAGtC,IADA,IAAI0B,EAAM/qB,KAAKq1B,mBAAmB1tB,EAAM0hB,GAC/BvqB,EAAI6I,EAAKqF,MAAMnO,OAAS,EAAGC,GAAK,EAAGA,IAAK,CAC/C,IAAIsN,EAAOpM,KAAKo1B,cAAcztB,EAAKqF,MAAMlO,GAAI6I,EAAKgE,SAAU0d,GACxDjd,KACPA,EAAK0mB,YAAc1mB,EAAK2e,KAAK6G,YAAY7G,GACpCA,EAAM3e,EAAK2e,KAGf,OAAOA,GAGT2J,EAAct0B,UAAUg1B,cAAgB,SAASA,cAAe3nB,EAAMoZ,EAAQwC,QACzD,IAAZA,IAAqBA,EAAU,IAEtC,IAAIuL,EAAQ50B,KAAKgN,MAAMS,EAAK9H,KAAK9B,MACjC,OAAO+wB,GAASF,EAAcY,WAAWvxB,IAAIslB,GAAUuL,EAAMnnB,EAAMoZ,KAOrE6N,EAAcY,WAAa,SAASA,WAAYvxB,EAAKsC,EAAWovB,GAG9D,QAFiB,IAAVA,IAAmBA,EAAQ,MAEV,iBAAbpvB,EACP,MAAO,CAAC0kB,IAAKhnB,EAAIyuB,eAAensB,IACpC,GAA0B,MAAtBA,EAAUwC,SACV,MAAO,CAACkiB,IAAK1kB,GACjB,GAAIA,EAAU0kB,KAAiC,MAA1B1kB,EAAU0kB,IAAIliB,SAC/B,OAAOxC,EACX,IAAIqvB,EAAUrvB,EAAU,GAAIsvB,EAAQD,EAAQ32B,QAAQ,KAChD42B,EAAQ,IACVF,EAAQC,EAAQjzB,MAAM,EAAGkzB,GACzBD,EAAUA,EAAQjzB,MAAMkzB,EAAQ,IAElC,IAAI7C,EAAa,KAAM/H,EAAM0K,EAAQ1xB,EAAI6xB,gBAAgBH,EAAOC,GAAW3xB,EAAI8xB,cAAcH,GACzF5sB,EAAQzC,EAAU,GAAIvF,EAAQ,EAClC,GAAIgI,GAAyB,iBAATA,GAAuC,MAAlBA,EAAMD,WAAqB4V,MAAMC,QAAQ5V,GAEhF,IAAK,IAAIjF,KADT/C,EAAQ,EACSgI,EAAS,GAAmB,MAAfA,EAAMjF,GAAe,CACjD,IAAIiyB,EAAUjyB,EAAK9E,QAAQ,KACvB+2B,EAAU,EAAK/K,EAAIgL,eAAelyB,EAAKpB,MAAM,EAAGqzB,GAAUjyB,EAAKpB,MAAMqzB,EAAU,GAAIhtB,EAAMjF,IACtFknB,EAAIiL,aAAanyB,EAAMiF,EAAMjF,IAGxC,IAAK,IAAI/E,EAAIgC,EAAOhC,EAAIuH,EAAUxH,OAAQC,IAAK,CAC7C,IAAI9B,EAAQqJ,EAAUvH,GACtB,GAAc,IAAV9B,EAAa,CACf,GAAI8B,EAAIuH,EAAUxH,OAAS,GAAKC,EAAIgC,EAChC,MAAM,IAAI4E,WAAW,0DACzB,MAAO,CAACqlB,IAAKA,EAAK+H,WAAY/H,GAE9B,IAAIjZ,EAAM4iB,EAAcY,WAAWvxB,EAAK/G,EAAOy4B,GACzCpsB,EAAQyI,EAAIiZ,IACZkL,EAAenkB,EAAIghB,WAEzB,GADA/H,EAAI6G,YAAYvoB,GACZ4sB,EAAc,CAChB,GAAInD,EAAc,MAAM,IAAIptB,WAAW,0BACvCotB,EAAamD,GAInB,MAAO,CAAClL,IAAKA,EAAK+H,WAAYA,IAMhC4B,EAAc3I,WAAa,SAASA,WAAYxmB,GAC9C,OAAOA,EAAO8c,OAAO6T,gBAClB3wB,EAAO8c,OAAO6T,cAAgB,IAAIxB,EAAc10B,KAAKm2B,gBAAgB5wB,GAASvF,KAAKo2B,gBAAgB7wB,MAMxGmvB,EAAcyB,gBAAkB,SAASA,gBAAiB5wB,GACxD,IAAIrE,EAASyzB,YAAYpvB,EAAOuZ,OAEhC,OADK5d,EAAO6b,OAAQ7b,EAAO6b,KAAO,SAAUpV,GAAQ,OAAOA,EAAKoV,OACzD7b,GAKTwzB,EAAc0B,gBAAkB,SAASA,gBAAiB7wB,GACxD,OAAOovB,YAAYpvB,EAAOyH,S,kCCl4G5BtJ,OAAO2yB,eAAe/gB,EAAS,aAAc,CAC3CzY,OAAO,IAET,IAEI+qB,EAAW,CACb0O,OAAQ,CACNC,WAAY,gTACZC,aAAc,iTAEhB/L,OAAQ,CACNgM,MAAO,CACLC,OAAQ,WAEVC,UAAW,CACTD,OAAQ,WACRE,SAAU,WACVC,WAAY,kBACZC,UAAW,gCACXC,gBAAiB,gBACjBC,WAAY,wBAEdC,cAAe,CACbL,SAAU,QACVjkB,IAAK,EACLukB,MAAO,EACPC,OAAQ,EACRC,KAAM,EACNC,OAAQ,KAEVC,QAAS,CACPV,SAAU,WACVjkB,IAAK,EACLukB,MAAO,EACPC,OAAQ,EACRC,KAAM,EACNG,gBAAiB,OACjBC,QAAS,EACTX,WAAY,kBAGhBY,mBAtCuB,KAyCzBniB,EAAQ0S,QAAUJ,G,oCC5ClBlkB,OAAO2yB,eAAe/gB,EAAS,aAAc,CAC3CzY,OAAO,IAGT,IAAI66B,EAAWh0B,OAAOi0B,QAAU,SAAU7rB,GAAU,IAAK,IAAIhN,EAAI,EAAGA,EAAIqW,UAAUtW,OAAQC,IAAK,CAAE,IAAI84B,EAASziB,UAAUrW,GAAI,IAAK,IAAIrC,KAAOm7B,EAAcl0B,OAAOtD,UAAUiX,eAAe9U,KAAKq1B,EAAQn7B,KAAQqP,EAAOrP,GAAOm7B,EAAOn7B,IAAY,OAAOqP,GAEnP+rB,EAAe,WAAc,SAAS/yB,iBAAiBgH,EAAQgsB,GAAS,IAAK,IAAIh5B,EAAI,EAAGA,EAAIg5B,EAAMj5B,OAAQC,IAAK,CAAE,IAAIi5B,EAAaD,EAAMh5B,GAAIi5B,EAAWC,WAAaD,EAAWC,aAAc,EAAOD,EAAW3zB,cAAe,EAAU,UAAW2zB,IAAYA,EAAWE,UAAW,GAAMv0B,OAAO2yB,eAAevqB,EAAQisB,EAAWt7B,IAAKs7B,IAAiB,OAAO,SAAUG,EAAaC,EAAYC,GAAiJ,OAA9HD,GAAYrzB,iBAAiBozB,EAAY93B,UAAW+3B,GAAiBC,GAAatzB,iBAAiBozB,EAAaE,GAAqBF,GAA7gB,GAEfG,EAAS,EAAQ,QAEjBC,EAAUC,uBAAuBF,GAEjCG,EAAa,EAAQ,QAIrBC,EAAaF,uBAFD,EAAQ,SAIpBG,EAAW,EAAQ,QAEnBC,EAAkB,EAAQ,QAI1BC,EAAkBL,uBAFD,EAAQ,SAMzBM,EAASN,uBAFD,EAAQ,SAIpB,SAASA,uBAAuB3hB,GAAO,OAAOA,GAAOA,EAAIkiB,WAAaliB,EAAM,CAAEoR,QAASpR,GAQvF,IAAImiB,EAAe,SAASA,aAAaC,GACvC,OAAOA,SAKLC,EAAY,SAAUC,GAGxB,SAASD,UAAUnB,IAfrB,SAASqB,gBAAgB5hB,EAAU2gB,GAAe,KAAM3gB,aAAoB2gB,GAAgB,MAAM,IAAIkB,UAAU,qCAgB5GD,CAAgBn5B,KAAMi5B,WAEtB,IAAII,EAhBR,SAASC,2BAA2BnjB,EAAM5T,GAAQ,IAAK4T,EAAQ,MAAM,IAAIojB,eAAe,6DAAgE,OAAOh3B,GAAyB,iBAATA,GAAqC,mBAATA,EAA8B4T,EAAP5T,EAgBlN+2B,CAA2Bt5B,MAAOi5B,UAAUz2B,WAAakB,OAAO81B,eAAeP,YAAY12B,KAAKvC,KAAM83B,IAgBlH,OAdAuB,EAAMvjB,MAAQ,CACZ2jB,YAAY,EACZT,UAAU,EACVU,WAAW,EACXC,IAAK7B,EAAMrB,MAAMkD,IACjBC,QAAS9B,EAAMrB,MAAMkD,IACrBE,WAAW,GAGbR,EAAMS,eAAiBT,EAAMS,eAAe7P,KAAKoP,GACjDA,EAAMU,YAAcV,EAAMU,YAAY9P,KAAKoP,GAC3CA,EAAMW,iBAAmBX,EAAMW,iBAAiB/P,KAAKoP,GACrDA,EAAMY,cAAgBZ,EAAMY,cAAchQ,KAAKoP,GAC/CA,EAAMa,YAAcb,EAAMa,YAAYjQ,KAAKoP,GACpCA,EA8PT,OA5RF,SAASc,UAAUC,EAAUC,GAAc,GAA0B,mBAAfA,GAA4C,OAAfA,EAAuB,MAAM,IAAIjB,UAAU,kEAAoEiB,GAAeD,EAASh6B,UAAYsD,OAAOC,OAAO02B,GAAcA,EAAWj6B,UAAW,CAAEwD,YAAa,CAAE/G,MAAOu9B,EAAUpC,YAAY,EAAOC,UAAU,EAAM7zB,cAAc,KAAei2B,IAAY32B,OAAO42B,eAAiB52B,OAAO42B,eAAeF,EAAUC,GAAcD,EAAS53B,UAAY63B,GAS/dF,CAAUlB,UAAWC,GAwBrBrB,EAAaoB,UAAW,CAAC,CACvBx8B,IAAK,qBAULI,MAAO,SAAS09B,mBAAmBC,EAAWC,GAC5C,IAAK1B,EAAayB,EAAUxB,WAAaD,EAAa/4B,KAAK83B,MAAMkB,UAC/D,MAAM,IAAI12B,MAAMm2B,EAAWzQ,QAAQsO,OAAOE,cACrC,GAAIuC,EAAayB,EAAUxB,YAAcD,EAAa/4B,KAAK83B,MAAMkB,UACtE,MAAM,IAAI12B,MAAMm2B,EAAWzQ,QAAQsO,OAAOC,YAG5C,IAAImE,EAAe3B,EAAayB,EAAUxB,UAAYwB,EAAUxB,SAAWyB,EAAUzB,SACjFA,EAAWD,EAAa/4B,KAAK83B,MAAMkB,UAAYh5B,KAAK83B,MAAMkB,SAAWh5B,KAAK8V,MAAMkjB,SAChF0B,IAAiB1B,IAAaA,GAAYh5B,KAAK26B,gBACjD36B,KAAK26B,eAAeC,OAAO,CAAEC,OAAO,MAGvC,CACDp+B,IAAK,SACLI,MAAO,SAASi+B,SACd,IAAIC,EAAS/6B,KAETg7B,EAASh7B,KAAK83B,MACdmD,EAAgBD,EAAOC,cACvBxE,EAAQuE,EAAOvE,MACfyE,EAAgBF,EAAOhC,SACvBmC,EAA4BH,EAAOG,0BACnCxE,EAAYqE,EAAOrE,UACnByE,EAAaJ,EAAOI,WACpBC,EAASr7B,KAAK8V,MACd2jB,EAAa4B,EAAO5B,WACpB6B,EAAgBD,EAAOrC,SACvBW,EAAM0B,EAAO1B,IACbE,EAAYwB,EAAOxB,UAWnB/wB,EAAQ4uB,EAAS,IAAK+B,GAAc,CAAE8B,SA/ExB,GA+EuD9E,EAAO,CAAEkD,IAAKA,EAAKxqB,MAAOnP,KAAKw7B,mBAAqB/B,GAAc,CACzIgC,YAAaz7B,KAAK07B,cAClBC,QAAS37B,KAAKk6B,YACd0B,UAAW57B,KAAK85B,iBAEdd,EAAWD,EAAamC,GAAiBA,EAAgBI,EAE7D,OAAOhD,EAAQtQ,QAAQ6N,cACrBwC,EAAO9a,SACP,KACA+a,EAAQtQ,QAAQ6N,cAAc,MAAO6B,EAAS,GAAI5uB,EAAO,CACvDrM,IAAK,QACLqV,IAAK,SAASA,IAAI+pB,GAChBd,EAAOtE,MAAQoF,GAEjBC,OAAQ97B,KAAK+5B,YACbgC,QAAS/7B,KAAKg6B,oBAEhBh6B,KAAKy2B,QAAUuC,GAAYa,GAAavB,EAAQtQ,QAAQ6N,cACtD+C,EAAgB5Q,QAChB,CACEvrB,IAAK,SACLqV,IAAK,SAASA,IAAInK,GAChBozB,EAAOJ,eAAiBhzB,GAE1Bq0B,kBAAmBh8B,KAAKi8B,wBACxBC,wBAAyBl8B,KAAKm8B,uBAEhC7D,EAAQtQ,QAAQ6N,cAAcgD,EAAO7Q,QAAS,CAC5CiT,cAAeA,EACfxE,MAAOz2B,KAAKy2B,MACZ0E,0BAA2BA,EAC3BxE,UAAWA,EACXyE,WAAYzT,OAAOyT,GACnBgB,SAAUp8B,KAAKi6B,iBAEf,QAaP,CACDx9B,IAAK,+BACLI,MAAO,SAASw/B,+BACd,IAAIC,EAAUt8B,KAAK83B,MACfqD,EAA4BmB,EAAQnB,0BACpCxE,EAAY2F,EAAQ3F,UAEpB8C,EAAa0B,IAA8BxE,IAAa,EAAI+B,EAAS6D,gBAAgBv8B,KAAKy2B,OAE9Fz2B,KAAKw8B,SAAS,CAAE/C,WAAYA,MAE7B,CACDh9B,IAAK,iBACLI,MAAO,SAAS2+B,iBACd,IAAIiB,EAAUz8B,KAAK83B,MACfmD,EAAgBwB,EAAQxB,cACxBxE,EAAQgG,EAAQhG,MAChBiG,EAAYD,EAAQzD,SACpB2D,EAAU38B,KAAK8V,MACf2jB,EAAakD,EAAQlD,WACrBmD,EAAaD,EAAQ3D,SACrBa,EAAY8C,EAAQ9C,UAGpBgD,EAAWD,GAAcF,GAAa7C,EAE1C,OAAOnC,EAAS,GAAIe,EAAWzQ,QAAQyC,OAAOgM,MAAOoG,GAAY,CAAEC,WAAY,UAAY7B,EAAcxE,MAAOA,EAAMtnB,MAAOsqB,GAAc,CAAE/C,OAAQ,cAStJ,CACDj6B,IAAK,cACLI,MAAO,SAASk9B,YAAY5zB,GAC1BnG,KAAKq8B,gCAEIr8B,KAAK83B,MAAMrB,MAAMqF,QAAUiB,SAAS38B,WAC1C+F,KAEJ,CACD1J,IAAK,mBACLI,MAAO,SAASm9B,iBAAiB7zB,GAC/BnG,KAAKw8B,SAAS,CAAE/C,YAAY,KAEnBz5B,KAAK83B,MAAMrB,MAAMsF,SAAWgB,SAAS38B,WAC3C+F,KAEJ,CACD1J,IAAK,iBACLI,MAAO,SAASi9B,eAAe3zB,IACzB,EAAIwyB,EAAgBqE,sBAAsB72B,KAC5CA,EAAE82B,iBACFj9B,KAAKk6B,YAAY/zB,MAGpB,CACD1J,IAAK,gBACLI,MAAO,SAAS6+B,cAAcv1B,GAC5BA,EAAE82B,mBAEH,CACDxgC,IAAK,cACLI,MAAO,SAASq9B,YAAY/zB,IACrB4yB,EAAa/4B,KAAK83B,MAAMkB,WAAah5B,KAAK83B,MAAMoF,iBAAiB/2B,GACpEnG,KAAKw8B,SAAS,CAAExD,UAAU,GAAQh5B,KAAK83B,MAAMqF,QAE7Cn9B,KAAK83B,MAAMqF,WAad,CACD1gC,IAAK,gBACLI,MAAO,SAASo9B,cAAcN,EAAKyD,GACjC,IAAIC,EAASr9B,KAEb,OAAO,WACL,IAAIs9B,EAAU5F,EAAS,CAAEsB,UAAU,EAAOa,WAAW,GAASwD,EAAOvF,MAAMyF,oBAAsB,CAAE5D,IAAKA,IAExG0D,EAAOb,SAASc,EAASD,EAAOvF,MAAMsE,UAElCgB,GAAgBC,EAAOlB,uBACzBkB,EAAO5G,MAAM+G,WAIlB,CACD/gC,IAAK,wBACLI,MAAO,SAASo/B,wBACd,OAAOlD,EAAa/4B,KAAK83B,MAAMkB,UAAYh5B,KAAK83B,MAAMsE,SAAW,OAElE,CACD3/B,IAAK,sBACLI,MAAO,SAASs/B,sBACd,OAAOn8B,KAAKy2B,QAzOQ,IAyOCz2B,KAAKy2B,MAAM8E,YAEhC,CAAC,CACH9+B,IAAK,2BACLI,MAAO,SAAS4gC,yBAAyB3F,EAAOhiB,GAO9C,IAAI+jB,EAAY/jB,EAAM4jB,YAAc5B,EAAMkB,UAAYljB,EAAM+jB,UAI5D,MAAO,CACLF,IAHQ7B,EAAMrB,MAAMkD,MAAQ7jB,EAAM8jB,QAAU9B,EAAMrB,MAAMkD,IAAM7jB,EAAM6jB,IAIpEE,UAAWA,EAEXH,UAAW5B,EAAMkB,SACjBY,QAAS9B,EAAMrB,MAAMkD,OAGxB,CACDl9B,IAAK,eACLwC,IAAK,SAASA,MACZ,MAAO,CACLs+B,oBAAoB,EACpBpC,2BAA2B,EAC3BC,WAAY,GACZH,cAAe,CACbhE,cAAe,GACfK,QAAS,GACTb,MAAO,GACPE,UAAW,IAEbuG,iBAAkB,SAASA,mBACzB,OAAO,GAETC,OAAQ,SAASA,WACjBf,SAAU,SAASA,kBAKlBnD,UApRO,CAqRdZ,EAAOqF,WAETpoB,EAAQ0S,QAAUiR,EAGlBA,EAAU0E,UAAY,CACpBlH,OAAO,EAAI+B,EAAWoF,OAAO,CAC3BjE,IAAKnB,EAAWvU,OAAO8E,WACvB8U,IAAKrF,EAAWvU,OAChB6Z,UAAWtF,EAAWvU,OACtB9U,MAAOqpB,EAAWh0B,SACjBukB,WACH4N,WAAW,EAAI6B,EAAWoF,OAAO,CAC/BjE,IAAKnB,EAAWvU,OAChB4Z,IAAKrF,EAAWvU,OAChB6Z,UAAWtF,EAAWvU,OACtB9U,MAAOqpB,EAAWh0B,SAEpBy2B,cAAezC,EAAWh0B,OAC1Bw0B,SAAUR,EAAWuF,KACrBb,iBAAkB1E,EAAWwF,KAC7BT,mBAAoB/E,EAAWuF,KAC/B5C,0BAA2B3C,EAAWuF,KACtCZ,OAAQ3E,EAAWwF,KACnB5B,SAAU5D,EAAWwF,O,kCCzVvBt6B,OAAO2yB,eAAe/gB,EAAS,aAAc,CAC3CzY,OAAO,IAGT,IAAI66B,EAAWh0B,OAAOi0B,QAAU,SAAU7rB,GAAU,IAAK,IAAIhN,EAAI,EAAGA,EAAIqW,UAAUtW,OAAQC,IAAK,CAAE,IAAI84B,EAASziB,UAAUrW,GAAI,IAAK,IAAIrC,KAAOm7B,EAAcl0B,OAAOtD,UAAUiX,eAAe9U,KAAKq1B,EAAQn7B,KAAQqP,EAAOrP,GAAOm7B,EAAOn7B,IAAY,OAAOqP,GAEnP+rB,EAAe,WAAc,SAAS/yB,iBAAiBgH,EAAQgsB,GAAS,IAAK,IAAIh5B,EAAI,EAAGA,EAAIg5B,EAAMj5B,OAAQC,IAAK,CAAE,IAAIi5B,EAAaD,EAAMh5B,GAAIi5B,EAAWC,WAAaD,EAAWC,aAAc,EAAOD,EAAW3zB,cAAe,EAAU,UAAW2zB,IAAYA,EAAWE,UAAW,GAAMv0B,OAAO2yB,eAAevqB,EAAQisB,EAAWt7B,IAAKs7B,IAAiB,OAAO,SAAUG,EAAaC,EAAYC,GAAiJ,OAA9HD,GAAYrzB,iBAAiBozB,EAAY93B,UAAW+3B,GAAiBC,GAAatzB,iBAAiBozB,EAAaE,GAAqBF,GAA7gB,GAEfG,EAAS,EAAQ,QAEjBC,EAAUC,uBAAuBF,GAEjCG,EAAa,EAAQ,QAIrBC,EAAaF,uBAFD,EAAQ,SAIpBG,EAAW,EAAQ,QAInBuF,EAAY1F,uBAFD,EAAQ,SAIvB,SAASA,uBAAuB3hB,GAAO,OAAOA,GAAOA,EAAIkiB,WAAaliB,EAAM,CAAEoR,QAASpR,GAoBvF,IAAIsnB,EAAO,SAAUhF,GAGnB,SAASgF,KAAKpG,IAnBhB,SAASqB,gBAAgB5hB,EAAU2gB,GAAe,KAAM3gB,aAAoB2gB,GAAgB,MAAM,IAAIkB,UAAU,qCAoB5GD,CAAgBn5B,KAAMk+B,MAEtB,IAAI7E,EApBR,SAASC,2BAA2BnjB,EAAM5T,GAAQ,IAAK4T,EAAQ,MAAM,IAAIojB,eAAe,6DAAgE,OAAOh3B,GAAyB,iBAATA,GAAqC,mBAATA,EAA8B4T,EAAP5T,EAoBlN+2B,CAA2Bt5B,MAAOk+B,KAAK17B,WAAakB,OAAO81B,eAAe0E,OAAO37B,KAAKvC,KAAM83B,IAWxG,OATAuB,EAAMvjB,MAAQ,CACZqoB,WAAW,EACXnF,UAAU,EACVW,IAAK7B,EAAMrB,MAAM2H,YAActG,EAAMrB,MAAMkD,IAC3C0E,OAAQ,MAGVhF,EAAMuB,OAASvB,EAAMuB,OAAO3Q,KAAKoP,GACjCA,EAAMiF,iBAAmBjF,EAAMiF,iBAAiBrU,KAAKoP,GAC9CA,EAqIT,OAlKF,SAASc,UAAUC,EAAUC,GAAc,GAA0B,mBAAfA,GAA4C,OAAfA,EAAuB,MAAM,IAAIjB,UAAU,kEAAoEiB,GAAeD,EAASh6B,UAAYsD,OAAOC,OAAO02B,GAAcA,EAAWj6B,UAAW,CAAEwD,YAAa,CAAE/G,MAAOu9B,EAAUpC,YAAY,EAAOC,UAAU,EAAM7zB,cAAc,KAAei2B,IAAY32B,OAAO42B,eAAiB52B,OAAO42B,eAAeF,EAAUC,GAAcD,EAAS53B,UAAY63B,GAa/dF,CAAU+D,KAAMhF,GAmBhBrB,EAAaqG,KAAM,CAAC,CAClBzhC,IAAK,oBACLI,MAAO,SAAS0hC,oBACd,IAAIC,EAAmBx+B,KAAK83B,MAAMnB,UAC9BgD,EAAM6E,EAAiB7E,IACvB8E,EAASD,EAAiBC,OAG9Bz+B,KAAKw8B,SAAS,CAAE2B,WAAW,KAEvBxE,GAAO8E,KACT,EAAI/F,EAASgG,YAAY1+B,KAAK83B,MAAMnB,UAAW32B,KAAKs+B,oBAGvD,CACD7hC,IAAK,qBACLI,MAAO,SAAS09B,mBAAmBC,EAAWC,GAC5C,IAAIM,EAAS/6B,MAGRy6B,EAAU4D,QAAUr+B,KAAK8V,MAAMuoB,QAClCM,YAAW,WACT5D,EAAOyB,SAAS,CAAE7C,IAAKoB,EAAOjlB,MAAMuoB,OAAQA,OAAQ,SACnD,OAGN,CACD5hC,IAAK,SACLI,MAAO,SAASi+B,SACd,IAAIE,EAASh7B,KAAK83B,MACdmD,EAAgBD,EAAOC,cACvBtE,EAAYqE,EAAOrE,UACnB0E,EAASr7B,KAAK8V,MACduoB,EAAShD,EAAOgD,OAChBrF,EAAWqC,EAAOrC,SAClBW,EAAM0B,EAAO1B,IAGbxqB,EAAQnP,KAAK4+B,qBAEjB,OAAOtG,EAAQtQ,QAAQ6N,cACrB,MACA,CAAE1mB,MAAOnP,KAAK6+B,0BACdvG,EAAQtQ,QAAQ6N,cAAcoI,EAAUjW,QAAS,CAAE8W,UAAW9F,EAAUiC,cAAeA,IACvF3C,EAAQtQ,QAAQ6N,cAAc,MAAO6B,EAAS,GAAIf,EAAW,CAAEgD,IAAKA,EAAKxqB,MAAOA,KAChFmpB,EAAQtQ,QAAQ6N,cAAckJ,EAAQrH,EAAS,GAAIf,EAAW,CAAEgD,IAAK0E,EAAQlvB,MAAOA,QAGvF,CACD1S,IAAK,SACLI,MAAO,SAAS+9B,OAAOwC,GACrB,IAAIhB,EAAWp8B,KAAK83B,MAAMsE,SAASp8B,KAAK8V,MAAM6jB,IAAKyD,GACnDp9B,KAAKw8B,SAAS,CAAExD,UAAU,IAAS,WACjC,OAAO2F,WAAWvC,EAAU3D,EAAWzQ,QAAQyP,yBAGlD,CACDh7B,IAAK,mBACLI,MAAO,SAASyhC,iBAAiBU,GAE3Bh/B,KAAK8V,MAAMkjB,UACbh5B,KAAKw8B,SAAS,CAAE6B,OAAQW,EAAIZ,YAAcY,EAAIrF,QAGjD,CACDl9B,IAAK,yBACLI,MAAO,SAASgiC,yBACd,OAAOnH,EAAS,GAAIe,EAAWzQ,QAAQyC,OAAOwM,cAAej3B,KAAK83B,MAAMmD,cAAchE,iBAEvF,CACDx6B,IAAK,qBACLI,MAAO,SAAS+hC,qBACd,IAAItC,EAAUt8B,KAAK83B,MACfrB,EAAQ6F,EAAQ7F,MAChB0E,EAA4BmB,EAAQnB,0BACpCxB,EAAM2C,EAAQ3C,IACdyB,EAAakB,EAAQlB,WAErB6D,EAAcxI,EAAMyI,wBAEpBvsB,EAAMssB,EAAYtsB,IAClBykB,EAAO6H,EAAY7H,KACnB+H,EAAQ1I,EAAM0I,MACdC,EAAS3I,EAAM2I,OACfC,EAAe5I,EAAM4I,aACrBC,EAAgB7I,EAAM6I,cAGtBnwB,EAAQ,CAAEwD,IAAKA,EAAKykB,KAAMA,EAAM+H,MAAOA,EAAOC,OAAQA,GAE1D,IAAKp/B,KAAK8V,MAAMqoB,YAAcn+B,KAAK8V,MAAMkjB,SACvC,OAAOtB,EAAS,GAAIe,EAAWzQ,QAAQyC,OAAOkM,UAAW32B,KAAK83B,MAAMmD,cAActE,UAAW32B,KAAK83B,MAAM3oB,MAAOA,GAIjH,IAAIowB,EAAY1K,SAAS2K,KAAKC,YAAc,EACxCC,EAAYxpB,OAAOypB,YAAc,EAmBjCC,EAAY,CACd9I,UAAW,gBAbIyI,GAJEN,EAAY7H,KAAO+H,EAAQ,IAiBH,QAZ1BO,GAJET,EAAYtsB,IAAMysB,EAAS,IAgBmB,iBATrDjE,IAA8BxB,GAAM,EAAIjB,EAASmH,sBAAsB,CACjFV,MAAOA,EACPC,OAAQA,EACRC,aAAcA,EACdC,cAAeA,EACflE,WAAYA,KACT,EAAI1C,EAASoH,UAAU,CAAEX,MAAOA,EAAOC,OAAQA,EAAQhE,WAAYA,KAGmB,KAG3F,OAAO1D,EAAS,GAAIe,EAAWzQ,QAAQyC,OAAOkM,UAAW32B,KAAK83B,MAAMmD,cAActE,UAAW32B,KAAK83B,MAAM3oB,MAAOA,EAAOywB,MAEtH,CAAC,CACHnjC,IAAK,eACLwC,IAAK,SAASA,MACZ,MAAO,CACL03B,UAAW,QAKVuH,KAtJE,CAuJT7F,EAAOqF,WAETpoB,EAAQ0S,QAAUkW,EAGlBA,EAAKP,UAAY,CACf1C,cAAezC,EAAWh0B,OAAOukB,WACjC0N,MAAO+B,EAAWh0B,OAAOukB,WACzBoS,0BAA2B3C,EAAWuF,KACtCpH,WAAW,EAAI6B,EAAWoF,OAAO,CAC/BjE,IAAKnB,EAAWvU,OAChB4Z,IAAKrF,EAAWvU,OAChB6Z,UAAWtF,EAAWvU,OACtB9U,MAAOqpB,EAAWh0B,SACjBukB,WACHqS,WAAY5C,EAAWuH,OAAOhX,WAC9BqT,SAAU5D,EAAWwF,KAAKjV,YAG5B,IAAIgW,EAAS,SAASA,OAAOiB,GAC3B,IAAIrG,EAAMqG,EAAKrG,IACXxqB,EAAQ6wB,EAAK7wB,MACb2oB,EA/LN,SAASmI,yBAAyBrpB,EAAKspB,GAAQ,IAAIp0B,EAAS,GAAI,IAAK,IAAIhN,KAAK8X,EAAWspB,EAAKnhC,QAAQD,IAAM,GAAkB4E,OAAOtD,UAAUiX,eAAe9U,KAAKqU,EAAK9X,KAAcgN,EAAOhN,GAAK8X,EAAI9X,IAAM,OAAOgN,EA+LrMm0B,CAAyBD,EAAM,CAAC,MAAO,UAEnD,OAAOrG,EAAMrB,EAAQtQ,QAAQ6N,cAAc,MAAO6B,EAAS,GAAII,EAAO,CAAE6B,IAAKA,EAAKxqB,MAAOgxB,EAAYhxB,MAAa,MAGhHixB,EAAW,CACbxJ,SAAU,QACVkG,WAAY,UAGVqD,EAAc,SAASA,YAAYhxB,GACrC,OAAOuoB,EAAS,GAAIvoB,EAAOixB,K,oCCtO7B,8aAGIC,EAAc38B,OAAOC,OAAO,MAI5B28B,EAAY,SAASA,UAAUC,EAASC,EAAOtgC,GAGjDF,KAAKE,OAASA,GAAU,CAAC,IAAIugC,EAAeF,EAAQvyB,IAAIwyB,GAAQD,EAAQh6B,IAAIi6B,KAI5ExgC,KAAKugC,QAAUA,EAIfvgC,KAAKwgC,MAAQA,GAGXt8B,EAAqB,CAAEw8B,OAAQ,CAAEt8B,cAAc,GAAO8pB,KAAM,CAAE9pB,cAAc,GAAOnC,KAAM,CAAEmC,cAAc,GAAOlC,GAAI,CAAEkC,cAAc,GAAOkD,MAAO,CAAElD,cAAc,GAAOqE,IAAK,CAAErE,cAAc,GAAOvC,MAAO,CAAEuC,cAAc,IAIhOF,EAAmBw8B,OAAOzhC,IAAM,WAAc,OAAOe,KAAKugC,QAAQ1gC,KAIlEqE,EAAmBgqB,KAAKjvB,IAAM,WAAc,OAAOe,KAAKwgC,MAAM3gC,KAI9DqE,EAAmBjC,KAAKhD,IAAM,WAAc,OAAOe,KAAKsH,MAAMzH,KAI9DqE,EAAmBhC,GAAGjD,IAAM,WAAc,OAAOe,KAAKyI,IAAI5I,KAI1DqE,EAAmBoD,MAAMrI,IAAM,WAC7B,OAAOe,KAAKE,OAAO,GAAGoH,OAKxBpD,EAAmBuE,IAAIxJ,IAAM,WAC3B,OAAOe,KAAKE,OAAO,GAAGuI,KAKxBvE,EAAmBrC,MAAM5C,IAAM,WAE7B,IADA,IAAIiB,EAASF,KAAKE,OACTpB,EAAI,EAAGA,EAAIoB,EAAOrB,OAAQC,IAC/B,GAAIoB,EAAOpB,GAAGwI,MAAMzH,KAAOK,EAAOpB,GAAG2J,IAAI5I,IAAO,OAAO,EAC3D,OAAO,GAYTygC,EAAUlgC,UAAUwG,QAAU,SAASA,UACrC,OAAO5G,KAAKsH,MAAMK,KAAK,GAAGlF,MAAMzC,KAAKiC,KAAMjC,KAAKkC,IAAI,IAMtDo+B,EAAUlgC,UAAU8F,QAAU,SAASA,QAASy6B,EAAI/5B,QAC/B,IAAZA,IAAqBA,EAAU,QAAM/E,OAM5C,IADA,IAAI++B,EAAWh6B,EAAQA,QAAQyJ,UAAWwwB,EAAa,KAC9C/hC,EAAI,EAAGA,EAAI8H,EAAQH,QAAS3H,IACnC+hC,EAAaD,EACbA,EAAWA,EAASvwB,UAItB,IADA,IAAI7D,EAAUm0B,EAAG38B,MAAMnF,OAAQqB,EAASF,KAAKE,OACpC2P,EAAM,EAAGA,EAAM3P,EAAOrB,OAAQgR,IAAO,CAC5C,IAAIiC,EAAM5R,EAAO2P,GACXvI,EAAQwK,EAAIxK,MACZmB,EAAMqJ,EAAIrJ,IACV1F,EAAU49B,EAAG59B,QAAQN,MAAM+J,GACjCm0B,EAAG3tB,aAAajQ,EAAQvE,IAAI8I,EAAMzH,KAAMkD,EAAQvE,IAAIiK,EAAI5I,KAAMgQ,EAAM,QAAMhO,MAAQ+E,GACvE,GAAPiJ,GACAixB,wBAAwBH,EAAIn0B,GAAUo0B,EAAWA,EAASj1B,SAAWk1B,GAAcA,EAAW11B,cAAgB,EAAI,KAO1Hm1B,EAAUlgC,UAAUgN,YAAc,SAASA,YAAauzB,EAAIh5B,GAE1D,IADA,IAAI6E,EAAUm0B,EAAG38B,MAAMnF,OAAQqB,EAASF,KAAKE,OACpCpB,EAAI,EAAGA,EAAIoB,EAAOrB,OAAQC,IAAK,CACtC,IAAIgT,EAAM5R,EAAOpB,GACXwI,EAAQwK,EAAIxK,MACZmB,EAAMqJ,EAAIrJ,IACV1F,EAAU49B,EAAG59B,QAAQN,MAAM+J,GAC7BvK,EAAOc,EAAQvE,IAAI8I,EAAMzH,KAAMqC,EAAKa,EAAQvE,IAAIiK,EAAI5I,KACpDf,EACF6hC,EAAG1tB,YAAYhR,EAAMC,IAErBy+B,EAAG9sB,iBAAiB5R,EAAMC,EAAIyF,GAC9Bm5B,wBAAwBH,EAAIn0B,EAAS7E,EAAKgE,UAAY,EAAI,MAiBhE20B,EAAUS,SAAW,SAASA,SAAU/2B,EAAMkB,EAAK81B,GACjD,IAAI33B,EAAQW,EAAK3B,OAAOyZ,cAAgB,IAAImf,EAAcj3B,GACpDk3B,gBAAgBl3B,EAAKrC,KAAK,GAAIqC,EAAK3B,OAAQ2B,EAAKnK,IAAKmK,EAAK1J,QAAS4K,EAAK81B,GAC9E,GAAI33B,EAAS,OAAOA,EAEpB,IAAK,IAAI5B,EAAQuC,EAAKvC,MAAQ,EAAGA,GAAS,EAAGA,IAAS,CACpD,IAAIyH,EAAQhE,EAAM,EACZg2B,gBAAgBl3B,EAAKrC,KAAK,GAAIqC,EAAKrC,KAAKF,GAAQuC,EAAK7F,OAAOsD,EAAQ,GAAIuC,EAAK1J,MAAMmH,GAAQyD,EAAK81B,GAChGE,gBAAgBl3B,EAAKrC,KAAK,GAAIqC,EAAKrC,KAAKF,GAAQuC,EAAKO,MAAM9C,EAAQ,GAAIuC,EAAK1J,MAAMmH,GAAS,EAAGyD,EAAK81B,GACzG,GAAI9xB,EAAS,OAAOA,IAQxBoxB,EAAUa,KAAO,SAASA,KAAMn3B,EAAMsB,GAGpC,YAFgB,IAATA,IAAkBA,EAAO,GAEzBtL,KAAK+gC,SAAS/2B,EAAMsB,IAAStL,KAAK+gC,SAAS/2B,GAAOsB,IAAS,IAAI81B,EAAap3B,EAAKrC,KAAK,KAQ/F24B,EAAUe,QAAU,SAASA,QAASt9B,GACpC,OAAOm9B,gBAAgBn9B,EAAKA,EAAK,EAAG,EAAG,IAAM,IAAIq9B,EAAar9B,IAMhEu8B,EAAUgB,MAAQ,SAASA,MAAOv9B,GAChC,OAAOm9B,gBAAgBn9B,EAAKA,EAAKA,EAAI6C,QAAQlK,KAAMqH,EAAI6D,YAAa,IAAM,IAAIw5B,EAAar9B,IAM7Fu8B,EAAUh7B,SAAW,SAASA,SAAUvB,EAAKyB,GAC3C,IAAKA,IAASA,EAAKG,KAAQ,MAAM,IAAID,WAAW,wCAChD,IAAI67B,EAAMlB,EAAY76B,EAAKG,MAC3B,IAAK47B,EAAO,MAAM,IAAI77B,WAAY,qBAAwBF,EAAS,KAAI,YACvE,OAAO+7B,EAAIj8B,SAASvB,EAAKyB,IAQ3B86B,EAAU16B,OAAS,SAASA,OAAQxK,EAAIomC,GACtC,GAAIpmC,KAAMilC,EAAe,MAAM,IAAI36B,WAAW,sCAAwCtK,GAGtF,OAFAilC,EAAYjlC,GAAMomC,EAClBA,EAAephC,UAAUwF,OAASxK,EAC3BomC,GAWTlB,EAAUlgC,UAAUqhC,YAAc,SAASA,cACzC,OAAOR,EAAcS,QAAQ1hC,KAAKugC,QAASvgC,KAAKwgC,OAAOiB,eAGzD/9B,OAAOoB,iBAAkBw7B,EAAUlgC,UAAW8D,GAM9Co8B,EAAUlgC,UAAUuhC,SAAU,EAiB9B,IAAIlB,EAAiB,SAASA,eAAen5B,EAAOmB,GAGlDzI,KAAKsH,MAAQA,EAGbtH,KAAKyI,IAAMA,GAOTw4B,EAA8B,SAAUX,GAC1C,SAASW,cAAcV,EAASC,QACf,IAAVA,IAAmBA,EAAQD,GAEhCD,EAAU/9B,KAAKvC,KAAMugC,EAASC,GAG3BF,IAAYW,cAAcz+B,UAAY89B,GAC3CW,cAAc7gC,UAAYsD,OAAOC,OAAQ28B,GAAaA,EAAUlgC,WAChE6gC,cAAc7gC,UAAUwD,YAAcq9B,cAEtC,IAAIhxB,EAAuB,CAAE2xB,QAAS,CAAEx9B,cAAc,IA+EtD,OA1EA6L,EAAqB2xB,QAAQ3iC,IAAM,WAAc,OAAOe,KAAKugC,QAAQ1gC,KAAOG,KAAKwgC,MAAM3gC,IAAMG,KAAKwgC,MAAQ,MAE1GS,cAAc7gC,UAAU5B,IAAM,SAASA,IAAKuF,EAAKhB,GAC/C,IAAIy9B,EAAQz8B,EAAIwD,QAAQxE,EAAQvE,IAAIwB,KAAKkuB,OACzC,IAAKsS,EAAMn4B,OAAOyZ,cAAiB,OAAOwe,EAAUa,KAAKX,GACzD,IAAID,EAAUx8B,EAAIwD,QAAQxE,EAAQvE,IAAIwB,KAAK0gC,SAC3C,OAAO,IAAIO,cAAcV,EAAQl4B,OAAOyZ,cAAgBye,EAAUC,EAAOA,IAG3ES,cAAc7gC,UAAU8F,QAAU,SAASA,QAASy6B,EAAI/5B,GAItD,QAHiB,IAAZA,IAAqBA,EAAU,QAAM/E,OAE1Cy+B,EAAUlgC,UAAU8F,QAAQ3D,KAAKvC,KAAM2gC,EAAI/5B,GACvCA,GAAW,QAAM/E,MAAO,CAC1B,IAAImL,EAAQhN,KAAKsH,MAAMqa,YAAY3hB,KAAKyI,KACpCuE,GAAS2zB,EAAGkB,YAAY70B,KAIhCi0B,cAAc7gC,UAAU2N,GAAK,SAASA,GAAIvH,GACxC,OAAOA,aAAiBy6B,eAAiBz6B,EAAMk6B,QAAU1gC,KAAK0gC,QAAUl6B,EAAM0nB,MAAQluB,KAAKkuB,MAG7F+S,cAAc7gC,UAAUqhC,YAAc,SAASA,cAC7C,OAAO,IAAIK,EAAa9hC,KAAK0gC,OAAQ1gC,KAAKkuB,OAG5C+S,cAAc7gC,UAAUiF,OAAS,SAASA,SACxC,MAAO,CAACM,KAAM,OAAQ+6B,OAAQ1gC,KAAK0gC,OAAQxS,KAAMluB,KAAKkuB,OAGxD+S,cAAc37B,SAAW,SAASA,SAAUvB,EAAKyB,GAC/C,GAA0B,iBAAfA,EAAKk7B,QAA0C,iBAAbl7B,EAAK0oB,KAC9C,MAAM,IAAIxoB,WAAW,4CACzB,OAAO,IAAIu7B,cAAcl9B,EAAIwD,QAAQ/B,EAAKk7B,QAAS38B,EAAIwD,QAAQ/B,EAAK0oB,QAKtE+S,cAAct9B,OAAS,SAASA,OAAQI,EAAK28B,EAAQxS,QACrC,IAATA,IAAkBA,EAAOwS,GAE9B,IAAIH,EAAUx8B,EAAIwD,QAAQm5B,GAC1B,OAAO,IAAI1gC,KAAKugC,EAASrS,GAAQwS,EAASH,EAAUx8B,EAAIwD,QAAQ2mB,KAUlE+S,cAAcS,QAAU,SAASA,QAASnB,EAASC,EAAOl1B,GACxD,IAAIy2B,EAAOxB,EAAQ1gC,IAAM2gC,EAAM3gC,IAE/B,GADKyL,IAAQy2B,IAAQz2B,EAAOy2B,GAAQ,EAAI,GAAK,IACxCvB,EAAMn4B,OAAOyZ,cAAe,CAC/B,IAAI5S,EAAQoxB,EAAUS,SAASP,EAAOl1B,GAAM,IAASg1B,EAAUS,SAASP,GAAQl1B,GAAM,GACtF,IAAI4D,EACG,OAAOoxB,EAAUa,KAAKX,EAAOl1B,GADvBk1B,EAAQtxB,EAAMsxB,MAW7B,OARKD,EAAQl4B,OAAOyZ,gBACN,GAARigB,IAGFxB,GAAWD,EAAUS,SAASR,GAAUj1B,GAAM,IAASg1B,EAAUS,SAASR,EAASj1B,GAAM,IAAOi1B,SACnF1gC,IAAM2gC,EAAM3gC,KAASkiC,EAAO,KAHzCxB,EAAUC,GAMP,IAAIS,cAAcV,EAASC,IAGpC98B,OAAOoB,iBAAkBm8B,cAAc7gC,UAAW6P,GAE3CgxB,cA1FwB,CA2F/BX,GAEFA,EAAU16B,OAAO,OAAQq7B,GAEzB,IAAIa,EAAe,SAASA,aAAapB,EAAQxS,GAC/CluB,KAAK0gC,OAASA,EACd1gC,KAAKkuB,KAAOA,GAEd4T,EAAa1hC,UAAU5B,IAAM,SAASA,IAAKuE,GACzC,OAAO,IAAI++B,EAAa/+B,EAAQvE,IAAIwB,KAAK0gC,QAAS39B,EAAQvE,IAAIwB,KAAKkuB,QAErE4T,EAAa1hC,UAAUmH,QAAU,SAASA,QAASxD,GACjD,OAAOk9B,EAAcS,QAAQ39B,EAAIwD,QAAQvH,KAAK0gC,QAAS38B,EAAIwD,QAAQvH,KAAKkuB,QAQ1E,IAAI8T,EAA8B,SAAU1B,GAC1C,SAAS0B,cAAch4B,GACrB,IAAIrC,EAAOqC,EAAKa,UACZgW,EAAO7W,EAAKrC,KAAK,GAAGJ,QAAQyC,EAAKnK,IAAM8H,EAAKoF,UAChDuzB,EAAU/9B,KAAKvC,KAAMgK,EAAM6W,GAE3B7gB,KAAK2H,KAAOA,EAiDd,OA9CK24B,IAAY0B,cAAcx/B,UAAY89B,GAC3C0B,cAAc5hC,UAAYsD,OAAOC,OAAQ28B,GAAaA,EAAUlgC,WAChE4hC,cAAc5hC,UAAUwD,YAAco+B,cAEtCA,cAAc5hC,UAAU5B,IAAM,SAASA,IAAKuF,EAAKhB,GAC/C,IAAI+O,EAAM/O,EAAQvC,UAAUR,KAAK0gC,QAC7B5gC,EAAUgS,EAAIhS,QACdD,EAAMiS,EAAIjS,IACVmK,EAAOjG,EAAIwD,QAAQ1H,GACvB,OAAIC,EAAkBwgC,EAAUa,KAAKn3B,GAC9B,IAAIg4B,cAAch4B,IAG3Bg4B,cAAc5hC,UAAUwG,QAAU,SAASA,UACzC,OAAO,IAAI,QAAM,WAAS3E,KAAKjC,KAAK2H,MAAO,EAAG,IAGhDq6B,cAAc5hC,UAAU2N,GAAK,SAASA,GAAIvH,GACxC,OAAOA,aAAiBw7B,eAAiBx7B,EAAMk6B,QAAU1gC,KAAK0gC,QAGhEsB,cAAc5hC,UAAUiF,OAAS,SAASA,SACxC,MAAO,CAACM,KAAM,OAAQ+6B,OAAQ1gC,KAAK0gC,SAGrCsB,cAAc5hC,UAAUqhC,YAAc,SAASA,cAAiB,OAAO,IAAIQ,EAAajiC,KAAK0gC,SAE7FsB,cAAc18B,SAAW,SAASA,SAAUvB,EAAKyB,GAC/C,GAA0B,iBAAfA,EAAKk7B,OACZ,MAAM,IAAIh7B,WAAW,4CACzB,OAAO,IAAIs8B,cAAcj+B,EAAIwD,QAAQ/B,EAAKk7B,UAK5CsB,cAAcr+B,OAAS,SAASA,OAAQI,EAAK9B,GAC3C,OAAO,IAAIjC,KAAK+D,EAAIwD,QAAQtF,KAM9B+/B,cAAcE,aAAe,SAASA,aAAcv6B,GAClD,OAAQA,EAAKmV,SAAwC,IAA9BnV,EAAKhC,KAAK+C,KAAKy5B,YAGjCH,cAvDwB,CAwD/B1B,GAEF0B,EAAc5hC,UAAUuhC,SAAU,EAElCrB,EAAU16B,OAAO,OAAQo8B,GAEzB,IAAIC,EAAe,SAASA,aAAavB,GACvC1gC,KAAK0gC,OAASA,GAEhBuB,EAAa7hC,UAAU5B,IAAM,SAASA,IAAKuE,GACzC,IAAI+O,EAAM/O,EAAQvC,UAAUR,KAAK0gC,QAC3B5gC,EAAUgS,EAAIhS,QACdD,EAAMiS,EAAIjS,IAChB,OAAOC,EAAU,IAAIgiC,EAAajiC,EAAKA,GAAO,IAAIoiC,EAAapiC,IAEjEoiC,EAAa7hC,UAAUmH,QAAU,SAASA,QAASxD,GACjD,IAAIiG,EAAOjG,EAAIwD,QAAQvH,KAAK0gC,QAAS/4B,EAAOqC,EAAKa,UACjD,OAAIlD,GAAQq6B,EAAcE,aAAav6B,GAAgB,IAAIq6B,EAAch4B,GAClEs2B,EAAUa,KAAKn3B,IAOxB,IAAIo3B,EAA6B,SAAUd,GACzC,SAASc,aAAar9B,GACpBu8B,EAAU/9B,KAAKvC,KAAM+D,EAAIwD,QAAQ,GAAIxD,EAAIwD,QAAQxD,EAAI6C,QAAQlK,OA6B/D,OA1BK4jC,IAAYc,aAAa5+B,UAAY89B,GAC1Cc,aAAahhC,UAAYsD,OAAOC,OAAQ28B,GAAaA,EAAUlgC,WAC/DghC,aAAahhC,UAAUwD,YAAcw9B,aAErCA,aAAahhC,UAAU8F,QAAU,SAASA,QAASy6B,EAAI/5B,GAGrD,QAFiB,IAAZA,IAAqBA,EAAU,QAAM/E,OAEtC+E,GAAW,QAAM/E,MAAO,CAC1B8+B,EAAGrkC,OAAO,EAAGqkC,EAAG58B,IAAI6C,QAAQlK,MAC5B,IAAI0lC,EAAM9B,EAAUe,QAAQV,EAAG58B,KAC1Bq+B,EAAIr0B,GAAG4yB,EAAG0B,YAAc1B,EAAG2B,aAAaF,QAE7C9B,EAAUlgC,UAAU8F,QAAQ3D,KAAKvC,KAAM2gC,EAAI/5B,IAI/Cw6B,aAAahhC,UAAUiF,OAAS,SAASA,SAAY,MAAO,CAACM,KAAM,QAEnEy7B,aAAa97B,SAAW,SAASA,SAAUvB,GAAO,OAAO,IAAIq9B,aAAar9B,IAE1Eq9B,aAAahhC,UAAU5B,IAAM,SAASA,IAAKuF,GAAO,OAAO,IAAIq9B,aAAar9B,IAE1Eq9B,aAAahhC,UAAU2N,GAAK,SAASA,GAAIvH,GAAS,OAAOA,aAAiB46B,cAE1EA,aAAahhC,UAAUqhC,YAAc,SAASA,cAAiB,OAAOc,GAE/DnB,aA/BuB,CAgC9Bd,GAEFA,EAAU16B,OAAO,MAAOw7B,GAExB,IAAImB,EAAc,CAChB/jC,IAAK,SAASA,MAAQ,OAAOwB,MAC7BuH,QAAS,SAASA,QAAQxD,GAAO,OAAO,IAAIq9B,EAAar9B,KAQ3D,SAASm9B,gBAAgBn9B,EAAK4D,EAAM9H,EAAKS,EAAO4K,EAAK6R,GACnD,GAAIpV,EAAKma,cAAiB,OAAOmf,EAAct9B,OAAOI,EAAKlE,GAC3D,IAAK,IAAIf,EAAIwB,GAAS4K,EAAM,EAAI,EAAI,GAAIA,EAAM,EAAIpM,EAAI6I,EAAKC,WAAa9I,GAAK,EAAGA,GAAKoM,EAAK,CACxF,IAAIlO,EAAQ2K,EAAK3K,MAAM8B,GACvB,GAAK9B,EAAM6lB,QAGJ,IAAK9F,GAAQilB,EAAcE,aAAallC,GAC7C,OAAOglC,EAAcr+B,OAAOI,EAAKlE,GAAOqL,EAAM,EAAIlO,EAAM+P,SAAW,QAJlD,CACjB,IAAI1D,EAAQ63B,gBAAgBn9B,EAAK/G,EAAO6C,EAAMqL,EAAKA,EAAM,EAAIlO,EAAM4K,WAAa,EAAGsD,EAAK6R,GACxF,GAAI1T,EAAS,OAAOA,EAItBxJ,GAAO7C,EAAM+P,SAAW7B,GAI5B,SAAS41B,wBAAwBH,EAAI6B,EAAUl3B,GAC7C,IAAI4I,EAAOysB,EAAG38B,MAAMnF,OAAS,EAC7B,KAAIqV,EAAOsuB,GAAX,CACA,IAEiCvhC,EAF7BsD,EAAOo8B,EAAG38B,MAAMkQ,GACpB,GAAM3P,aAAgB,KAAeA,aAAgB,IAC3Co8B,EAAG59B,QAAQhB,KAAKmS,GACtB/X,SAAQ,SAAUsmC,EAAOC,EAAKC,EAAUC,GAAoB,MAAP3hC,IAAeA,EAAM2hC,MAC9EjC,EAAG2B,aAAahC,EAAUa,KAAKR,EAAG58B,IAAIwD,QAAQtG,GAAMqK,KAGtD,IAmBIu3B,EAA4B,SAAU/+B,GACxC,SAAS++B,YAAY/sB,GACnBhS,EAAUvB,KAAKvC,KAAM8V,EAAM/R,KAI3B/D,KAAK8iC,KAAOC,KAAKC,MACjBhjC,KAAKijC,aAAentB,EAAMusB,UAE1BriC,KAAKkjC,gBAAkB,EAGvBljC,KAAKmjC,YAAcrtB,EAAMqtB,YAGzBnjC,KAAKojC,QAAU,EAEfpjC,KAAKqjC,KAAO3/B,OAAOC,OAAO,MAGvBG,IAAY++B,YAAYrgC,UAAYsB,GACzC++B,YAAYziC,UAAYsD,OAAOC,OAAQG,GAAaA,EAAU1D,WAC9DyiC,YAAYziC,UAAUwD,YAAci/B,YAEpC,IAAI3+B,EAAqB,CAAEm+B,UAAW,CAAEj+B,cAAc,GAAOk/B,aAAc,CAAEl/B,cAAc,GAAOm/B,eAAgB,CAAEn/B,cAAc,GAAOo/B,UAAW,CAAEp/B,cAAc,GAAOq/B,iBAAkB,CAAEr/B,cAAc,IAwK7M,OAjKAF,EAAmBm+B,UAAUpjC,IAAM,WAKjC,OAJIe,KAAKkjC,gBAAkBljC,KAAKgE,MAAMnF,SACpCmB,KAAKijC,aAAejjC,KAAKijC,aAAazkC,IAAIwB,KAAK+D,IAAK/D,KAAK+C,QAAQN,MAAMzC,KAAKkjC,kBAC5EljC,KAAKkjC,gBAAkBljC,KAAKgE,MAAMnF,QAE7BmB,KAAKijC,cAMdJ,YAAYziC,UAAUkiC,aAAe,SAASA,aAAcD,GAC1D,GAAIA,EAAU/6B,MAAMvD,KAAO/D,KAAK+D,IAC5B,MAAM,IAAI2B,WAAW,uEAKzB,OAJA1F,KAAKijC,aAAeZ,EACpBriC,KAAKkjC,gBAAkBljC,KAAKgE,MAAMnF,OAClCmB,KAAKojC,SAAyC,GAlEhC,EAkEEpjC,KAAKojC,SACrBpjC,KAAKmjC,YAAc,KACZnjC,MAKTkE,EAAmBo/B,aAAarkC,IAAM,WACpC,OA1Ec,EA0ENe,KAAKojC,SAAyB,GAKxCP,YAAYziC,UAAUsjC,eAAiB,SAASA,eAAgB12B,GAG9D,OAFAhN,KAAKmjC,YAAcn2B,EACnBhN,KAAKojC,SAjF4B,EAkF1BpjC,MAOT6iC,YAAYziC,UAAUyhC,YAAc,SAASA,YAAa70B,GAGxD,OAFK,OAAKqS,QAAQrf,KAAKmjC,aAAenjC,KAAKqiC,UAAU/6B,MAAM0F,QAASA,IAChEhN,KAAK0jC,eAAe12B,GACjBhN,MAKT6iC,YAAYziC,UAAUujC,cAAgB,SAASA,cAAel2B,GAC5D,OAAOzN,KAAK6hC,YAAYp0B,EAAKI,SAAS7N,KAAKmjC,aAAenjC,KAAKqiC,UAAU7B,MAAMxzB,WAKjF61B,YAAYziC,UAAUwjC,iBAAmB,SAASA,iBAAkBn2B,GAClE,OAAOzN,KAAK6hC,YAAYp0B,EAAKS,cAAclO,KAAKmjC,aAAenjC,KAAKqiC,UAAU7B,MAAMxzB,WAKtF9I,EAAmBq/B,eAAetkC,IAAM,WACtC,OA9GiC,EA8GzBe,KAAKojC,SAA2B,GAG1CP,YAAYziC,UAAUwE,QAAU,SAASA,QAASL,EAAMR,GACtDD,EAAU1D,UAAUwE,QAAQrC,KAAKvC,KAAMuE,EAAMR,GAC7C/D,KAAKojC,SAAyB,EAAfpjC,KAAKojC,QACpBpjC,KAAKmjC,YAAc,MAKrBN,YAAYziC,UAAUyjC,QAAU,SAASA,QAASf,GAEhD,OADA9iC,KAAK8iC,KAAOA,EACL9iC,MAKT6iC,YAAYziC,UAAU0jC,iBAAmB,SAASA,iBAAkBrhC,GAElE,OADAzC,KAAKqiC,UAAUn8B,QAAQlG,KAAMyC,GACtBzC,MAOT6iC,YAAYziC,UAAU2jC,qBAAuB,SAASA,qBAAsBp8B,EAAMq8B,GAChF,IAAI3B,EAAYriC,KAAKqiC,UAIrB,OAHqB,IAAjB2B,IACAr8B,EAAOA,EAAK8F,KAAKzN,KAAKmjC,cAAgBd,EAAUxgC,MAAQwgC,EAAU/6B,MAAM0F,QAAWq1B,EAAU/6B,MAAMqa,YAAY0gB,EAAU55B,MAAQ,OAAK8W,QAC1I8iB,EAAUj1B,YAAYpN,KAAM2H,GACrB3H,MAKT6iC,YAAYziC,UAAU6jC,gBAAkB,SAASA,kBAE/C,OADAjkC,KAAKqiC,UAAUn8B,QAAQlG,MAChBA,MAMT6iC,YAAYziC,UAAU8jC,WAAa,SAASA,WAAYnnB,EAAM9a,EAAMC,QACtD,IAAPA,IAAgBA,EAAKD,GAE1B,IAAIsD,EAASvF,KAAK+D,IAAI4B,KAAKJ,OAC3B,GAAY,MAARtD,EACF,OAAK8a,EACE/c,KAAK+jC,qBAAqBx+B,EAAOwX,KAAKA,IAAO,GADhC/c,KAAKikC,kBAGzB,IAAKlnB,EAAQ,OAAO/c,KAAKiT,YAAYhR,EAAMC,GAC3C,IAAI8K,EAAQhN,KAAKmjC,YACjB,IAAKn2B,EAAO,CACV,IAAI1F,EAAQtH,KAAK+D,IAAIwD,QAAQtF,GAC7B+K,EAAQ9K,GAAMD,EAAOqF,EAAM0F,QAAU1F,EAAMqa,YAAY3hB,KAAK+D,IAAIwD,QAAQrF,IAI1E,OAFAlC,KAAK6T,iBAAiB5R,EAAMC,EAAIqD,EAAOwX,KAAKA,EAAM/P,IAC7ChN,KAAKqiC,UAAUxgC,OAAS7B,KAAKsiC,aAAahC,EAAUa,KAAKnhC,KAAKqiC,UAAU55B,MACtEzI,MAOX6iC,YAAYziC,UAAU+jC,QAAU,SAASA,QAAS1nC,EAAKI,GAErD,OADAmD,KAAKqjC,KAAmB,iBAAP5mC,EAAkBA,EAAMA,EAAIA,KAAOI,EAC7CmD,MAKT6iC,YAAYziC,UAAUgkC,QAAU,SAASA,QAAS3nC,GAChD,OAAOuD,KAAKqjC,KAAmB,iBAAP5mC,EAAkBA,EAAMA,EAAIA,MAMtDyH,EAAmBs/B,UAAUvkC,IAAM,WACjC,IAAK,IAAIzC,KAAKwD,KAAKqjC,KAAQ,OAAO,EAClC,OAAO,GAMTR,YAAYziC,UAAUikC,eAAiB,SAASA,iBAE9C,OADArkC,KAAKojC,SAzMgD,EA0M9CpjC,MAGTkE,EAAmBu/B,iBAAiBxkC,IAAM,WACxC,OA9MqD,EA8M7Ce,KAAKojC,SAA4B,GAG3C1/B,OAAOoB,iBAAkB+9B,YAAYziC,UAAW8D,GAEzC2+B,YAhMsB,CAiM7B,KAEF,SAAS5Y,KAAK7oB,EAAG+U,GACf,OAAQA,GAAS/U,EAAQA,EAAE6oB,KAAK9T,GAAX/U,EAGvB,IAAIkjC,EAAY,SAASA,UAAUzgC,EAAM0gC,EAAMpuB,GAC7CnW,KAAK6D,KAAOA,EACZ7D,KAAKiV,KAAOgV,KAAKsa,EAAKtvB,KAAMkB,GAC5BnW,KAAK2E,MAAQslB,KAAKsa,EAAK5/B,MAAOwR,IAG5BquB,EAAa,CACf,IAAIF,EAAU,MAAO,CACnBrvB,KAAM,SAASA,KAAKwvB,GAAU,OAAOA,EAAO1gC,KAAO0gC,EAAOl/B,OAAO2kB,YAAY5D,iBAC7E3hB,MAAO,SAASA,MAAMg8B,GAAM,OAAOA,EAAG58B,OAGxC,IAAIugC,EAAU,YAAa,CACzBrvB,KAAM,SAASA,KAAKwvB,EAAQltB,GAAY,OAAOktB,EAAOpC,WAAa/B,EAAUe,QAAQ9pB,EAASxT,MAC9FY,MAAO,SAASA,MAAMg8B,GAAM,OAAOA,EAAG0B,aAGxC,IAAIiC,EAAU,cAAe,CAC3BrvB,KAAM,SAASA,KAAKwvB,GAAU,OAAOA,EAAOtB,aAAe,MAC3Dx+B,MAAO,SAASA,MAAMg8B,EAAI+D,EAAQC,EAAM7uB,GAAS,OAAOA,EAAMusB,UAAUT,QAAUjB,EAAGwC,YAAc,QAGrG,IAAImB,EAAU,oBAAqB,CACjCrvB,KAAM,SAASA,OAAS,OAAO,GAC/BtQ,MAAO,SAASA,MAAMg8B,EAAIiE,GAAQ,OAAOjE,EAAG8C,iBAAmBmB,EAAO,EAAIA,MAM1EC,EAAgB,SAASA,cAAct/B,EAAQu/B,GACjD,IAAIv4B,EAASvM,KAEbA,KAAKuF,OAASA,EACdvF,KAAK+kC,OAASP,EAAW36B,SACzB7J,KAAK8kC,QAAU,GACf9kC,KAAKglC,aAAethC,OAAOC,OAAO,MAC9BmhC,GAAWA,EAAQ3oC,SAAQ,SAAU8oC,GACvC,GAAI14B,EAAOy4B,aAAaC,EAAOxoC,KAC3B,MAAM,IAAIiJ,WAAW,iDAAmDu/B,EAAOxoC,IAAM,KACzF8P,EAAOu4B,QAAQ5mC,KAAK+mC,GACpB14B,EAAOy4B,aAAaC,EAAOxoC,KAAOwoC,EAC9BA,EAAOv8B,KAAKoN,OACZvJ,EAAOw4B,OAAO7mC,KAAK,IAAIomC,EAAUW,EAAOxoC,IAAKwoC,EAAOv8B,KAAKoN,MAAOmvB,QAWpEC,EAAc,SAASA,YAAYT,GACrCzkC,KAAKykC,OAASA,GAGZx0B,EAAuB,CAAE1K,OAAQ,CAAEnB,cAAc,GAAO0gC,QAAS,CAAE1gC,cAAc,GAAOu8B,GAAI,CAAEv8B,cAAc,IAchH6L,EAAqB1K,OAAOtG,IAAM,WAChC,OAAOe,KAAKykC,OAAOl/B,QAKrB0K,EAAqB60B,QAAQ7lC,IAAM,WACjC,OAAOe,KAAKykC,OAAOK,SAKrBI,EAAY9kC,UAAUuE,MAAQ,SAASA,MAAOg8B,GAC5C,OAAO3gC,KAAKmlC,iBAAiBxE,GAAI7qB,OAInCovB,EAAY9kC,UAAUglC,kBAAoB,SAASA,kBAAmBzE,EAAI7O,QACtD,IAAXA,IAAoBA,GAAU,GAErC,IAAK,IAAIhzB,EAAI,EAAGA,EAAIkB,KAAKykC,OAAOK,QAAQjmC,OAAQC,IAAO,GAAIA,GAAKgzB,EAAQ,CACtE,IAAImT,EAASjlC,KAAKykC,OAAOK,QAAQhmC,GACjC,GAAImmC,EAAOv8B,KAAK08B,oBAAsBH,EAAOv8B,KAAK08B,kBAAkB7iC,KAAK0iC,EAAQtE,EAAI3gC,MACjF,OAAO,EAEb,OAAO,GASTklC,EAAY9kC,UAAU+kC,iBAAmB,SAASA,iBAAkBE,GAClE,IAAKrlC,KAAKolC,kBAAkBC,GAAW,MAAO,CAACvvB,MAAO9V,KAAMslC,aAAc,IAMzE,IAJD,IAAIC,EAAM,CAACF,GAASG,EAAWxlC,KAAKylC,WAAWJ,GAASpf,EAAO,OAIrD,CAER,IADA,IAAIyf,GAAU,EACL5mC,EAAI,EAAGA,EAAIkB,KAAKykC,OAAOK,QAAQjmC,OAAQC,IAAK,CACnD,IAAImmC,EAASjlC,KAAKykC,OAAOK,QAAQhmC,GACjC,GAAImmC,EAAOv8B,KAAKi9B,kBAAmB,CACjC,IAAI/jC,EAAIqkB,EAAOA,EAAKnnB,GAAG8C,EAAI,EAAGgkC,EAAW3f,EAAOA,EAAKnnB,GAAGgX,MAAQ9V,KAC5D2gC,EAAK/+B,EAAI2jC,EAAI1mC,QACbomC,EAAOv8B,KAAKi9B,kBAAkBpjC,KAAK0iC,EAAQrjC,EAAI2jC,EAAI9iC,MAAMb,GAAK2jC,EAAKK,EAAUJ,GACjF,GAAI7E,GAAM6E,EAASJ,kBAAkBzE,EAAI7hC,GAAI,CAE3C,GADA6hC,EAAGwD,QAAQ,sBAAuBkB,IAC7Bpf,EAAM,CACTA,EAAO,GACP,IAAK,IAAI5W,EAAI,EAAGA,EAAIrP,KAAKykC,OAAOK,QAAQjmC,OAAQwQ,IAC5C4W,EAAK/nB,KAAKmR,EAAIvQ,EAAI,CAACgX,MAAO0vB,EAAU5jC,EAAG2jC,EAAI1mC,QAAU,CAACiX,MAAO9V,KAAM4B,EAAG,IAE5E2jC,EAAIrnC,KAAKyiC,GACT6E,EAAWA,EAASC,WAAW9E,GAC/B+E,GAAU,EAERzf,IAAQA,EAAKnnB,GAAK,CAACgX,MAAO0vB,EAAU5jC,EAAG2jC,EAAI1mC,UAGnD,IAAK6mC,EAAW,MAAO,CAAC5vB,MAAO0vB,EAAUF,aAAcC,KAK3DL,EAAY9kC,UAAUqlC,WAAa,SAASA,WAAY9E,GACtD,IAAKA,EAAGx8B,OAAO4J,GAAG/N,KAAK+D,KAAQ,MAAM,IAAI2B,WAAW,qCAEpD,IADA,IAAImgC,EAAc,IAAIX,EAAYllC,KAAKykC,QAASM,EAAS/kC,KAAKykC,OAAOM,OAC5DjmC,EAAI,EAAGA,EAAIimC,EAAOlmC,OAAQC,IAAK,CACtC,IAAIgnC,EAAQf,EAAOjmC,GACnB+mC,EAAYC,EAAMjiC,MAAQiiC,EAAMnhC,MAAMg8B,EAAI3gC,KAAK8lC,EAAMjiC,MAAO7D,KAAM6lC,GAEpE,IAAK,IAAIh2B,EAAM,EAAGA,EAAMk2B,EAAelnC,OAAQgR,IAASk2B,EAAel2B,GAAK7P,KAAM2gC,EAAIkF,GACtF,OAAOA,GAKT51B,EAAqB0wB,GAAG1hC,IAAM,WAAc,OAAO,IAAI4jC,EAAY7iC,OAqBnEklC,EAAYvhC,OAAS,SAASA,OAAQ8gC,GAGpC,IAFA,IAAIuB,EAAU,IAAInB,EAAcJ,EAAO1gC,IAAM0gC,EAAO1gC,IAAI4B,KAAKJ,OAASk/B,EAAOl/B,OAAQk/B,EAAOK,SACxFvtB,EAAW,IAAI2tB,EAAYc,GACtBlnC,EAAI,EAAGA,EAAIknC,EAAQjB,OAAOlmC,OAAQC,IACvCyY,EAASyuB,EAAQjB,OAAOjmC,GAAG+E,MAAQmiC,EAAQjB,OAAOjmC,GAAGmW,KAAKwvB,EAAQltB,GACtE,OAAOA,GAeT2tB,EAAY9kC,UAAU6lC,YAAc,SAASA,YAAaxB,GAGxD,IAFA,IAAIuB,EAAU,IAAInB,EAAc7kC,KAAKuF,OAAQk/B,EAAOK,SAChDC,EAASiB,EAAQjB,OAAQxtB,EAAW,IAAI2tB,EAAYc,GAC/ClnC,EAAI,EAAGA,EAAIimC,EAAOlmC,OAAQC,IAAK,CACtC,IAAI+E,EAAOkhC,EAAOjmC,GAAG+E,KACrB0T,EAAS1T,GAAQ7D,KAAKqX,eAAexT,GAAQ7D,KAAK6D,GAAQkhC,EAAOjmC,GAAGmW,KAAKwvB,EAAQltB,GAEnF,OAAOA,GAST2tB,EAAY9kC,UAAUiF,OAAS,SAASA,OAAQ6gC,GAC9C,IAAIhlC,EAAS,CAAC6C,IAAK/D,KAAK+D,IAAIsB,SAAUg9B,UAAWriC,KAAKqiC,UAAUh9B,UAEhE,GADIrF,KAAKmjC,cAAejiC,EAAOiiC,YAAcnjC,KAAKmjC,YAAY3kC,KAAI,SAAU2E,GAAK,OAAOA,EAAEkC,aACtF6gC,GAAuC,iBAAhBA,EAA4B,IAAK,IAAIzpB,KAAQypB,EAAc,CACpF,GAAY,OAARzpB,GAAyB,aAARA,EACjB,MAAM,IAAI/W,WAAW,sDACzB,IAAIu/B,EAASiB,EAAazpB,GAAO3G,EAAQmvB,EAAOv8B,KAAKoN,MACjDA,GAASA,EAAMzQ,SAAUnE,EAAOub,GAAQ3G,EAAMzQ,OAAO9C,KAAK0iC,EAAQjlC,KAAKilC,EAAOxoC,OAEpF,OAAOyE,GAiBTgkC,EAAY5/B,SAAW,SAASA,SAAUm/B,EAAQj/B,EAAM0gC,GACtD,IAAK1gC,EAAQ,MAAM,IAAIE,WAAW,0CAClC,IAAK++B,EAAOl/B,OAAU,MAAM,IAAIG,WAAW,0CAC3C,IAAIsgC,EAAU,IAAInB,EAAcJ,EAAOl/B,OAAQk/B,EAAOK,SAClDvtB,EAAW,IAAI2tB,EAAYc,GAqB/B,OApBAA,EAAQjB,OAAO5oC,SAAQ,SAAU2pC,GAC/B,GAAkB,OAAdA,EAAMjiC,KACR0T,EAASxT,IAAM,OAAKuB,SAASm/B,EAAOl/B,OAAQC,EAAKzB,UAC5C,GAAkB,aAAd+hC,EAAMjiC,KACf0T,EAAS8qB,UAAY/B,EAAUh7B,SAASiS,EAASxT,IAAKyB,EAAK68B,gBACtD,GAAkB,eAAdyD,EAAMjiC,KACX2B,EAAK29B,cAAe5rB,EAAS4rB,YAAc39B,EAAK29B,YAAY3kC,IAAIimC,EAAOl/B,OAAO0I,mBAC7E,CACL,GAAIi4B,EAAgB,IAAK,IAAIzpB,KAAQypB,EAAc,CACjD,IAAIjB,EAASiB,EAAazpB,GAAO3G,EAAQmvB,EAAOv8B,KAAKoN,MACrD,GAAImvB,EAAOxoC,KAAOqpC,EAAMjiC,MAAQiS,GAASA,EAAMxQ,UAC3C5B,OAAOtD,UAAUiX,eAAe9U,KAAKiD,EAAMiX,GAG7C,YADAlF,EAASuuB,EAAMjiC,MAAQiS,EAAMxQ,SAAS/C,KAAK0iC,EAAQR,EAAQj/B,EAAKiX,GAAOlF,IAI3EA,EAASuuB,EAAMjiC,MAAQiiC,EAAM7wB,KAAKwvB,EAAQltB,OAGvCA,GAST2tB,EAAYiB,iBAAmB,SAASA,iBAAkB/kC,GACxD2kC,EAAe7nC,KAAKkD,IAEtB8jC,EAAYkB,oBAAsB,SAASA,oBAAqBhlC,GAC9D,IAAI8N,EAAQ62B,EAAehnC,QAAQqC,GAC/B8N,GAAS,GAAK62B,EAAe5mC,OAAO+P,EAAO,IAGjDxL,OAAOoB,iBAAkBogC,EAAY9kC,UAAW6P,GAEhD,IAAI81B,EAAiB,GAoDrB,SAASM,UAAUzvB,EAAKT,EAAMrK,GAC5B,IAAK,IAAI2Q,KAAQ7F,EAAK,CACpB,IAAI0K,EAAM1K,EAAI6F,GACV6E,aAAeyb,SAAYzb,EAAMA,EAAI2I,KAAK9T,GAC7B,mBAARsG,IAA6B6E,EAAM+kB,UAAU/kB,EAAKnL,EAAM,KACjErK,EAAO2Q,GAAQ6E,EAEjB,OAAOxV,EAMT,IAAIw6B,EAAS,SAASA,OAAO59B,GAG3B1I,KAAK83B,MAAQ,GACTpvB,EAAKovB,OAASuO,UAAU39B,EAAKovB,MAAO93B,KAAMA,KAAK83B,OAGnD93B,KAAK0I,KAAOA,EACZ1I,KAAKvD,IAAMiM,EAAKjM,IAAMiM,EAAKjM,IAAIA,IAAM8pC,UAAU,WAKjDD,EAAOlmC,UAAUomC,SAAW,SAASA,SAAU1wB,GAAS,OAAOA,EAAM9V,KAAKvD,MA4B1E,IAAIyjC,EAAOx8B,OAAOC,OAAO,MAEzB,SAAS4iC,UAAU1iC,GACjB,OAAIA,KAAQq8B,EAAer8B,EAAO,OAAQq8B,EAAKr8B,IAC/Cq8B,EAAKr8B,GAAQ,EACNA,EAAO,KAOhB,IAAI4iC,EAAY,SAASA,UAAU5iC,QACrB,IAATA,IAAkBA,EAAO,OAC7B7D,KAAKvD,IAAM8pC,UAAU1iC,IAKtB4iC,EAAUrmC,UAAUnB,IAAM,SAASA,IAAK6W,GAAS,OAAOA,EAAM2uB,OAAOO,aAAahlC,KAAKvD,MAIvFgqC,EAAUrmC,UAAUomC,SAAW,SAASA,SAAU1wB,GAAS,OAAOA,EAAM9V,KAAKvD,O,kCC1mC7E,iJAIIyE,EAAS,GAEb,GAAwB,oBAAbwlC,WAA+C,oBAAZ7R,SAAyB,CACrE,IAAI8R,EAAU,cAAc7X,KAAK4X,UAAUE,WACvCC,EAAY,UAAUzf,KAAKsf,UAAUE,WACrCE,EAAU,wCAAwChY,KAAK4X,UAAUE,WAEjEG,EAAK7lC,EAAO6lC,MAAQF,GAAaC,GAAWH,GAChDzlC,EAAO8lC,WAAaH,EAAYhS,SAASoS,cAAgB,EAAIH,GAAWA,EAAQ,GAAKH,GAAWA,EAAQ,GAAK,KAC7GzlC,EAAOgmC,OAASH,GAAM,gBAAgB3f,KAAKsf,UAAUE,WACrD1lC,EAAOimC,cAAgBjmC,EAAOgmC,SAAW,iBAAiBpY,KAAK4X,UAAUE,YAAc,CAAC,EAAG,IAAI,GAC/F,IAAIQ,GAAUL,GAAM,gBAAgBjY,KAAK4X,UAAUE,WACnD1lC,EAAOkmC,SAAWA,EAClBlmC,EAAOmmC,eAAiBD,IAAWA,EAAO,GAE1ClmC,EAAOomC,QAAUP,GAAM,iBAAiB3f,KAAKsf,UAAUa,QACvDrmC,EAAOsmC,IAAMtmC,EAAOomC,SAAW,cAAclgB,KAAKsf,UAAUE,YAAcF,UAAUe,eAAiB,GACrGvmC,EAAOwmC,IAAMxmC,EAAOsmC,KAAO,MAAMpgB,KAAKsf,UAAUiB,UAChDzmC,EAAO0mC,QAAU,aAAaxgB,KAAKsf,UAAUE,WAC7C1lC,EAAO2mC,OAAS,wBAAyBhT,SAASiT,gBAAgB34B,MAClEjO,EAAO6mC,eAAiB7mC,EAAO2mC,UAAY,uBAAuB/Y,KAAK4X,UAAUE,YAAc,CAAC,EAAG,IAAI,GAGzG,IAAIoB,SAAW,SAASrgC,GACtB,IAAK,IAAIrH,EAAQ,GAAIA,IAEnB,KADAqH,EAAOA,EAAKwpB,iBACC,OAAO7wB,GAIpB+uB,WAAa,SAAS1nB,GACxB,IAAIU,EAASV,EAAKsgC,cAAgBtgC,EAAK0nB,WACvC,OAAOhnB,GAA6B,IAAnBA,EAAOQ,SAAiBR,EAAO6/B,KAAO7/B,GAGrD8/B,EAAc,KAKdC,UAAY,SAASzgC,EAAM1F,EAAMC,GACnC,IAAIkG,EAAQ+/B,IAAgBA,EAActT,SAASwT,eAGnD,OAFAjgC,EAAMkgC,OAAO3gC,EAAY,MAANzF,EAAayF,EAAKspB,UAAUpyB,OAASqD,GACxDkG,EAAMmgC,SAAS5gC,EAAM1F,GAAQ,GACtBmG,GAMLogC,qBAAuB,SAAS7gC,EAAM8gC,EAAKC,EAAYC,GACzD,OAAOD,IAAeE,QAAQjhC,EAAM8gC,EAAKC,EAAYC,GAAY,IAC3CC,QAAQjhC,EAAM8gC,EAAKC,EAAYC,EAAW,KAG9DE,EAAe,gCAEnB,SAASD,QAAQjhC,EAAM8gC,EAAKC,EAAYC,EAAWz9B,GACjD,OAAS,CACP,GAAIvD,GAAQ+gC,GAAcD,GAAOE,EAAa,OAAO,EACrD,GAAIF,IAAQv9B,EAAM,EAAI,EAAI6B,SAASpF,IAAQ,CACzC,IAAIU,EAASV,EAAK0nB,WAClB,GAAuB,GAAnBhnB,EAAOQ,UAAiBigC,aAAanhC,IAASkhC,EAAazhB,KAAKzf,EAAK2nB,WAAqC,SAAxB3nB,EAAKohC,gBACvF,OAAO,EACXN,EAAMT,SAASrgC,IAASuD,EAAM,EAAI,EAAI,GACtCvD,EAAOU,MACF,IAAqB,GAAjBV,EAAKkB,SAKd,OAAO,EAHP,GAA4B,UAD5BlB,EAAOA,EAAKurB,WAAWuV,GAAOv9B,EAAM,GAAK,EAAI,KACpC69B,gBAA8B,OAAO,EAC9CN,EAAMv9B,EAAM,EAAI6B,SAASpF,GAAQ,IAOvC,SAASoF,SAASpF,GAChB,OAAwB,GAAjBA,EAAKkB,SAAgBlB,EAAKspB,UAAUpyB,OAAS8I,EAAKurB,WAAWr0B,OActE,SAASiqC,aAAa/d,GAEpB,IADA,IAAIwZ,EACK90B,EAAMsb,EAAKtb,KAAiC80B,EAAO90B,EAAIu5B,YAAvCv5B,EAAMA,EAAI4f,YACnC,OAAOkV,GAAQA,EAAK58B,MAAQ48B,EAAK58B,KAAKmW,UAAYymB,EAAKxZ,KAAOA,GAAOwZ,EAAKzR,YAAc/H,GAK1F,IAAIke,mBAAqB,SAASC,GAChC,IAAIC,EAAYD,EAAOE,YAGvB,OAFID,GAAajoC,EAAOkmC,QAAU8B,EAAOG,aAAeH,EAAOI,WAAW,GAAGH,YACzEA,GAAY,GACTA,GAGT,SAASI,SAASC,EAAS/sC,GACzB,IAAIgtC,EAAQ5U,SAAS6U,YAAY,SAIjC,OAHAD,EAAME,UAAU,WAAW,GAAM,GACjCF,EAAMD,QAAUA,EAChBC,EAAMhtC,IAAMgtC,EAAM3gB,KAAOrsB,EAClBgtC,EAGT,SAASG,WAAW7lC,GAClB,MAAO,CAACqzB,KAAM,EAAGF,MAAOnzB,EAAI+jC,gBAAgBrI,YACpC9sB,IAAK,EAAGwkB,OAAQpzB,EAAI+jC,gBAAgB+B,cAG9C,SAASC,QAAQjtC,EAAOktC,GACtB,MAAuB,iBAATltC,EAAoBA,EAAQA,EAAMktC,GAGlD,SAASC,WAAWriC,GAClB,IAAIsiC,EAAOtiC,EAAKu3B,wBAEZgL,EAAUD,EAAK9K,MAAQx3B,EAAKwiC,aAAgB,EAC5CC,EAAUH,EAAK7K,OAASz3B,EAAK0iC,cAAiB,EAElD,MAAO,CAACjT,KAAM6S,EAAK7S,KAAMF,MAAO+S,EAAK7S,KAAOzvB,EAAK83B,YAAcyK,EACvDv3B,IAAKs3B,EAAKt3B,IAAKwkB,OAAQ8S,EAAKt3B,IAAMhL,EAAKkiC,aAAeO,GAGhE,SAASE,mBAAmBC,EAAMN,EAAMO,GAGtC,IAFA,IAAIC,EAAkBF,EAAKG,SAAS,oBAAsB,EAAGC,EAAeJ,EAAKG,SAAS,iBAAmB,EACzG3mC,EAAMwmC,EAAKxf,IAAIwH,cACVlqB,EAASmiC,GAAYD,EAAKxf,IAC5B1iB,EADkCA,EAASgnB,WAAWhnB,GAE3D,GAAuB,GAAnBA,EAAOQ,SAAX,CACA,IAAI+hC,EAAQviC,GAAUtE,EAAIy7B,MAA2B,GAAnBn3B,EAAOQ,SACrCgiC,EAAWD,EAAQhB,WAAW7lC,GAAOimC,WAAW3hC,GAChDyiC,EAAQ,EAAGC,EAAQ,EASvB,GARId,EAAKt3B,IAAMk4B,EAASl4B,IAAMm3B,QAAQW,EAAiB,OACnDM,IAAUF,EAASl4B,IAAMs3B,EAAKt3B,IAAMm3B,QAAQa,EAAc,QACrDV,EAAK9S,OAAS0T,EAAS1T,OAAS2S,QAAQW,EAAiB,YAC9DM,EAAQd,EAAK9S,OAAS0T,EAAS1T,OAAS2S,QAAQa,EAAc,WAC9DV,EAAK7S,KAAOyT,EAASzT,KAAO0S,QAAQW,EAAiB,QACrDK,IAAUD,EAASzT,KAAO6S,EAAK7S,KAAO0S,QAAQa,EAAc,SACvDV,EAAK/S,MAAQ2T,EAAS3T,MAAQ4S,QAAQW,EAAiB,WAC5DK,EAAQb,EAAK/S,MAAQ2T,EAAS3T,MAAQ4S,QAAQa,EAAc,UAC5DG,GAASC,EACX,GAAIH,EACF7mC,EAAIinC,YAAYC,SAASH,EAAOC,OAC3B,CACL,IAAIG,EAAS7iC,EAAO8iC,WAAYC,EAAS/iC,EAAOgjC,UAC5CN,IAAS1iC,EAAOgjC,WAAaN,GAC7BD,IAASziC,EAAO8iC,YAAcL,GAClC,IAAIQ,EAAKjjC,EAAO8iC,WAAaD,EAAQK,EAAKljC,EAAOgjC,UAAYD,EAC7DnB,EAAO,CAAC7S,KAAM6S,EAAK7S,KAAOkU,EAAI34B,IAAKs3B,EAAKt3B,IAAM44B,EAAIrU,MAAO+S,EAAK/S,MAAQoU,EAAInU,OAAQ8S,EAAK9S,OAASoU,GAGpG,GAAIX,EAAS,OAyBjB,SAASY,YAAYzgB,GAEnB,IADA,IAAI0gB,EAAQ,GAAI1nC,EAAMgnB,EAAIwH,cACnBxH,IACL0gB,EAAMvtC,KAAK,CAAC6sB,IAAKA,EAAKpY,IAAKoY,EAAIsgB,UAAWjU,KAAMrM,EAAIogB,aAChDpgB,GAAOhnB,GAFDgnB,EAAMsE,WAAWtE,IAI7B,OAAO0gB,EAcT,SAASC,mBAAmBD,EAAOE,GACjC,IAAK,IAAI7sC,EAAI,EAAGA,EAAI2sC,EAAM5sC,OAAQC,IAAK,CACrC,IAAIgT,EAAM25B,EAAM3sC,GACZisB,EAAMjZ,EAAIiZ,IACVpY,EAAMb,EAAIa,IACVykB,EAAOtlB,EAAIslB,KACXrM,EAAIsgB,WAAa14B,EAAMg5B,IAAQ5gB,EAAIsgB,UAAY14B,EAAMg5B,GACrD5gB,EAAIogB,YAAc/T,IAAQrM,EAAIogB,WAAa/T,IAInD,IAAIwU,EAAyB,KAoB7B,SAASC,iBAAiBlkC,EAAMmkC,GAG9B,IAFA,IAAIC,EAA0BC,EAAjBC,EAAY,IAAoBtqC,EAAS,EAClDuqC,EAASJ,EAAOn5B,IAAKw5B,EAASL,EAAOn5B,IAChC3V,EAAQ2K,EAAKK,WAAYokC,EAAa,EAAGpvC,EAAOA,EAAQA,EAAM20B,YAAaya,IAAc,CAChG,IAAIC,OAAQ,EACZ,GAAsB,GAAlBrvC,EAAM6L,SAAiBwjC,EAAQrvC,EAAMsvC,qBACpC,IAAsB,GAAlBtvC,EAAM6L,SACR,SADyBwjC,EAAQjE,UAAUprC,GAAOsvC,iBAGzD,IAAK,IAAIxtC,EAAI,EAAGA,EAAIutC,EAAMxtC,OAAQC,IAAK,CACrC,IAAImrC,EAAOoC,EAAMvtC,GACjB,GAAImrC,EAAKt3B,KAAOu5B,GAAUjC,EAAK9S,QAAUgV,EAAQ,CAC/CD,EAASzsC,KAAK8G,IAAI0jC,EAAK9S,OAAQ+U,GAC/BC,EAAS1sC,KAAKuO,IAAIi8B,EAAKt3B,IAAKw5B,GAC5B,IAAII,EAAKtC,EAAK7S,KAAO0U,EAAO1U,KAAO6S,EAAK7S,KAAO0U,EAAO1U,KAChD6S,EAAK/S,MAAQ4U,EAAO1U,KAAO0U,EAAO1U,KAAO6S,EAAK/S,MAAQ,EAC5D,GAAIqV,EAAKN,EAAW,CAClBF,EAAU/uC,EACVivC,EAAYM,EACZP,EAAgBO,GAA0B,GAApBR,EAAQljC,SAAgB,CAACuuB,KAAM6S,EAAK/S,MAAQ4U,EAAO1U,KAAO6S,EAAK/S,MAAQ+S,EAAK7S,KAAMzkB,IAAKm5B,EAAOn5B,KAAOm5B,EACrG,GAAlB9uC,EAAM6L,UAAiB0jC,IACvB5qC,EAASyqC,GAAcN,EAAO1U,OAAS6S,EAAK7S,KAAO6S,EAAK/S,OAAS,EAAI,EAAI,IAC7E,WAGC6U,IAAYD,EAAO1U,MAAQ6S,EAAK/S,OAAS4U,EAAOn5B,KAAOs3B,EAAKt3B,KAChDm5B,EAAO1U,MAAQ6S,EAAK7S,MAAQ0U,EAAOn5B,KAAOs3B,EAAK9S,UAC5Dx1B,EAASyqC,EAAa,IAG9B,OAAIL,GAA+B,GAApBA,EAAQljC,SAKzB,SAAS2jC,iBAAiB7kC,EAAMmkC,GAG9B,IAFA,IAAIW,EAAM9kC,EAAKspB,UAAUpyB,OACrBuJ,EAAQysB,SAASwT,cACZvpC,EAAI,EAAGA,EAAI2tC,EAAK3tC,IAAK,CAC5BsJ,EAAMkgC,OAAO3gC,EAAM7I,EAAI,GACvBsJ,EAAMmgC,SAAS5gC,EAAM7I,GACrB,IAAImrC,EAAOyC,WAAWtkC,EAAO,GAC7B,GAAI6hC,EAAKt3B,KAAOs3B,EAAK9S,QACjBwV,OAAOb,EAAQ7B,GACf,MAAO,CAACtiC,KAAMA,EAAMhG,OAAQ7C,GAAKgtC,EAAO1U,OAAS6S,EAAK7S,KAAO6S,EAAK/S,OAAS,EAAI,EAAI,IAEzF,MAAO,CAACvvB,KAAMA,EAAMhG,OAAQ,GAhBmB6qC,CAAiBT,EAASC,IACpED,GAAYE,GAAiC,GAApBF,EAAQljC,SAAyB,CAAClB,KAAMA,EAAMhG,OAAQA,GAC7EkqC,iBAAiBE,EAASC,GAiBnC,SAASW,OAAOb,EAAQ7B,GACtB,OAAO6B,EAAO1U,MAAQ6S,EAAK7S,KAAO,GAAK0U,EAAO1U,MAAQ6S,EAAK/S,MAAQ,GACjE4U,EAAOn5B,KAAOs3B,EAAKt3B,IAAM,GAAKm5B,EAAOn5B,KAAOs3B,EAAK9S,OAAS,EA6C9D,SAASyV,iBAAiBC,EAASf,EAAQgB,GACzC,IAAIL,EAAMI,EAAQ3Z,WAAWr0B,OAC7B,GAAI4tC,GAAOK,EAAIn6B,IAAMm6B,EAAI3V,OACvB,IAAK,IAAI4V,EAASttC,KAAK8G,IAAI,EAAG9G,KAAKuO,IAAIy+B,EAAM,EAAGhtC,KAAKutC,MAAMP,GAAOX,EAAOn5B,IAAMm6B,EAAIn6B,MAAQm6B,EAAI3V,OAAS2V,EAAIn6B,MAAQ,IAAK7T,EAAIiuC,IAAU,CACrI,IAAI/vC,EAAQ6vC,EAAQ3Z,WAAWp0B,GAC/B,GAAsB,GAAlB9B,EAAM6L,SAER,IADA,IAAIwjC,EAAQrvC,EAAMsvC,iBACTj9B,EAAI,EAAGA,EAAIg9B,EAAMxtC,OAAQwQ,IAAK,CACrC,IAAI46B,EAAOoC,EAAMh9B,GACjB,GAAIs9B,OAAOb,EAAQ7B,GAAS,OAAO2C,iBAAiB5vC,EAAO8uC,EAAQ7B,GAGvE,IAAKnrC,GAAKA,EAAI,GAAK2tC,IAAQM,EAAU,MAGzC,OAAOF,EAIT,SAASI,YAAY1C,EAAMuB,GACzB,IAAInU,EAAQuV,EAEsBvlC,EAAMhG,EAApCoC,EAAMwmC,EAAKxf,IAAIwH,cACnB,GAAIxuB,EAAIopC,uBACN,IACE,IAAIC,EAAQrpC,EAAIopC,uBAAuBrB,EAAO1U,KAAM0U,EAAOn5B,KACvDy6B,IAA2BzlC,GAAhBgwB,EAASyV,GAAqBC,WAAY1rC,EAASg2B,EAAOh2B,QACzE,MAAOnF,IAEX,IAAKmL,GAAQ5D,EAAIupC,oBAAqB,CACpC,IAAIllC,EAAQrE,EAAIupC,oBAAoBxB,EAAO1U,KAAM0U,EAAOn5B,KACpDvK,IAA6BT,GAAlBulC,EAAW9kC,GAAuBmlC,eAAgB5rC,EAASurC,EAASM,aAGrF,IAAwG3tC,EAApG4tC,GAAOlD,EAAKmD,KAAKd,iBAAmBrC,EAAKmD,KAAO3pC,GAAK6oC,iBAAiBd,EAAO1U,KAAM0U,EAAOn5B,IAAM,GACpG,IAAK86B,IAAQlD,EAAKxf,IAAI6I,SAAyB,GAAhB6Z,EAAI5kC,SAAgB4kC,EAAIpe,WAAaoe,GAAM,CACxE,IAAIX,EAAMvC,EAAKxf,IAAImU,wBACnB,IAAKyN,OAAOb,EAAQgB,GAAQ,OAAO,KAEnC,KADAW,EAAMb,iBAAiBrC,EAAKxf,IAAK+gB,EAAQgB,IAC7B,OAAO,KAGrB,GAAI5rC,EAAOomC,OACT,IAAK,IAAIrpB,EAAIwvB,EAAK9lC,GAAQsW,EAAGA,EAAIoR,WAAWpR,GACpCA,EAAE0vB,YAAahmC,EAAOhG,EAAS,MAGzC,GADA8rC,EAxFF,SAASG,aAAa7iB,EAAK+gB,GACzB,IAAIzjC,EAAS0iB,EAAIsE,WACjB,OAAIhnB,GAAU,QAAQ+e,KAAK/e,EAAOinB,WAAawc,EAAO1U,KAAOrM,EAAImU,wBAAwB9H,KAC9E/uB,EACJ0iB,EAoFD6iB,CAAaH,EAAK3B,GACpBnkC,EAAM,CACR,GAAIzG,EAAOgmC,OAA0B,GAAjBv/B,EAAKkB,WAGvBlH,EAASlC,KAAKuO,IAAIrM,EAAQgG,EAAKurB,WAAWr0B,SAG7B8I,EAAKurB,WAAWr0B,OAAQ,CACnC,IAAoCgvC,EAAhChmC,EAAOF,EAAKurB,WAAWvxB,GACN,OAAjBkG,EAAKynB,WAAsBue,EAAQhmC,EAAKq3B,yBAAyBhI,OAAS4U,EAAO1U,MACjFyW,EAAM1W,OAAS2U,EAAOn5B,KACtBhR,IAKJgG,GAAQ4iC,EAAKxf,KAAOppB,GAAUgG,EAAKurB,WAAWr0B,OAAS,GAAgC,GAA3B8I,EAAK0I,UAAUxH,UAC3EijC,EAAOn5B,IAAMhL,EAAK0I,UAAU6uB,wBAAwB/H,OACpDt3B,EAAM0qC,EAAKz0B,MAAM/R,IAAI6C,QAAQlK,KAId,GAAViF,GAAgC,GAAjBgG,EAAKkB,UAAyD,MAAxClB,EAAKurB,WAAWvxB,EAAS,GAAG2tB,WACtEzvB,EA7FR,SAASiuC,aAAavD,EAAM5iC,EAAMhG,EAAQmqC,GAQxC,IADA,IAAIiC,GAAW,EACNt+B,EAAM9H,EACT8H,GAAO86B,EAAKxf,KADK,CAErB,IAAIwZ,EAAOgG,EAAKyD,QAAQC,YAAYx+B,GAAK,GACzC,IAAK80B,EAAQ,OAAO,KACpB,GAAIA,EAAK58B,KAAKmW,SAAWymB,EAAKl8B,OAAQ,CACpC,IAAI4hC,EAAO1F,EAAKxZ,IAAImU,wBACpB,GAAI+K,EAAK7S,KAAO0U,EAAO1U,MAAQ6S,EAAKt3B,IAAMm5B,EAAOn5B,IAAOo7B,EAAUxJ,EAAK2J,cAClE,MAAIjE,EAAK/S,MAAQ4U,EAAO1U,MAAQ6S,EAAK9S,OAAS2U,EAAOn5B,KACnD,MAD0Do7B,EAAUxJ,EAAK4J,UAGlF1+B,EAAM80B,EAAKxZ,IAAIsE,WAEjB,OAAO0e,GAAW,EAAIA,EAAUxD,EAAKyD,QAAQI,WAAWzmC,EAAMhG,GAyElDmsC,CAAavD,EAAM5iC,EAAMhG,EAAQmqC,IAElC,MAAPjsC,IAAeA,EA3GrB,SAASwuC,eAAe9D,EAAMkD,EAAK3B,GACjC,IAAIh6B,EAAM+5B,iBAAiB4B,EAAK3B,GAC5BnkC,EAAOmK,EAAInK,KACXhG,EAASmQ,EAAInQ,OACb2J,GAAQ,EACZ,GAAqB,GAAjB3D,EAAKkB,WAAkBlB,EAAKK,WAAY,CAC1C,IAAIiiC,EAAOtiC,EAAKu3B,wBAChB5zB,EAAO2+B,EAAK7S,MAAQ6S,EAAK/S,OAAS4U,EAAO1U,MAAQ6S,EAAK7S,KAAO6S,EAAK/S,OAAS,EAAI,GAAK,EAEtF,OAAOqT,EAAKyD,QAAQI,WAAWzmC,EAAMhG,EAAQ2J,GAkGpB+iC,CAAe9D,EAAMkD,EAAK3B,IAEnD,IAAIvH,EAAOgG,EAAKyD,QAAQC,YAAYR,GAAK,GACzC,MAAO,CAAC5tC,IAAKA,EAAK0J,OAAQg7B,EAAOA,EAAK+J,WAAa/J,EAAKgK,QAAU,GAGpE,SAAS7B,WAAWloC,EAAQ8G,GAC1B,IAAI+gC,EAAQ7nC,EAAO8nC,iBACnB,OAAQD,EAAMxtC,OAA0CwtC,EAAM/gC,EAAO,EAAI,EAAI+gC,EAAMxtC,OAAS,GAArE2F,EAAO06B,wBAGhC,IAAIsP,EAAO,4CAKX,SAASC,YAAYlE,EAAM1qC,EAAKkqC,GAC9B,IAAIj4B,EAAMy4B,EAAKyD,QAAQU,WAAW7uC,EAAKkqC,EAAO,GAAK,EAAI,GACnDpiC,EAAOmK,EAAInK,KACXhG,EAASmQ,EAAInQ,OAEbgtC,EAAoBztC,EAAO2mC,QAAU3mC,EAAOgmC,MAChD,GAAqB,GAAjBv/B,EAAKkB,SAAe,CAGtB,IAAI8lC,IAAsBH,EAAKpnB,KAAKzf,EAAKspB,aAAe8Y,EAAO,EAAKpoC,EAASA,GAAUgG,EAAKspB,UAAUpyB,QAc/F,CACL,IAAIoD,EAAON,EAAQO,EAAKP,EAAQitC,EAAW7E,EAAO,EAAI,GAAK,EAK3D,OAJIA,EAAO,IAAMpoC,GAAUO,IAAM0sC,GAAY,GACpC7E,GAAQ,GAAKpoC,GAAUgG,EAAKspB,UAAUpyB,QAAUoD,IAAQ2sC,EAAW,GACnE7E,EAAO,EAAK9nC,IACdC,IACA2sC,SAASnC,WAAWtE,UAAUzgC,EAAM1F,EAAMC,GAAK0sC,GAAWA,EAAW,GAnB5E,IAAI3E,EAAOyC,WAAWtE,UAAUzgC,EAAMhG,EAAQA,GAASooC,GAIvD,GAAI7oC,EAAOgmC,OAASvlC,GAAU,KAAKylB,KAAKzf,EAAKspB,UAAUtvB,EAAS,KAAOA,EAASgG,EAAKspB,UAAUpyB,OAAQ,CACrG,IAAIiwC,EAAapC,WAAWtE,UAAUzgC,EAAMhG,EAAS,EAAGA,EAAS,IAAK,GACtE,GAAImtC,EAAWn8B,KAAOs3B,EAAKt3B,IAAK,CAC9B,IAAIo8B,EAAYrC,WAAWtE,UAAUzgC,EAAMhG,EAAQA,EAAS,IAAK,GACjE,GAAIotC,EAAUp8B,KAAOs3B,EAAKt3B,IACtB,OAAOk8B,SAASE,EAAWA,EAAU3X,KAAO0X,EAAW1X,OAG/D,OAAO6S,EAYX,IAAKM,EAAKz0B,MAAM/R,IAAIwD,QAAQ1H,GAAKwI,OAAOyZ,cAAe,CACrD,GAAIngB,IAAWooC,EAAO,GAAKpoC,GAAUoL,SAASpF,IAAQ,CACpD,IAAIxD,EAASwD,EAAKurB,WAAWvxB,EAAS,GACtC,GAAuB,GAAnBwC,EAAO0E,SAAiB,OAAOmmC,SAAS7qC,EAAO+6B,yBAAyB,GAE9E,GAAIv9B,EAASoL,SAASpF,GAAO,CAC3B,IAAI4C,EAAQ5C,EAAKurB,WAAWvxB,GAC5B,GAAsB,GAAlB4I,EAAM1B,SAAiB,OAAOmmC,SAASzkC,EAAM20B,yBAAyB,GAE5E,OAAO8P,SAASrnC,EAAKu3B,wBAAyB6K,GAAQ,GAIxD,GAAIpoC,IAAWooC,EAAO,GAAKpoC,GAAUoL,SAASpF,IAAQ,CACpD,IAAIsnC,EAAWtnC,EAAKurB,WAAWvxB,EAAS,GACpCmK,EAA8B,GAArBmjC,EAASpmC,SAAgBu/B,UAAU6G,EAAUliC,SAASkiC,IAAaN,EAAoB,EAAI,IAG7E,GAArBM,EAASpmC,UAAuC,MAArBomC,EAAS3f,UAAqB2f,EAAStd,YAA0B,KAAXsd,EACvF,GAAInjC,EAAU,OAAO+iC,SAASnC,WAAW5gC,EAAQ,IAAI,GAEvD,GAAInK,EAASoL,SAASpF,GAAO,CAE3B,IADA,IAAIunC,EAAUvnC,EAAKurB,WAAWvxB,GACvButC,EAAQlG,YAAckG,EAAQlG,WAAWmG,iBAAmBD,EAAUA,EAAQvd,YACrF,IAAIyd,EAAYF,EAAqC,GAApBA,EAAQrmC,SAAgBu/B,UAAU8G,EAAS,EAAIP,EAAoB,EAAI,GAC9E,GAApBO,EAAQrmC,SAAgBqmC,EAAU,KADd,KAE1B,GAAIE,EAAY,OAAOP,SAASnC,WAAW0C,GAAW,IAAI,GAG5D,OAAOP,SAASnC,WAA4B,GAAjB/kC,EAAKkB,SAAgBu/B,UAAUzgC,GAAQA,GAAOoiC,GAAOA,GAAQ,GAG1F,SAAS8E,SAAS5E,EAAM7S,GACtB,GAAkB,GAAd6S,EAAK9K,MAAc,OAAO8K,EAC9B,IAAIpO,EAAIzE,EAAO6S,EAAK7S,KAAO6S,EAAK/S,MAChC,MAAO,CAACvkB,IAAKs3B,EAAKt3B,IAAKwkB,OAAQ8S,EAAK9S,OAAQC,KAAMyE,EAAG3E,MAAO2E,GAG9D,SAASmT,SAAS/E,EAAMt3B,GACtB,GAAmB,GAAfs3B,EAAK7K,OAAe,OAAO6K,EAC/B,IAAIoF,EAAI18B,EAAMs3B,EAAKt3B,IAAMs3B,EAAK9S,OAC9B,MAAO,CAACxkB,IAAK08B,EAAGlY,OAAQkY,EAAGjY,KAAM6S,EAAK7S,KAAMF,MAAO+S,EAAK/S,OAG1D,SAASoY,iBAAiB/E,EAAMz0B,EAAO1U,GACrC,IAAImuC,EAAYhF,EAAKz0B,MAAO2Q,EAAS8jB,EAAKmD,KAAK8B,cAC3CD,GAAaz5B,GAASy0B,EAAKkF,YAAY35B,GACvC2Q,GAAU8jB,EAAKxf,KAAOwf,EAAK/M,QAC/B,IACE,OAAOp8B,IACP,QACImuC,GAAaz5B,GAASy0B,EAAKkF,YAAYF,GACvC9oB,GAAU8jB,EAAKxf,KAAOtE,GAAUA,EAAO+W,SAqC/C,IAAIkS,EAAW,kBAiCf,IAAIC,EAAc,KAAMC,EAAY,KAAMC,GAAe,EACzD,SAASC,eAAevF,EAAMz0B,EAAO5K,GACnC,OAAIykC,GAAe75B,GAAS85B,GAAa1kC,EAAc2kC,GACvDF,EAAc75B,EAAO85B,EAAY1kC,EAC1B2kC,EAAsB,MAAP3kC,GAAsB,QAAPA,EAnEvC,SAAS6kC,uBAAuBxF,EAAMz0B,EAAO5K,GAC3C,IAAIk3B,EAAMtsB,EAAMusB,UACZr4B,EAAc,MAAPkB,EAAck3B,EAAI96B,MAAQ86B,EAAI35B,IACzC,OAAO6mC,iBAAiB/E,EAAMz0B,GAAO,WAGnC,IAFA,IACIiV,EADMwf,EAAKyD,QAAQU,WAAW1kC,EAAKnK,IAAY,MAAPqL,GAAe,EAAI,GACjDvD,OACL,CACP,IAAIqoC,EAAUzF,EAAKyD,QAAQC,YAAYljB,GAAK,GAC5C,IAAKilB,EAAW,MAChB,GAAIA,EAAQroC,KAAKmW,QAAS,CAAEiN,EAAMilB,EAAQjlB,IAAK,MAC/CA,EAAMilB,EAAQjlB,IAAIsE,WAGpB,IADA,IAAIyc,EAAS2C,YAAYlE,EAAMvgC,EAAKnK,IAAK,GAChC7C,EAAQ+tB,EAAI/iB,WAAYhL,EAAOA,EAAQA,EAAM20B,YAAa,CACjE,IAAIse,OAAQ,EACZ,GAAsB,GAAlBjzC,EAAM6L,SAAiBonC,EAAQjzC,EAAMsvC,qBACpC,IAAsB,GAAlBtvC,EAAM6L,SACR,SADyBonC,EAAQ7H,UAAUprC,EAAO,EAAGA,EAAMi0B,UAAUpyB,QAAQytC,iBAEpF,IAAK,IAAIxtC,EAAI,EAAGA,EAAImxC,EAAMpxC,OAAQC,IAAK,CACrC,IAAIguC,EAAMmD,EAAMnxC,GAChB,GAAIguC,EAAI3V,OAAS2V,EAAIn6B,IAAM,IACf,MAAPzH,EAAc4gC,EAAOn5B,IAAMm6B,EAAIn6B,IAAkC,GAA3Bm6B,EAAI3V,OAAS2U,EAAOn5B,KACxDm6B,EAAI3V,OAAS2U,EAAO3U,OAAqC,GAA3B2U,EAAO3U,OAAS2V,EAAIn6B,MACrD,OAAO,GAGf,OAAO,KA0CLo9B,CAAuBxF,EAAMz0B,EAAO5K,GApC1C,SAASglC,yBAAyB3F,EAAMz0B,EAAO5K,GAC7C,IACIs1B,EADM1qB,EAAMusB,UACA7B,MAChB,IAAKA,EAAMn4B,OAAO8C,YAAe,OAAO,EACxC,IAAIxJ,EAAS6+B,EAAMxsB,aAAcqtB,GAAW1/B,EAAQ2/B,EAAQ3/B,GAAU6+B,EAAMn4B,OAAOzB,QAAQlK,KACvF0lC,EAAMmI,EAAKmD,KAAKyC,eAGpB,OAAKT,EAAStoB,KAAKoZ,EAAMn4B,OAAOua,cAAiBwf,EAAIgO,OAG9Cd,iBAAiB/E,EAAMz0B,GAAO,WAMnC,IAAIu6B,EAAWjO,EAAIkH,WAAW,GAAIgH,EAAUlO,EAAImO,UAAWC,EAASpO,EAAIqO,YACpEC,EAAetO,EAAIuO,eACvBvO,EAAIgO,OAAO,OAAQllC,EAAK,aACxB,IACIhK,IADYs/B,EAAM/4B,MAAQ8iC,EAAKyD,QAAQ4C,YAAYpQ,EAAMr8B,UAAYomC,EAAKxf,KACtD6I,SAAmC,GAA1BwO,EAAImO,UAAU1nC,SAAgBu5B,EAAImO,UAAYnO,EAAImO,UAAUlhB,aACxFihB,GAAWlO,EAAImO,WAAaC,GAAUpO,EAAIqO,YAK/C,OAHArO,EAAIyO,kBACJzO,EAAIzhB,SAAS0vB,GACO,MAAhBK,IAAwBtO,EAAIuO,eAAiBD,GAC1CxvC,KAlBS,QAAPgK,GAAwB,YAAPA,EAAoBm2B,EAAUC,EA4BtD4O,CAAyB3F,EAAMz0B,EAAO5K,IAwF5C,IAII4lC,EAAW,SAASA,SAASzoC,EAAQ9M,EAAUwvB,EAAK+H,GACtD9yB,KAAKqI,OAASA,EACdrI,KAAKzE,SAAWA,EAChByE,KAAK+qB,IAAMA,EAGXA,EAAIie,WAAahpC,KAGjBA,KAAK8yB,WAAaA,EAClB9yB,KAAK+wC,MAdS,GAiBZ7sC,EAAqB,CAAExH,KAAM,CAAE0H,cAAc,GAAOmqC,OAAQ,CAAEnqC,cAAc,GAAO8pC,UAAW,CAAE9pC,cAAc,GAAOkqC,WAAY,CAAElqC,cAAc,GAAO+pC,SAAU,CAAE/pC,cAAc,GAAO4sC,SAAU,CAAE5sC,cAAc,GAAO6sC,YAAa,CAAE7sC,cAAc,GAAO8sC,QAAS,CAAE9sC,cAAc,GAAO+qC,gBAAiB,CAAE/qC,cAAc,IAInU0sC,EAAS1wC,UAAU+wC,cAAgB,SAASA,gBAAmB,OAAO,GACtEL,EAAS1wC,UAAUgxC,YAAc,SAASA,cAAiB,OAAO,GAClEN,EAAS1wC,UAAUixC,YAAc,SAASA,cAAiB,OAAO,GAClEP,EAAS1wC,UAAUkxC,YAAc,SAASA,YAAaC,GAAa,OAAO,GAM3ET,EAAS1wC,UAAUoxC,UAAY,SAASA,YAAe,OAAO,MAK9DV,EAAS1wC,UAAUqxC,UAAY,SAASA,YAAe,OAAO,GAG9DvtC,EAAmBxH,KAAKuC,IAAM,WAE5B,IADA,IAAIvC,EAAO,EACFoC,EAAI,EAAGA,EAAIkB,KAAKzE,SAASsD,OAAQC,IAAOpC,GAAQsD,KAAKzE,SAASuD,GAAGpC,KAC1E,OAAOA,GAKTwH,EAAmBqqC,OAAOtvC,IAAM,WAAc,OAAO,GAErD6xC,EAAS1wC,UAAUsxC,QAAU,SAASA,UACpC1xC,KAAKqI,OAAS,KACVrI,KAAK+qB,IAAIie,YAAchpC,OAAQA,KAAK+qB,IAAIie,WAAa,MACzD,IAAK,IAAIlqC,EAAI,EAAGA,EAAIkB,KAAKzE,SAASsD,OAAQC,IACtCkB,KAAKzE,SAASuD,GAAG4yC,WAGvBZ,EAAS1wC,UAAUuxC,eAAiB,SAASA,eAAgB30C,GAC3D,IAAK,IAAI8B,EAAI,EAAGe,EAAMG,KAAKsuC,WAAYxvC,EAAIkB,KAAKzE,SAASsD,OAAQC,IAAK,CACpE,IAAI2Q,EAAMzP,KAAKzE,SAASuD,GACxB,GAAI2Q,GAAOzS,EAAS,OAAO6C,EAC3BA,GAAO4P,EAAI/S,OAIfwH,EAAmBgqC,UAAUjvC,IAAM,WACjC,OAAOe,KAAKqI,OAAOspC,eAAe3xC,OAGpCkE,EAAmBoqC,WAAWrvC,IAAM,WAClC,OAAOe,KAAKqI,OAASrI,KAAKqI,OAAOspC,eAAe3xC,MAAQA,KAAKuuC,OAAS,GAGxErqC,EAAmBiqC,SAASlvC,IAAM,WAChC,OAAOe,KAAKkuC,UAAYluC,KAAKtD,MAG/BwH,EAAmB8sC,SAAS/xC,IAAM,WAChC,OAAOe,KAAKsuC,WAAatuC,KAAKtD,KAAO,EAAIsD,KAAKuuC,QAIhDuC,EAAS1wC,UAAUwxC,gBAAkB,SAASA,gBAAiB7mB,EAAKppB,EAAQ2J,GAG1E,GAAItL,KAAK8yB,YAAc9yB,KAAK8yB,WAAWc,SAAyB,GAAhB7I,EAAIliB,SAAgBkiB,EAAMA,EAAIsE,YAAa,CACzF,GAAI/jB,EAAO,EAAG,CACZ,IAAIumC,EAAWtN,EACf,GAAIxZ,GAAO/qB,KAAK8yB,WACd+e,EAAY9mB,EAAImI,WAAWvxB,EAAS,OAC/B,CACL,KAAOopB,EAAIsE,YAAcrvB,KAAK8yB,YAAc/H,EAAMA,EAAIsE,WACtDwiB,EAAY9mB,EAAIoG,gBAElB,KAAO0gB,MAAgBtN,EAAOsN,EAAU7I,aAAezE,EAAKl8B,QAAUrI,OAAS6xC,EAAYA,EAAU1gB,gBACrG,OAAO0gB,EAAY7xC,KAAK2xC,eAAepN,GAAQA,EAAK7nC,KAAOsD,KAAKsuC,WAEhE,IAAIwD,EAAUC,EACd,GAAIhnB,GAAO/qB,KAAK8yB,WACdgf,EAAW/mB,EAAImI,WAAWvxB,OACrB,CACL,KAAOopB,EAAIsE,YAAcrvB,KAAK8yB,YAAc/H,EAAMA,EAAIsE,WACtDyiB,EAAW/mB,EAAI4G,YAEjB,KAAOmgB,MAAeC,EAASD,EAAS9I,aAAe+I,EAAO1pC,QAAUrI,OAAS8xC,EAAWA,EAASngB,YACrG,OAAOmgB,EAAW9xC,KAAK2xC,eAAeI,GAAU/xC,KAAKgxC,SAMzD,IAAI1P,EACJ,GAAIvW,GAAO/qB,KAAK+qB,KAAO/qB,KAAK8yB,WAC1BwO,EAAQ3/B,EAASqmC,SAAShoC,KAAK8yB,iBAC1B,GAAI9yB,KAAK8yB,YAAc9yB,KAAK8yB,YAAc9yB,KAAK+qB,KAAO/qB,KAAK+qB,IAAI6I,SAAS5zB,KAAK8yB,YAClFwO,EAAuD,EAA/CvW,EAAI8I,wBAAwB7zB,KAAK8yB,iBACpC,GAAI9yB,KAAK+qB,IAAI/iB,WAAY,CAC9B,GAAc,GAAVrG,EAAe,IAAK,IAAIukB,EAAS6E,GAAM7E,EAASA,EAAOmJ,WAAY,CACrE,GAAInJ,GAAUlmB,KAAK+qB,IAAK,CAAEuW,GAAQ,EAAO,MACzC,GAAIpb,EAAOmJ,WAAWrnB,YAAcke,EAAU,MAEhD,GAAa,MAATob,GAAiB3/B,GAAUopB,EAAImI,WAAWr0B,OAAU,IAAK,IAAImzC,EAAWjnB,GAAMinB,EAAWA,EAAS3iB,WAAY,CAChH,GAAI2iB,GAAYhyC,KAAK+qB,IAAK,CAAEuW,GAAQ,EAAM,MAC1C,GAAI0Q,EAAS3iB,WAAWhf,WAAa2hC,EAAY,OAGrD,OAAiB,MAAT1Q,EAAgBh2B,EAAO,EAAIg2B,GAASthC,KAAKgxC,SAAWhxC,KAAKsuC,YAKnEwC,EAAS1wC,UAAU6tC,YAAc,SAASA,YAAaljB,EAAKknB,GAC1D,IAAK,IAAI/gC,GAAQ,EAAMzB,EAAMsb,EAAKtb,EAAKA,EAAMA,EAAI4f,WAAY,CAC3D,IAAIkV,EAAOvkC,KAAKkyC,QAAQziC,GACxB,GAAI80B,KAAU0N,GAAa1N,EAAK58B,MAAO,CAErC,IAAIuJ,IAASqzB,EAAK4N,UACa,GAAzB5N,EAAK4N,QAAQtpC,SAAgB07B,EAAK4N,QAAQve,SAAyB,GAAhB7I,EAAIliB,SAAgBkiB,EAAMA,EAAIsE,YAAckV,EAAK4N,SAAWpnB,GAGjH,OAAOwZ,EAFPrzB,GAAQ,KAOlB4/B,EAAS1wC,UAAU8xC,QAAU,SAASA,QAASnnB,GAE7C,IADA,IAAIwZ,EAAOxZ,EAAIie,WACNv5B,EAAM80B,EAAM90B,EAAKA,EAAMA,EAAIpH,OAAU,GAAIoH,GAAOzP,KAAQ,OAAOukC,GAG1EuM,EAAS1wC,UAAUguC,WAAa,SAASA,WAAYrjB,EAAKppB,EAAQ2J,GAChE,IAAK,IAAIuH,EAAOkY,EAAKlY,EAAMA,EAAOA,EAAKwc,WAAY,CACjD,IAAIkV,EAAOvkC,KAAKkyC,QAAQr/B,GACxB,GAAI0xB,EAAQ,OAAOA,EAAKqN,gBAAgB7mB,EAAKppB,EAAQ2J,GAEvD,OAAQ,GAMVwlC,EAAS1wC,UAAUgyC,OAAS,SAASA,OAAQvyC,GAC3C,IAAK,IAAIf,EAAI,EAAG6C,EAAS,EAAG7C,EAAIkB,KAAKzE,SAASsD,OAAQC,IAAK,CACzD,IAAI9B,EAAQgD,KAAKzE,SAASuD,GAAImC,EAAMU,EAAS3E,EAAMN,KACnD,GAAIiF,GAAU9B,GAAOoB,GAAOU,EAAQ,CAClC,MAAQ3E,EAAMuxC,QAAUvxC,EAAMzB,SAASsD,QAAU7B,EAAQA,EAAMzB,SAAS,GACxE,OAAOyB,EAET,GAAI6C,EAAMoB,EAAO,OAAOjE,EAAMo1C,OAAOvyC,EAAM8B,EAAS3E,EAAMuxC,QAC1D5sC,EAASV,IAKb6vC,EAAS1wC,UAAUsuC,WAAa,SAASA,WAAY7uC,EAAKkqC,GACxD,IAAK/pC,KAAK8yB,WAAc,MAAO,CAACnrB,KAAM3H,KAAK+qB,IAAKppB,OAAQ,GAGxD,IADA,IAAI7C,EAAI,EAAG6C,EAAS,EACX4c,EAAS,EAAGzf,EAAIkB,KAAKzE,SAASsD,OAAQC,IAAK,CAClD,IAAI9B,EAAQgD,KAAKzE,SAASuD,GAAImC,EAAMsd,EAASvhB,EAAMN,KACnD,GAAIuE,EAAMpB,GAAO7C,aAAiBq1C,EAAsB,CAAE1wC,EAAS9B,EAAM0e,EAAQ,MACjFA,EAAStd,EAGX,GAAIU,EAAU,OAAO3B,KAAKzE,SAASuD,GAAG4vC,WAAW/sC,EAAS3B,KAAKzE,SAASuD,GAAGyvC,OAAQxE,GAEnF,IAAK,IAAInF,OAAO,EAAU9lC,KAAO8lC,EAAO5kC,KAAKzE,SAASuD,EAAI,IAAIpC,MAAQkoC,aAAgB0N,GAAkB1N,EAAK2N,OAAO5sC,KAAKokC,MAAQ,EAAGjrC,KAEpI,GAAIirC,GAAQ,EAAG,CAEb,IADA,IAAIyI,EAAQ7f,GAAQ,GAElB6f,EAAS1zC,EAAIkB,KAAKzE,SAASuD,EAAI,GAAK,OACrB0zC,EAAOznB,IAAIsE,YAAcrvB,KAAK8yB,WAFvCh0B,IAAK6zB,GAAQ,GAIrB,OAAI6f,GAAUzI,GAAQpX,IAAU6f,EAAOjE,SAAWiE,EAAOtB,QAAkBsB,EAAO9D,WAAW8D,EAAO91C,KAAMqtC,GACnG,CAACpiC,KAAM3H,KAAK8yB,WAAYnxB,OAAQ6wC,EAASxK,SAASwK,EAAOznB,KAAO,EAAI,GAG3E,IADA,IAAIljB,EAAM4qC,GAAU,GAElB5qC,EAAO/I,EAAIkB,KAAKzE,SAASsD,OAASmB,KAAKzE,SAASuD,GAAK,OACxC+I,EAAKkjB,IAAIsE,YAAcrvB,KAAK8yB,WAFnCh0B,IAAK2zC,GAAU,GAIvB,OAAI5qC,GAAQ4qC,IAAY5qC,EAAK0mC,SAAW1mC,EAAKqpC,QAAkBrpC,EAAK6mC,WAAW,EAAG3E,GAC3E,CAACpiC,KAAM3H,KAAK8yB,WAAYnxB,OAAQkG,EAAOmgC,SAASngC,EAAKkjB,KAAO/qB,KAAK8yB,WAAWI,WAAWr0B,SAMlGiyC,EAAS1wC,UAAUsyC,WAAa,SAASA,WAAYzwC,EAAMC,EAAI+H,GAG7D,QAFgB,IAATA,IAAkBA,EAAO,GAEJ,GAAxBjK,KAAKzE,SAASsD,OACd,MAAO,CAAC8I,KAAM3H,KAAK8yB,WAAY7wB,KAAMA,EAAMC,GAAIA,EAAIywC,WAAY,EAAGC,SAAU5yC,KAAK8yB,WAAWI,WAAWr0B,QAG3G,IADA,IAAI8zC,GAAc,EAAGC,GAAY,EACxBjxC,EAASsI,EAAMnL,EAAI,GAAIA,IAAK,CACnC,IAAI9B,EAAQgD,KAAKzE,SAASuD,GAAImC,EAAMU,EAAS3E,EAAMN,KACnD,IAAmB,GAAfi2C,GAAoB1wC,GAAQhB,EAAK,CACnC,IAAI4xC,EAAYlxC,EAAS3E,EAAMuxC,OAE/B,GAAItsC,GAAQ4wC,GAAa3wC,GAAMjB,EAAMjE,EAAMuxC,QAAUvxC,EAAM2K,MACvD3K,EAAM81B,YAAc9yB,KAAK8yB,WAAWc,SAAS52B,EAAM81B,YACnD,OAAO91B,EAAM01C,WAAWzwC,EAAMC,EAAI2wC,GAEtC5wC,EAAON,EACP,IAAK,IAAI0N,EAAIvQ,EAAGuQ,EAAI,EAAGA,IAAK,CAC1B,IAAIu1B,EAAO5kC,KAAKzE,SAAS8T,EAAI,GAC7B,GAAIu1B,EAAKloC,MAAQkoC,EAAK7Z,IAAIsE,YAAcrvB,KAAK8yB,aAAe8R,EAAKkO,aAAa,GAAI,CAChFH,EAAa3K,SAASpD,EAAK7Z,KAAO,EAClC,MAEF9oB,GAAQ2iC,EAAKloC,MAEI,GAAfi2C,IAAoBA,EAAa,GAEvC,GAAIA,GAAc,IAAM1xC,EAAMiB,GAAMpD,GAAKkB,KAAKzE,SAASsD,OAAS,GAAI,CAClEqD,EAAKjB,EACL,IAAK,IAAI8xC,EAAMj0C,EAAI,EAAGi0C,EAAM/yC,KAAKzE,SAASsD,OAAQk0C,IAAO,CACvD,IAAIlrC,EAAO7H,KAAKzE,SAASw3C,GACzB,GAAIlrC,EAAKnL,MAAQmL,EAAKkjB,IAAIsE,YAAcrvB,KAAK8yB,aAAejrB,EAAKirC,cAAc,GAAI,CACjFF,EAAW5K,SAASngC,EAAKkjB,KACzB,MAEF7oB,GAAM2F,EAAKnL,MAEI,GAAbk2C,IAAkBA,EAAW5yC,KAAK8yB,WAAWI,WAAWr0B,QAC5D,MAEF8C,EAASV,EAEX,MAAO,CAAC0G,KAAM3H,KAAK8yB,WAAY7wB,KAAMA,EAAMC,GAAIA,EAAIywC,WAAYA,EAAYC,SAAUA,IAGvF9B,EAAS1wC,UAAU0yC,aAAe,SAASA,aAAc/I,GACvD,GAAI/pC,KAAKuuC,SAAWvuC,KAAK8yB,aAAe9yB,KAAKzE,SAASsD,OAAU,OAAO,EACvE,IAAI7B,EAAQgD,KAAKzE,SAASwuC,EAAO,EAAI,EAAI/pC,KAAKzE,SAASsD,OAAS,GAChE,OAAqB,GAAd7B,EAAMN,MAAaM,EAAM81C,aAAa/I,IAI/C+G,EAAS1wC,UAAUwwC,YAAc,SAASA,YAAa/wC,GACrD,IAAIiS,EAAM9R,KAAK0uC,WAAW7uC,EAAK,GACzB8H,EAAOmK,EAAInK,KACXhG,EAASmQ,EAAInQ,OACnB,GAAqB,GAAjBgG,EAAKkB,UAAiBlH,GAAUgG,EAAKurB,WAAWr0B,OAChD,MAAM,IAAI6G,WAAW,qBAAuB7F,GAChD,OAAO8H,EAAKurB,WAAWvxB,IASzBmvC,EAAS1wC,UAAUkiC,aAAe,SAASA,aAAc5B,EAAQxS,EAAMwf,EAAM7S,GAG3E,IADA,IAAI54B,EAAOxC,KAAKuO,IAAI0yB,EAAQxS,GAAOhsB,EAAKzC,KAAK8G,IAAIm6B,EAAQxS,GAChDpvB,EAAI,EAAG6C,EAAS,EAAG7C,EAAIkB,KAAKzE,SAASsD,OAAQC,IAAK,CACzD,IAAI9B,EAAQgD,KAAKzE,SAASuD,GAAImC,EAAMU,EAAS3E,EAAMN,KACnD,GAAIuF,EAAON,GAAUO,EAAKjB,EACtB,OAAOjE,EAAMslC,aAAa5B,EAAS/+B,EAAS3E,EAAMuxC,OAAQrgB,EAAOvsB,EAAS3E,EAAMuxC,OAAQb,EAAM7S,GAClGl5B,EAASV,EAGX,IAAI+xC,EAAYhzC,KAAK0uC,WAAWhO,EAAQA,GAAU,EAAI,GAClDuS,EAAU/kB,GAAQwS,EAASsS,EAAYhzC,KAAK0uC,WAAWxgB,EAAMA,GAAQ,EAAI,GACzEgb,EAASwE,EAAKyC,eAEd+C,GAAW,EAKf,IAAKhyC,EAAOgmC,OAAShmC,EAAOomC,SAAW5G,GAAUxS,EAAM,CACrD,IAAIvmB,EAAOqrC,EAAUrrC,KACfwrC,EAAWH,EAAUrxC,OAC3B,GAAqB,GAAjBgG,EAAKkB,UAGP,IAFAqqC,EAAWC,GAA4C,MAAhCxrC,EAAKspB,UAAUkiB,EAAW,KAEjCA,GAAYxrC,EAAKspB,UAAUpyB,OACzC,IAAK,IAAIgU,EAAOlL,EAAM4C,OAAQ,EAAUsI,EAAMA,EAAOA,EAAKwc,WAAY,CACpE,GAAI9kB,EAAQsI,EAAK8e,YAAa,CACN,MAAlBpnB,EAAM+kB,WACN0jB,EAAYC,EAAU,CAACtrC,KAAM4C,EAAM8kB,WAAY1tB,OAAQqmC,SAASz9B,GAAS,IAC7E,MAEF,IAAIg6B,EAAO1xB,EAAKm2B,WAChB,GAAIzE,GAAQA,EAAK58B,MAAQ48B,EAAK58B,KAAKmW,QAAW,WAG7C,CACL,IAAI8mB,EAAOj9B,EAAKurB,WAAWigB,EAAW,GACtCD,EAAWtO,IAA0B,MAAjBA,EAAKtV,UAA4C,SAAxBsV,EAAKmE,kBAKtD,GAAI7nC,EAAOgmC,OAASgC,EAAOqH,WAAarH,EAAOqH,WAAa0C,EAAQtrC,MAAqC,GAA7BuhC,EAAOqH,UAAU1nC,SAAe,CAC1G,IAAIqmC,EAAUhG,EAAOqH,UAAUrd,WAAWgW,EAAOuH,aAC7CvB,GAAsC,SAA3BA,EAAQnG,kBAA8BlO,GAAQ,GAG/D,GAAMA,GAASqY,GAAYhyC,EAAOomC,SAC9BkB,qBAAqBwK,EAAUrrC,KAAMqrC,EAAUrxC,OAAQunC,EAAOkK,WAAYlK,EAAOmK,gBACjF7K,qBAAqByK,EAAQtrC,KAAMsrC,EAAQtxC,OAAQunC,EAAOqH,UAAWrH,EAAOuH,aAFhF,CAQA,IAAI6C,GAAiB,EACrB,IAAKpK,EAAOhyB,QAAUwpB,GAAUxS,KAAUglB,EAAU,CAClDhK,EAAOqK,SAASP,EAAUrrC,KAAMqrC,EAAUrxC,QAC1C,IACM++B,GAAUxS,GAAQgb,EAAOhyB,OAAO+7B,EAAQtrC,KAAMsrC,EAAQtxC,QAC1D2xC,GAAiB,EACjB,MAAOjxC,GAKP,KAAMA,aAAemxC,cAAiB,MAAMnxC,GAIhD,IAAKixC,EAAgB,CACnB,GAAI5S,EAASxS,EAAM,CAAE,IAAIzM,EAAMuxB,EAAWA,EAAYC,EAASA,EAAUxxB,EACzE,IAAIrZ,EAAQysB,SAASwT,cACrBjgC,EAAMkgC,OAAO2K,EAAQtrC,KAAMsrC,EAAQtxC,QACnCyG,EAAMmgC,SAASyK,EAAUrrC,KAAMqrC,EAAUrxC,QACzCunC,EAAO2H,kBACP3H,EAAOvoB,SAASvY,MAKpB0oC,EAAS1wC,UAAUqzC,eAAiB,SAASA,eAAgBC,GAC3D,OAAQ1zC,KAAK8yB,YAA+B,aAAjB4gB,EAAS/tC,MAGtCzB,EAAmB+sC,YAAYhyC,IAAM,WACnC,OAAOe,KAAK8yB,YAAc9yB,KAAK8yB,YAAc9yB,KAAK+qB,MAAQ/qB,KAAK+qB,IAAI6I,SAAS5zB,KAAK8yB,aAKnFge,EAAS1wC,UAAUuzC,UAAY,SAASA,UAAW1xC,EAAMC,GACvD,IAAK,IAAIP,EAAS,EAAG7C,EAAI,EAAGA,EAAIkB,KAAKzE,SAASsD,OAAQC,IAAK,CACzD,IAAI9B,EAAQgD,KAAKzE,SAASuD,GAAImC,EAAMU,EAAS3E,EAAMN,KACnD,GAAIiF,GAAUV,EAAMgB,GAAQhB,GAAOiB,GAAMP,EAASM,EAAOhB,GAAOiB,EAAKP,EAAQ,CAC3E,IAAIiyC,EAAcjyC,EAAS3E,EAAMuxC,OAAQsF,EAAY5yC,EAAMjE,EAAMuxC,OACjE,GAAItsC,GAAQ2xC,GAAe1xC,GAAM2xC,EAK/B,OAJA7zC,KAAK+wC,MAAQ9uC,GAAQN,GAAUO,GAAMjB,EApXO,EAAnB,OAqXrBgB,GAAQ2xC,GAAe1xC,GAAM2xC,IAC5B72C,EAAMi0C,aAAej0C,EAAM+tB,IAAIsE,YAAcrvB,KAAK8yB,WAChD91B,EAAM22C,UAAU1xC,EAAO2xC,EAAa1xC,EAAK0xC,GADsB52C,EAAM+zC,MAtXhB,GA0X5D/zC,EAAM+zC,MAAQ/zC,EAAM+tB,KAAO/tB,EAAM81B,YAAc91B,EAAM+tB,IAAIsE,YAAcrvB,KAAK8yB,YAAe91B,EAAMzB,SAASsD,OA1X9C,EAAhB,EA8XhD8C,EAASV,EAEXjB,KAAK+wC,MAhY6C,GAmYpDD,EAAS1wC,UAAU0zC,iBAAmB,SAASA,mBAE7C,IADA,IAAIphC,EAAQ,EACH/K,EAAO3H,KAAKqI,OAAQV,EAAMA,EAAOA,EAAKU,OAAQqK,IAAS,CAC9D,IAAIq+B,EAAiB,GAATr+B,EAtYoC,EAAnB,EAuYzB/K,EAAKopC,MAAQA,IAASppC,EAAKopC,MAAQA,KAI3C7sC,EAAmBgtC,QAAQjyC,IAAM,WAAc,OAAO,GAEtDiF,EAAmBirC,gBAAgBlwC,IAAM,WAAc,OAAO,GAE9DyE,OAAOoB,iBAAkBgsC,EAAS1wC,UAAW8D,GAI7C,IAAI6vC,EAAU,GAIVzB,EAA+B,SAAUxB,GAC3C,SAASwB,eAAejqC,EAAQkqC,EAAQhI,EAAM1qC,GAC5C,IAAIsW,EAAM4U,EAAMwnB,EAAO5sC,KAAKivB,MAK5B,GAJkB,mBAAP7J,IAAqBA,EAAMA,EAAIwf,GAAM,WAC9C,OAAKp0B,EACDA,EAAK9N,OAAiB8N,EAAK9N,OAAOspC,eAAex7B,QAArD,EADoBtW,OAGjB0yC,EAAO5sC,KAAK+C,KAAKsrC,IAAK,CACzB,GAAoB,GAAhBjpB,EAAIliB,SAAe,CACrB,IAAIuD,EAAOyoB,SAASgB,cAAc,QAClCzpB,EAAKwlB,YAAY7G,GACjBA,EAAM3e,EAER2e,EAAIge,iBAAkB,EACtBhe,EAAIkpB,UAAUj1C,IAAI,sBAEpB8xC,EAASvuC,KAAKvC,KAAMqI,EAAQ0rC,EAAShpB,EAAK,MAC1C/qB,KAAKuyC,OAASA,EACdp8B,EAAOnW,KAGJ8wC,IAAWwB,eAAe9vC,UAAYsuC,GAC3CwB,eAAelyC,UAAYsD,OAAOC,OAAQmtC,GAAYA,EAAS1wC,WAC/DkyC,eAAelyC,UAAUwD,YAAc0uC,eAEvC,IAAIriC,EAAuB,CAAEihC,QAAS,CAAE9sC,cAAc,IA0BtD,OAxBAkuC,eAAelyC,UAAU+wC,cAAgB,SAASA,cAAeoB,GAC/D,OAnbY,GAmbLvyC,KAAK+wC,OAAsBwB,EAAO5sC,KAAKoI,GAAG/N,KAAKuyC,OAAO5sC,OAG/D2sC,eAAelyC,UAAUoxC,UAAY,SAASA,YAAe,MAAO,CAAC1f,QAAQ,IAE7EwgB,eAAelyC,UAAUqxC,UAAY,SAASA,UAAWhI,GACvD,IAAIyK,EAAOl0C,KAAKuyC,OAAO7pC,KAAK+oC,UAC5B,QAAOyC,GAAOA,EAAKzK,IAGrB6I,eAAelyC,UAAUqzC,eAAiB,SAASA,eAAgBC,GACjE,MAAwB,aAAjBA,EAAS/tC,MAAuB3F,KAAKuyC,OAAO7pC,KAAKyrC,iBAG1D7B,eAAelyC,UAAUsxC,QAAU,SAASA,UAC1C1xC,KAAKuyC,OAAO5sC,KAAK+rC,QAAQ1xC,KAAK+qB,KAC9B+lB,EAAS1wC,UAAUsxC,QAAQnvC,KAAKvC,OAGlCiQ,EAAqBihC,QAAQjyC,IAAM,WAAc,OAAO,GAExDyE,OAAOoB,iBAAkBwtC,eAAelyC,UAAW6P,GAE5CqiC,eAnDyB,CAoDhCxB,GAEEsD,EAAoC,SAAUtD,GAChD,SAASsD,oBAAoB/rC,EAAQ0iB,EAAKspB,EAASt3B,GACjD+zB,EAASvuC,KAAKvC,KAAMqI,EAAQ0rC,EAAShpB,EAAK,MAC1C/qB,KAAKq0C,QAAUA,EACfr0C,KAAK+c,KAAOA,EAGT+zB,IAAWsD,oBAAoB5xC,UAAYsuC,GAChDsD,oBAAoBh0C,UAAYsD,OAAOC,OAAQmtC,GAAYA,EAAS1wC,WACpEg0C,oBAAoBh0C,UAAUwD,YAAcwwC,oBAE5C,IAAIhzB,EAAuB,CAAE1kB,KAAM,CAAE0H,cAAc,IAmBnD,OAjBAgd,EAAqB1kB,KAAKuC,IAAM,WAAc,OAAOe,KAAK+c,KAAKle,QAE/Du1C,oBAAoBh0C,UAAUwxC,gBAAkB,SAASA,gBAAiB7mB,EAAKppB,GAC7E,OAAIopB,GAAO/qB,KAAKq0C,QAAkBr0C,KAAKsuC,YAAc3sC,EAAS3B,KAAKtD,KAAO,GACnEsD,KAAKsuC,WAAa3sC,GAG3ByyC,oBAAoBh0C,UAAUsuC,WAAa,SAASA,WAAY7uC,GAC9D,MAAO,CAAC8H,KAAM3H,KAAKq0C,QAAS1yC,OAAQ9B,IAGtCu0C,oBAAoBh0C,UAAUqzC,eAAiB,SAASA,eAAgBa,GACtE,MAAoB,kBAAbA,EAAI3uC,MAA4B2uC,EAAIxoC,OAAOmlB,WAAaqjB,EAAIC,UAGrE7wC,OAAOoB,iBAAkBsvC,oBAAoBh0C,UAAWghB,GAEjDgzB,oBA9B8B,CA+BrCtD,GAOE0D,EAA6B,SAAU1D,GACzC,SAAS0D,aAAansC,EAAQoF,EAAMsd,EAAK+H,GACvCge,EAASvuC,KAAKvC,KAAMqI,EAAQ,GAAI0iB,EAAK+H,GACrC9yB,KAAKyN,KAAOA,EA2Cd,OAxCKqjC,IAAW0D,aAAahyC,UAAYsuC,GACzC0D,aAAap0C,UAAYsD,OAAOC,OAAQmtC,GAAYA,EAAS1wC,WAC7Do0C,aAAap0C,UAAUwD,YAAc4wC,aAErCA,aAAa7wC,OAAS,SAASA,OAAQ0E,EAAQoF,EAAMoZ,EAAQ0jB,GAC3D,IAAI5uC,EAAS4uC,EAAKkK,UAAUhnC,EAAK9H,KAAK9B,MAClC6E,EAAO/M,GAAUA,EAAO8R,EAAM88B,EAAM1jB,GAGxC,OAFKne,GAASA,EAAKqiB,MACfriB,EAAO,gBAAc4sB,WAAWT,SAAUpnB,EAAK9H,KAAK+C,KAAKksB,MAAMnnB,EAAMoZ,KAClE,IAAI2tB,aAAansC,EAAQoF,EAAM/E,EAAKqiB,IAAKriB,EAAKoqB,YAAcpqB,EAAKqiB,MAG1EypB,aAAap0C,UAAUoxC,UAAY,SAASA,YAC1C,OAtgBgE,EAsgB3DxxC,KAAK+wC,OAAuB/wC,KAAKyN,KAAK9H,KAAK+C,KAAKgsC,cAAwB,KACtE,CAACjnC,KAAMzN,KAAKyN,KAAK9H,KAAK9B,KAAMiF,MAAO9I,KAAKyN,KAAK3E,MAAOiqB,eAAgB/yB,KAAK8yB,aAGlF0hB,aAAap0C,UAAUgxC,YAAc,SAASA,YAAa3jC,GAAQ,OA1gBD,GA0gBQzN,KAAK+wC,OAAuB/wC,KAAKyN,KAAKM,GAAGN,IAEnH+mC,aAAap0C,UAAUuzC,UAAY,SAASA,UAAW1xC,EAAMC,GAG3D,GAFA4uC,EAAS1wC,UAAUuzC,UAAUpxC,KAAKvC,KAAMiC,EAAMC,GA7gBlC,GA+gBRlC,KAAK+wC,MAAoB,CAE3B,IADA,IAAI1oC,EAASrI,KAAKqI,QACVA,EAAOV,MAAQU,EAASA,EAAOA,OACnCA,EAAO0oC,MAAQ/wC,KAAK+wC,QAAS1oC,EAAO0oC,MAAQ/wC,KAAK+wC,OACrD/wC,KAAK+wC,MAnhBK,IAuhBdyD,aAAap0C,UAAUqC,MAAQ,SAASA,MAAOR,EAAMC,EAAIqoC,GACvD,IAAI7nC,EAAO8xC,aAAa7wC,OAAO3D,KAAKqI,OAAQrI,KAAKyN,MAAM,EAAM88B,GACzDzrB,EAAQ9e,KAAKzE,SAAUmB,EAAOsD,KAAKtD,KACnCwF,EAAKxF,IAAQoiB,EAAQ61B,aAAa71B,EAAO5c,EAAIxF,EAAM6tC,IACnDtoC,EAAO,IAAK6c,EAAQ61B,aAAa71B,EAAO,EAAG7c,EAAMsoC,IACrD,IAAK,IAAIzrC,EAAI,EAAGA,EAAIggB,EAAMjgB,OAAQC,IAAOggB,EAAMhgB,GAAGuJ,OAAS3F,EAE3D,OADAA,EAAKnH,SAAWujB,EACTpc,GAGF8xC,aA9CuB,CA+C9B1D,GAKE8D,EAA6B,SAAU9D,GACzC,SAAS8D,aAAavsC,EAAQV,EAAMktC,EAAWC,EAAW/pB,EAAK+H,EAAYqf,EAAS5H,EAAM1qC,GACxFixC,EAASvuC,KAAKvC,KAAMqI,EAAQV,EAAKI,OAASgsC,EAAU,GAAIhpB,EAAK+H,GAC7D9yB,KAAKmyC,QAAUA,EACfnyC,KAAK2H,KAAOA,EACZ3H,KAAK60C,UAAYA,EACjB70C,KAAK80C,UAAYA,EACbhiB,GAAc9yB,KAAK+0C,eAAexK,EAAM1qC,GAGzCixC,IAAW8D,aAAapyC,UAAYsuC,GACzC8D,aAAax0C,UAAYsD,OAAOC,OAAQmtC,GAAYA,EAAS1wC,WAC7Dw0C,aAAax0C,UAAUwD,YAAcgxC,aAErC,IAAIjyB,EAAuB,CAAEjmB,KAAM,CAAE0H,cAAc,GAAOmqC,OAAQ,CAAEnqC,cAAc,GAAO8sC,QAAS,CAAE9sC,cAAc,IAqNlH,OA1MAwwC,aAAajxC,OAAS,SAASA,OAAQ0E,EAAQV,EAAMktC,EAAWC,EAAWvK,EAAM1qC,GAC/E,IAAI83B,EAEyCqd,EAAzCr5C,EAAS4uC,EAAKkK,UAAU9sC,EAAKhC,KAAK9B,MAClC6E,EAAO/M,GAAUA,EAAOgM,EAAM4iC,GAAM,WAGtC,OAAKyK,EACDA,EAAQ3sC,OAAiB2sC,EAAQ3sC,OAAOspC,eAAeqD,QAA3D,EADuBn1C,IAEtBg1C,EAAWC,GAEV/pB,EAAMriB,GAAQA,EAAKqiB,IAAK+H,EAAapqB,GAAQA,EAAKoqB,WACtD,GAAInrB,EAAKmV,OACP,GAAKiO,GACA,GAAoB,GAAhBA,EAAIliB,SAAiB,MAAM,IAAInD,WAAW,iDADvCqlB,EAAM8J,SAASrC,eAAe7qB,EAAKoV,WAErCgO,IAC2DA,GAAzE4M,EAAS,gBAAcrC,WAAWT,SAAUltB,EAAKhC,KAAK+C,KAAKksB,MAAMjtB,KAAqBojB,IAAK+H,EAAa6E,EAAO7E,YAExGA,GAAenrB,EAAKmV,QAA0B,MAAhBiO,EAAIuE,WAChCvE,EAAIkqB,aAAa,qBAAsBlqB,EAAIge,iBAAkB,GAC9DphC,EAAKhC,KAAK+C,KAAKilC,YAAa5iB,EAAI4iB,WAAY,IAGlD,IAAIwE,EAAUpnB,EAGd,OAFAA,EAAMmqB,eAAenqB,EAAK8pB,EAAWltC,GAEjCe,EACOssC,EAAU,IAAIG,EAAmB9sC,EAAQV,EAAMktC,EAAWC,EAAW/pB,EAAK+H,EAAYqf,EACvDzpC,EAAM6hC,EAAM1qC,EAAM,GACnD8H,EAAKmV,OACH,IAAIs4B,EAAa/sC,EAAQV,EAAMktC,EAAWC,EAAW/pB,EAAKonB,EAAS5H,GAEnE,IAAIqK,aAAavsC,EAAQV,EAAMktC,EAAWC,EAAW/pB,EAAK+H,EAAYqf,EAAS5H,EAAM1qC,EAAM,IAGxG+0C,aAAax0C,UAAUoxC,UAAY,SAASA,YAC1C,IAAIjlC,EAASvM,KAGb,GAAIA,KAAK2H,KAAKhC,KAAK+C,KAAKgsC,cAAiB,OAAO,KAKhD,IAAIhqB,EAAO,CAAC/iB,KAAM3H,KAAK2H,KAAKhC,KAAK9B,KAAMiF,MAAO9I,KAAK2H,KAAKmB,OAIxD,MAHiC,OAA7B9I,KAAK2H,KAAKhC,KAAKijB,aAAuB8B,EAAK6D,mBAAqB,QAChEvuB,KAAK8yB,aAAe9yB,KAAKixC,YAAevmB,EAAKqI,eAAiB/yB,KAAK8yB,WAChEpI,EAAKmI,WAAa,WAAc,OAAOtmB,EAAOumB,WAAa,WAASjxB,MAAQ0K,EAAO5E,KAAKf,SACxF8jB,GAGTkqB,aAAax0C,UAAUixC,YAAc,SAASA,YAAa1pC,EAAMktC,EAAWC,GAC1E,OApnBY,GAonBL90C,KAAK+wC,OAAsBppC,EAAKoG,GAAG/N,KAAK2H,OAC7C0tC,cAAcR,EAAW70C,KAAK60C,YAAcC,EAAU/mC,GAAG/N,KAAK80C,YAGlEnyB,EAAqBjmB,KAAKuC,IAAM,WAAc,OAAOe,KAAK2H,KAAKoF,UAE/D4V,EAAqB4rB,OAAOtvC,IAAM,WAAc,OAAOe,KAAK2H,KAAKI,OAAS,EAAI,GAM9E6sC,aAAax0C,UAAU20C,eAAiB,SAASA,eAAgBxK,EAAM1qC,GACrE,IAAI0M,EAASvM,KAET6mB,EAAS7mB,KAAK2H,KAAKma,cAAe2mB,EAAM5oC,EACxCy1C,EAAc/K,EAAKgL,WAAav1C,KAAKw1C,qBAAqBjL,EAAM1qC,GAChE41C,EAAmBH,GAAeA,EAAYz1C,KAAO,EAAIy1C,EAAc,KACvEI,EAAqBJ,GAAeA,EAAYz1C,IAAM,EACtD81C,EAAU,IAAIC,EAAgB51C,KAAMy1C,GAAoBA,EAAiB9tC,OAipBjF,SAASkuC,SAASxtC,EAAQytC,EAAMC,EAAUC,GACxC,IAAIC,EAASH,EAAKG,OAAO5tC,GAAS1G,EAAS,EAE3C,GAAqB,GAAjBs0C,EAAOp3C,OAAa,CACtB,IAAK,IAAIC,EAAI,EAAGA,EAAIuJ,EAAOT,WAAY9I,IAAK,CAC1C,IAAI9B,EAAQqL,EAAOrL,MAAM8B,GACzBk3C,EAAOh5C,EAAOi5C,EAAQH,EAAKI,SAASv0C,EAAQ3E,GAAQ8B,GACpD6C,GAAU3E,EAAM+P,SAElB,OAIF,IADA,IAAIopC,EAAY,EAAG1vB,EAAS,GAAI2vB,EAAW,KAClCC,EAAc,IAAK,CAC1B,GAAIF,EAAYF,EAAOp3C,QAAUo3C,EAAOE,GAAWj0C,IAAMP,EAAQ,CAE/D,IADA,IAAI4wC,EAAS0D,EAAOE,KAAcG,OAAU,EACrCH,EAAYF,EAAOp3C,QAAUo3C,EAAOE,GAAWj0C,IAAMP,IACvD20C,IAAYA,EAAU,CAAC/D,KAAUr0C,KAAK+3C,EAAOE,MAClD,GAAIG,EAAS,CACXA,EAAQ92B,KAAK+2B,aACb,IAAK,IAAI1mC,EAAM,EAAGA,EAAMymC,EAAQz3C,OAAQgR,IAASkmC,EAASO,EAAQzmC,GAAMwmC,IAAeD,QAEvFL,EAASxD,EAAQ8D,IAAeD,GAIpC,IAAII,OAAU,EAAUl2C,OAAQ,EAChC,GAAI81C,EACF91C,GAAS,EACTk2C,EAAUJ,EACVA,EAAW,SACN,MAAIC,EAAchuC,EAAOT,YAI9B,MAHAtH,EAAQ+1C,EACRG,EAAUnuC,EAAOrL,MAAMq5C,KAKzB,IAAK,IAAI5jC,EAAM,EAAGA,EAAMgU,EAAO5nB,OAAQ4T,IAAagU,EAAOhU,GAAKvQ,IAAMP,GAAU8kB,EAAOtnB,OAAOsT,IAAO,GACrG,KAAO0jC,EAAYF,EAAOp3C,QAAUo3C,EAAOE,GAAWl0C,MAAQN,GAAUs0C,EAAOE,GAAWj0C,GAAKP,GAC3F8kB,EAAOvoB,KAAK+3C,EAAOE,MAEvB,IAAIl1C,EAAMU,EAAS60C,EAAQzpC,SAC3B,GAAIypC,EAAQ15B,OAAQ,CAClB,IAAI25B,EAAQx1C,EACRk1C,EAAYF,EAAOp3C,QAAUo3C,EAAOE,GAAWl0C,KAAOw0C,IAASA,EAAQR,EAAOE,GAAWl0C,MAC7F,IAAK,IAAIy0C,EAAM,EAAGA,EAAMjwB,EAAO5nB,OAAQ63C,IAAajwB,EAAOiwB,GAAKx0C,GAAKu0C,IAASA,EAAQhwB,EAAOiwB,GAAKx0C,IAC9Fu0C,EAAQx1C,IACVm1C,EAAWI,EAAQx4B,IAAIy4B,EAAQ90C,GAC/B60C,EAAUA,EAAQx4B,IAAI,EAAGy4B,EAAQ90C,GACjCV,EAAMw1C,EACNn2C,GAAS,GAOb01C,EAAOQ,EAHU/vB,EAAO5nB,OAClB23C,EAAQ7qC,WAAa6qC,EAAQzuC,OAAS0e,EAAOkwB,QAAO,SAAUvsC,GAAK,OAAQA,EAAEyc,UAC7EJ,EAAOhkB,QAFoBsxC,EAGN+B,EAAKI,SAASv0C,EAAQ60C,GAAUl2C,GAC3DqB,EAASV,GA3sBT40C,CAAS71C,KAAK2H,KAAM3H,KAAK80C,WAAW,SAAUvC,EAAQzzC,EAAG83C,GACnDrE,EAAO7pC,KAAKsE,MACZ2oC,EAAQkB,YAAYtE,EAAO7pC,KAAKsE,MAAO6Z,EAAQ0jB,GAC1CgI,EAAO5sC,KAAKokC,MAAQ,IAAM6M,GAC/BjB,EAAQkB,YAAY/3C,GAAKyN,EAAO5E,KAAKC,WAAa,OAAK2X,KAAOhT,EAAO5E,KAAK3K,MAAM8B,GAAGkO,MAAO6Z,EAAQ0jB,GAGtGoL,EAAQmB,YAAYvE,EAAQhI,EAAM9B,MACjC,SAAUzrC,EAAO63C,EAAWC,EAAWh2C,GAIxC,IAAIi4C,EAFJpB,EAAQkB,YAAY75C,EAAMgQ,MAAO6Z,EAAQ0jB,GAGrCoL,EAAQqB,cAAch6C,EAAO63C,EAAWC,EAAWh2C,IAAe42C,GAAsBnL,EAAKz0B,MAAMusB,UAAUpgC,KAAOwmC,GAC7G8B,EAAKz0B,MAAMusB,UAAUngC,GAAKumC,EAAMzrC,EAAM+P,WACrCgqC,EAAYpB,EAAQsB,mBAAmB3B,EAAY3tC,QAAU,GAC9DguC,EAAQuB,aAAal6C,EAAO63C,EAAWC,EAAWiC,EAAWxM,IAAkBoL,EAAQwB,eAAen6C,EAAO63C,EAAWC,EAAWvK,EAAMzrC,IAElJ62C,EAAQj1B,QAAQ1jB,EAAO63C,EAAWC,EAAWvK,EAAM9B,GAErDA,GAAOzrC,EAAM+P,YAGf4oC,EAAQkB,YAAY9C,EAASltB,EAAQ0jB,GACjCvqC,KAAK2H,KAAKwD,aAAewqC,EAAQyB,oBACrCzB,EAAQ0B,eAGJ1B,EAAQ2B,SApqBoC,GAoqBzBt3C,KAAK+wC,SAEtB0E,GAAoBz1C,KAAKu3C,wBAAwBhN,EAAMkL,GAC3D+B,YAAYx3C,KAAK8yB,WAAY9yB,KAAKzE,SAAUgvC,GACxCrpC,EAAOsmC,KAirBjB,SAASiQ,SAAS1sB,GAChB,GAAoB,MAAhBA,EAAIuE,UAAoC,MAAhBvE,EAAIuE,SAAkB,CAChD,IAAIooB,EAAS3sB,EAAI5b,MAAMwoC,QACvB5sB,EAAI5b,MAAMwoC,QAAUD,EAAS,kCAC7BxhC,OAAO0hC,iBAAiB7sB,GAAK8sB,UAC7B9sB,EAAI5b,MAAMwoC,QAAUD,GAtrBAD,CAASz3C,KAAK+qB,OAIpC6pB,aAAax0C,UAAUo1C,qBAAuB,SAASA,qBAAsBjL,EAAM1qC,GAGjF,IAAIiS,EAAMy4B,EAAKz0B,MAAMusB,UACjBpgC,EAAO6P,EAAI7P,KACXC,EAAK4P,EAAI5P,GACb,OAAMqoC,EAAKz0B,MAAMusB,qBAAqB,kBAAkBpgC,EAAOpC,GAAOqC,EAAKrC,EAAMG,KAAK2H,KAAKf,QAAQlK,MAAnG,CACA,IAAI0lC,EAAMmI,EAAKmD,KAAKyC,eAChBrc,EA8qBR,SAASgkB,eAAenwC,EAAMhG,GAC5B,OAAS,CACP,GAAqB,GAAjBgG,EAAKkB,SAAiB,OAAOlB,EACjC,GAAqB,GAAjBA,EAAKkB,UAAiBlH,EAAS,EAAG,CACpC,GAAIgG,EAAKurB,WAAWr0B,OAAS8C,GAA8C,GAApCgG,EAAKurB,WAAWvxB,GAAQkH,SAC3D,OAAOlB,EAAKurB,WAAWvxB,GAE3BA,EAASoL,SADTpF,EAAOA,EAAKurB,WAAWvxB,EAAS,QAE3B,MAAqB,GAAjBgG,EAAKkB,UAAiBlH,EAASgG,EAAKurB,WAAWr0B,QAIxD,OAAO,KAHP8I,EAAOA,EAAKurB,WAAWvxB,GACvBA,EAAS,IAxrBIm2C,CAAe1V,EAAImO,UAAWnO,EAAIqO,aACjD,GAAK3c,GAAa9zB,KAAK+qB,IAAI6I,SAASE,EAASzE,YAA7C,CAEA,GAAIrvB,KAAK2H,KAAKma,cAAe,CAI3B,IAAI/E,EAAO+W,EAAS7C,UAChB8mB,EAwrBV,SAASC,mBAAmBxnC,EAAMuM,EAAM9a,EAAMC,GAC5C,IAAK,IAAIpD,EAAI,EAAGe,EAAM,EAAGf,EAAI0R,EAAK5I,YAAc/H,GAAOqC,GAAK,CAC1D,IAAIlF,EAAQwT,EAAKxT,MAAM8B,KAAMm5C,EAAap4C,EAE1C,GADAA,GAAO7C,EAAM+P,SACR/P,EAAM8f,OAAX,CAEA,IADA,IAAImF,EAAMjlB,EAAM+f,KACTje,EAAI0R,EAAK5I,YAAY,CAC1B,IAAIC,EAAO2I,EAAKxT,MAAM8B,KAEtB,GADAe,GAAOgI,EAAKkF,UACPlF,EAAKiV,OAAU,MACpBmF,GAAOpa,EAAKkV,KAEd,GAAIld,GAAOoC,GAAQg2C,EAAa/1C,EAAI,CAClC,IAAIgN,EAAQ+S,EAAIuS,YAAYzX,EAAM7a,EAAK+1C,EAAa,GACpD,GAAI/oC,GAAS,GAAKA,EAAQ6N,EAAKle,OAASo5C,GAAch2C,EAClD,OAAOg2C,EAAa/oC,IAG5B,OAAQ,EA1sBU8oC,CAAmBh4C,KAAK2H,KAAKf,QAASmW,EAAM9a,EAAOpC,EAAKqC,EAAKrC,GAC3E,OAAOk4C,EAAU,EAAI,KAAO,CAACpwC,KAAMmsB,EAAUj0B,IAAKk4C,EAASh7B,KAAMA,GAEjE,MAAO,CAACpV,KAAMmsB,EAAUj0B,KAAM,MAIlC+0C,aAAax0C,UAAUm3C,wBAA0B,SAASA,wBAAyBhN,EAAMz4B,GACvF,IAAInK,EAAOmK,EAAInK,KACX9H,EAAMiS,EAAIjS,IACVkd,EAAOjL,EAAIiL,KAGf,IAAI/c,KAAKkyC,QAAQvqC,GAAjB,CAIA,IADA,IAAIyhB,EAAUzhB,EAERyhB,EAAQiG,YAAcrvB,KAAK8yB,WADzB1J,EAAUA,EAAQiG,WAAY,CAEpC,KAAOjG,EAAQ+H,iBAAmB/H,EAAQiG,WAAW6oB,YAAY9uB,EAAQ+H,iBACzE,KAAO/H,EAAQuI,aAAevI,EAAQiG,WAAW6oB,YAAY9uB,EAAQuI,aACjEvI,EAAQ4f,aAAc5f,EAAQ4f,WAAa,MAEjD,IAAIzE,EAAO,IAAI6P,EAAoBp0C,KAAMopB,EAASzhB,EAAMoV,GACxDwtB,EAAK4N,iBAAiBj6C,KAAKqmC,GAG3BvkC,KAAKzE,SAAWo5C,aAAa30C,KAAKzE,SAAUsE,EAAKA,EAAMkd,EAAKle,OAAQ0rC,EAAMhG,KAM5EqQ,aAAax0C,UAAUib,OAAS,SAASA,OAAQ1T,EAAMktC,EAAWC,EAAWvK,GAC3E,QA9tBgE,GA8tB5DvqC,KAAK+wC,QACJppC,EAAKkV,WAAW7c,KAAK2H,SAC1B3H,KAAKo4C,YAAYzwC,EAAMktC,EAAWC,EAAWvK,IACtC,IAGTqK,aAAax0C,UAAUg4C,YAAc,SAASA,YAAazwC,EAAMktC,EAAWC,EAAWvK,GACrFvqC,KAAKq4C,gBAAgBxD,GACrB70C,KAAK2H,KAAOA,EACZ3H,KAAK80C,UAAYA,EACb90C,KAAK8yB,YAAc9yB,KAAK+0C,eAAexK,EAAMvqC,KAAKsuC,YACtDtuC,KAAK+wC,MAzuBO,GA4uBd6D,aAAax0C,UAAUi4C,gBAAkB,SAASA,gBAAiBxD,GACjE,IAAIQ,cAAcR,EAAW70C,KAAK60C,WAAlC,CACA,IAAIyD,EAAqC,GAAzBt4C,KAAKmyC,QAAQtpC,SACzB0vC,EAASv4C,KAAK+qB,IAClB/qB,KAAK+qB,IAAMytB,eAAex4C,KAAK+qB,IAAK/qB,KAAKmyC,QACfsG,iBAAiBz4C,KAAK60C,UAAW70C,KAAK2H,KAAM2wC,GAC5CG,iBAAiB5D,EAAW70C,KAAK2H,KAAM2wC,IAC7Dt4C,KAAK+qB,KAAOwtB,IACdA,EAAOvP,WAAa,KACpBhpC,KAAK+qB,IAAIie,WAAahpC,MAExBA,KAAK60C,UAAYA,IAInBD,aAAax0C,UAAUs4C,WAAa,SAASA,aAC3C14C,KAAKmyC,QAAQ8B,UAAUj1C,IAAI,6BACvBgB,KAAK8yB,YAAe9yB,KAAK2H,KAAKhC,KAAK+C,KAAKilC,YAAa3tC,KAAK+qB,IAAI4iB,WAAY,IAIhFiH,aAAax0C,UAAUu4C,aAAe,SAASA,eAC7C34C,KAAKmyC,QAAQ8B,UAAUh4B,OAAO,6BAC1Bjc,KAAK8yB,YAAe9yB,KAAK2H,KAAKhC,KAAK+C,KAAKilC,WAAa3tC,KAAK+qB,IAAI6tB,gBAAgB,cAGpFj2B,EAAqBuuB,QAAQjyC,IAAM,WAAc,OAAOe,KAAK2H,KAAKkb,QAElEnf,OAAOoB,iBAAkB8vC,aAAax0C,UAAWuiB,GAE1CiyB,aAnOuB,CAoO9B9D,GAIF,SAAS+H,YAAY90C,EAAK8wC,EAAWC,EAAW/pB,EAAKwf,GAEnD,OADA2K,eAAenqB,EAAK8pB,EAAW9wC,GACxB,IAAI6wC,EAAa,KAAM7wC,EAAK8wC,EAAWC,EAAW/pB,EAAKA,EAAKA,EAAKwf,EAAM,GAGhF,IAAI6K,EAA6B,SAAUR,GACzC,SAASQ,aAAa/sC,EAAQV,EAAMktC,EAAWC,EAAW/pB,EAAKonB,EAAS5H,GACtEqK,EAAaryC,KAAKvC,KAAMqI,EAAQV,EAAMktC,EAAWC,EAAW/pB,EAAK,KAAMonB,EAAS5H,GAG7EqK,IAAeQ,aAAa5yC,UAAYoyC,GAC7CQ,aAAah1C,UAAYsD,OAAOC,OAAQixC,GAAgBA,EAAax0C,WACrEg1C,aAAah1C,UAAUwD,YAAcwxC,aAErC,IAAItxB,EAAuB,CAAEotB,QAAS,CAAE9sC,cAAc,IAuDtD,OArDAgxC,aAAah1C,UAAUoxC,UAAY,SAASA,YAE1C,IADA,IAAIxf,EAAOhyB,KAAKmyC,QAAQ9iB,WACjB2C,GAAQA,GAAQhyB,KAAK+qB,MAAQiH,EAAK8mB,UAAY9mB,EAAOA,EAAK3C,WACjE,MAAO,CAAC2C,KAAMA,IAAQ,IAGxBojB,aAAah1C,UAAUib,OAAS,SAASA,OAAQ1T,EAAMktC,EAAWr4C,EAAG+tC,GACnE,QAtyBgE,GAsyB5DvqC,KAAK+wC,OAtyBG,GAsyBqB/wC,KAAK+wC,QAAuB/wC,KAAK+4C,aAC7DpxC,EAAKkV,WAAW7c,KAAK2H,SAC1B3H,KAAKq4C,gBAAgBxD,GAxyBT,GAyyBP70C,KAAK+wC,OAAsBppC,EAAKoV,MAAQ/c,KAAK2H,KAAKoV,MAASpV,EAAKoV,MAAQ/c,KAAKmyC,QAAQlhB,YACxFjxB,KAAKmyC,QAAQlhB,UAAYtpB,EAAKoV,KAC1BwtB,EAAKyO,aAAeh5C,KAAKmyC,UAAW5H,EAAKyO,YAAc,OAE7Dh5C,KAAK2H,KAAOA,EACZ3H,KAAK+wC,MA9yBO,GA+yBL,IAGTqE,aAAah1C,UAAU24C,SAAW,SAASA,WAEzC,IADA,IAAIE,EAAYj5C,KAAKqI,OAAOyqB,WACnBlxB,EAAI5B,KAAKmyC,QAASvwC,EAAGA,EAAIA,EAAEytB,WAAc,GAAIztB,GAAKq3C,EAAa,OAAO,EAC/E,OAAO,GAGT7D,aAAah1C,UAAUsuC,WAAa,SAASA,WAAY7uC,GACvD,MAAO,CAAC8H,KAAM3H,KAAKmyC,QAASxwC,OAAQ9B,IAGtCu1C,aAAah1C,UAAUwxC,gBAAkB,SAASA,gBAAiB7mB,EAAKppB,EAAQ2J,GAC9E,OAAIyf,GAAO/qB,KAAKmyC,QAAkBnyC,KAAKsuC,WAAa7uC,KAAKuO,IAAIrM,EAAQ3B,KAAK2H,KAAKoV,KAAKle,QAC7E+1C,EAAax0C,UAAUwxC,gBAAgBrvC,KAAKvC,KAAM+qB,EAAKppB,EAAQ2J,IAGxE8pC,aAAah1C,UAAUqzC,eAAiB,SAASA,eAAgBC,GAC/D,MAAwB,iBAAjBA,EAAS/tC,MAA4C,aAAjB+tC,EAAS/tC,MAGtDyvC,aAAah1C,UAAUqC,MAAQ,SAASA,MAAOR,EAAMC,EAAIqoC,GACvD,IAAI5iC,EAAO3H,KAAK2H,KAAKqW,IAAI/b,EAAMC,GAAK6oB,EAAM8J,SAASrC,eAAe7qB,EAAKoV,MACvE,OAAO,IAAIq4B,aAAap1C,KAAKqI,OAAQV,EAAM3H,KAAK60C,UAAW70C,KAAK80C,UAAW/pB,EAAKA,EAAKwf,IAGvF6K,aAAah1C,UAAUuzC,UAAY,SAASA,UAAW1xC,EAAMC,GAC3D0yC,EAAax0C,UAAUuzC,UAAUpxC,KAAKvC,KAAMiC,EAAMC,GAC9ClC,KAAK+qB,KAAO/qB,KAAKmyC,SAAoB,GAARlwC,GAAaC,GAAMlC,KAAKmyC,QAAQlhB,UAAUpyB,SACvEmB,KAAK+wC,MA70BuD,IAg1BlEjtB,EAAqBotB,QAAQjyC,IAAM,WAAc,OAAO,GAExDyE,OAAOoB,iBAAkBswC,aAAah1C,UAAW0jB,GAE1CsxB,aAhEuB,CAiE9BR,GAIEvC,EAAqC,SAAUvB,GACjD,SAASuB,uBACPvB,EAASnsC,MAAM3E,KAAMmV,WAGlB27B,IAAWuB,qBAAqB7vC,UAAYsuC,GACjDuB,qBAAqBjyC,UAAYsD,OAAOC,OAAQmtC,GAAYA,EAAS1wC,WACrEiyC,qBAAqBjyC,UAAUwD,YAAcyuC,qBAE7C,IAAI1pB,EAAuB,CAAEuoB,QAAS,CAAE9sC,cAAc,GAAO+qC,gBAAiB,CAAE/qC,cAAc,IAS9F,OAPAiuC,qBAAqBjyC,UAAUoxC,UAAY,SAASA,YAAe,MAAO,CAAC1f,QAAQ,IACnFugB,qBAAqBjyC,UAAUkxC,YAAc,SAASA,YAAahiB,GAAY,OAr2BjE,GAq2BwEtvB,KAAK+wC,OAAsB/wC,KAAK+qB,IAAIuE,UAAYA,GACtI3G,EAAqBuoB,QAAQjyC,IAAM,WAAc,OAAO,GACxD0pB,EAAqBwmB,gBAAgBlwC,IAAM,WAAc,MAA4B,OAArBe,KAAK+qB,IAAIuE,UAEzE5rB,OAAOoB,iBAAkButC,qBAAqBjyC,UAAWuoB,GAElD0pB,qBAlB+B,CAmBtCvB,GAKEqE,EAAmC,SAAUP,GAC/C,SAASO,mBAAmB9sC,EAAQV,EAAMktC,EAAWC,EAAW/pB,EAAK+H,EAAYqf,EAASzpC,EAAM6hC,EAAM1qC,GACpG+0C,EAAaryC,KAAKvC,KAAMqI,EAAQV,EAAMktC,EAAWC,EAAW/pB,EAAK+H,EAAYqf,EAAS5H,EAAM1qC,GAC5FG,KAAK0I,KAAOA,EAiDd,OA9CKksC,IAAeO,mBAAmB3yC,UAAYoyC,GACnDO,mBAAmB/0C,UAAYsD,OAAOC,OAAQixC,GAAgBA,EAAax0C,WAC3E+0C,mBAAmB/0C,UAAUwD,YAAcuxC,mBAK3CA,mBAAmB/0C,UAAUib,OAAS,SAASA,OAAQ1T,EAAMktC,EAAWC,EAAWvK,GACjF,GA/3BgE,GA+3B5DvqC,KAAK+wC,MAAuB,OAAO,EACvC,GAAI/wC,KAAK0I,KAAK2S,OAAQ,CACpB,IAAIna,EAASlB,KAAK0I,KAAK2S,OAAO1T,EAAMktC,EAAWC,GAE/C,OADI5zC,GAAUlB,KAAKo4C,YAAYzwC,EAAMktC,EAAWC,EAAWvK,GACpDrpC,EACF,SAAKlB,KAAK8yB,aAAenrB,EAAKI,SAG5B6sC,EAAax0C,UAAUib,OAAO9Y,KAAKvC,KAAM2H,EAAMktC,EAAWC,EAAWvK,IAIhF4K,mBAAmB/0C,UAAUs4C,WAAa,SAASA,aACjD14C,KAAK0I,KAAKgwC,WAAa14C,KAAK0I,KAAKgwC,aAAe9D,EAAax0C,UAAUs4C,WAAWn2C,KAAKvC,OAGzFm1C,mBAAmB/0C,UAAUu4C,aAAe,SAASA,eACnD34C,KAAK0I,KAAKiwC,aAAe34C,KAAK0I,KAAKiwC,eAAiB/D,EAAax0C,UAAUu4C,aAAap2C,KAAKvC,OAG/Fm1C,mBAAmB/0C,UAAUkiC,aAAe,SAASA,aAAc5B,EAAQxS,EAAMwf,EAAM7S,GACrF76B,KAAK0I,KAAK45B,aAAetiC,KAAK0I,KAAK45B,aAAa5B,EAAQxS,EAAMwf,GAC1DkH,EAAax0C,UAAUkiC,aAAa//B,KAAKvC,KAAM0gC,EAAQxS,EAAMwf,EAAM7S,IAGzEsa,mBAAmB/0C,UAAUsxC,QAAU,SAASA,UAC1C1xC,KAAK0I,KAAKgpC,SAAW1xC,KAAK0I,KAAKgpC,UACnCkD,EAAax0C,UAAUsxC,QAAQnvC,KAAKvC,OAGtCm1C,mBAAmB/0C,UAAUqxC,UAAY,SAASA,UAAWhI,GAC3D,QAAOzpC,KAAK0I,KAAK+oC,WAAYzxC,KAAK0I,KAAK+oC,UAAUhI,IAGnD0L,mBAAmB/0C,UAAUqzC,eAAiB,SAASA,eAAgBC,GACrE,OAAO1zC,KAAK0I,KAAK+qC,eAAiBzzC,KAAK0I,KAAK+qC,eAAeC,GAAYkB,EAAax0C,UAAUqzC,eAAelxC,KAAKvC,KAAM0zC,IAGnHyB,mBApD6B,CAqDpCP,GAMF,SAAS4C,YAAYyB,EAAWC,EAAO3O,GAErC,IADA,IAAIxf,EAAMkuB,EAAUjxC,WAAYmxC,GAAU,EACjCr6C,EAAI,EAAGA,EAAIo6C,EAAMr6C,OAAQC,IAAK,CACrC,IAAIylC,EAAO2U,EAAMp6C,GAAIs6C,EAAW7U,EAAKxZ,IACrC,GAAIquB,EAAS/pB,YAAc4pB,EAAW,CACpC,KAAOG,GAAYruB,GAAOA,EAAMsuB,GAAGtuB,GAAMouB,GAAU,EACnDpuB,EAAMA,EAAI4G,iBAEVwnB,GAAU,EACVF,EAAUK,aAAaF,EAAUruB,GAEnC,GAAIwZ,aAAgBiQ,EAAc,CAChC,IAAI30C,EAAMkrB,EAAMA,EAAIoG,gBAAkB8nB,EAAU5oC,UAChDmnC,YAAYjT,EAAKzR,WAAYyR,EAAKhpC,SAAUgvC,GAC5Cxf,EAAMlrB,EAAMA,EAAI8xB,YAAcsnB,EAAUjxC,YAG5C,KAAO+iB,GAAOA,EAAMsuB,GAAGtuB,GAAMouB,GAAU,EACnCA,GAAW5O,EAAKyO,aAAeC,IAAa1O,EAAKyO,YAAc,MAGrE,SAASO,eAAejqB,GAClBA,IAAYtvB,KAAKsvB,SAAWA,GAElCiqB,eAAen5C,UAAYsD,OAAOC,OAAO,MAEzC,IAAI61C,EAAS,CAAC,IAAID,gBAElB,SAASd,iBAAiB5D,EAAWltC,EAAM2wC,GACzC,GAAwB,GAApBzD,EAAUh2C,OAAe,OAAO26C,EAIpC,IAFA,IAAI7mC,EAAM2lC,EAAYkB,EAAO,GAAK,IAAID,eAAgBr4C,EAAS,CAACyR,GAEvD7T,EAAI,EAAGA,EAAI+1C,EAAUh2C,OAAQC,IAAK,CACzC,IAAIgK,EAAQ+rC,EAAU/1C,GAAG6G,KAAKmD,MAC9B,GAAKA,EAIL,IAAK,IAAIjF,KAHLiF,EAAMwmB,UACNpuB,EAAOhD,KAAKyU,EAAM,IAAI4mC,eAAezwC,EAAMwmB,WAE9BxmB,EAAO,CACtB,IAAIwY,EAAMxY,EAAMjF,GACL,MAAPyd,IACAg3B,GAA8B,GAAjBp3C,EAAOrC,QACpBqC,EAAOhD,KAAKyU,EAAM,IAAI4mC,eAAe5xC,EAAKgE,SAAW,OAAS,QACtD,SAAR9H,EAAmB8O,EAAI8mC,OAAS9mC,EAAI8mC,MAAQ9mC,EAAI8mC,MAAQ,IAAM,IAAMn4B,EACvD,SAARzd,EAAmB8O,EAAIxD,OAASwD,EAAIxD,MAAQwD,EAAIxD,MAAQ,IAAM,IAAMmS,EAC5D,YAARzd,IAAsB8O,EAAI9O,GAAQyd,KAI/C,OAAOpgB,EAGT,SAASs3C,eAAekB,EAAUvH,EAASwH,EAAcC,GAEvD,GAAID,GAAgBH,GAAUI,GAAeJ,EAAU,OAAOrH,EAG9D,IADA,IAAI0H,EAAS1H,EACJrzC,EAAI,EAAGA,EAAI86C,EAAY/6C,OAAQC,IAAK,CAC3C,IAAIg3C,EAAO8D,EAAY96C,GAAI8lC,EAAO+U,EAAa76C,GAC/C,GAAIA,EAAG,CACL,IAAIuJ,OAAS,EACTu8B,GAAQA,EAAKtV,UAAYwmB,EAAKxmB,UAAYuqB,GAAUH,IACnDrxC,EAASwxC,EAAOxqB,aAAehnB,EAAOqtB,QAAQnG,eAAiBumB,EAAKxmB,YAGvEjnB,EAASwsB,SAASgB,cAAcigB,EAAKxmB,WAC9BwpB,UAAW,EAClBzwC,EAAOupB,YAAYioB,GACnBjV,EAAO4U,EAAO,IALdK,EAASxxC,EASbyxC,gBAAgBD,EAAQjV,GAAQ4U,EAAO,GAAI1D,GAE7C,OAAO+D,EAGT,SAASC,gBAAgB/uB,EAAK6Z,EAAMn1B,GAClC,IAAK,IAAI5L,KAAQ+gC,EACD,SAAR/gC,GAA2B,SAARA,GAA2B,YAARA,GAAwBA,KAAQ4L,GACxEsb,EAAI6tB,gBAAgB/0C,GAC1B,IAAK,IAAIioB,KAAUrc,EACD,SAAVqc,GAA+B,SAAVA,GAA+B,YAAVA,GAAwBrc,EAAIqc,IAAW8Y,EAAK9Y,IACxFf,EAAIiL,aAAalK,EAAQrc,EAAIqc,IACnC,GAAI8Y,EAAK6U,OAAShqC,EAAIgqC,MAAO,CAG3B,IAFA,IAAIM,EAAWnV,EAAK6U,MAAQ7U,EAAK6U,MAAMpsC,MAAM,KAAKspC,OAAOqD,SAAWjG,EAChEkG,EAAUxqC,EAAIgqC,MAAQhqC,EAAIgqC,MAAMpsC,MAAM,KAAKspC,OAAOqD,SAAWjG,EACxDj1C,EAAI,EAAGA,EAAIi7C,EAASl7C,OAAQC,KAA4C,GAAjCm7C,EAAQl7C,QAAQg7C,EAASj7C,KACrEisB,EAAIkpB,UAAUh4B,OAAO89B,EAASj7C,IAClC,IAAK,IAAI+Q,EAAM,EAAGA,EAAMoqC,EAAQp7C,OAAQgR,KAAgD,GAAnCkqC,EAASh7C,QAAQk7C,EAAQpqC,KAC1Ekb,EAAIkpB,UAAUj1C,IAAIi7C,EAAQpqC,IACF,GAAxBkb,EAAIkpB,UAAUp1C,QACdksB,EAAI6tB,gBAAgB,SAE1B,GAAIhU,EAAKz1B,OAASM,EAAIN,MAAO,CAC3B,GAAIy1B,EAAKz1B,MAEP,IADA,IAA4FhM,EAAxFsZ,EAAO,gFACJtZ,EAAIsZ,EAAKqS,KAAK8V,EAAKz1B,QACtB4b,EAAI5b,MAAM+qC,eAAe/2C,EAAE,IAE7BsM,EAAIN,QACJ4b,EAAI5b,MAAMwoC,SAAWloC,EAAIN,QAIjC,SAAS+lC,eAAenqB,EAAK+qB,EAAMnuC,GACjC,OAAO6wC,eAAeztB,EAAKA,EAAKyuB,EAAQf,iBAAiB3C,EAAMnuC,EAAsB,GAAhBojB,EAAIliB,WAI3E,SAASwsC,cAAcvqC,EAAGC,GACxB,GAAID,EAAEjM,QAAUkM,EAAElM,OAAU,OAAO,EACnC,IAAK,IAAIC,EAAI,EAAGA,EAAIgM,EAAEjM,OAAQC,IAAO,IAAKgM,EAAEhM,GAAG6G,KAAKoI,GAAGhD,EAAEjM,GAAG6G,MAAS,OAAO,EAC5E,OAAO,EAIT,SAAS0zC,GAAGtuB,GACV,IAAIljB,EAAOkjB,EAAI4G,YAEf,OADA5G,EAAIsE,WAAW6oB,YAAYntB,GACpBljB,EAKT,IAAI+tC,EAAkB,SAASA,gBAAgBjjC,EAAKwnC,GAClDn6C,KAAK2S,IAAMA,EACX3S,KAAKo6C,KAAOD,EAGZn6C,KAAKM,MAAQ,EAGbN,KAAKyrC,MAAQ,GAEbzrC,KAAKs3C,SAAU,EAEft3C,KAAKq6C,SAyLP,SAASA,SAAS7pC,EAAM8pC,GACtB,IAAIC,EAAUD,EAAYE,EAAQD,EAAQh/C,SAASsD,OAC/C47C,EAAKjqC,EAAK5I,WAAYoH,EAAU,IAAIlS,IAAKwV,EAAU,GACvDnJ,EAAO,KAAOsxC,EAAK,GAAG,CAEpB,IADA,IAAIlW,OAAO,IAET,GAAIiW,EAAO,CACT,IAAI3yC,EAAO0yC,EAAQh/C,SAASi/C,EAAQ,GACpC,KAAI3yC,aAAgB2sC,GAGb,CACLjQ,EAAO18B,EACP2yC,IACA,MALAD,EAAU1yC,EACV2yC,EAAQ3yC,EAAKtM,SAASsD,WAMnB,IAAI07C,GAAWD,EACpB,MAAMnxC,EAGNqxC,EAAQD,EAAQlyC,OAAO9M,SAASwD,QAAQw7C,GACxCA,EAAUA,EAAQlyC,OAGtB,IAAIV,EAAO48B,EAAK58B,KAChB,GAAKA,EAAL,CACA,GAAIA,GAAQ6I,EAAKxT,MAAMy9C,EAAK,GAAM,QAChCA,EACFzrC,EAAQ/S,IAAIsoC,EAAMkW,GAClBnoC,EAAQpU,KAAKqmC,IAEf,MAAO,CAACjkC,MAAOm6C,EAAIzrC,QAASA,EAASsD,QAASA,EAAQsU,WAxNtCyzB,CAAS1nC,EAAIhL,KAAKf,QAAS+L,IA2N7C,SAAS4jC,YAAYzrC,EAAGC,GAAK,OAAOD,EAAEnF,KAAKokC,KAAOh/B,EAAEpF,KAAKokC,KA6HzD,SAAS4K,aAAa71B,EAAO7c,EAAMC,EAAIqoC,EAAMhnB,GAE3C,IADA,IAAIriB,EAAS,GACJpC,EAAI,EAAG2pC,EAAM,EAAG3pC,EAAIggB,EAAMjgB,OAAQC,IAAK,CAC9C,IAAI9B,EAAQ8hB,EAAMhgB,GAAIgC,EAAQ2nC,EAAKxnC,EAAMwnC,GAAOzrC,EAAMN,KAClDoE,GAASoB,GAAMjB,GAAOgB,EACxBf,EAAOhD,KAAKlB,IAER8D,EAAQmB,GAAQf,EAAOhD,KAAKlB,EAAMyF,MAAM,EAAGR,EAAOnB,EAAOypC,IACzDhnB,IACFriB,EAAOhD,KAAKqlB,GACZA,EAAc,MAEZtiB,EAAMiB,GAAMhB,EAAOhD,KAAKlB,EAAMyF,MAAMP,EAAKpB,EAAO9D,EAAMN,KAAM6tC,KAGpE,OAAOrpC,EAGT,SAASw5C,iBAAiBnQ,EAAMoQ,GAC9B,IAAIzR,EAASqB,EAAKmD,KAAKyC,eAAgBpsC,EAAMwmC,EAAKz0B,MAAM/R,IACxD,IAAKmlC,EAAOqH,UAAa,OAAO,KAChC,IAAItC,EAAc1D,EAAKyD,QAAQC,YAAY/E,EAAOqH,WAAYqK,EAAW3M,GAAmC,GAApBA,EAAYvxC,KAChGwxB,EAAOqc,EAAKyD,QAAQI,WAAWlF,EAAOqH,UAAWrH,EAAOuH,aAC5D,GAAIviB,EAAO,EAAK,OAAO,KACvB,IAA+BqS,EAAS8B,EAApC7B,EAAQz8B,EAAIwD,QAAQ2mB,GACxB,GAAI+a,mBAAmBC,GAAS,CAE9B,IADA3I,EAAUC,EACHyN,IAAgBA,EAAYtmC,MAAQsmC,EAAcA,EAAY5lC,OACrE,GAAI4lC,GAAeA,EAAYtmC,KAAKkb,QAAU,gBAAcqf,aAAa+L,EAAYtmC,OAASsmC,EAAY5lC,UACjG4lC,EAAYtmC,KAAKgE,WA1/D9B,SAASkvC,SAASlzC,EAAMhG,EAAQ0G,GAC9B,IAAK,IAAIg5B,EAAoB,GAAV1/B,EAAa2/B,EAAQ3/B,GAAUoL,SAASpF,GAAO05B,GAAWC,GAAQ,CACnF,GAAI35B,GAAQU,EAAU,OAAO,EAC7B,IAAI/H,EAAQ0nC,SAASrgC,GAErB,KADAA,EAAOA,EAAK0nB,YACC,OAAO,EACpBgS,EAAUA,GAAoB,GAAT/gC,EACrBghC,EAAQA,GAAShhC,GAASyM,SAASpF,IAm/DGkzC,CAAS3R,EAAOqH,UAAWrH,EAAOuH,YAAaxC,EAAYljB,MAAO,CACtG,IAAIlrB,EAAMouC,EAAYC,UACtB7L,EAAY,IAAI,gBAAcnU,GAAQruB,EAAM2gC,EAAQz8B,EAAIwD,QAAQ1H,SAE7D,CACL,IAAI6gC,EAAS6J,EAAKyD,QAAQI,WAAWlF,EAAOkK,WAAYlK,EAAOmK,cAC/D,GAAI3S,EAAS,EAAK,OAAO,KACzBH,EAAUx8B,EAAIwD,QAAQm5B,GAGnB2B,IAEHA,EAAYyY,iBAAiBvQ,EAAMhK,EAASC,EADvB,WAAVma,GAAwBpQ,EAAKz0B,MAAMusB,UAAUnU,KAAOsS,EAAM3gC,MAAQ+6C,EAAY,GAAK,IAGhG,OAAOvY,EAGT,SAAS0Y,oBAAoBxQ,GAC3B,OAAOA,EAAKyQ,SAAWzQ,EAAK0Q,WAC1BC,aAAa3Q,IAAS1V,SAAS2a,eAAiB3a,SAAS2a,cAAc5b,SAAS2W,EAAKxf,KAGzF,SAASowB,eAAe5Q,EAAM1P,GAC5B,IAAIuH,EAAMmI,EAAKz0B,MAAMusB,UAGrB,GAFA+Y,kBAAkB7Q,EAAMnI,GAEnB2Y,oBAAoBxQ,GAAzB,CAKA,IAAK1P,GAAS0P,EAAK8Q,WAAa9Q,EAAK8Q,UAAUC,cAAgBp6C,EAAOkmC,OAAQ,CAC5E,IAAI8B,EAASqB,EAAKmD,KAAKyC,eAAgBoL,EAAShR,EAAKiR,YAAYC,iBACjE,GAAIvS,EAAOkK,YAAc5K,qBAAqBU,EAAOkK,WAAYlK,EAAOmK,aAC1BkI,EAAOnI,WAAYmI,EAAOlI,cAGtE,OAFA9I,EAAK8Q,UAAUK,sBAAuB,OACtCnR,EAAKiR,YAAYG,kBAOrB,GAFApR,EAAKiR,YAAYI,sBAEbrR,EAAKsR,eA2EX,SAASC,oBAAoBvR,GAC3B,IAAIrB,EAASqB,EAAKmD,KAAKyC,eAAgB/nC,EAAQysB,SAASwT,cACpD1gC,EAAO4iC,EAAKsR,cAAc9wB,IAAKiU,EAAuB,OAAjBr3B,EAAK2nB,SAC1C0P,EAAO52B,EAAMkgC,OAAO3gC,EAAK0nB,WAAY2Y,SAASrgC,GAAQ,GACnDS,EAAMkgC,OAAO3gC,EAAM,GAC1BS,EAAMmrC,UAAS,GACfrK,EAAO2H,kBACP3H,EAAOvoB,SAASvY,IAMX42B,IAAQuL,EAAKz0B,MAAMusB,UAAUV,SAAWzgC,EAAO6lC,IAAM7lC,EAAO8lC,YAAc,KAC7Er/B,EAAKo0C,UAAW,EAChBp0C,EAAKo0C,UAAW,GAzFhBD,CAAoBvR,OACf,CACL,IAEIyR,EAAmBC,EAFnBvb,EAAS0B,EAAI1B,OACbxS,EAAOkU,EAAIlU,MAEXguB,GAAmC9Z,aAAe,kBAC/CA,EAAI96B,MAAMe,OAAOyZ,gBAClBk6B,EAAoBG,wBAAwB5R,EAAMnI,EAAIngC,OACrDmgC,EAAIvgC,OAAUugC,EAAI96B,MAAMe,OAAOyZ,gBAChCm6B,EAAkBE,wBAAwB5R,EAAMnI,EAAIlgC,MAE1DqoC,EAAKyD,QAAQ1L,aAAa5B,EAAQxS,EAAMqc,EAAKmD,KAAM7S,GAC/CqhB,IACEF,GAAqBI,cAAcJ,GACnCC,GAAmBG,cAAcH,IAEnC7Z,EAAIT,QACN4I,EAAKxf,IAAIkpB,UAAUh4B,OAAO,8BAE1BsuB,EAAKxf,IAAIkpB,UAAUj1C,IAAI,6BACnB,sBAAuB61B,UAsCjC,SAASwnB,6BAA6B9R,GACpC,IAAIxmC,EAAMwmC,EAAKxf,IAAIwH,cACnBxuB,EAAIu4C,oBAAoB,kBAAmB/R,EAAKgS,oBAChD,IAAIrT,EAASqB,EAAKmD,KAAKyC,eACnBxoC,EAAOuhC,EAAOkK,WAAYzxC,EAASunC,EAAOmK,aAC9CtvC,EAAIy4C,iBAAiB,kBAAmBjS,EAAKgS,mBAAqB,WAC5DrT,EAAOkK,YAAczrC,GAAQuhC,EAAOmK,cAAgB1xC,IACtDoC,EAAIu4C,oBAAoB,kBAAmB/R,EAAKgS,oBAChD5d,YAAW,WACJoc,oBAAoBxQ,KAASA,EAAKz0B,MAAMusB,UAAUV,SACnD4I,EAAKxf,IAAIkpB,UAAUh4B,OAAO,+BAC7B,OAjDoCogC,CAA6B9R,IAIxEA,EAAKiR,YAAYG,kBACjBpR,EAAKiR,YAAYiB,oBArbnB7G,EAAgBx1C,UAAUs8C,eAAiB,SAASA,eAAgB57C,EAAOG,GACzE,GAAIH,GAASG,EAAb,CACA,IAAK,IAAInC,EAAIgC,EAAOhC,EAAImC,EAAKnC,IAAOkB,KAAK2S,IAAIpX,SAASuD,GAAG4yC,UACzD1xC,KAAK2S,IAAIpX,SAAS4D,OAAO2B,EAAOG,EAAMH,GACtCd,KAAKs3C,SAAU,IAIjB1B,EAAgBx1C,UAAUi3C,YAAc,SAASA,cAC/Cr3C,KAAK08C,eAAe18C,KAAKM,MAAON,KAAK2S,IAAIpX,SAASsD,SAMpD+2C,EAAgBx1C,UAAUy2C,YAAc,SAASA,YAAa7pC,EAAO6Z,EAAQ0jB,GAG3E,IAFA,IAAIvV,EAAO,EAAGvtB,EAAQzH,KAAKyrC,MAAM5sC,QAAU,EACvC89C,EAAUl9C,KAAKuO,IAAIvG,EAAOuF,EAAMnO,QAC7Bm2B,EAAO2nB,IACN3nB,GAAQvtB,EAAQ,EAAIzH,KAAK2S,IAAM3S,KAAKyrC,MAAOzW,EAAO,GAAM,IAAIoc,YAAYpkC,EAAMgoB,MAA6C,IAAnChoB,EAAMgoB,GAAMrvB,KAAK+C,KAAKwsB,UAClHF,IAEJ,KAAOA,EAAOvtB,GACZzH,KAAKq3C,cACLr3C,KAAK2S,IAAIo+B,MAnlCG,EAolCZ/wC,KAAKM,MAAQN,KAAKyrC,MAAM14B,MACxB/S,KAAK2S,IAAM3S,KAAKyrC,MAAM14B,MACtBtL,IAEF,KAAOA,EAAQuF,EAAMnO,QAAQ,CAC3BmB,KAAKyrC,MAAMvtC,KAAK8B,KAAK2S,IAAK3S,KAAKM,MAAQ,GAEvC,IADA,IAAI4O,GAAS,EACJpQ,EAAIkB,KAAKM,MAAOxB,EAAIW,KAAKuO,IAAIhO,KAAKM,MAAQ,EAAGN,KAAK2S,IAAIpX,SAASsD,QAASC,IAC/E,GAAIkB,KAAK2S,IAAIpX,SAASuD,GAAGsyC,YAAYpkC,EAAMvF,IAAS,CAAEyH,EAAQpQ,EAAG,MAEnE,GAAIoQ,GAAS,EACPA,EAAQlP,KAAKM,QACfN,KAAKs3C,SAAU,EACft3C,KAAK08C,eAAe18C,KAAKM,MAAO4O,IAElClP,KAAK2S,IAAM3S,KAAK2S,IAAIpX,SAASyE,KAAKM,WAC7B,CACL,IAAIs8C,EAAWpI,EAAa7wC,OAAO3D,KAAK2S,IAAK3F,EAAMvF,GAAQof,EAAQ0jB,GACnEvqC,KAAK2S,IAAIpX,SAAS4D,OAAOa,KAAKM,MAAO,EAAGs8C,GACxC58C,KAAK2S,IAAMiqC,EACX58C,KAAKs3C,SAAU,EAEjBt3C,KAAKM,MAAQ,EACbmH,MAOJmuC,EAAgBx1C,UAAU42C,cAAgB,SAASA,cAAervC,EAAMktC,EAAWC,EAAWx0C,GAC5F,IAAgBu8C,EAAZ3tC,GAAS,EACb,GAAI5O,GAASN,KAAKq6C,SAAS/5C,QACtBu8C,EAAa78C,KAAKq6C,SAAS/nC,QAAQhS,EAAQN,KAAKq6C,SAAS/5C,QAAQ+H,QAAUrI,KAAK2S,KACjFkqC,EAAWxL,YAAY1pC,EAAMktC,EAAWC,GAC1C5lC,EAAQlP,KAAK2S,IAAIpX,SAASwD,QAAQ89C,EAAY78C,KAAKM,YAEnD,IAAK,IAAIxB,EAAIkB,KAAKM,MAAO6F,EAAI1G,KAAKuO,IAAIhO,KAAK2S,IAAIpX,SAASsD,OAAQC,EAAI,GAAIA,EAAIqH,EAAGrH,IAAK,CAClF,IAAI9B,EAAQgD,KAAK2S,IAAIpX,SAASuD,GAC9B,GAAI9B,EAAMq0C,YAAY1pC,EAAMktC,EAAWC,KAAe90C,KAAKq6C,SAASrrC,QAAQzP,IAAIvC,GAAQ,CACtFkS,EAAQpQ,EACR,OAIN,QAAIoQ,EAAQ,KACZlP,KAAK08C,eAAe18C,KAAKM,MAAO4O,GAChClP,KAAKM,SACE,IAGTs1C,EAAgBx1C,UAAU82C,aAAe,SAASA,aAAcvvC,EAAMktC,EAAWC,EAAWx0C,EAAOiqC,GAEjG,QADYvqC,KAAK2S,IAAIpX,SAAS+E,GACnB+a,OAAO1T,EAAMktC,EAAWC,EAAWvK,KAC9CvqC,KAAK08C,eAAe18C,KAAKM,MAAOA,GAChCN,KAAKM,MAAQA,EAAQ,GACd,IAGTs1C,EAAgBx1C,UAAU62C,mBAAqB,SAASA,mBAAoB6F,GAC1E,OAAS,CACP,IAAIz0C,EAASy0C,EAAQztB,WACrB,IAAKhnB,EAAU,OAAQ,EACvB,GAAIA,GAAUrI,KAAK2S,IAAImgB,WAAY,CACjC,IAAIyR,EAAOuY,EAAQ9T,WACnB,GAAIzE,EAAQ,IAAK,IAAIzlC,EAAIkB,KAAKM,MAAOxB,EAAIkB,KAAK2S,IAAIpX,SAASsD,OAAQC,IACjE,GAAIkB,KAAK2S,IAAIpX,SAASuD,IAAMylC,EAAQ,OAAOzlC,EAE7C,OAAQ,EAEVg+C,EAAUz0C,IAOdutC,EAAgBx1C,UAAU+2C,eAAiB,SAASA,eAAgBxvC,EAAMktC,EAAWC,EAAWvK,EAAMjqC,GACpG,IAAK,IAAIxB,EAAIkB,KAAKM,MAAOxB,EAAIkB,KAAK2S,IAAIpX,SAASsD,OAAQC,IAAK,CAC1D,IAAI+I,EAAO7H,KAAK2S,IAAIpX,SAASuD,GAC7B,GAAI+I,aAAgB+sC,EAAc,CAChC,IAAIyF,EAAWr6C,KAAKq6C,SAASrrC,QAAQ/P,IAAI4I,GACzC,GAAgB,MAAZwyC,GAAoBA,GAAY/5C,EAAS,OAAO,EACpD,IAAIy8C,EAAUl1C,EAAKkjB,IAQnB,KAHa/qB,KAAKo6C,OAAS2C,GAAW/8C,KAAKo6C,MAA4B,GAApB2C,EAAQl0C,UAAiBk0C,EAAQnpB,SAAS5zB,KAAKo6C,KAAK/qB,gBACjG1nB,EAAKmV,QAAUjV,EAAKF,MAAQE,EAAKF,KAAKmV,QAAUjV,EAAKsqC,QAAQlhB,WAAatpB,EAAKoV,MA7qCvB,GA8qCxDlV,EAAKkpC,OAAuBsE,cAAcR,EAAWhtC,EAAKgtC,cACjDhtC,EAAKwT,OAAO1T,EAAMktC,EAAWC,EAAWvK,GAIrD,OAHAvqC,KAAK08C,eAAe18C,KAAKM,MAAOxB,GAC5B+I,EAAKkjB,KAAOgyB,IAAW/8C,KAAKs3C,SAAU,GAC1Ct3C,KAAKM,SACE,EAET,OAGJ,OAAO,GAKTs1C,EAAgBx1C,UAAUsgB,QAAU,SAASA,QAAS/Y,EAAMktC,EAAWC,EAAWvK,EAAM1qC,GACtFG,KAAK2S,IAAIpX,SAAS4D,OAAOa,KAAKM,QAAS,EAAGs0C,EAAajxC,OAAO3D,KAAK2S,IAAKhL,EAAMktC,EAAWC,EAAWvK,EAAM1qC,IAC1GG,KAAKs3C,SAAU,GAGjB1B,EAAgBx1C,UAAU02C,YAAc,SAASA,YAAavE,EAAQhI,EAAM1qC,GAC1E,IAAIgI,EAAO7H,KAAKM,MAAQN,KAAK2S,IAAIpX,SAASsD,OAASmB,KAAK2S,IAAIpX,SAASyE,KAAKM,OAAS,KACnF,IAAIuH,IAAQA,EAAKspC,cAAcoB,IAAYA,GAAU1qC,EAAK0qC,QAAW1qC,EAAK0qC,OAAO5sC,KAAKivB,MAAMvF,WAErF,CACL,IAAIkV,EAAO,IAAI+N,EAAetyC,KAAK2S,IAAK4/B,EAAQhI,EAAM1qC,GACtDG,KAAK2S,IAAIpX,SAAS4D,OAAOa,KAAKM,QAAS,EAAGikC,GAC1CvkC,KAAKs3C,SAAU,OAJft3C,KAAKM,SAUTs1C,EAAgBx1C,UAAUg3C,kBAAoB,SAASA,oBAErD,IADA,IAAI/mC,EAAYrQ,KAAK2S,IAAIpX,SAASyE,KAAKM,MAAQ,GACxC+P,aAAqBmkC,GAAgBnkC,EAAYA,EAAU9U,SAAS8U,EAAU9U,SAASsD,OAAS,GAElGwR,GACCA,aAAqB+kC,IACvB,MAAMhuB,KAAK/W,EAAU1I,KAAKoV,SAEvB7b,EAAOomC,QAAUpmC,EAAOkmC,SAAW/2B,GAA8C,SAAjCA,EAAU0a,IAAIge,iBAC/D/oC,KAAKg9C,YAAY,OACrBh9C,KAAKg9C,YAAY,QAIrBpH,EAAgBx1C,UAAU48C,YAAc,SAASA,YAAa1tB,GAC5D,GAAItvB,KAAKM,MAAQN,KAAK2S,IAAIpX,SAASsD,QAAUmB,KAAK2S,IAAIpX,SAASyE,KAAKM,OAAOgxC,YAAYhiB,GACrFtvB,KAAKM,YACA,CACL,IAAIyqB,EAAM8J,SAASgB,cAAcvG,GACjB,OAAZA,IAAqBvE,EAAI+S,UAAY,yBACzB,MAAZxO,IAAoBvE,EAAI+S,UAAY,6BACxC99B,KAAK2S,IAAIpX,SAAS4D,OAAOa,KAAKM,QAAS,EAAG,IAAI+xC,EAAqBryC,KAAK2S,IAAKohC,EAAShpB,EAAK,OAC3F/qB,KAAKs3C,SAAU,IAkRnB,IAAI4E,EAAgCh7C,EAAOomC,QAAUpmC,EAAOkmC,QAAUlmC,EAAOmmC,eAAiB,GAE9F,SAAS8U,wBAAwB5R,EAAM1qC,GACrC,IAAIiS,EAAMy4B,EAAKyD,QAAQU,WAAW7uC,EAAK,GACnC8H,EAAOmK,EAAInK,KACXhG,EAASmQ,EAAInQ,OACb4I,EAAQ5I,EAASgG,EAAKurB,WAAWr0B,OAAS8I,EAAKurB,WAAWvxB,GAAU,KACpEwC,EAASxC,EAASgG,EAAKurB,WAAWvxB,EAAS,GAAK,KACpD,GAAIT,EAAOomC,QAAU/8B,GAAkC,SAAzBA,EAAMw+B,gBAA8B,OAAOkU,YAAY1yC,GACrF,KAAMA,GAAkC,SAAzBA,EAAMw+B,iBAAiC5kC,GAAoC,SAA1BA,EAAO4kC,iBAA6B,CAClG,GAAIx+B,EAAS,OAAO0yC,YAAY1yC,GAC3B,GAAIpG,EAAU,OAAO84C,YAAY94C,IAI1C,SAAS84C,YAAYpQ,GAGnB,OAFAA,EAAQ9D,gBAAkB,OACtB7nC,EAAOomC,QAAUuF,EAAQc,YAAad,EAAQc,WAAY,EAAOd,EAAQqQ,cAAe,GACrFrQ,EAGT,SAASuP,cAAcvP,GACrBA,EAAQ9D,gBAAkB,QACtB8D,EAAQqQ,eAAgBrQ,EAAQc,WAAY,EAAMd,EAAQqQ,aAAe,MAsC/E,SAAS9B,kBAAkB7Q,EAAMnI,GAC/B,GAAIA,aAAe,gBAAe,CAChC,IAAImC,EAAOgG,EAAKyD,QAAQoE,OAAOhQ,EAAIngC,MAC/BsiC,GAAQgG,EAAK4S,uBACfC,mBAAmB7S,GACfhG,GAAQA,EAAKmU,aACjBnO,EAAK4S,qBAAuB5Y,QAG9B6Y,mBAAmB7S,GAKvB,SAAS6S,mBAAmB7S,GACtBA,EAAK4S,uBACH5S,EAAK4S,qBAAqB90C,QAC1BkiC,EAAK4S,qBAAqBxE,eAC9BpO,EAAK4S,qBAAuB,MAIhC,SAASrC,iBAAiBvQ,EAAMhK,EAASC,EAAOl1B,GAC9C,OAAOi/B,EAAKG,SAAS,0BAA0B,SAAUtpC,GAAK,OAAOA,EAAEmpC,EAAMhK,EAASC,OACjF,gBAAckB,QAAQnB,EAASC,EAAOl1B,GAQ7C,SAAS4vC,aAAa3Q,GACpB,IAAInI,EAAMmI,EAAKmD,KAAKyC,eACpB,IAAK/N,EAAIgR,WAAc,OAAO,EAC9B,IAIE,OAAO7I,EAAKxf,IAAI6I,SAAoC,GAA3BwO,EAAIgR,WAAWvqC,SAAgBu5B,EAAIgR,WAAW/jB,WAAa+S,EAAIgR,cACrF7I,EAAKyQ,UAAYzQ,EAAKxf,IAAI6I,SAAmC,GAA1BwO,EAAImO,UAAU1nC,SAAgBu5B,EAAImO,UAAUlhB,WAAa+S,EAAImO,YACnG,MAAM/zC,GACN,OAAO,GAUX,SAAS6gD,mBAAmBvnC,EAAO5K,GACjC,IAAI4G,EAAMgE,EAAMusB,UACZ9B,EAAUzuB,EAAIyuB,QACdC,EAAQ1uB,EAAI0uB,MACZ8c,EAAQpyC,EAAM,EAAIq1B,EAAQh6B,IAAIi6B,GAASD,EAAQvyB,IAAIwyB,GACnD5f,EAAU08B,EAAMj1C,OAAOyZ,cAAwBw7B,EAAM71C,MAAQqO,EAAM/R,IAAIwD,QAAQ2D,EAAM,EAAIoyC,EAAM/yC,QAAU+yC,EAAMn5C,UAAY,KAApFm5C,EAC3C,OAAO18B,GAAU,YAAUmgB,SAASngB,EAAQ1V,GAG9C,SAASvG,MAAM4lC,EAAMnI,GAEnB,OADAmI,EAAKgT,SAAShT,EAAKz0B,MAAM6qB,GAAG2B,aAAaF,GAAKiC,mBACvC,EAGT,SAASmZ,mBAAmBjT,EAAMr/B,EAAKuyC,GACrC,IAAIrb,EAAMmI,EAAKz0B,MAAMusB,UACrB,KAAID,aAAe,iBAuBZ,IAAIA,aAAe,iBAAiBA,EAAIz6B,KAAKgE,SAClD,OAAOhH,MAAM4lC,EAAM,IAAI,gBAAcr/B,EAAM,EAAIk3B,EAAI35B,IAAM25B,EAAI96B,QAE7D,IAAIoe,EAAS23B,mBAAmB9S,EAAKz0B,MAAO5K,GAC5C,QAAIwa,GAAiB/gB,MAAM4lC,EAAM7kB,GA1BjC,IAAK0c,EAAIvgC,OAAS47C,EAAK1+C,QAAQ,MAAQ,EACrC,OAAO,EACF,GAAIwrC,EAAKuF,eAAe5kC,EAAM,EAAI,QAAU,QAAS,CAC1D,IAAIrD,EAAOw1C,mBAAmB9S,EAAKz0B,MAAO5K,GAC1C,SAAIrD,GAASA,aAAgB,kBAAyBlD,MAAM4lC,EAAM1iC,GAE7D,KAAM3G,EAAOwmC,KAAO+V,EAAK1+C,QAAQ,MAAQ,GAAI,CAClD,IAAsGwlC,EAAlG/D,EAAQ4B,EAAI5B,MAAO74B,EAAO64B,EAAM1f,WAAa,KAAO5V,EAAM,EAAIs1B,EAAM51B,WAAa41B,EAAM31B,UAC3F,IAAKlD,GAAQA,EAAKmV,OAAU,OAAO,EACnC,IAAI4gC,EAAUxyC,EAAM,EAAIs1B,EAAM3gC,IAAM8H,EAAKoF,SAAWyzB,EAAM3gC,IAC1D,SAAM8H,EAAKkb,SAAW0hB,EAAOgG,EAAKyD,QAAQoE,OAAOsL,MAAcnZ,EAAKzR,cAChE,gBAAcoP,aAAav6B,GACtBhD,MAAM4lC,EAAM,IAAI,gBAAcr/B,EAAM,EAAIq/B,EAAKz0B,MAAM/R,IAAIwD,QAAQi5B,EAAM3gC,IAAM8H,EAAKoF,UAAYyzB,MAC1Ft/B,EAAO2mC,QAITljC,MAAM4lC,EAAM,IAAI,gBAAcA,EAAKz0B,MAAM/R,IAAIwD,QAAQ2D,EAAM,EAAIwyC,EAAUA,EAAU/1C,EAAKoF,cAcvG,SAAS4wC,QAAQh2C,GACf,OAAwB,GAAjBA,EAAKkB,SAAgBlB,EAAKspB,UAAUpyB,OAAS8I,EAAKurB,WAAWr0B,OAGtE,SAAS++C,YAAY7yB,GACnB,IAAIwZ,EAAOxZ,EAAIie,WACf,OAAOzE,GAAqB,GAAbA,EAAK7nC,OAAcquB,EAAI4G,aAA+B,MAAhB5G,EAAIuE,UAK3D,SAASuuB,qBAAqBtT,GAC5B,IAAInI,EAAMmI,EAAKmD,KAAKyC,eAChBxoC,EAAOy6B,EAAImO,UAAW5uC,EAASygC,EAAIqO,YACvC,GAAK9oC,EAAL,CACA,IAAIm2C,EAAUC,EAAYljB,GAAQ,EAKlC,IADI35B,EAAOgmC,OAA0B,GAAjBv/B,EAAKkB,UAAiBlH,EAASg8C,QAAQh2C,IAASi2C,YAAYj2C,EAAKurB,WAAWvxB,MAAYk5B,GAAQ,KAElH,GAAIl5B,EAAS,EAAG,CACd,GAAqB,GAAjBgG,EAAKkB,SACP,MAEA,IAAI1E,EAASwD,EAAKurB,WAAWvxB,EAAS,GACtC,GAAIi8C,YAAYz5C,GACd25C,EAAWn2C,EACXo2C,IAAep8C,MACV,IAAuB,GAAnBwC,EAAO0E,SAGT,MADPlH,GADAgG,EAAOxD,GACO8sB,UAAUpyB,YAGvB,IAAIm/C,YAAYr2C,GACrB,MAGA,IADA,IAAIi9B,EAAOj9B,EAAKwpB,gBACTyT,GAAQgZ,YAAYhZ,IACzBkZ,EAAWn2C,EAAK0nB,WAChB0uB,EAAa/V,SAASpD,GACtBA,EAAOA,EAAKzT,gBAEd,GAAKyT,EAMHjjC,EAASg8C,QADTh2C,EAAOi9B,OALE,CAET,IADAj9B,EAAOA,EAAK0nB,aACAkb,EAAKxf,IAAO,MACxBppB,EAAS,GAOXk5B,EAASojB,YAAY1T,EAAMnI,EAAKz6B,EAAMhG,GACjCm8C,GAAYG,YAAY1T,EAAMnI,EAAK0b,EAAUC,IAKxD,SAASG,sBAAsB3T,GAC7B,IAAInI,EAAMmI,EAAKmD,KAAKyC,eAChBxoC,EAAOy6B,EAAImO,UAAW5uC,EAASygC,EAAIqO,YACvC,GAAK9oC,EAAL,CAGA,IAFA,IACIm2C,EAAUC,EADVtR,EAAMkR,QAAQh2C,KAGhB,GAAIhG,EAAS8qC,EAAK,CAChB,GAAqB,GAAjB9kC,EAAKkB,SAAiB,MAE1B,IAAI+0C,YADQj2C,EAAKurB,WAAWvxB,IAKrB,MAHLm8C,EAAWn2C,EACXo2C,IAAep8C,MAGZ,IAAIq8C,YAAYr2C,GACrB,MAGA,IADA,IAAIE,EAAOF,EAAKgqB,YACT9pB,GAAQ+1C,YAAY/1C,IACzBi2C,EAAWj2C,EAAKwnB,WAChB0uB,EAAa/V,SAASngC,GAAQ,EAC9BA,EAAOA,EAAK8pB,YAEd,GAAK9pB,EAMHlG,EAAS,EACT8qC,EAAMkR,QAFNh2C,EAAOE,OALE,CAET,IADAF,EAAOA,EAAK0nB,aACAkb,EAAKxf,IAAO,MACxBppB,EAAS8qC,EAAM,GAQjBqR,GAAYG,YAAY1T,EAAMnI,EAAK0b,EAAUC,IAGnD,SAASC,YAAYjzB,GACnB,IAAIwZ,EAAOxZ,EAAIie,WACf,OAAOzE,GAAQA,EAAK58B,MAAQ48B,EAAK58B,KAAKmW,QAGxC,SAASmgC,YAAY1T,EAAMnI,EAAKz6B,EAAMhG,GACpC,GAAIsnC,mBAAmB7G,GAAM,CAC3B,IAAIh6B,EAAQysB,SAASwT,cACrBjgC,EAAMkgC,OAAO3gC,EAAMhG,GACnByG,EAAMmgC,SAAS5gC,EAAMhG,GACrBygC,EAAIyO,kBACJzO,EAAIzhB,SAASvY,QACJg6B,EAAIlrB,QACbkrB,EAAIlrB,OAAOvP,EAAMhG,GAEnB4oC,EAAKiR,YAAYG,kBACjB,IAAI7lC,EAAQy0B,EAAKz0B,MAEjB6oB,YAAW,WACL4L,EAAKz0B,OAASA,GAASqlC,eAAe5Q,KACzC,IAOL,SAAS4T,iBAAiB5T,EAAMr/B,EAAKuyC,GACnC,IAAIrb,EAAMmI,EAAKz0B,MAAMusB,UACrB,GAAID,aAAe,kBAAkBA,EAAIvgC,OAAS47C,EAAK1+C,QAAQ,MAAQ,EAAK,OAAO,EACnF,GAAImC,EAAOwmC,KAAO+V,EAAK1+C,QAAQ,MAAQ,EAAK,OAAO,EACnD,IAAIuI,EAAQ86B,EAAI96B,MACZmB,EAAM25B,EAAI35B,IAEd,IAAKnB,EAAMe,OAAOyZ,eAAiByoB,EAAKuF,eAAe5kC,EAAM,EAAI,KAAO,QAAS,CAC/E,IAAIrD,EAAOw1C,mBAAmB9S,EAAKz0B,MAAO5K,GAC1C,GAAIrD,GAASA,aAAgB,gBACzB,OAAOlD,MAAM4lC,EAAM1iC,GAEzB,IAAKP,EAAMe,OAAOyZ,cAAe,CAC/B,IAAIioB,EAAO7+B,EAAM,EAAI5D,EAAQmB,EACzB21C,EAAShc,aAAe,eAAe,YAAUjB,KAAK4I,EAAM7+B,GAAO,YAAU61B,SAASgJ,EAAM7+B,GAChG,QAAOkzC,GAASz5C,MAAM4lC,EAAM6T,GAE9B,OAAO,EAGT,SAASC,2BAA2B9T,EAAMr/B,GACxC,KAAMq/B,EAAKz0B,MAAMusB,qBAAqB,iBAAkB,OAAO,EAC/D,IAAIvwB,EAAMy4B,EAAKz0B,MAAMusB,UACjB7B,EAAQ1uB,EAAI0uB,MACZD,EAAUzuB,EAAIyuB,QACd1+B,EAAQiQ,EAAIjQ,MAChB,IAAK2+B,EAAMxe,WAAWue,GAAY,OAAO,EACzC,IAAK1+B,EAAS,OAAO,EACrB,GAAI0oC,EAAKuF,eAAe5kC,EAAM,EAAI,UAAY,YAAe,OAAO,EACpE,IAAIozC,GAAY9d,EAAM1f,aAAe5V,EAAM,EAAIs1B,EAAM51B,WAAa41B,EAAM31B,WACxE,GAAIyzC,IAAaA,EAASxhC,OAAQ,CAChC,IAAI6jB,EAAK4J,EAAKz0B,MAAM6qB,GAIpB,OAHIz1B,EAAM,EAAKy1B,EAAGrkC,OAAOkkC,EAAM3gC,IAAMy+C,EAASvxC,SAAUyzB,EAAM3gC,KACvD8gC,EAAGrkC,OAAOkkC,EAAM3gC,IAAK2gC,EAAM3gC,IAAMy+C,EAASvxC,UACjDw9B,EAAKgT,SAAS5c,IACP,EAET,OAAO,EAGT,SAAS4d,eAAehU,EAAM5iC,EAAMmO,GAClCy0B,EAAKiR,YAAYtH,OACjBvsC,EAAKohC,gBAAkBjzB,EACvBy0B,EAAKiR,YAAY16C,QAqCnB,SAAS09C,eAAejU,EAAMd,GAC5B,IAAI3gB,EAAO2gB,EAAMD,QAASiU,EAV5B,SAASgB,QAAQhV,GACf,IAAIvoC,EAAS,GAKb,OAJIuoC,EAAMiV,UAAWx9C,GAAU,KAC3BuoC,EAAMkV,UAAWz9C,GAAU,KAC3BuoC,EAAMmV,SAAU19C,GAAU,KAC1BuoC,EAAMoV,WAAY39C,GAAU,KACzBA,EAI0Bu9C,CAAQhV,GACzC,OAAY,GAAR3gB,GAAc5nB,EAAOwmC,KAAe,IAAR5e,GAAsB,KAAR20B,EACrCY,2BAA2B9T,GAAO,IAAMsT,qBAAqBtT,GACnD,IAARzhB,GAAe5nB,EAAOwmC,KAAe,IAAR5e,GAAsB,KAAR20B,EAC7CY,2BAA2B9T,EAAM,IAAM2T,sBAAsB3T,GACnD,IAARzhB,GAAsB,IAARA,IAEN,IAARA,EACF00B,mBAAmBjT,GAAO,EAAGkT,IAASI,qBAAqBtT,GACjD,IAARzhB,EACF00B,mBAAmBjT,EAAM,EAAGkT,IAASS,sBAAsB3T,GACjD,IAARzhB,EACFq1B,iBAAiB5T,GAAO,EAAGkT,IAASI,qBAAqBtT,GAC/C,IAARzhB,EA3Cb,SAASg2B,mBAAmBvU,GAC1B,GAAKrpC,EAAOomC,UAAUiD,EAAKz0B,MAAMusB,UAAU7B,MAAMxsB,aAAe,GAAhE,CACA,IAAIlC,EAAMy4B,EAAKmD,KAAKyC,eAChBI,EAAYz+B,EAAIy+B,UAChBE,EAAc3+B,EAAI2+B,YACtB,GAAIF,GAAmC,GAAtBA,EAAU1nC,UAAgC,GAAf4nC,GACxCF,EAAUvoC,YAAsD,SAAxCuoC,EAAUvoC,WAAW+gC,gBAA4B,CAC3E,IAAI/rC,EAAQuzC,EAAUvoC,WACtBu2C,eAAehU,EAAMvtC,GAAO,GAC5B2hC,YAAW,WAAc,OAAO4f,eAAehU,EAAMvtC,GAAO,KAAW,MAmChE8hD,CAAmBvU,IAAS4T,iBAAiB5T,EAAM,EAAGkT,IAASS,sBAAsB3T,GACnFkT,IAASv8C,EAAOwmC,IAAM,IAAM,OACnB,IAAR5e,GAAsB,IAARA,GAAsB,IAARA,GAAsB,IAARA,IA2DxD,SAAS+I,aAAa9G,GACpB,IAAIwZ,EAAOxZ,EAAIie,WACf,GAAIzE,EACF,OAAOA,EAAKiN,YACP,GAAoB,MAAhBzmB,EAAIuE,UAAoBvE,EAAIsE,WAAY,CAIjD,GAAInuB,EAAOomC,QAAU,aAAalgB,KAAK2D,EAAIsE,WAAWC,UAAW,CAC/D,IAAI0C,EAAO6C,SAASgB,cAAc,OAElC,OADA7D,EAAKJ,YAAYiD,SAASgB,cAAc,OACjC,CAAC7D,KAAMA,GACT,GAAIjH,EAAIsE,WAAWhf,WAAa0a,GAAO7pB,EAAOomC,QAAU,gBAAgBlgB,KAAK2D,EAAIsE,WAAWC,UACjG,MAAO,CAACwC,QAAQ,QAEb,GAAoB,OAAhB/G,EAAIuE,UAAqBvE,EAAI0F,aAAa,oBACnD,MAAO,CAACqB,QAAQ,GAIpB,SAASitB,cAAcxU,EAAMtoC,EAAMC,EAAI88C,EAAUC,GAC/C,GAAIh9C,EAAO,EAAX,CACE,IAAI04C,EAASpQ,EAAK2U,kBAAoBnc,KAAKC,MAAQ,GAAKuH,EAAK4U,oBAAsB,KAC/EC,EAAS1E,iBAAiBnQ,EAAMoQ,GACpC,GAAIyE,IAAW7U,EAAKz0B,MAAMusB,UAAUt0B,GAAGqxC,GAAS,CAC9C,IAAIC,EAAO9U,EAAKz0B,MAAM6qB,GAAG2B,aAAa8c,GACxB,WAAVzE,EAAuB0E,EAAKlb,QAAQ,WAAW,GAChC,OAAVwW,GAAmB0E,EAAKhb,iBACjCkG,EAAKgT,SAAS8B,QAPlB,CAYA,IAAI7+B,EAAU+pB,EAAKz0B,MAAM/R,IAAIwD,QAAQtF,GACjCq9C,EAAS9+B,EAAQ7S,YAAYzL,GACjCD,EAAOue,EAAQrc,OAAOm7C,EAAS,GAC/Bp9C,EAAKqoC,EAAKz0B,MAAM/R,IAAIwD,QAAQrF,GAAIqI,MAAM+0C,EAAS,GAE/C,IAAIld,EAAMmI,EAAKz0B,MAAMusB,UACjBvpB,EAtFN,SAASymC,aAAahV,EAAMiV,EAAOC,GACjC,IAAI3tC,EAAMy4B,EAAKyD,QAAQ0E,WAAW8M,EAAOC,GACrCp3C,EAASyJ,EAAInK,KACbgrC,EAAa7gC,EAAI6gC,WACjBC,EAAW9gC,EAAI8gC,SACf3wC,EAAO6P,EAAI7P,KACXC,EAAK4P,EAAI5P,GAETgnC,EAASqB,EAAKmD,KAAKyC,eAAgBp0B,EAAO,KAAM2kB,EAASwI,EAAOkK,WAQpE,GAPI1S,GAAU6J,EAAKxf,IAAI6I,SAA4B,GAAnB8M,EAAO73B,SAAgB63B,EAASA,EAAOrR,cACrEtT,EAAO,CAAC,CAACpU,KAAM+4B,EAAQ/+B,OAAQunC,EAAOmK,eACjCpK,mBAAmBC,IACpBntB,EAAK7d,KAAK,CAACyJ,KAAMuhC,EAAOqH,UAAW5uC,OAAQunC,EAAOuH,eAIpDvvC,EAAOkmC,QAA+B,IAArBmD,EAAKmV,YACxB,IAAK,IAAIjX,EAAMmK,EAAUnK,EAAMkK,EAAYlK,IAAO,CAChD,IAAI9gC,EAAOU,EAAO6qB,WAAWuV,EAAM,GAAIlE,EAAO58B,EAAKqhC,WACnD,GAAqB,MAAjBrhC,EAAK2nB,WAAqBiV,EAAM,CAAEqO,EAAWnK,EAAK,MACtD,IAAKlE,GAAQA,EAAK7nC,KAAQ,MAG9B,IAAIijD,EAAWpV,EAAKz0B,MAAM/R,IACtByrB,EAAS+a,EAAKG,SAAS,cAAgB,YAAU3e,WAAWwe,EAAKz0B,MAAMvQ,QACvE+B,EAAQq4C,EAASp4C,QAAQtF,GAEzBmgC,EAAM,KAAMr+B,EAAMyrB,EAAO1W,MAAMzQ,EAAQ,CACzC+gB,QAAS9hB,EAAMe,OACfunB,SAAUtoB,EAAMe,OAAOa,eAAe5B,EAAMhH,SAC5CqzB,SAAS,EACT1xB,KAAM0wC,EACNzwC,GAAI0wC,EACJrkB,mBAAoD,OAAhCjnB,EAAMe,OAAO1C,KAAKijB,YAAsB,OAC5Dg3B,iBAAiB,EACjB/vB,cAAe9T,EACf8V,aAAcA,aACd91B,QAASuL,IAEX,GAAIyU,GAAuB,MAAfA,EAAK,GAAGlc,IAAa,CAC/B,IAAIggD,EAAW9jC,EAAK,GAAGlc,IAAKquB,EAAOnS,EAAK,IAAMA,EAAK,GAAGlc,IAC1C,MAARquB,IAAgBA,EAAO2xB,GAC3Bzd,EAAM,CAAC1B,OAAQmf,EAAW59C,EAAMisB,KAAMA,EAAOjsB,GAE/C,MAAO,CAAC8B,IAAKA,EAAKq+B,IAAKA,EAAKngC,KAAMA,EAAMC,GAAIA,GA0ChCq9C,CAAahV,EAAMtoC,EAAMC,GAGrC,GAAIhB,EAAOkmC,QAAUmD,EAAKsR,eAAiB/iC,EAAMspB,KAAOtpB,EAAMspB,IAAI1B,QAAU6J,EAAKsR,cAAc/F,KAAK7zC,KAAM,CACxG,IAAI8a,EAAOwtB,EAAKsR,cAAc/F,KAAKnwC,KAAKivB,MAAMjD,YAC1Cj1B,EAAOqgB,GAAQA,EAAKkU,UAAYlU,EAAKkU,UAAUpyB,OAAS,EAC5Dia,EAAMspB,IAAM,CAAC1B,OAAQ5nB,EAAMspB,IAAI1B,OAAShkC,EAAMwxB,KAAMpV,EAAMspB,IAAI1B,OAAShkC,GAGzE,IACIojD,EAAcC,EADdh8C,EAAMwmC,EAAKz0B,MAAM/R,IAAKi8C,EAAUj8C,EAAItB,MAAMqW,EAAM7W,KAAM6W,EAAM5W,IAGvC,IAArBqoC,EAAKmV,aAAqB3c,KAAKC,MAAQ,IAAMuH,EAAK0V,iBACpDH,EAAevV,EAAKz0B,MAAMusB,UAAUngC,GACpC69C,EAAgB,QAEhBD,EAAevV,EAAKz0B,MAAMusB,UAAUpgC,KACpC89C,EAAgB,SAElBxV,EAAKmV,YAAc,KAEnB,IAAIQ,EA+MN,SAASC,SAASr1C,EAAGC,EAAGlL,EAAKigD,EAAcC,GACzC,IAAIj/C,EAAQgK,EAAE4R,cAAc3R,EAAGlL,GAC/B,GAAa,MAATiB,EAAiB,OAAO,KAC5B,IAAIgR,EAAMhH,EAAEkS,YAAYjS,EAAGlL,EAAMiL,EAAEpO,KAAMmD,EAAMkL,EAAErO,MAC7C0jD,EAAOtuC,EAAIhH,EACXu1C,EAAOvuC,EAAI/G,EACf,GAAqB,OAAjBg1C,EAAwB,CAE1BD,GAAgBM,EADH3gD,KAAK8G,IAAI,EAAGzF,EAAQrB,KAAKuO,IAAIoyC,EAAMC,IAChBv/C,EAElC,GAAIs/C,EAAOt/C,GAASgK,EAAEpO,KAAOqO,EAAErO,KAAM,CAGnC2jD,GADAv/C,GADWg/C,GAAgBh/C,GAASg/C,GAAgBM,EAAOt/C,EAAQg/C,EAAe,IAElEO,EAAOD,GACvBA,EAAOt/C,OACF,GAAIu/C,EAAOv/C,EAAO,CAGvBs/C,GADAt/C,GADag/C,GAAgBh/C,GAASg/C,GAAgBO,EAAOv/C,EAAQg/C,EAAe,IAEpEM,EAAOC,GACvBA,EAAOv/C,EAET,MAAO,CAACA,MAAOA,EAAOs/C,KAAMA,EAAMC,KAAMA,GApO3BF,CAASH,EAAQp5C,QAASkS,EAAM/U,IAAI6C,QAASkS,EAAM7W,KAAM69C,EAAcC,GACpF,IAAKG,EAAQ,CACX,KAAIlB,GAAY5c,aAAe,kBAAkBA,EAAIvgC,OAASugC,EAAI5B,MAAMxe,WAAWogB,EAAI7B,WAClFgK,EAAKgL,WAAez8B,EAAMspB,KAAOtpB,EAAMspB,IAAI1B,QAAU5nB,EAAMspB,IAAIlU,KAE7D,KAAKhtB,EAAOsmC,KAAO+C,EAAK+V,aAAevd,KAAKC,MAAQ,KAAO9hC,EAAO0mC,UAC9DqX,EAAWp0B,MAAK,SAAUjpB,GAAK,MAAqB,OAAdA,EAAE0tB,UAAmC,KAAd1tB,EAAE0tB,aAC/Dib,EAAKG,SAAS,iBAAiB,SAAUtpC,GAAK,OAAOA,EAAEmpC,EAAMhB,SAAS,GAAI,aAEnF,YADAgB,EAAK+V,aAAe,GAGpB,GAAIxnC,EAAMspB,IAAK,CACb,IAAIme,EAAQC,iBAAiBjW,EAAMA,EAAKz0B,MAAM/R,IAAK+U,EAAMspB,KACrDme,IAAUA,EAAMxyC,GAAGw8B,EAAKz0B,MAAMusB,YAAckI,EAAKgT,SAAShT,EAAKz0B,MAAM6qB,GAAG2B,aAAaie,IAE3F,OAXAL,EAAS,CAACp/C,MAAOshC,EAAIngC,KAAMm+C,KAAMhe,EAAIlgC,GAAIm+C,KAAMje,EAAIlgC,IAcvDqoC,EAAKkW,iBAIDlW,EAAKz0B,MAAMusB,UAAUpgC,KAAOsoC,EAAKz0B,MAAMusB,UAAUngC,IACjDg+C,EAAOp/C,OAASo/C,EAAOG,MACvB9V,EAAKz0B,MAAMusB,qBAAqB,kBAC9B6d,EAAOp/C,MAAQypC,EAAKz0B,MAAMusB,UAAUpgC,MAAQi+C,EAAOp/C,OAASypC,EAAKz0B,MAAMusB,UAAUpgC,KAAO,EAC1Fi+C,EAAOp/C,MAAQypC,EAAKz0B,MAAMusB,UAAUpgC,KAC3Bi+C,EAAOE,KAAO7V,EAAKz0B,MAAMusB,UAAUngC,IAAMg+C,EAAOE,MAAQ7V,EAAKz0B,MAAMusB,UAAUngC,GAAK,IAC3Fg+C,EAAOG,MAAS9V,EAAKz0B,MAAMusB,UAAUngC,GAAKg+C,EAAOE,KACjDF,EAAOE,KAAO7V,EAAKz0B,MAAMusB,UAAUngC,KAOnChB,EAAO6lC,IAAM7lC,EAAO8lC,YAAc,IAAMkZ,EAAOG,MAAQH,EAAOp/C,MAAQ,GACtEo/C,EAAOE,MAAQF,EAAOp/C,OAASo/C,EAAOp/C,MAAQgY,EAAM7W,MACmC,MAAvF6W,EAAM/U,IAAI2Z,YAAYwiC,EAAOp/C,MAAQgY,EAAM7W,KAAO,EAAGi+C,EAAOp/C,MAAQgY,EAAM7W,KAAO,KACnFi+C,EAAOp/C,QACPo/C,EAAOE,OACPF,EAAOG,QAGT,IAGIK,EAHAp5C,EAAQwR,EAAM/U,IAAImc,eAAeggC,EAAOp/C,MAAQgY,EAAM7W,MACtDwG,EAAMqQ,EAAM/U,IAAImc,eAAeggC,EAAOG,KAAOvnC,EAAM7W,MACnD0+C,EAAer5C,EAAM0a,WAAWvZ,IAAQnB,EAAMe,OAAOyZ,cAIzD,IAAM5gB,EAAOsmC,KAAO+C,EAAK+V,aAAevd,KAAKC,MAAQ,OAC7C2d,GAAgB1B,EAAWp0B,MAAK,SAAUjpB,GAAK,MAAqB,OAAdA,EAAE0tB,UAAmC,KAAd1tB,EAAE0tB,eAChFqxB,GAAgBr5C,EAAMzH,IAAMiZ,EAAM/U,IAAI6C,QAAQlK,OAC9CgkD,EAAU,YAAU3f,SAASjoB,EAAM/U,IAAIwD,QAAQD,EAAMzH,IAAM,GAAI,GAAG,KACnE6gD,EAAQxyB,MAAQzlB,EAAI5I,MACtB0qC,EAAKG,SAAS,iBAAiB,SAAUtpC,GAAK,OAAOA,EAAEmpC,EAAMhB,SAAS,GAAI,aAC5EgB,EAAK+V,aAAe,OAItB,GAAI/V,EAAKz0B,MAAMusB,UAAU3B,OAASwf,EAAOp/C,OA4G3C,SAAS8/C,cAAcC,EAAK//C,EAAOG,EAAK6/C,EAAWC,GACjD,IAAKD,EAAUz4C,OAAO8C,aAElBlK,EAAMH,GAASigD,EAAQlhD,IAAMihD,EAAUjhD,KAEvCmhD,sBAAsBF,GAAW,GAAM,GAASC,EAAQlhD,IACxD,OAAO,EAEX,IAAI+gB,EAASigC,EAAIt5C,QAAQzG,GAEzB,GAAI8f,EAAO5M,aAAe4M,EAAOvY,OAAOzB,QAAQlK,OAASkkB,EAAOvY,OAAO8C,YACnE,OAAO,EACX,IAAI81C,EAAQJ,EAAIt5C,QAAQy5C,sBAAsBpgC,GAAQ,GAAM,IAE5D,IAAKqgC,EAAM54C,OAAO8C,aAAe81C,EAAMphD,IAAMoB,GACzC+/C,sBAAsBC,GAAO,GAAM,GAAShgD,EAC5C,OAAO,EAGX,OAAO6/C,EAAUz4C,OAAOzB,QAAQoX,IAAI8iC,EAAU9sC,cAAcjG,GAAGkzC,EAAM54C,OAAOzB,SA9HxEg6C,CAAc78C,EAAKm8C,EAAOp/C,MAAOo/C,EAAOE,KAAM94C,EAAOmB,IACrD8hC,EAAKG,SAAS,iBAAiB,SAAUtpC,GAAK,OAAOA,EAAEmpC,EAAMhB,SAAS,EAAG,iBACvEroC,EAAO0mC,SAAW1mC,EAAOkmC,QAAUmD,EAAKiR,YAAY0F,+BAH1D,CAUIhgD,EAAOkmC,QAAUlmC,EAAO0mC,SAAWsY,EAAOiB,KAAOjB,EAAOj+C,OACxDsoC,EAAK6W,kBAAoBre,KAAKC,OAU9B9hC,EAAO0mC,UAAY+Y,GAAgBr5C,EAAMxG,SAAW2H,EAAI3H,SAA+B,GAApB2H,EAAIuL,cAAqB1M,EAAMG,OAASgB,EAAIhB,OAC/GqR,EAAMspB,KAAOtpB,EAAMspB,IAAI1B,QAAU5nB,EAAMspB,IAAIlU,MAAQpV,EAAMspB,IAAIlU,MAAQgyB,EAAOE,OAC9EF,EAAOG,MAAQ,EACf53C,EAAMqQ,EAAM/U,IAAImc,eAAeggC,EAAOG,KAAOvnC,EAAM7W,MACnD08B,YAAW,WACT4L,EAAKG,SAAS,iBAAiB,SAAUtpC,GAAK,OAAOA,EAAEmpC,EAAMhB,SAAS,GAAI,eACzE,KAGL,IAEI5I,EAAIwC,EAAake,EAAYC,EAF7BC,EAASrB,EAAOp/C,MAAO0gD,EAAOtB,EAAOE,KAGzC,GAAIO,EACF,GAAIr5C,EAAMzH,KAAO4I,EAAI5I,IAGfqB,EAAO6lC,IAAM7lC,EAAO8lC,YAAc,IAA4B,GAAtB1/B,EAAM0M,eAChDu2B,EAAKiR,YAAY0F,2BACjBviB,YAAW,WAAc,OAAOwc,eAAe5Q,KAAU,KAE3D5J,EAAK4J,EAAKz0B,MAAM6qB,GAAGrkC,OAAOilD,EAAQC,GAClCre,EAAcp/B,EAAIwD,QAAQ24C,EAAOp/C,OAAO6gB,YAAY5d,EAAIwD,QAAQ24C,EAAOE,YAClE,GACLF,EAAOE,MAAQF,EAAOG,OAASiB,EAASv9C,EAAIwD,QAAQ24C,EAAOp/C,UAC1DugD,EA0CP,SAASI,aAAahyC,EAAKm1B,GAGzB,IAFA,IAC2Cj/B,EAAM8H,EAAM4N,EADnDqmC,EAAWjyC,EAAIzH,WAAWgF,MAAO20C,EAAY/c,EAAK58B,WAAWgF,MAC7DyB,EAAQizC,EAAUlzC,EAAUmzC,EACvB7iD,EAAI,EAAGA,EAAI6iD,EAAU9iD,OAAQC,IAAO2P,EAAQkzC,EAAU7iD,GAAGoP,cAAcO,GAChF,IAAK,IAAIoB,EAAM,EAAGA,EAAM6xC,EAAS7iD,OAAQgR,IAASrB,EAAUkzC,EAAS7xC,GAAK3B,cAAcM,GACxF,GAAoB,GAAhBC,EAAM5P,QAAiC,GAAlB2P,EAAQ3P,OAC/B4O,EAAOgB,EAAM,GACb9I,EAAO,MACP0V,EAAS,SAAU1T,GAAQ,OAAOA,EAAK8F,KAAKA,EAAKI,SAASlG,EAAKqF,aAC1D,IAAoB,GAAhByB,EAAM5P,QAAiC,GAAlB2P,EAAQ3P,OAKtC,OAAO,KAJP4O,EAAOe,EAAQ,GACf7I,EAAO,SACP0V,EAAS,SAAU1T,GAAQ,OAAOA,EAAK8F,KAAKA,EAAKS,cAAcvG,EAAKqF,SAKtE,IADA,IAAIo2B,EAAU,GACL3wB,EAAM,EAAGA,EAAMmyB,EAAKh9B,WAAY6K,IAAS2wB,EAAQllC,KAAKmd,EAAOupB,EAAK5nC,MAAMyV,KACjF,GAAI,WAASxQ,KAAKmhC,GAASr1B,GAAG0B,GAAQ,MAAO,CAAChC,KAAMA,EAAM9H,KAAMA,GA5D9C87C,CAAan6C,EAAMe,OAAOzB,QAAQoX,IAAI1W,EAAM0M,aAAcvL,EAAIuL,cACjDstC,EAAOj5C,OAAOzB,QAAQoX,IAAIsjC,EAAOttC,aAAcksC,EAAOE,KAAOkB,EAAOxgD,WAE/F6/B,EAAK4J,EAAKz0B,MAAM6qB,GACO,OAAnB0gB,EAAW17C,KAAiBg7B,EAAGpyB,QAAQgzC,EAAQC,EAAMH,EAAW5zC,MAC7DkzB,EAAG5xB,WAAWwyC,EAAQC,EAAMH,EAAW5zC,WACzC,GAAInG,EAAMe,OAAOrL,MAAMsK,EAAMhH,SAASwc,QAAUxV,EAAMhH,SAAWmI,EAAInI,SAAWmI,EAAIqY,WAAa,EAAI,GAAI,CAE9G,IAAIuJ,EAAS/iB,EAAMe,OAAOqV,YAAYpW,EAAM0M,aAAcvL,EAAIuL,cAC9D,GAAIu2B,EAAKG,SAAS,mBAAmB,SAAUtpC,GAAK,OAAOA,EAAEmpC,EAAMgX,EAAQC,EAAMn3B,MAAe,OAChGsW,EAAK4J,EAAKz0B,MAAM6qB,GAAGuD,WAAW7Z,EAAQk3B,EAAQC,GAMlD,GAFK7gB,IACDA,EAAK4J,EAAKz0B,MAAM6qB,GAAGz6B,QAAQq7C,EAAQC,EAAM1oC,EAAM/U,IAAItB,MAAMy9C,EAAOp/C,MAAQgY,EAAM7W,KAAMi+C,EAAOG,KAAOvnC,EAAM7W,QACxG6W,EAAMspB,IAAK,CACb,IAAIwf,EAAQpB,iBAAiBjW,EAAM5J,EAAG58B,IAAK+U,EAAMspB,KAM7Cwf,KAAW1gD,EAAOkmC,QAAUlmC,EAAO0mC,SAAW2C,EAAKgL,WAAaqM,EAAM//C,QAC5Dq+C,EAAOp/C,OAASo/C,EAAOG,MAAQ9V,EAAK6W,kBAAoBre,KAAKC,MAAQ,OACrE4e,EAAM1zB,MAAQqzB,GAAUK,EAAM1zB,MAAQyS,EAAG59B,QAAQvE,IAAIgjD,GAAQ,IAC9DtgD,EAAO6lC,IAAM6a,EAAM//C,OAAS+/C,EAAM1zB,MAAQqzB,IACnD5gB,EAAG2B,aAAasf,GAElBze,GAAexC,EAAGkB,YAAYsB,GAClCoH,EAAKgT,SAAS5c,EAAG0D,oBAGnB,SAASmc,iBAAiBjW,EAAMxmC,EAAK89C,GACnC,OAAIpiD,KAAK8G,IAAIs7C,EAAUnhB,OAAQmhB,EAAU3zB,MAAQnqB,EAAI6C,QAAQlK,KAAe,KACrEo+C,iBAAiBvQ,EAAMxmC,EAAIwD,QAAQs6C,EAAUnhB,QAAS38B,EAAIwD,QAAQs6C,EAAU3zB,OAkDrF,SAAS8yB,sBAAsBh3C,EAAM83C,EAASC,GAE5C,IADA,IAAIt6C,EAAQuC,EAAKvC,MAAOxG,EAAM6gD,EAAU93C,EAAK/I,MAAQ+I,EAAKnK,IACnD4H,EAAQ,IAAMq6C,GAAW93C,EAAKtC,WAAWD,IAAUuC,EAAKrC,KAAKF,GAAOG,aACzEH,IACAxG,IACA6gD,GAAU,EAEZ,GAAIC,EAEF,IADA,IAAIl6C,EAAOmC,EAAKrC,KAAKF,GAAOK,WAAWkC,EAAKtC,WAAWD,IAChDI,IAASA,EAAKE,QACnBF,EAAOA,EAAKG,WACZ/G,IAGJ,OAAOA,EA2BT,SAAS+gD,sBAAsBzX,EAAM9nC,GAKnC,IAJA,IAAI1G,EAAU,GACV6K,EAAUnE,EAAMmE,QAChBF,EAAYjE,EAAMiE,UAClBD,EAAUhE,EAAMgE,QACbC,EAAY,GAAKD,EAAU,GAA2B,GAAtBG,EAAQgB,YAAoD,GAAjChB,EAAQoB,WAAWJ,YAAiB,CACpGlB,IACAD,IACA,IAAIkB,EAAOf,EAAQoB,WACnBjM,EAAQmC,KAAKyJ,EAAKhC,KAAK9B,KAAM8D,EAAKmB,OAASnB,EAAKhC,KAAKod,aAAepb,EAAKmB,MAAQ,MACjFlC,EAAUe,EAAKf,QAGjB,IAAIq7C,EAAa1X,EAAKG,SAAS,wBAA0B,gBAAc3e,WAAWwe,EAAKz0B,MAAMvQ,QACzFxB,EAAMm+C,cAAe91C,EAAOrI,EAAI8xB,cAAc,OAClDzpB,EAAKwlB,YAAYqwB,EAAWntB,kBAAkBluB,EAAS,CAACiuB,SAAU9wB,KAGlE,IADA,IAAkCu0C,EAA9BtwC,EAAaoE,EAAKpE,WACfA,GAAqC,GAAvBA,EAAWa,WAAkByvC,EAAY6J,EAAQn6C,EAAWsnB,SAASC,iBAAiB,CACzG,IAAK,IAAIzwB,EAAIw5C,EAAUz5C,OAAS,EAAGC,GAAK,EAAGA,IAAK,CAE9C,IADA,IAAIkW,EAAUjR,EAAI8xB,cAAcyiB,EAAUx5C,IACnCsN,EAAKpE,YAAcgN,EAAQ4c,YAAYxlB,EAAKpE,YACnDoE,EAAKwlB,YAAY5c,GACG,SAAhBsjC,EAAUx5C,KACZ4H,IACAD,KAGJuB,EAAaoE,EAAKpE,WASpB,OANIA,GAAqC,GAAvBA,EAAWa,UACzBb,EAAWguB,aAAa,gBAAkBtvB,EAAY,IAAMD,EAAU,IAAOhF,KAAKC,UAAU3F,IAKzF,CAACgvB,IAAK3e,EAAM2Q,KAHRwtB,EAAKG,SAAS,2BAA2B,SAAUtpC,GAAK,OAAOA,EAAEqB,OACxEA,EAAMmE,QAAQ8W,YAAY,EAAGjb,EAAMmE,QAAQlK,KAAM,SAOvD,SAAS0lD,mBAAmB7X,EAAMxtB,EAAMslC,EAAMC,EAAWluB,GACvD,IAAIrJ,EAA8CtoB,EAAzC8/C,EAASnuB,EAAS/rB,OAAO1C,KAAK+C,KAAKogB,KAC5C,IAAKu5B,IAAStlC,EAAQ,OAAO,KAC7B,IAAIylC,EAASzlC,IAASulC,GAAaC,IAAWF,GAC9C,GAAIG,EAAQ,CAEV,GADAjY,EAAKG,SAAS,uBAAuB,SAAUtpC,GAAK2b,EAAO3b,EAAE2b,EAAMwlC,GAAUD,MACzEC,EAAU,OAAOxlC,EAAO,IAAI,QAAM,WAAS9a,KAAKsoC,EAAKz0B,MAAMvQ,OAAOwX,KAAKA,EAAK7W,QAAQ,SAAU,QAAS,EAAG,GAAK,QAAMrE,MACzH,IAAI4gD,EAASlY,EAAKG,SAAS,uBAAuB,SAAUtpC,GAAK,OAAOA,EAAE2b,EAAMqX,EAAUkuB,MAC1F,GAAIG,EACFhgD,EAAQggD,MACH,CACL,IAAIz1C,EAAQonB,EAASpnB,QAEjBzH,EADMglC,EAAKz0B,MACEvQ,OACb08C,EAAa,gBAAcl2B,WAAWxmB,GAC1CwlB,EAAM8J,SAASgB,cAAc,OAC7B9Y,EAAK1P,MAAM,iBAAiBlR,SAAQ,SAAUo3B,GAC5C,IAAItV,EAAI8M,EAAI6G,YAAYiD,SAASgB,cAAc,MAC3CtC,GAAStV,EAAE2T,YAAYqwB,EAAWzsB,cAAcjwB,EAAOwX,KAAKwW,EAAOvmB,cAI3Eu9B,EAAKG,SAAS,uBAAuB,SAAUtpC,GAAKihD,EAAOjhD,EAAEihD,MAC7Dt3B,EA4IJ,SAAS23B,SAASL,GAChB,IAAIM,EAAQ,sBAAsB7zB,KAAKuzB,GACnCM,IAASN,EAAOA,EAAK5/C,MAAMkgD,EAAM,GAAG9jD,SACxC,IAC8CuN,EAD1CqhC,EAAMyU,cAAcrsB,cAAc,OAClC+sB,EAAW,mBAAmB9zB,KAAKuzB,IACnCj2C,EAAOw2C,GAAYT,EAAQS,EAAS,GAAGrzB,kBACvC8yB,EAAOj2C,EAAK5N,KAAI,SAAUoD,GAAK,MAAO,IAAMA,EAAI,OAAQ2L,KAAK,IAAM80C,EAAOj2C,EAAK5N,KAAI,SAAUoD,GAAK,MAAO,KAAOA,EAAI,OAAQglB,UAAUrZ,KAAK,KAE/I,GADAkgC,EAAIoV,UAAYR,EACZj2C,EAAQ,IAAK,IAAItN,EAAI,EAAGA,EAAIsN,EAAKvN,OAAQC,IAAO2uC,EAAMA,EAAIza,cAAc5mB,EAAKtN,KAAO2uC,EACxF,OAAOA,EArJCiV,CAASL,GACXnhD,EAAO2mC,QA4Jf,SAASib,sBAAsB/3B,GAE7B,IADA,IAAIjM,EAAQiM,EAAIg4B,iBAAiB7hD,EAAOkmC,OAAS,iCAAmC,8BAC3EtoC,EAAI,EAAGA,EAAIggB,EAAMjgB,OAAQC,IAAK,CACrC,IAAI6I,EAAOmX,EAAMhgB,GACa,GAA1B6I,EAAKurB,WAAWr0B,QAAmC,KAApB8I,EAAKib,aAA2Bjb,EAAK0nB,YACpE1nB,EAAK0nB,WAAW7kB,aAAaugB,EAAIwH,cAAcC,eAAe,KAAM7qB,IAjKnDm7C,CAAsB/3B,GAG7C,IAAIi4B,EAAcj4B,GAAOA,EAAIiI,cAAc,mBACvCiwB,EAAYD,GAAe,oBAAoBl0B,KAAKk0B,EAAYvyB,aAAa,kBACjF,IAAKhuB,EAAO,CACV,IAAI+sB,EAAS+a,EAAKG,SAAS,oBAAsBH,EAAKG,SAAS,cAAgB,YAAU3e,WAAWwe,EAAKz0B,MAAMvQ,QAC/G9C,EAAQ+sB,EAAOrE,WAAWJ,EAAK,CAC7BwD,sBAAuBi0B,IAAUS,GACjClnD,QAASq4B,EACTvC,aAAc,SAASA,aAAa9G,GAClC,GAAoB,MAAhBA,EAAIuE,WAAqBvE,EAAI4G,aAC7B5G,EAAIsE,aAAe6zB,EAAc97B,KAAK2D,EAAIsE,WAAWC,UAAa,MAAO,CAACwC,QAAQ,MAI5F,GAAImxB,EACFxgD,EAoJJ,SAAS0gD,WAAW1gD,EAAO1G,GACzB,IAAK0G,EAAM/F,KAAQ,OAAO+F,EAC1B,IAAmDmc,EAA/CrZ,EAAS9C,EAAMmE,QAAQoB,WAAWrC,KAAKJ,OAC3C,IAAMqZ,EAAQnd,KAAKqX,MAAM/c,GACzB,MAAMoK,GAAK,OAAO1D,EAIlB,IAHA,IAAImE,EAAUnE,EAAMmE,QAChBF,EAAYjE,EAAMiE,UAClBD,EAAUhE,EAAMgE,QACX3H,EAAI8f,EAAM/f,OAAS,EAAGC,GAAK,EAAGA,GAAK,EAAG,CAC7C,IAAI6G,EAAOJ,EAAOuZ,MAAMF,EAAM9f,IAC9B,IAAK6G,GAAQA,EAAKogB,mBAAsB,MACxCnf,EAAU,WAAS3E,KAAK0D,EAAKhC,OAAOib,EAAM9f,EAAI,GAAI8H,IAClDF,IAAaD,IAEf,OAAO,IAAI,QAAMG,EAASF,EAAWD,GAlK3B08C,CAAWC,WAAW3gD,GAAQwgD,EAAU,IAAKA,EAAU,IAAKA,EAAU,SAG9E,IADAxgD,EAAQ,QAAMse,QAyBlB,SAASsiC,kBAAkB53C,EAAU2oB,GACnC,GAAI3oB,EAAS7D,WAAa,EAAK,OAAO6D,EAsBtC,IArBA,IAAI+Z,KAAO,SAAWpb,GACpB,IACImF,EADS6kB,EAASzsB,KAAKyC,GACRlB,eAAekrB,EAAS9zB,MAAM8J,IAC7Ck5C,OAAW,EAAUpiD,EAAS,GAelC,GAdAuK,EAAStP,SAAQ,SAAUwL,GACzB,GAAKzG,EAAL,CACA,IAA0CqiD,EAAtCn3C,EAAOmD,EAAM3G,aAAajB,EAAKhC,MACnC,IAAKyG,EAAQ,OAAOlL,EAAS,KAC7B,GAAIqiD,EAASriD,EAAOrC,QAAUykD,EAASzkD,QAAU2kD,aAAap3C,EAAMk3C,EAAU37C,EAAMzG,EAAOA,EAAOrC,OAAS,GAAI,GAC7GqC,EAAOA,EAAOrC,OAAS,GAAK0kD,MACvB,CACDriD,EAAOrC,SAAUqC,EAAOA,EAAOrC,OAAS,GAAK4kD,WAAWviD,EAAOA,EAAOrC,OAAS,GAAIykD,EAASzkD,SAChG,IAAI6kD,EAAUC,aAAah8C,EAAMyE,GACjClL,EAAOhD,KAAKwlD,GACZn0C,EAAQA,EAAM7F,UAAUg6C,EAAQ/9C,KAAM+9C,EAAQ56C,OAC9Cw6C,EAAWl3C,OAGXlL,EAAU,MAAO,CAAEmvB,EAAG,WAASpuB,KAAKf,KAGjCkJ,EAAIgqB,EAAS3sB,MAAO2C,GAAK,EAAGA,IAAK,CACxC,IAAIkmB,EAAW9K,KAAMpb,GAErB,GAAKkmB,EAAW,OAAOA,EAASD,EAElC,OAAO5kB,EArDiB43C,CAAkB5gD,EAAMmE,QAASwtB,IAAW,IACxD1tB,WAAajE,EAAMgE,QAAS,CAEpC,IADA,IAAIC,EAAY,EAAGD,EAAU,EACpBkB,EAAOlF,EAAMmE,QAAQoB,WAAYtB,EAAYjE,EAAMiE,YAAciB,EAAKhC,KAAK+C,KAAKC,UACpFjC,IAAaiB,EAAOA,EAAKK,YAC9B,IAAK,IAAI47C,EAASnhD,EAAMmE,QAAQyJ,UAAW5J,EAAUhE,EAAMgE,UAAYm9C,EAAOj+C,KAAK+C,KAAKC,UACnFlC,IAAWm9C,EAASA,EAAOvzC,WAChC5N,EAAQ2gD,WAAW3gD,EAAOiE,EAAWD,GAKzC,OADA8jC,EAAKG,SAAS,mBAAmB,SAAUtpC,GAAKqB,EAAQrB,EAAEqB,MACnDA,EAGT,IAAIygD,EAAgB,gHAyCpB,SAASS,aAAah8C,EAAMyE,EAAMnK,QAClB,IAATA,IAAkBA,EAAO,GAE9B,IAAK,IAAInD,EAAIsN,EAAKvN,OAAS,EAAGC,GAAKmD,EAAMnD,IACrC6I,EAAOyE,EAAKtN,GAAG6E,OAAO,KAAM,WAAS1B,KAAK0F,IAC9C,OAAOA,EAKT,SAAS67C,aAAap3C,EAAMk3C,EAAU37C,EAAMk8C,EAASp8C,GACnD,GAAIA,EAAQ2E,EAAKvN,QAAU4I,EAAQ67C,EAASzkD,QAAUuN,EAAK3E,IAAU67C,EAAS77C,GAAQ,CACpF,IAAI4B,EAAQm6C,aAAap3C,EAAMk3C,EAAU37C,EAAMk8C,EAAQxzC,UAAW5I,EAAQ,GAC1E,GAAI4B,EAAS,OAAOw6C,EAAQnhD,KAAKmhD,EAAQj9C,QAAQ4D,aAAaq5C,EAAQj8C,WAAa,EAAGyB,IAEtF,GADYw6C,EAAQ36C,eAAe26C,EAAQj8C,YACjC8B,UAAUjC,GAAS2E,EAAKvN,OAAS,EAAI8I,EAAKhC,KAAOyG,EAAK3E,EAAQ,IACpE,OAAOo8C,EAAQnhD,KAAKmhD,EAAQj9C,QAAQC,OAAO,WAAS5E,KAAK0hD,aAAah8C,EAAMyE,EAAM3E,EAAQ,OAIlG,SAASg8C,WAAW97C,EAAMF,GACxB,GAAa,GAATA,EAAc,OAAOE,EACzB,IAAI8D,EAAW9D,EAAKf,QAAQ4D,aAAa7C,EAAKC,WAAa,EAAG67C,WAAW97C,EAAK0I,UAAW5I,EAAQ,IAC7FkI,EAAOhI,EAAKuB,eAAevB,EAAKC,YAAYgI,WAAW,WAAS/N,OAAO,GAC3E,OAAO8F,EAAKjF,KAAK+I,EAAS5E,OAAO8I,IAGnC,SAASm0C,WAAWr4C,EAAUs+B,EAAM9nC,EAAMC,EAAIuF,EAAOhB,GACnD,IAAIkB,EAAOoiC,EAAO,EAAIt+B,EAASzD,WAAayD,EAAS4E,UAAWhH,EAAQ1B,EAAKf,QAK7E,OAJIa,EAAQvF,EAAK,IAAKmH,EAAQy6C,WAAWz6C,EAAO0gC,EAAM9nC,EAAMC,EAAIuF,EAAQ,EAAGhB,IACvEgB,GAASxF,IACToH,EAAQ0gC,EAAO,EAAIpiC,EAAKuB,eAAe,GAAG0G,WAAWvG,EAAOoC,EAAS7D,WAAa,GAAKnB,GAAWgB,GAAOZ,OAAOwC,GAC9GA,EAAMxC,OAAOc,EAAKuB,eAAevB,EAAKC,YAAYgI,WAAW,WAAS/N,OAAO,KAC5E4J,EAASjB,aAAau/B,EAAO,EAAI,EAAIt+B,EAAS7D,WAAa,EAAGD,EAAKjF,KAAK2G,IAGjF,SAAS+5C,WAAW3gD,EAAOiE,EAAWD,GAKpC,OAJIC,EAAYjE,EAAMiE,YAClBjE,EAAQ,IAAI,QAAMqhD,WAAWrhD,EAAMmE,SAAU,EAAGF,EAAWjE,EAAMiE,UAAW,EAAGjE,EAAMgE,SAAUC,EAAWjE,EAAMgE,UAChHA,EAAUhE,EAAMgE,UAChBhE,EAAQ,IAAI,QAAMqhD,WAAWrhD,EAAMmE,QAAS,EAAGH,EAAShE,EAAMgE,QAAS,EAAG,GAAIhE,EAAMiE,UAAWD,IAC5FhE,EAMT,IAAI0/C,EAAU,CACZ4B,MAAO,CAAC,SACRC,MAAO,CAAC,SACRj2B,MAAO,CAAC,SACRk2B,QAAS,CAAC,SACVC,SAAU,CAAC,SACXC,IAAK,CAAC,QAAS,YACfxjB,GAAI,CAAC,QAAS,SACdyjB,GAAI,CAAC,QAAS,QAAS,MACvBC,GAAI,CAAC,QAAS,QAAS,OAGrBC,EAAe,KACnB,SAASpC,cACP,OAAOoC,IAAiBA,EAAezvB,SAAS0vB,eAAeC,mBAAmB,UA8CpF,IAAIC,EAAiB,CACnBC,WAAW,EACXC,eAAe,EACfC,uBAAuB,EACvBC,YAAY,EACZC,mBAAmB,EACnBC,SAAS,GAGPC,EAAc9jD,EAAO6lC,IAAM7lC,EAAO8lC,YAAc,GAEhDie,EAAiB,SAASA,iBAC5BjlD,KAAKozC,WAAapzC,KAAKqzC,aAAerzC,KAAKuwC,UAAYvwC,KAAKywC,YAAc,MAG5EwU,EAAe7kD,UAAUnE,IAAM,SAASA,IAAKmmC,GAC3CpiC,KAAKozC,WAAahR,EAAIgR,WAAYpzC,KAAKqzC,aAAejR,EAAIiR,aAC1DrzC,KAAKuwC,UAAYnO,EAAImO,UAAWvwC,KAAKywC,YAAcrO,EAAIqO,aAGzDwU,EAAe7kD,UAAU2N,GAAK,SAASA,GAAIq0B,GACzC,OAAOA,EAAIgR,YAAcpzC,KAAKozC,YAAchR,EAAIiR,cAAgBrzC,KAAKqzC,cACnEjR,EAAImO,WAAavwC,KAAKuwC,WAAanO,EAAIqO,aAAezwC,KAAKywC,aAG/D,IAAIyU,EAAc,SAASA,YAAY3a,EAAM4a,GAC3C,IAAI54C,EAASvM,KAEbA,KAAKuqC,KAAOA,EACZvqC,KAAKmlD,gBAAkBA,EACvBnlD,KAAKolD,MAAQ,GACbplD,KAAKqlD,cAAgB,EACrBrlD,KAAKslD,SAAWpvC,OAAOqvC,kBACrB,IAAIrvC,OAAOqvC,kBAAiB,SAAUC,GACpC,IAAK,IAAI1mD,EAAI,EAAGA,EAAI0mD,EAAU3mD,OAAQC,IAAOyN,EAAO64C,MAAMlnD,KAAKsnD,EAAU1mD,IAKrEoC,EAAO6lC,IAAM7lC,EAAO8lC,YAAc,IAAMwe,EAAU36B,MACpD,SAAU1nB,GAAK,MAAiB,aAAVA,EAAEwC,MAAuBxC,EAAEsiD,aAAa5mD,QAC/C,iBAAVsE,EAAEwC,MAA2BxC,EAAEoxC,SAAS11C,OAASsE,EAAE2I,OAAOmlB,UAAUpyB,UACvE0N,EAAOm5C,YAEPn5C,EAAOo5C,WAEf3lD,KAAKy7C,iBAAmB,IAAIwJ,EACxBD,IACFhlD,KAAK4lD,WAAa,SAAUz/C,GAC1BoG,EAAO64C,MAAMlnD,KAAK,CAAC4N,OAAQ3F,EAAE2F,OAAQnG,KAAM,gBAAiB4uC,SAAUpuC,EAAE0/C,YACxEt5C,EAAOm5C,cAGX1lD,KAAK8lD,kBAAoB9lD,KAAK8lD,kBAAkB77B,KAAKjqB,MACrDA,KAAK+lD,6BAA8B,GAGrCb,EAAY9kD,UAAUslD,UAAY,SAASA,YACvC,IAAIn5C,EAASvM,KAEXA,KAAKqlD,aAAe,IACpBrlD,KAAKqlD,aAAenvC,OAAOyoB,YAAW,WAAcpyB,EAAO84C,cAAgB,EAAG94C,EAAOo5C,UAAY,MAGvGT,EAAY9kD,UAAU4lD,WAAa,SAASA,aACtChmD,KAAKqlD,cAAgB,IACvBnvC,OAAO+vC,aAAajmD,KAAKqlD,cACzBrlD,KAAKqlD,cAAgB,EACrBrlD,KAAK2lD,UAITT,EAAY9kD,UAAUU,MAAQ,SAASA,QACjCd,KAAKslD,UACLtlD,KAAKslD,SAASY,QAAQlmD,KAAKuqC,KAAKxf,IAAK05B,GACrCO,GACAhlD,KAAKuqC,KAAKxf,IAAIyxB,iBAAiB,2BAA4Bx8C,KAAK4lD,YACpE5lD,KAAKy8C,oBAGPyI,EAAY9kD,UAAU8zC,KAAO,SAASA,OAClC,IAAI3nC,EAASvM,KAEf,GAAIA,KAAKslD,SAAU,CACjB,IAAIa,EAAOnmD,KAAKslD,SAASc,cACzB,GAAID,EAAKtnD,OAAQ,CACf,IAAK,IAAIC,EAAI,EAAGA,EAAIqnD,EAAKtnD,OAAQC,IAAOkB,KAAKolD,MAAMlnD,KAAKioD,EAAKrnD,IAC7DoX,OAAOyoB,YAAW,WAAc,OAAOpyB,EAAOo5C,UAAY,IAE5D3lD,KAAKslD,SAASe,aAEZrB,GAAehlD,KAAKuqC,KAAKxf,IAAIuxB,oBAAoB,2BAA4Bt8C,KAAK4lD,YACtF5lD,KAAK47C,uBAGPsJ,EAAY9kD,UAAUq8C,iBAAmB,SAASA,mBAChDz8C,KAAKuqC,KAAKxf,IAAIwH,cAAciqB,iBAAiB,kBAAmBx8C,KAAK8lD,oBAGvEZ,EAAY9kD,UAAUw7C,oBAAsB,SAASA,sBACnD57C,KAAKuqC,KAAKxf,IAAIwH,cAAc+pB,oBAAoB,kBAAmBt8C,KAAK8lD,oBAG1EZ,EAAY9kD,UAAU8gD,yBAA2B,SAASA,2BACtD,IAAI30C,EAASvM,KAEfA,KAAK+lD,6BAA8B,EACnCpnB,YAAW,WAAc,OAAOpyB,EAAOw5C,6BAA8B,IAAU,KAGjFb,EAAY9kD,UAAU0lD,kBAAoB,SAASA,oBACjD,GA3+BF,SAASQ,qBAAqB/b,GAC5B,QAAIA,EAAKyQ,UAAYzQ,EAAKmD,KAAK8B,eAAiBjF,EAAKxf,MAC9CmwB,aAAa3Q,GAy+Bf+b,CAAqBtmD,KAAKuqC,MAA/B,CACA,GAAIvqC,KAAK+lD,4BAA+B,OAAO5K,eAAen7C,KAAKuqC,MAInE,GAAIrpC,EAAO6lC,IAAM7lC,EAAO8lC,YAAc,KAAOhnC,KAAKuqC,KAAKz0B,MAAMusB,UAAUxgC,MAAO,CAC5E,IAAIugC,EAAMpiC,KAAKuqC,KAAKmD,KAAKyC,eAEzB,GAAI/N,EAAImO,WAAa/H,qBAAqBpG,EAAImO,UAAWnO,EAAIqO,YAAarO,EAAIgR,WAAYhR,EAAIiR,cAC1F,OAAOrzC,KAAK0lD,YAElB1lD,KAAK2lD,UAGPT,EAAY9kD,UAAUu7C,gBAAkB,SAASA,kBAC/C37C,KAAKy7C,iBAAiBx/C,IAAI+D,KAAKuqC,KAAKmD,KAAKyC,iBAG3C+U,EAAY9kD,UAAUmmD,sBAAwB,SAASA,sBAAuBnkB,GAC5E,GAAsB,GAAlBA,EAAIiH,WAAmB,OAAO,EAClC,IAAImd,EAAYpkB,EAAIkH,WAAW,GAAGmd,wBAC9BliB,EAAOvkC,KAAKuqC,KAAKyD,QAAQC,YAAYuY,GACzC,OAAIjiB,GAAQA,EAAKkP,eAAe,CAAC9tC,KAAM,YAAamG,OAA8B,GAAtB06C,EAAU39C,SAAgB29C,EAAUn3B,WAAam3B,KAC3GxmD,KAAK27C,mBACE,QAFT,GAMFuJ,EAAY9kD,UAAUulD,MAAQ,SAASA,QACrC,GAAK3lD,KAAKuqC,KAAKyD,WAAWhuC,KAAKqlD,cAAgB,GAA/C,CACA,IAAIG,EAAYxlD,KAAKslD,SAAWtlD,KAAKslD,SAASc,cAAgB,GAC1DpmD,KAAKolD,MAAMvmD,SACb2mD,EAAYxlD,KAAKolD,MAAMv7C,OAAO27C,GAC9BxlD,KAAKolD,MAAMvmD,OAAS,GAGtB,IAAIujC,EAAMpiC,KAAKuqC,KAAKmD,KAAKyC,eACrBiP,GAAUp/C,KAAK+lD,8BAAgC/lD,KAAKy7C,iBAAiB1tC,GAAGq0B,IAAQ8Y,aAAal7C,KAAKuqC,QAAUvqC,KAAKumD,sBAAsBnkB,GAEvIngC,GAAQ,EAAGC,GAAM,EAAG88C,GAAW,EAAOvwC,EAAQ,GAClD,GAAIzO,KAAKuqC,KAAKyQ,SACZ,IAAK,IAAIl8C,EAAI,EAAGA,EAAI0mD,EAAU3mD,OAAQC,IAAK,CACzC,IAAI4nD,EAAW1mD,KAAK2mD,iBAAiBnB,EAAU1mD,GAAI2P,GAC/Ci4C,IACFzkD,EAAOA,EAAO,EAAIykD,EAASzkD,KAAOxC,KAAKuO,IAAI04C,EAASzkD,KAAMA,GAC1DC,EAAKA,EAAK,EAAIwkD,EAASxkD,GAAKzC,KAAK8G,IAAImgD,EAASxkD,GAAIA,GAC9CwkD,EAAS1H,WAAYA,GAAW,IAK1C,GAAI99C,EAAOgmC,OAASz4B,EAAM5P,OAAS,EAAG,CACpC,IAAI+nD,EAAMn4C,EAAMkoC,QAAO,SAAU/0C,GAAK,MAAqB,MAAdA,EAAE0tB,YAC/C,GAAkB,GAAds3B,EAAI/nD,OAAa,CACnB,IAAIiM,EAAI87C,EAAI,GACN77C,EAAI67C,EAAI,GACV97C,EAAEukB,YAAcvkB,EAAEukB,WAAWA,YAActkB,EAAEskB,WAActkB,EAAEkR,SAC1DnR,EAAEmR,WAITha,GAAQ,GAAKm9C,KACXn9C,GAAQ,IACVjC,KAAKuqC,KAAKyD,QAAQ2F,UAAU1xC,EAAMC,GA6DxC,SAAS2kD,SAAStc,GAChB,GAAIuc,EAAc,OAClBA,GAAa,EACgC,UAAzClP,iBAAiBrN,EAAKxf,KAAKg8B,YAC3BC,QAAc,KAAE,4KAhEhBH,CAAS7mD,KAAKuqC,OAEhBvqC,KAAKmlD,gBAAgBljD,EAAMC,EAAI88C,EAAUvwC,GACrCzO,KAAKuqC,KAAKyD,QAAQ+C,MAAS/wC,KAAKuqC,KAAKkF,YAAYzvC,KAAKuqC,KAAKz0B,OACrD9V,KAAKy7C,iBAAiB1tC,GAAGq0B,IAAQ+Y,eAAen7C,KAAKuqC,MAC/DvqC,KAAKy7C,iBAAiBx/C,IAAImmC,MAI9B8iB,EAAY9kD,UAAUumD,iBAAmB,SAASA,iBAAkBrS,EAAK7lC,GAEvE,GAAIA,EAAM1P,QAAQu1C,EAAIxoC,SAAW,EAAK,OAAO,KAC7C,IAAIy4B,EAAOvkC,KAAKuqC,KAAKyD,QAAQC,YAAYqG,EAAIxoC,QAC7C,GAAgB,cAAZwoC,EAAI3uC,OACH4+B,GAAQvkC,KAAKuqC,KAAKyD,SAAgC,mBAArBsG,EAAI2S,eAEX,SAArB3S,EAAI2S,gBAA6B3S,EAAIC,WAAaD,EAAIxoC,OAAO2kB,aAAa,UAC5E,OAAO,KACX,IAAK8T,GAAQA,EAAKkP,eAAea,GAAQ,OAAO,KAEhD,GAAgB,aAAZA,EAAI3uC,KAAqB,CAC3B,IAAK,IAAI7G,EAAI,EAAGA,EAAIw1C,EAAI2K,WAAWpgD,OAAQC,IAAO2P,EAAMvQ,KAAKo2C,EAAI2K,WAAWngD,IAC5E,GAAIylC,EAAKzR,YAAcyR,EAAKzR,YAAcyR,EAAKxZ,MAAQwZ,EAAKzR,WAAWc,SAAS0gB,EAAIxoC,QAChF,MAAO,CAAC7J,KAAMsiC,EAAK2J,UAAWhsC,GAAIqiC,EAAK4J,UAC3C,IAAIvJ,EAAO0P,EAAInjB,gBAAiBtpB,EAAOysC,EAAI3iB,YAC3C,GAAIzwB,EAAO6lC,IAAM7lC,EAAO8lC,YAAc,IAAMsN,EAAI2K,WAAWpgD,OAGzD,IAAK,IAAIgR,EAAM,EAAGA,EAAMykC,EAAI2K,WAAWpgD,OAAQgR,IAAO,CACpD,IAAIiC,EAAMwiC,EAAI2K,WAAWpvC,GACnBshB,EAAkBrf,EAAIqf,gBACtBQ,EAAc7f,EAAI6f,cACnBR,GAAmB1S,MAAMre,UAAUrB,QAAQwD,KAAK+xC,EAAI2K,WAAY9tB,GAAmB,KAAKyT,EAAOzT,KAC/FQ,GAAelT,MAAMre,UAAUrB,QAAQwD,KAAK+xC,EAAI2K,WAAYttB,GAAe,KAAK9pB,EAAO8pB,GAGhG,IAAIghB,EAAa/N,GAAQA,EAAKvV,YAAcilB,EAAIxoC,OAC1Ck8B,SAASpD,GAAQ,EAAI,EACvB3iC,EAAOsiC,EAAKqN,gBAAgB0C,EAAIxoC,OAAQ6mC,GAAa,GACrDC,EAAW/qC,GAAQA,EAAKwnB,YAAcilB,EAAIxoC,OACxCk8B,SAASngC,GAAQysC,EAAIxoC,OAAOonB,WAAWr0B,OAE7C,MAAO,CAACoD,KAAMA,EAAMC,GADXqiC,EAAKqN,gBAAgB0C,EAAIxoC,OAAQ8mC,EAAU,IAE/C,MAAgB,cAAZ0B,EAAI3uC,KACN,CAAC1D,KAAMsiC,EAAK+J,WAAa/J,EAAKgK,OAAQrsC,GAAIqiC,EAAKyM,SAAWzM,EAAKgK,QAE/D,CACLtsC,KAAMsiC,EAAK+J,WACXpsC,GAAIqiC,EAAKyM,SAKTgO,SAAU1K,EAAIxoC,OAAOmlB,WAAaqjB,EAAIC,WAK5C,IAAIuS,GAAa,EAWjB,IAAII,EAAW,GAAIC,EAAe,GA4ClC,SAASC,mBAAmB7c,EAAMoQ,GAChCpQ,EAAK4U,oBAAsBxE,EAC3BpQ,EAAK2U,kBAAoBnc,KAAKC,MAWhC,SAASqkB,gBAAgB9c,GACvBA,EAAKG,SAAS,mBAAmB,SAAU4c,GACzC,IAAK,IAAI3hD,KAAQ2hD,EAAwB/c,EAAKgd,cAAc5hD,IACxD4kC,EAAKxf,IAAIyxB,iBAAiB72C,EAAM4kC,EAAKgd,cAAc5hD,GAAQ,SAAU8jC,GAAS,OAAO+d,iBAAiBjd,EAAMd,QAIpH,SAAS+d,iBAAiBjd,EAAMd,GAC9B,OAAOc,EAAKG,SAAS,mBAAmB,SAAUwc,GAChD,IAAIO,EAAUP,EAASzd,EAAM9jC,MAC7B,QAAO8hD,IAAUA,EAAQld,EAAMd,IAAUA,EAAMie,qBAyEnD,SAASC,YAAYle,GAAS,MAAO,CAACrS,KAAMqS,EAAMme,QAASj1C,IAAK82B,EAAMoe,SAOtE,SAASC,oBAAoBvd,EAAMwd,EAAUloD,EAAK0J,EAAQkgC,GACxD,IAAe,GAAXlgC,EAAgB,OAAO,EAQ3B,IAPA,IAAIS,EAAOugC,EAAKz0B,MAAM/R,IAAIwD,QAAQgC,GAC9Bic,KAAO,SAAW1mB,GACpB,GAAIyrC,EAAKG,SAASqd,GAAU,SAAU3mD,GAAK,OAAOtC,EAAIkL,EAAKvC,MAAQrG,EAAEmpC,EAAM1qC,EAAKmK,EAAKa,UAAWb,EAAK7F,OAAOrF,GAAI2qC,GAAO,GACrEroC,EAAEmpC,EAAM1qC,EAAKmK,EAAKrC,KAAK7I,GAAIkL,EAAK7F,OAAOrF,GAAI2qC,GAAO,MAChG,MAAO,CAAEpZ,GAAG,IAGTvxB,EAAIkL,EAAKvC,MAAQ,EAAG3I,EAAI,EAAGA,IAAK,CACvC,IAAIwxB,EAAW9K,KAAM1mB,GAErB,GAAKwxB,EAAW,OAAOA,EAASD,EAElC,OAAO,EAGT,SAAS23B,gBAAgBzd,EAAMlI,EAAWsY,GACnCpQ,EAAK0d,SAAW1d,EAAK/M,QAC1B,IAAImD,EAAK4J,EAAKz0B,MAAM6qB,GAAG2B,aAAaD,GACtB,WAAVsY,GAAuBha,EAAGwD,QAAQ,WAAW,GACjDoG,EAAKgT,SAAS5c,GAuChB,SAASunB,kBAAkB3d,EAAM1qC,EAAK0J,EAAQkgC,EAAOiP,GACnD,OAAOoP,oBAAoBvd,EAAM,gBAAiB1qC,EAAK0J,EAAQkgC,IAC7Dc,EAAKG,SAAS,eAAe,SAAUtpC,GAAK,OAAOA,EAAEmpC,EAAM1qC,EAAK4pC,QAC/DiP,EA7BL,SAASyP,kBAAkB5d,EAAMhhC,GAC/B,IAAe,GAAXA,EAAgB,OAAO,EAC3B,IAAgC6+C,EAAcC,EAA1CjmB,EAAMmI,EAAKz0B,MAAMusB,UACjBD,aAAe,kBAAiBgmB,EAAehmB,EAAIz6B,MAGvD,IADA,IAAIqC,EAAOugC,EAAKz0B,MAAM/R,IAAIwD,QAAQgC,GACzBzK,EAAIkL,EAAKvC,MAAQ,EAAG3I,EAAI,EAAGA,IAAK,CACvC,IAAI6I,EAAO7I,EAAIkL,EAAKvC,MAAQuC,EAAKa,UAAYb,EAAKrC,KAAK7I,GACvD,GAAI,gBAAcojC,aAAav6B,GAAO,CAGhC0gD,EAFAD,GAAgBhmB,EAAI96B,MAAMG,MAAQ,GAClC3I,GAAKsjC,EAAI96B,MAAMG,OAASuC,EAAK7F,OAAOi+B,EAAI96B,MAAMG,MAAQ,IAAM26B,EAAI96B,MAAMzH,IAC3DmK,EAAK7F,OAAOi+B,EAAI96B,MAAMG,OAEtBuC,EAAK7F,OAAOrF,GAC3B,OAIJ,OAAgB,MAAZupD,IACFL,gBAAgBzd,EAAM,gBAAc5mC,OAAO4mC,EAAKz0B,MAAM/R,IAAKskD,GAAW,YAC/D,GASOF,CAAkB5d,EAAMhhC,GAvC1C,SAAS++C,kBAAkB/d,EAAMhhC,GAC/B,IAAe,GAAXA,EAAgB,OAAO,EAC3B,IAAIS,EAAOugC,EAAKz0B,MAAM/R,IAAIwD,QAAQgC,GAAS5B,EAAOqC,EAAKa,UACvD,SAAIlD,GAAQA,EAAKkb,QAAU,gBAAcqf,aAAav6B,MACpDqgD,gBAAgBzd,EAAM,IAAI,gBAAcvgC,GAAO,YACxC,GAkCyCs+C,CAAkB/d,EAAMhhC,IAG5E,SAASg/C,kBAAkBhe,EAAM1qC,EAAK0J,EAAQkgC,GAC5C,OAAOqe,oBAAoBvd,EAAM,sBAAuB1qC,EAAK0J,EAAQkgC,IACnEc,EAAKG,SAAS,qBAAqB,SAAUtpC,GAAK,OAAOA,EAAEmpC,EAAM1qC,EAAK4pC,MAG1E,SAAS+e,kBAAkBje,EAAM1qC,EAAK0J,EAAQkgC,GAC5C,OAAOqe,oBAAoBvd,EAAM,sBAAuB1qC,EAAK0J,EAAQkgC,IACnEc,EAAKG,SAAS,qBAAqB,SAAUtpC,GAAK,OAAOA,EAAEmpC,EAAM1qC,EAAK4pC,OAI1E,SAASgf,mBAAmBle,EAAMhhC,EAAQkgC,GACxC,GAAoB,GAAhBA,EAAMif,OAAe,OAAO,EAChC,IAAI3kD,EAAMwmC,EAAKz0B,MAAM/R,IACrB,IAAe,GAAXwF,EACF,QAAIxF,EAAI+d,gBACNkmC,gBAAgBzd,EAAM,gBAAc5mC,OAAOI,EAAK,EAAGA,EAAI6C,QAAQlK,MAAO,YAC/D,GAMX,IADA,IAAIsN,EAAOjG,EAAIwD,QAAQgC,GACdzK,EAAIkL,EAAKvC,MAAQ,EAAG3I,EAAI,EAAGA,IAAK,CACvC,IAAI6I,EAAO7I,EAAIkL,EAAKvC,MAAQuC,EAAKa,UAAYb,EAAKrC,KAAK7I,GACnD4+C,EAAU1zC,EAAK7F,OAAOrF,GAC1B,GAAI6I,EAAKma,cACLkmC,gBAAgBzd,EAAM,gBAAc5mC,OAAOI,EAAK25C,EAAU,EAAGA,EAAU,EAAI/1C,EAAKf,QAAQlK,MAAO,eAC9F,KAAI,gBAAcwlC,aAAav6B,GAGhC,SAFAqgD,gBAAgBzd,EAAM,gBAAc5mC,OAAOI,EAAK25C,GAAU,WAG9D,OAAO,GAxBP+K,CAAmBle,EAAMhhC,EAAQkgC,GA4BrC,SAASkf,cAAcpe,GACrB,OAAOqe,eAAere,GAnKxB4c,EAAa0B,QAAU,SAAUte,EAAMd,GAErC,GADAc,EAAKsU,SAA4B,IAAjBpV,EAAMD,SAAiBC,EAAMoV,UACzCiK,oBAAoBve,EAAMd,KAC9Bc,EAAKmV,YAAcjW,EAAMD,QACzBe,EAAK0V,gBAAkBld,KAAKC,OAIxB9hC,EAAO0mC,UAAW1mC,EAAOkmC,QAA2B,IAAjBqC,EAAMD,SAO7C,GANqB,KAAjBC,EAAMD,SAAkBe,EAAKiR,YAAYwK,cAMzC9kD,EAAOsmC,KAAwB,IAAjBiC,EAAMD,SAAkBC,EAAMiV,SAAYjV,EAAMmV,QAAWnV,EAAMkV,QASxEpU,EAAKG,SAAS,iBAAiB,SAAUtpC,GAAK,OAAOA,EAAEmpC,EAAMd,OAAc+U,eAAejU,EAAMd,GACzGA,EAAMxM,iBAENmqB,mBAAmB7c,EAAM,WAZiE,CAC1F,IAAIvH,EAAMD,KAAKC,MACfuH,EAAK+V,aAAetd,EACpBuH,EAAKwe,4BAA8BpqB,YAAW,WACxC4L,EAAK+V,cAAgBtd,IACvBuH,EAAKG,SAAS,iBAAiB,SAAUtpC,GAAK,OAAOA,EAAEmpC,EAAMhB,SAAS,GAAI,aAC1EgB,EAAK+V,aAAe,KAErB,OAQP6G,EAAa6B,MAAQ,SAAUze,EAAMpkC,GAClB,IAAbA,EAAEqjC,UAAiBe,EAAKsU,UAAW,IAGzCsI,EAAa8B,SAAW,SAAU1e,EAAMd,GACtC,KAAIqf,oBAAoBve,EAAMd,KAAWA,EAAMyf,UAC3Czf,EAAMiV,UAAYjV,EAAMmV,QAAU19C,EAAOwmC,KAAO+B,EAAMkV,SAE1D,GAAIpU,EAAKG,SAAS,kBAAkB,SAAUtpC,GAAK,OAAOA,EAAEmpC,EAAMd,MAChEA,EAAMxM,qBADR,CAKA,IAAImF,EAAMmI,EAAKz0B,MAAMusB,UACrB,KAAMD,aAAe,iBAAmBA,EAAI96B,MAAM0a,WAAWogB,EAAI35B,MAAM,CACrE,IAAIsU,EAAO1D,OAAOC,aAAamwB,EAAMyf,UAChC3e,EAAKG,SAAS,mBAAmB,SAAUtpC,GAAK,OAAOA,EAAEmpC,EAAMnI,EAAI96B,MAAMzH,IAAKuiC,EAAI35B,IAAI5I,IAAKkd,OAC5FwtB,EAAKgT,SAAShT,EAAKz0B,MAAM6qB,GAAGuD,WAAWnnB,GAAMsnB,kBACjDoF,EAAMxM,oBAqHV,IAAIksB,EAAqBjoD,EAAOwmC,IAAM,UAAY,UAElDwf,EAASkC,UAAY,SAAU7e,EAAMd,GACnCc,EAAKsU,SAAWpV,EAAMoV,SACtB,IAAIwK,EAAUV,cAAcpe,GACxBvH,EAAMD,KAAKC,MAAOr9B,EAAO,cACzBq9B,EAAMuH,EAAK+e,UAAUxmB,KAAO,KArHlC,SAASymB,OAAO9f,EAAO+f,GACrB,IAAIjd,EAAKid,EAAM3tB,EAAI4N,EAAMme,QAAS6B,EAAKD,EAAMna,EAAI5F,EAAMoe,QACvD,OAAOtb,EAAKA,EAAKkd,EAAKA,EAAK,IAmHYF,CAAO9f,EAAOc,EAAK+e,aAAe7f,EAAM0f,KAClD,eAAvB5e,EAAK+e,UAAU3jD,KAAyBA,EAAO,cACnB,eAAvB4kC,EAAK+e,UAAU3jD,OAAyBA,EAAO,gBAE1D4kC,EAAK+e,UAAY,CAACxmB,KAAME,EAAKnH,EAAG4N,EAAMme,QAASvY,EAAG5F,EAAMoe,QAASliD,KAAMA,GAEvE,IAAI9F,EAAM0qC,EAAK0C,YAAY0a,YAAYle,IAClC5pC,IAEO,eAAR8F,GACE4kC,EAAK8Q,WAAa9Q,EAAK8Q,UAAUqO,OACrCnf,EAAK8Q,UAAY,IAAIsO,EAAUpf,EAAM1qC,EAAK4pC,EAAO4f,KAC/B,eAAR1jD,EAAwB4iD,kBAAoBC,mBAAmBje,EAAM1qC,EAAIA,IAAKA,EAAI0J,OAAQkgC,GACpGA,EAAMxM,iBAENmqB,mBAAmB7c,EAAM,aAI7B,IAAIof,EAAY,SAASA,UAAUpf,EAAM1qC,EAAK4pC,EAAO4f,GACnD,IAWI3gB,EAAYkhB,EAXZr9C,EAASvM,KAYb,GAVAA,KAAKuqC,KAAOA,EACZvqC,KAAK2/C,SAAWpV,EAAKz0B,MAAM/R,IAC3B/D,KAAKH,IAAMA,EACXG,KAAKypC,MAAQA,EACbzpC,KAAKqpD,QAAUA,EACfrpD,KAAK04C,WAAajP,EAAM0f,GACxBnpD,KAAKs7C,aAAe7R,EAAMoV,SAC1B7+C,KAAK07C,sBAAuB,EAGxB77C,EAAI0J,QAAU,EAChBm/B,EAAa6B,EAAKz0B,MAAM/R,IAAImJ,OAAOrN,EAAI0J,QACvCqgD,EAAY/pD,EAAI0J,WACX,CACL,IAAIS,EAAOugC,EAAKz0B,MAAM/R,IAAIwD,QAAQ1H,EAAIA,KACtC6oC,EAAa1+B,EAAK3B,OAClBuhD,EAAY5/C,EAAKvC,MAAQuC,EAAK7F,SAAW,EAG3CnE,KAAK6pD,UAAY,KAEjB,IAAI/9C,EAASu9C,EAAU,KAAO5f,EAAM39B,OAChC+wC,EAAa/wC,EAASy+B,EAAKyD,QAAQC,YAAYniC,GAAQ,GAAQ,KACnE9L,KAAK8L,OAAS+wC,EAAaA,EAAW9xB,IAAM,KAE5C,IACIsX,EADMkI,EAAKz0B,MACKusB,WACA,GAAhBoH,EAAMif,QACNhgB,EAAW/iC,KAAK+C,KAAKilC,YAAiD,IAApCjF,EAAW/iC,KAAK+C,KAAKy5B,YACvDE,aAAqB,iBAAiBA,EAAUpgC,MAAQ2nD,GAAavnB,EAAUngC,GAAK0nD,KACpF5pD,KAAK6pD,UAAY,CAACliD,KAAM+gC,EACR7oC,IAAK+pD,EACLE,QAAS9pD,KAAK8L,SAAW9L,KAAK8L,OAAO6hC,UACrCoc,cAAe/pD,KAAK8L,QAAU5K,EAAOgmC,QAAUlnC,KAAK8L,OAAOmpC,aAAa,qBAExFj1C,KAAK8L,QAAU9L,KAAK6pD,YAAc7pD,KAAK6pD,UAAUC,SAAW9pD,KAAK6pD,UAAUE,iBAC7E/pD,KAAKuqC,KAAKiR,YAAYtH,OAClBl0C,KAAK6pD,UAAUC,UAAW9pD,KAAK8L,OAAO6hC,WAAY,GAClD3tC,KAAK6pD,UAAUE,eACfprB,YAAW,WACPpyB,EAAOg+B,KAAK8Q,WAAa9uC,GAAUA,EAAOT,OAAOkqB,aAAa,kBAAmB,WACpF,IACLh2B,KAAKuqC,KAAKiR,YAAY16C,SAGxBypC,EAAKmD,KAAK8O,iBAAiB,UAAWx8C,KAAKgqD,GAAKhqD,KAAKgqD,GAAG//B,KAAKjqB,OAC7DuqC,EAAKmD,KAAK8O,iBAAiB,YAAax8C,KAAKiqD,KAAOjqD,KAAKiqD,KAAKhgC,KAAKjqB,OACnEonD,mBAAmB7c,EAAM,YAmE3B,SAASue,oBAAoBve,EAAMd,GACjC,QAAIc,EAAKgL,cAWLr0C,EAAOomC,QAAU7nC,KAAKyqD,IAAIzgB,EAAM0gB,UAAY5f,EAAK6f,oBAAsB,OACzE7f,EAAK6f,oBAAsB,KACpB,GA9EXT,EAAUvpD,UAAUspD,KAAO,SAASA,OAChC,IAAIn9C,EAASvM,KAEfA,KAAKuqC,KAAKmD,KAAK4O,oBAAoB,UAAWt8C,KAAKgqD,IACnDhqD,KAAKuqC,KAAKmD,KAAK4O,oBAAoB,YAAat8C,KAAKiqD,MACjDjqD,KAAK6pD,WAAa7pD,KAAK8L,SACzB9L,KAAKuqC,KAAKiR,YAAYtH,OAClBl0C,KAAK6pD,UAAUC,SAAW9pD,KAAK8L,OAAO8sC,gBAAgB,aACtD54C,KAAK6pD,UAAUE,eAAiB/pD,KAAK8L,OAAO8sC,gBAAgB,mBAChE54C,KAAKuqC,KAAKiR,YAAY16C,SAEpBd,KAAK07C,sBAAwB/c,YAAW,WAAc,OAAOwc,eAAe5uC,EAAOg+B,SACvFvqC,KAAKuqC,KAAK8Q,UAAY,MAGxBsO,EAAUvpD,UAAU4pD,GAAK,SAASA,GAAIvgB,GAGpC,GAFAzpC,KAAK0pD,OAEA1pD,KAAKuqC,KAAKxf,IAAI6I,SAAkC,GAAzB6V,EAAM39B,OAAOjD,SAAgB4gC,EAAM39B,OAAOujB,WAAaoa,EAAM39B,QAAzF,CAGA,IAAIjM,EAAMG,KAAKH,IACXG,KAAKuqC,KAAKz0B,MAAM/R,KAAO/D,KAAK2/C,WAAY9/C,EAAMG,KAAKuqC,KAAK0C,YAAY0a,YAAYle,KAEhFzpC,KAAKs7C,eAAiBz7C,EACxBunD,mBAAmBpnD,KAAKuqC,KAAM,WACrB2d,kBAAkBloD,KAAKuqC,KAAM1qC,EAAIA,IAAKA,EAAI0J,OAAQkgC,EAAOzpC,KAAK04C,YACvEjP,EAAMxM,iBACmB,GAAhBwM,EAAMif,SACL1oD,KAAKqpD,SAEJnoD,EAAOomC,QAAUtnC,KAAK6pD,YAAc7pD,KAAK6pD,UAAUliD,KAAKkb,QAQxD3hB,EAAOkmC,UAAYpnC,KAAKuqC,KAAKz0B,MAAMusB,qBAAqB,kBACxD5iC,KAAKuO,IAAIvO,KAAKyqD,IAAIrqD,EAAIA,IAAMG,KAAKuqC,KAAKz0B,MAAMusB,UAAUpgC,MAC7CxC,KAAKyqD,IAAIrqD,EAAIA,IAAMG,KAAKuqC,KAAKz0B,MAAMusB,UAAUngC,MAAQ,IACzE8lD,gBAAgBhoD,KAAKuqC,KAAM,YAAUpJ,KAAKnhC,KAAKuqC,KAAKz0B,MAAM/R,IAAIwD,QAAQ1H,EAAIA,MAAO,WACjF4pC,EAAMxM,kBAENmqB,mBAAmBpnD,KAAKuqC,KAAM,aAIlCof,EAAUvpD,UAAU6pD,KAAO,SAASA,KAAMxgB,IACnCzpC,KAAKs7C,eAAiB77C,KAAKyqD,IAAIlqD,KAAKypC,MAAM5N,EAAI4N,EAAMme,SAAW,GACzCnoD,KAAKyqD,IAAIlqD,KAAKypC,MAAM4F,EAAI5F,EAAMoe,SAAW,KAChE7nD,KAAKs7C,cAAe,GACxB8L,mBAAmBpnD,KAAKuqC,KAAM,WACT,GAAjBd,EAAM4gB,SAAgBrqD,KAAK0pD,QAGjCxC,EAASoD,UAAY,SAAU/f,GAC7Boe,cAAcpe,GACd6c,mBAAmB7c,EAAM,YAG3B2c,EAASqD,YAAc,SAAUhgB,GAAQ,OAAOoe,cAAcpe,IAsB9D,IAAIigB,EAAqBtpD,EAAO0mC,QAAU,KAAQ,EA+ClD,SAAS6iB,mBAAmBlgB,EAAMmgB,GAChCzE,aAAa1b,EAAKogB,kBACdD,GAAS,IAAKngB,EAAKogB,iBAAmBhsB,YAAW,WAAc,OAAOiqB,eAAere,KAAUmgB,IAGrG,SAASE,iBAAiBrgB,GAKxB,IAJIA,EAAKgL,YACPhL,EAAKgL,WAAY,EACjBhL,EAAK6f,mBAKT,SAASS,2BACP,IAAIphB,EAAQ5U,SAAS6U,YAAY,SAEjC,OADAD,EAAME,UAAU,SAAS,GAAM,GACxBF,EAAM0gB,UAReU,IAErBtgB,EAAK4N,iBAAiBt5C,OAAS,GAAK0rC,EAAK4N,iBAAiBplC,MAAM+gC,mBASzE,SAAS8U,eAAere,EAAM1sC,GAC5B,KAAIqD,EAAO0mC,SAAW2C,EAAKiR,YAAY6J,cAAgB,GAAvD,CAGA,GAFA9a,EAAKiR,YAAYwK,aACjB4E,iBAAiBrgB,GACb1sC,GAAe0sC,EAAKyD,QAAQ+C,MAAO,CACrC,IAAI3O,EAAMsY,iBAAiBnQ,GAG3B,OAFInI,IAAQA,EAAIr0B,GAAGw8B,EAAKz0B,MAAMusB,WAAckI,EAAKgT,SAAShT,EAAKz0B,MAAM6qB,GAAG2B,aAAaF,IAC9EmI,EAAKkF,YAAYlF,EAAKz0B,QACtB,EAET,OAAO,GA1ETqxC,EAAa2D,iBAAmB3D,EAAa4D,kBAAoB,SAAUxgB,GACzE,IAAKA,EAAKgL,UAAW,CACnBhL,EAAKiR,YAAYmK,QACjB,IAAI7vC,EAAQy0B,EAAKz0B,MACb9L,EAAO8L,EAAMusB,UAAU/6B,MAC3B,GAAIwO,EAAMusB,UAAUxgC,QACfiU,EAAMqtB,cACJn5B,EAAK8W,YAAc9W,EAAKgK,cAAgBhK,EAAKY,WAAWoC,MAAM6d,MAAK,SAAU1nB,GAAK,OAAiC,IAA1BA,EAAEwC,KAAK+C,KAAKgZ,cAE1G6oB,EAAKygB,WAAazgB,EAAKz0B,MAAMqtB,aAAen5B,EAAKgD,QACjD47C,eAAere,GAAM,GACrBA,EAAKygB,WAAa,UAMlB,GAJApC,eAAere,GAIXrpC,EAAOgmC,OAASpxB,EAAMusB,UAAUxgC,OAASmI,EAAKgK,eAAiBhK,EAAK8W,YAAc9W,EAAKY,WAAWoC,MAAMnO,OAE1G,IADA,IAAIujC,EAAMmI,EAAKmD,KAAKyC,eACXxoC,EAAOy6B,EAAImO,UAAW5uC,EAASygC,EAAIqO,YAAa9oC,GAAyB,GAAjBA,EAAKkB,UAA2B,GAAVlH,GAAc,CACnG,IAAIwC,EAASxC,EAAS,EAAIgG,EAAK0I,UAAY1I,EAAKurB,WAAWvxB,EAAS,GACpE,IAAKwC,EAAU,MACf,GAAuB,GAAnBA,EAAO0E,SAAe,CACxBu5B,EAAImR,SAASpvC,EAAQA,EAAO8sB,UAAUpyB,QACtC,MAEA8I,EAAOxD,EACPxC,GAAU,EAKlB4oC,EAAKgL,WAAY,EAEnBkV,mBAAmBlgB,EAAMigB,IAG3BrD,EAAa8D,eAAiB,SAAU1gB,EAAMd,GACxCc,EAAKgL,YACPhL,EAAKgL,WAAY,EACjBhL,EAAK6f,mBAAqB3gB,EAAM0gB,UAChCM,mBAAmBlgB,EAAM,MA4D7B,IAAI2gB,EAAsBhqD,EAAO6lC,IAAM7lC,EAAO8lC,WAAa,IACpD9lC,EAAOsmC,KAAOtmC,EAAO6mC,eAAiB,IA0C7C,SAASojB,QAAQ5gB,EAAMxtB,EAAMslC,EAAMl8C,GACjC,IAAI1D,EAAQ2/C,mBAAmB7X,EAAMxtB,EAAMslC,EAAM9X,EAAKsU,SAAUtU,EAAKz0B,MAAMusB,UAAU/6B,OACrF,GAAIijC,EAAKG,SAAS,eAAe,SAAUtpC,GAAK,OAAOA,EAAEmpC,EAAMpkC,EAAG1D,GAAS,QAAMZ,UAAc,OAAO,EACtG,IAAKY,EAAS,OAAO,EAErB,IAAI2oD,EAxBN,SAASC,gBAAgB5oD,GACvB,OAA0B,GAAnBA,EAAMiE,WAAmC,GAAjBjE,EAAMgE,SAA4C,GAA5BhE,EAAMmE,QAAQgB,WAAkBnF,EAAMmE,QAAQoB,WAAa,KAuB/FqjD,CAAgB5oD,GAC7Bk+B,EAAKyqB,EAAa7gB,EAAKz0B,MAAM6qB,GAAGoD,qBAAqBqnB,EAAY7gB,EAAKsU,UAAYtU,EAAKz0B,MAAM6qB,GAAGmD,iBAAiBrhC,GAErH,OADA8nC,EAAKgT,SAAS5c,EAAG0D,iBAAiBF,QAAQ,SAAS,GAAMA,QAAQ,UAAW,WACrE,EAhDT+iB,EAASxkD,KAAOykD,EAAanpC,IAAM,SAAUusB,EAAMpkC,GACjD,IAAIi8B,EAAMmI,EAAKz0B,MAAMusB,UAAWrkB,EAAgB,OAAV7X,EAAER,KACxC,IAAIy8B,EAAIvgC,MAAR,CAGA,IAAIwY,EAAO6wC,EAAqB,KAAO/kD,EAAEmlD,cAErCx5C,EAAMkwC,sBAAsBzX,EADpBnI,EAAIx7B,WAEZmkB,EAAMjZ,EAAIiZ,IACVhO,EAAOjL,EAAIiL,KACX1C,GACFlU,EAAE82B,iBACF5iB,EAAKkxC,YACLlxC,EAAKmxC,QAAQ,YAAazgC,EAAI83B,WAC9BxoC,EAAKmxC,QAAQ,aAAczuC,IAzC/B,SAAS0uC,YAAYlhB,EAAMxf,GAGzB,GAAKwf,EAAKxf,IAAIsE,WAAd,CACA,IAAIjjB,EAAOm+B,EAAKxf,IAAIsE,WAAWuC,YAAYiD,SAASgB,cAAc,QAClEzpB,EAAKwlB,YAAY7G,GACjB3e,EAAK+C,MAAMwoC,QAAU,6CACrB,IAAIvV,EAAM+N,eAAgB/nC,EAAQysB,SAASwT,cAC3CjgC,EAAMsjD,mBAAmB3gC,GAIzBwf,EAAKxf,IAAI4gC,OACTvpB,EAAIyO,kBACJzO,EAAIzhB,SAASvY,GACbu2B,YAAW,WACLvyB,EAAKijB,YAAcjjB,EAAKijB,WAAW6oB,YAAY9rC,GACnDm+B,EAAK/M,UACJ,KAyBDiuB,CAAYlhB,EAAMxf,GAEhB/M,GAAOusB,EAAKgT,SAAShT,EAAKz0B,MAAM6qB,GAAGsD,kBAAkBI,iBAAiBF,QAAQ,UAAW,UAiC/FgjB,EAAayE,MAAQ,SAAUrhB,EAAMpkC,GAKnC,IAAIokC,EAAKgL,WAAcr0C,EAAO0mC,QAA9B,CACA,IAAIvtB,EAAO6wC,EAAqB,KAAO/kD,EAAEmlD,cACrCjxC,GAAQ8wC,QAAQ5gB,EAAMlwB,EAAKwxC,QAAQ,cAAexxC,EAAKwxC,QAAQ,aAAc1lD,GAAMA,EAAE82B,iBAjC3F,SAAS6uB,aAAavhB,EAAMpkC,GAC1B,GAAKokC,EAAKxf,IAAIsE,WAAd,CACA,IAAIizB,EAAY/X,EAAKsU,UAAYtU,EAAKz0B,MAAMusB,UAAU/6B,MAAMe,OAAO1C,KAAK+C,KAAKogB,KACzEhd,EAASy+B,EAAKxf,IAAIsE,WAAWuC,YAAYiD,SAASgB,cAAcysB,EAAY,WAAa,QACxFA,IAAax2C,EAAOi9B,gBAAkB,QAC3Cj9B,EAAOqD,MAAMwoC,QAAU,6CACvB7rC,EAAO0xB,QACPmB,YAAW,WACT4L,EAAK/M,QACD1xB,EAAOujB,YAAcvjB,EAAOujB,WAAW6oB,YAAYpsC,GACnDw2C,EAAa6I,QAAQ5gB,EAAMz+B,EAAOjP,MAAO,KAAMsJ,GAC5CglD,QAAQ5gB,EAAMz+B,EAAO8W,YAAa9W,EAAO+2C,UAAW18C,KAC1D,KAsBI2lD,CAAavhB,EAAMpkC,KAG5B,IAAI4lD,EAAW,SAASA,SAAStpD,EAAOwnD,GACtCjqD,KAAKyC,MAAQA,EACbzC,KAAKiqD,KAAOA,GAGV+B,EAAmB9qD,EAAOwmC,IAAM,SAAW,UA0I/C,IAAK,IAAIjrB,KAxITyqC,EAAS+E,UAAY,SAAU1hB,EAAMpkC,GACnC,IAAIk1C,EAAY9Q,EAAK8Q,UAErB,GADIA,GAAaA,EAAUqO,OACtBvjD,EAAE+lD,aAAP,CAEA,IAAI9pB,EAAMmI,EAAKz0B,MAAMusB,UACjBxiC,EAAMuiC,EAAIvgC,MAAQ,KAAO0oC,EAAK0C,YAAY0a,YAAYxhD,IAC1D,GAAItG,GAAOA,EAAIA,KAAOuiC,EAAIngC,MAAQpC,EAAIA,MAAQuiC,aAAe,gBAAgBA,EAAIlgC,GAAK,EAAGkgC,EAAIlgC,UAAY,GAAIm5C,GAAaA,EAAUwO,UAClItf,EAAKgT,SAAShT,EAAKz0B,MAAM6qB,GAAG2B,aAAa,gBAAc3+B,OAAO4mC,EAAKz0B,MAAM/R,IAAKs3C,EAAUwO,UAAUhqD,YAC7F,GAAIsG,EAAE2F,QAA+B,GAArB3F,EAAE2F,OAAOjD,SAAe,CAC7C,IAAI07B,EAAOgG,EAAKyD,QAAQC,YAAY9nC,EAAE2F,QAAQ,GAC1Cy4B,GAAQA,EAAK58B,KAAKhC,KAAK+C,KAAKilC,WAAapJ,GAAQgG,EAAKyD,SACtDzD,EAAKgT,SAAShT,EAAKz0B,MAAM6qB,GAAG2B,aAAa,gBAAc3+B,OAAO4mC,EAAKz0B,MAAM/R,IAAKwgC,EAAK2J,aAEzF,IAAIzrC,EAAQ8nC,EAAKz0B,MAAMusB,UAAUz7B,UAC7BkL,EAAMkwC,sBAAsBzX,EAAM9nC,GAClCsoB,EAAMjZ,EAAIiZ,IACVhO,EAAOjL,EAAIiL,KACf5W,EAAE+lD,aAAaX,YACfplD,EAAE+lD,aAAaV,QAAQN,EAAqB,OAAS,YAAangC,EAAI83B,WAEtE18C,EAAE+lD,aAAaC,cAAgB,WAC1BjB,GAAsB/kD,EAAE+lD,aAAaV,QAAQ,aAAczuC,GAChEwtB,EAAK6hB,SAAW,IAAIL,EAAStpD,GAAQ0D,EAAE6lD,MAGzC9E,EAASmF,QAAU,SAAU9hB,GAC3B,IAAI6hB,EAAW7hB,EAAK6hB,SACpBl2C,OAAOyoB,YAAW,WACZ4L,EAAK6hB,UAAYA,IAAa7hB,EAAK6hB,SAAW,QACjD,KAGLjF,EAAamF,SAAWnF,EAAaoF,UAAY,SAAU/vD,EAAG2J,GAAK,OAAOA,EAAE82B,kBAE5EkqB,EAAaqF,KAAO,SAAUjiB,EAAMpkC,GAClC,IAAIimD,EAAW7hB,EAAK6hB,SAGpB,GAFA7hB,EAAK6hB,SAAW,KAEXjmD,EAAE+lD,aAAP,CAEA,IAAIO,EAAWliB,EAAK0C,YAAY0a,YAAYxhD,IAC5C,GAAKsmD,EAAL,CACA,IAAIC,EAASniB,EAAKz0B,MAAM/R,IAAIwD,QAAQklD,EAAS5sD,KAC7C,GAAK6sD,EAAL,CACA,IAAIjqD,EAAQ2pD,GAAYA,EAAS3pD,MAC7BA,EACF8nC,EAAKG,SAAS,mBAAmB,SAAUtpC,GAAKqB,EAAQrB,EAAEqB,MAE1DA,EAAQ2/C,mBAAmB7X,EAAMpkC,EAAE+lD,aAAaL,QAAQX,EAAqB,OAAS,cAC3DA,EAAqB,KAAO/kD,EAAE+lD,aAAaL,QAAQ,cAAc,EAAOa,GAErG,IAAIzC,EAAOmC,IAAajmD,EAAE6lD,GAC1B,GAAIzhB,EAAKG,SAAS,cAAc,SAAUtpC,GAAK,OAAOA,EAAEmpC,EAAMpkC,EAAG1D,GAAS,QAAMZ,MAAOooD,MACrF9jD,EAAE82B,sBAGJ,GAAKx6B,EAAL,CAEA0D,EAAE82B,iBACF,IAAI1xB,EAAY9I,EAAQ,YAAU8nC,EAAKz0B,MAAM/R,IAAK2oD,EAAO7sD,IAAK4C,GAASiqD,EAAO7sD,IAC7D,MAAb0L,IAAqBA,EAAYmhD,EAAO7sD,KAE5C,IAAI8gC,EAAK4J,EAAKz0B,MAAM6qB,GAChBspB,GAAQtpB,EAAGsD,kBAEf,IAAIpkC,EAAM8gC,EAAG59B,QAAQvE,IAAI+M,GACrBohD,EAA4B,GAAnBlqD,EAAMiE,WAAmC,GAAjBjE,EAAMgE,SAA4C,GAA5BhE,EAAMmE,QAAQgB,WACrEglD,EAAejsB,EAAG58B,IAKtB,GAJI4oD,EACAhsB,EAAG9sB,iBAAiBhU,EAAKA,EAAK4C,EAAMmE,QAAQoB,YAE5C24B,EAAG3tB,aAAanT,EAAKA,EAAK4C,IAC1Bk+B,EAAG58B,IAAIgK,GAAG6+C,GAAd,CAEA,IAAI5iD,EAAO22B,EAAG58B,IAAIwD,QAAQ1H,GAC1B,GAAI8sD,GAAU,gBAAczqB,aAAaz/B,EAAMmE,QAAQoB,aACnDgC,EAAKa,WAAab,EAAKa,UAAUgS,WAAWpa,EAAMmE,QAAQoB,YAC5D24B,EAAG2B,aAAa,IAAI,gBAAct4B,QAC7B,CACL,IAAI/I,EAAM0/B,EAAG59B,QAAQvE,IAAI+M,GACzBo1B,EAAG59B,QAAQhB,KAAK4+B,EAAG59B,QAAQhB,KAAKlD,OAAS,GAAG1C,SAAQ,SAAUsmC,EAAOC,EAAKC,EAAUC,GAAS,OAAO3hC,EAAM2hC,KAC1GjC,EAAG2B,aAAawY,iBAAiBvQ,EAAMvgC,EAAM22B,EAAG58B,IAAIwD,QAAQtG,KAE9DspC,EAAK/M,QACL+M,EAAKgT,SAAS5c,EAAGwD,QAAQ,UAAW,eAGtC+iB,EAAS1pB,MAAQ,SAAU+M,GACpBA,EAAK0d,UACR1d,EAAKiR,YAAYtH,OACjB3J,EAAKxf,IAAIkpB,UAAUj1C,IAAI,uBACvBurC,EAAKiR,YAAY16C,QACjBypC,EAAK0d,SAAU,EACftpB,YAAW,WACL4L,EAAKyD,SAAWzD,EAAK0Q,aAAe1Q,EAAKiR,YAAYC,iBAAiB1tC,GAAGw8B,EAAKmD,KAAKyC,iBACnFgL,eAAe5Q,KAClB,MAIP2c,EAASyE,KAAO,SAAUphB,EAAMpkC,GAC1BokC,EAAK0d,UACP1d,EAAKiR,YAAYtH,OACjB3J,EAAKxf,IAAIkpB,UAAUh4B,OAAO,uBAC1BsuB,EAAKiR,YAAY16C,QACbqF,EAAE0mD,eAAiBtiB,EAAKxf,IAAI6I,SAASztB,EAAE0mD,gBACvCtiB,EAAKiR,YAAYC,iBAAiBx/C,IAAI,IAC1CsuC,EAAK0d,SAAU,IAInBf,EAAS4F,YAAc,SAAUviB,EAAMd,GAMrC,GAAIvoC,EAAOkmC,QAAUlmC,EAAO0mC,SAA8B,yBAAnB6B,EAAMsjB,UAAsC,CACjFxiB,EAAKiR,YAAYkK,YACjB,IAAIjF,EAAiBlW,EAAKkW,eAC1B9hB,YAAW,WACT,GAAI4L,EAAKkW,gBAAkBA,IAE3BlW,EAAKxf,IAAI4gC,OACTphB,EAAK/M,SACD+M,EAAKG,SAAS,iBAAiB,SAAUtpC,GAAK,OAAOA,EAAEmpC,EAAMhB,SAAS,EAAG,kBAA7E,CACA,IACI3H,EADM2I,EAAKz0B,MAAMusB,UACHT,QAEdA,GAAWA,EAAQ/hC,IAAM,GAAK0qC,EAAKgT,SAAShT,EAAKz0B,MAAM6qB,GAAGrkC,OAAOslC,EAAQ/hC,IAAM,EAAG+hC,EAAQ/hC,KAAKwkC,qBAClG,MAKU8iB,EAAgBD,EAASzqC,GAAQ0qC,EAAa1qC,GAE/D,SAASuwC,YAAYliD,EAAGC,GACtB,GAAID,GAAKC,EAAK,OAAO,EACrB,IAAK,IAAIkT,KAAKnT,EAAK,GAAIA,EAAEmT,KAAOlT,EAAEkT,GAAM,OAAO,EAC/C,IAAK,IAAIe,KAAOjU,EAAK,KAAMiU,KAAOlU,GAAM,OAAO,EAC/C,OAAO,EAGT,IAAImiD,EAAa,SAASA,WAAWr4B,EAAOlsB,GAC1C1I,KAAK0I,KAAOA,GAAQwkD,GACpBltD,KAAK+pC,KAAO/pC,KAAK0I,KAAKqhC,MAAQ,EAC9B/pC,KAAK40B,MAAQA,GAGfq4B,EAAW7sD,UAAU5B,IAAM,SAASA,IAAKuE,EAASoqD,EAAMxrD,EAAQyrD,GAC9D,IAAIt7C,EAAM/O,EAAQvC,UAAU2sD,EAAKlrD,KAAOmrD,EAAWptD,KAAK+pC,KAAO,GAAK,EAAI,GAClElqC,EAAMiS,EAAIjS,IAEhB,OADgBiS,EAAIhS,QACH,KAAO,IAAIutD,GAAWxtD,EAAM8B,EAAQ9B,EAAM8B,EAAQ3B,OAGrEitD,EAAW7sD,UAAUktD,MAAQ,SAASA,QAAW,OAAO,GAExDL,EAAW7sD,UAAU2N,GAAK,SAASA,GAAIvH,GACrC,OAAOxG,MAAQwG,GACZA,aAAiBymD,IAChBjtD,KAAK0I,KAAKjM,KAAOuD,KAAK0I,KAAKjM,KAAO+J,EAAMkC,KAAKjM,KAC7CuD,KAAK40B,OAASpuB,EAAMouB,OAASo4B,YAAYhtD,KAAK0I,KAAMlC,EAAMkC,QAGhEukD,EAAW7sD,UAAUsxC,QAAU,SAASA,QAAS/pC,GAC3C3H,KAAK0I,KAAKgpC,SAAW1xC,KAAK0I,KAAKgpC,QAAQ/pC,IAG7C,IAAI4lD,EAAa,SAASA,WAAWzkD,EAAOJ,GAC1C1I,KAAK0I,KAAOA,GAAQwkD,GACpBltD,KAAK8I,MAAQA,GAGfykD,EAAWntD,UAAU5B,IAAM,SAASA,IAAKuE,EAASoqD,EAAMxrD,EAAQyrD,GAC9D,IAAInrD,EAAOc,EAAQvE,IAAI2uD,EAAKlrD,KAAOmrD,EAAWptD,KAAK0I,KAAK8kD,gBAAkB,EAAI,GAAK7rD,EAC/EO,EAAKa,EAAQvE,IAAI2uD,EAAKjrD,GAAKkrD,EAAWptD,KAAK0I,KAAK+kD,aAAe,GAAK,GAAK9rD,EAC7E,OAAOM,GAAQC,EAAK,KAAO,IAAImrD,GAAWprD,EAAMC,EAAIlC,OAGtDutD,EAAWntD,UAAUktD,MAAQ,SAASA,MAAO9wD,EAAG2wD,GAAQ,OAAOA,EAAKlrD,KAAOkrD,EAAKjrD,IAEhFqrD,EAAWntD,UAAU2N,GAAK,SAASA,GAAIvH,GACrC,OAAOxG,MAAQwG,GACZA,aAAiB+mD,GAAcP,YAAYhtD,KAAK8I,MAAOtC,EAAMsC,QAC7DkkD,YAAYhtD,KAAK0I,KAAMlC,EAAMkC,OAGlC6kD,EAAWG,GAAK,SAASA,GAAIP,GAAQ,OAAOA,EAAKxnD,gBAAgB4nD,GAEjE,IAAI/kC,EAAW,SAASA,SAAS1f,EAAOJ,GACtC1I,KAAK0I,KAAOA,GAAQwkD,GACpBltD,KAAK8I,MAAQA,GAGf0f,EAASpoB,UAAU5B,IAAM,SAASA,IAAKuE,EAASoqD,EAAMxrD,EAAQyrD,GAC5D,IAAInrD,EAAOc,EAAQvC,UAAU2sD,EAAKlrD,KAAOmrD,EAAW,GACpD,GAAInrD,EAAKnC,QAAW,OAAO,KAC3B,IAAIoC,EAAKa,EAAQvC,UAAU2sD,EAAKjrD,GAAKkrD,GAAY,GACjD,OAAIlrD,EAAGpC,SAAWoC,EAAGrC,KAAOoC,EAAKpC,IAAc,KACxC,IAAIwtD,GAAWprD,EAAKpC,IAAM8B,EAAQO,EAAGrC,IAAM8B,EAAQ3B,OAG5DwoB,EAASpoB,UAAUktD,MAAQ,SAASA,MAAO3lD,EAAMwlD,GAC/C,IAGMnwD,EAHF8U,EAAMnK,EAAKf,QAAQvH,UAAU8tD,EAAKlrD,MAChC3B,EAAQwR,EAAIxR,MACZqB,EAASmQ,EAAInQ,OAEnB,OAAOA,GAAUwrD,EAAKlrD,QAAUjF,EAAQ2K,EAAK3K,MAAMsD,IAAQwc,QAAUnb,EAAS3E,EAAM+P,UAAYogD,EAAKjrD,IAGvGsmB,EAASpoB,UAAU2N,GAAK,SAASA,GAAIvH,GACnC,OAAOxG,MAAQwG,GACZA,aAAiBgiB,GAAYwkC,YAAYhtD,KAAK8I,MAAOtC,EAAMsC,QAC3DkkD,YAAYhtD,KAAK0I,KAAMlC,EAAMkC,OAMlC,IAAI2kD,GAAa,SAASA,WAAWprD,EAAMC,EAAIyD,GAG7C3F,KAAKiC,KAAOA,EAIZjC,KAAKkC,GAAKA,EACVlC,KAAK2F,KAAOA,GAGVsK,GAAuB,CAAEvH,KAAM,CAAEtE,cAAc,GAAOyiB,OAAQ,CAAEziB,cAAc,IAElFipD,GAAWjtD,UAAUsC,KAAO,SAASA,KAAMT,EAAMC,GAC/C,OAAO,IAAImrD,GAAWprD,EAAMC,EAAIlC,KAAK2F,OAGvC0nD,GAAWjtD,UAAU2N,GAAK,SAASA,GAAIvH,EAAO7E,GAG5C,YAFkB,IAAXA,IAAoBA,EAAS,GAE7B3B,KAAK2F,KAAKoI,GAAGvH,EAAMb,OAAS3F,KAAKiC,KAAON,GAAU6E,EAAMvE,MAAQjC,KAAKkC,GAAKP,GAAU6E,EAAMtE,IAGnGmrD,GAAWjtD,UAAU5B,IAAM,SAASA,IAAKuE,EAASpB,EAAQyrD,GACxD,OAAOptD,KAAK2F,KAAKnH,IAAIuE,EAAS/C,KAAM2B,EAAQyrD,IAwD9CC,GAAW9a,OAAS,SAASA,OAAQ1yC,EAAK+0B,EAAOlsB,GAC/C,OAAO,IAAI2kD,GAAWxtD,EAAKA,EAAK,IAAIotD,EAAWr4B,EAAOlsB,KAoBxD2kD,GAAWxmC,OAAS,SAASA,OAAQ5kB,EAAMC,EAAI4G,EAAOJ,GACpD,OAAO,IAAI2kD,GAAWprD,EAAMC,EAAI,IAAIqrD,EAAWzkD,EAAOJ,KAYxD2kD,GAAW1lD,KAAO,SAASA,KAAM1F,EAAMC,EAAI4G,EAAOJ,GAChD,OAAO,IAAI2kD,GAAWprD,EAAMC,EAAI,IAAIsmB,EAAS1f,EAAOJ,KAMtDuH,GAAqBvH,KAAKzJ,IAAM,WAAc,OAAOe,KAAK2F,KAAK+C,MAE/DuH,GAAqB4W,OAAO5nB,IAAM,WAAc,OAAOe,KAAK2F,gBAAgB4nD,GAE5E7pD,OAAOoB,iBAAkBuoD,GAAWjtD,UAAW6P,IAkB/C,IAAIsP,GAAO,GAAI2tC,GAAS,GAOpBS,GAAgB,SAASA,cAAcC,EAAOryD,GAChDyE,KAAK4tD,MAAQA,GAASA,EAAM/uD,OAAS+uD,EAAQruC,GAC7Cvf,KAAKzE,SAAWA,GAAYA,EAASsD,OAAStD,EAAWgkB,IAM3DouC,GAAchqD,OAAS,SAASA,OAAQI,EAAK8pD,GAC3C,OAAOA,EAAYhvD,OAASivD,UAAUD,EAAa9pD,EAAK,EAAGmpD,IAAUrrD,IAUvE8rD,GAAcvtD,UAAU2b,KAAO,SAASA,KAAMjb,EAAOG,EAAK8sD,GACxD,IAAI7sD,EAAS,GAEb,OADAlB,KAAKguD,UAAmB,MAATltD,EAAgB,EAAIA,EAAc,MAAPG,EAAc,IAAMA,EAAKC,EAAQ,EAAG6sD,GACvE7sD,GAGTysD,GAAcvtD,UAAU4tD,UAAY,SAASA,UAAWltD,EAAOG,EAAKC,EAAQS,EAAQosD,GAClF,IAAK,IAAIjvD,EAAI,EAAGA,EAAIkB,KAAK4tD,MAAM/uD,OAAQC,IAAK,CAC1C,IAAIquD,EAAOntD,KAAK4tD,MAAM9uD,GAClBquD,EAAKlrD,MAAQhB,GAAOksD,EAAKjrD,IAAMpB,KAAWitD,GAAaA,EAAUZ,EAAKzkD,QACtExH,EAAOhD,KAAKivD,EAAKzqD,KAAKyqD,EAAKlrD,KAAON,EAAQwrD,EAAKjrD,GAAKP,IAE1D,IAAK,IAAIkO,EAAM,EAAGA,EAAM7P,KAAKzE,SAASsD,OAAQgR,GAAO,EACnD,GAAI7P,KAAKzE,SAASsU,GAAO5O,GAAOjB,KAAKzE,SAASsU,EAAM,GAAK/O,EAAO,CAC9D,IAAImtD,EAAWjuD,KAAKzE,SAASsU,GAAO,EACpC7P,KAAKzE,SAASsU,EAAM,GAAGm+C,UAAUltD,EAAQmtD,EAAUhtD,EAAMgtD,EAAU/sD,EAAQS,EAASssD,EAAUF,KAepGJ,GAAcvtD,UAAU5B,IAAM,SAASA,IAAKuE,EAASgB,EAAKslB,GACxD,OAAIrpB,MAAQ6B,IAAgC,GAAvBkB,EAAQhB,KAAKlD,OAAsBmB,KACjDA,KAAKkuD,SAASnrD,EAASgB,EAAK,EAAG,EAAGslB,GAAW6jC,KAGtDS,GAAcvtD,UAAU8tD,SAAW,SAASA,SAAUnrD,EAAS4E,EAAMhG,EAAQyrD,EAAW/jC,GAEtF,IADA,IAAI8kC,EACKrvD,EAAI,EAAGA,EAAIkB,KAAK4tD,MAAM/uD,OAAQC,IAAK,CAC1C,IAAI4M,EAAS1L,KAAK4tD,MAAM9uD,GAAGN,IAAIuE,EAASpB,EAAQyrD,GAC5C1hD,GAAUA,EAAO/F,KAAK2nD,MAAM3lD,EAAM+D,IAAYyiD,IAAaA,EAAW,KAAKjwD,KAAKwN,GAC3E2d,EAAQ+kC,UAAY/kC,EAAQ+kC,SAASpuD,KAAK4tD,MAAM9uD,GAAG4J,MAG9D,OAAI1I,KAAKzE,SAASsD,OAmNpB,SAASwvD,YAAYC,EAAaH,EAAUprD,EAAS4E,EAAMhG,EAAQyrD,EAAW/jC,GAiB5E,IAhBA,IAAI9tB,EAAW+yD,EAAY7rD,QAIvBkkB,MAAQ,SAAUtlB,EAAUktD,EAAQjtD,EAAUktD,GAChD,IAAK,IAAI1vD,EAAI,EAAGA,EAAIvD,EAASsD,OAAQC,GAAK,EAAG,CAC3C,IAAImC,EAAM1F,EAASuD,EAAI,GAAI2vD,OAAQ,GACvB,GAARxtD,GAAaI,EAAWJ,EAAMmsD,IAC9BmB,GAAUhzD,EAASuD,GAAKsuD,EAC1B7xD,EAASuD,EAAI,IAAM,EACVwC,GAAYK,IAAW8sD,EAASD,EAASltD,GAAaitD,EAASltD,MACxE9F,EAASuD,IAAM2vD,EACflzD,EAASuD,EAAI,IAAM2vD,MAIhB3vD,EAAI,EAAGA,EAAIiE,EAAQhB,KAAKlD,OAAQC,IAAOiE,EAAQhB,KAAKjD,GAAG3C,QAAQwqB,OAKxE,IADA,IAAI+nC,GAAc,EACT7+C,EAAM,EAAGA,EAAMtU,EAASsD,OAAQgR,GAAO,EAAK,IAA0B,GAAtBtU,EAASsU,EAAM,GAAU,CAChF,IAAI5N,EAAOc,EAAQvE,IAAI8vD,EAAYz+C,GAAOu9C,GAAYuB,EAAY1sD,EAAON,EACzE,GAAIgtD,EAAY,GAAKA,GAAahnD,EAAKf,QAAQlK,KAAM,CACnDgyD,GAAc,EACd,SAGF,IAA4DE,EAAnD7rD,EAAQvE,IAAI8vD,EAAYz+C,EAAM,GAAKu9C,GAAY,GAAmBzrD,EACvEmQ,EAAMnK,EAAKf,QAAQvH,UAAUsvD,GAC7BruD,EAAQwR,EAAIxR,MACZuuD,EAAc/8C,EAAInQ,OAClBmtD,EAAYnnD,EAAKG,WAAWxH,GAChC,GAAIwuD,GAAaD,GAAeF,GAAaE,EAAcC,EAAU/hD,UAAY6hD,EAAS,CACxF,IAAIljD,EAASnQ,EAASsU,EAAM,GAAGq+C,SAASnrD,EAAS+rD,EAAW7sD,EAAO,EAAGqsD,EAAYz+C,GAAOu9C,EAAY,EAAG/jC,GACpG3d,GAAU7J,IACZtG,EAASsU,GAAO8+C,EAChBpzD,EAASsU,EAAM,GAAK++C,EACpBrzD,EAASsU,EAAM,GAAKnE,IAEpBnQ,EAASsU,EAAM,IAAM,EACrB6+C,GAAc,QAGhBA,GAAc,EAKlB,GAAIA,EAAa,CACf,IAEIxmC,EAAQ4lC,UA0BhB,SAASiB,iCAAiCxzD,EAAU+yD,EAAaT,EAAa9qD,EAASpB,EAAQyrD,EAAW/jC,GAExG,SAAS2lC,OAAO/yD,EAAKmxD,GACnB,IAAK,IAAItuD,EAAI,EAAGA,EAAI7C,EAAI2xD,MAAM/uD,OAAQC,IAAK,CACzC,IAAI4M,EAASzP,EAAI2xD,MAAM9uD,GAAGN,IAAIuE,EAASpB,EAAQyrD,GAC3C1hD,EAAUmiD,EAAY3vD,KAAKwN,GACtB2d,EAAQ+kC,UAAY/kC,EAAQ+kC,SAASnyD,EAAI2xD,MAAM9uD,GAAG4J,MAE7D,IAAK,IAAImH,EAAM,EAAGA,EAAM5T,EAAIV,SAASsD,OAAQgR,GAAO,EAChDm/C,OAAO/yD,EAAIV,SAASsU,EAAM,GAAI5T,EAAIV,SAASsU,GAAOu9C,EAAY,GAEpE,IAAK,IAAItuD,EAAI,EAAGA,EAAIvD,EAASsD,OAAQC,GAAK,GAA6B,GAApBvD,EAASuD,EAAI,IAC5DkwD,OAAOzzD,EAASuD,EAAI,GAAIwvD,EAAYxvD,GAAKsuD,EAAY,GAEzD,OAAOS,EA1CakB,CAAiCxzD,EAAU+yD,EAAaH,GAAY,GAAIprD,EACvCpB,EAAQyrD,EAAW/jC,GACnC1hB,EAAM,EAAG0hB,GAC5C8kC,EAAWjmC,EAAM0lC,MACjB,IAAK,IAAIn7C,EAAM,EAAGA,EAAMlX,EAASsD,OAAQ4T,GAAO,EAASlX,EAASkX,EAAM,GAAK,IAC3ElX,EAAS4D,OAAOsT,EAAK,GACrBA,GAAO,GAET,IAAK,IAAIikC,EAAM,EAAGrnC,EAAI,EAAGqnC,EAAMxuB,EAAM3sB,SAASsD,OAAQ63C,GAAO,EAAG,CAE9D,IADA,IAAIuY,EAAS/mC,EAAM3sB,SAASm7C,GACrBrnC,EAAI9T,EAASsD,QAAUtD,EAAS8T,GAAK4/C,GAAU5/C,GAAK,EAC3D9T,EAAS4D,OAAOkQ,EAAG,EAAG6Y,EAAM3sB,SAASm7C,GAAMxuB,EAAM3sB,SAASm7C,EAAM,GAAIxuB,EAAM3sB,SAASm7C,EAAM,KAI7F,OAAO,IAAIiX,GAAcQ,GAAYA,EAAS3uC,KAAK0vC,OAAQ3zD,GApRhD8yD,CAAYruD,KAAKzE,SAAU4yD,EAAUprD,EAAS4E,EAAMhG,EAAQyrD,EAAW/jC,GAEvE8kC,EAAW,IAAIR,GAAcQ,EAAS3uC,KAAK0vC,QAAUrtD,IAOlE8rD,GAAcvtD,UAAUpB,IAAM,SAASA,IAAK+E,EAAK8pD,GAC/C,OAAKA,EAAYhvD,OACbmB,MAAQ6B,GAAgB8rD,GAAchqD,OAAOI,EAAK8pD,GAC/C7tD,KAAKmvD,SAASprD,EAAK8pD,EAAa,GAFL7tD,MAKpC2tD,GAAcvtD,UAAU+uD,SAAW,SAASA,SAAUprD,EAAK8pD,EAAalsD,GACpE,IAEEpG,EAFEgR,EAASvM,KAEDosC,EAAa,EAC3BroC,EAAI5H,SAAQ,SAAU2yD,EAAWD,GAC/B,IAAuC3/C,EAAnCkgD,EAAaP,EAAcltD,EAC/B,GAAMuN,EAAQmgD,iBAAiBxB,EAAaiB,EAAWM,GAAvD,CAGA,IADK7zD,IAAYA,EAAWgR,EAAOhR,SAASkH,SACrC2pC,EAAa7wC,EAASsD,QAAUtD,EAAS6wC,GAAcyiB,GAAeziB,GAAc,EACvF7wC,EAAS6wC,IAAeyiB,EACxBtzD,EAAS6wC,EAAa,GAAK7wC,EAAS6wC,EAAa,GAAG+iB,SAASL,EAAW5/C,EAAOkgD,EAAa,GAE5F7zD,EAAS4D,OAAOitC,EAAY,EAAGyiB,EAAaA,EAAcC,EAAU/hD,SAAU+gD,UAAU5+C,EAAO4/C,EAAWM,EAAa,EAAGlC,KAC9H9gB,GAAc,MAIhB,IADA,IAAIwhB,EAAQ0B,UAAUljB,EAAamjB,aAAa1B,GAAeA,GAAclsD,GACpE7C,EAAI,EAAGA,EAAI8uD,EAAM/uD,OAAQC,IAAY8uD,EAAM9uD,GAAG6G,KAAK2nD,MAAMvpD,EAAK6pD,EAAM9uD,KAAO8uD,EAAMzuD,OAAOL,IAAK,GAEtG,OAAO,IAAI6uD,GAAcC,EAAM/uD,OAASmB,KAAK4tD,MAAM/jD,OAAO+jD,GAAOpuC,KAAK0vC,OAASlvD,KAAK4tD,MAC3DryD,GAAYyE,KAAKzE,WAM5CoyD,GAAcvtD,UAAU6b,OAAS,SAASA,OAAQ4xC,GAChD,OAA0B,GAAtBA,EAAYhvD,QAAemB,MAAQ6B,GAAgB7B,KAChDA,KAAKwvD,YAAY3B,EAAa,IAGvCF,GAAcvtD,UAAUovD,YAAc,SAASA,YAAa3B,EAAalsD,GAEvE,IADA,IAAIpG,EAAWyE,KAAKzE,SAAUqyD,EAAQ5tD,KAAK4tD,MAClC9uD,EAAI,EAAGA,EAAIvD,EAASsD,OAAQC,GAAK,EAAG,CAE3C,IADA,IAAIoQ,OAAQ,EAAUjN,EAAO1G,EAASuD,GAAK6C,EAAQO,EAAK3G,EAASuD,EAAI,GAAK6C,EACjE0N,EAAI,EAAG89C,OAAO,EAAU99C,EAAIw+C,EAAYhvD,OAAQwQ,KAAW89C,EAAOU,EAAYx+C,KACjF89C,EAAKlrD,KAAOA,GAAQkrD,EAAKjrD,GAAKA,IAChC2rD,EAAYx+C,GAAK,MACfH,IAAUA,EAAQ,KAAKhR,KAAKivD,IAGlC,GAAKj+C,EAAL,CACI3T,GAAYyE,KAAKzE,WAAYA,EAAWyE,KAAKzE,SAASkH,SAC1D,IAAI+L,EAAUjT,EAASuD,EAAI,GAAG0wD,YAAYtgD,EAAOjN,EAAO,GACpDuM,GAAW3M,GACbtG,EAASuD,EAAI,GAAK0P,GAElBjT,EAAS4D,OAAOL,EAAG,GACnBA,GAAK,IAGT,GAAI8uD,EAAM/uD,OAAU,IAAK,IAAIgR,EAAM,EAAG4/C,OAAS,EAAU5/C,EAAMg+C,EAAYhvD,OAAQgR,IAAS,GAAI4/C,EAAS5B,EAAYh+C,GACnH,IAAK,IAAIkjC,EAAM,EAAGA,EAAM6a,EAAM/uD,OAAQk0C,IAAa6a,EAAM7a,GAAKhlC,GAAG0hD,EAAQ9tD,KACnEisD,GAAS5tD,KAAK4tD,QAASA,EAAQ5tD,KAAK4tD,MAAMnrD,SAC9CmrD,EAAMzuD,OAAO4zC,IAAO,IAGxB,OAAIx3C,GAAYyE,KAAKzE,UAAYqyD,GAAS5tD,KAAK4tD,MAAgB5tD,KACxD4tD,EAAM/uD,QAAUtD,EAASsD,OAAS,IAAI8uD,GAAcC,EAAOryD,GAAYsG,IAGhF8rD,GAAcvtD,UAAU81C,SAAW,SAASA,SAAUv0C,EAAQgG,GAC5D,GAAI3H,MAAQ6B,GAAS,OAAO7B,KAC5B,GAAI2H,EAAKI,OAAU,OAAO4lD,GAAc9rD,MAGxC,IADA,IAAI7E,EAAO4wD,EACF9uD,EAAI,EAAGA,EAAIkB,KAAKzE,SAASsD,OAAQC,GAAK,EAAK,GAAIkB,KAAKzE,SAASuD,IAAM6C,EAAQ,CAC9E3B,KAAKzE,SAASuD,IAAM6C,IAAU3E,EAAQgD,KAAKzE,SAASuD,EAAI,IAC5D,MAGF,IADA,IAAIgC,EAAQa,EAAS,EAAGV,EAAMH,EAAQ6G,EAAKf,QAAQlK,KAC1CmT,EAAM,EAAGA,EAAM7P,KAAK4tD,MAAM/uD,OAAQgR,IAAO,CAChD,IAAI6/C,EAAM1vD,KAAK4tD,MAAM/9C,GACrB,GAAI6/C,EAAIztD,KAAOhB,GAAOyuD,EAAIxtD,GAAKpB,GAAU4uD,EAAI/pD,gBAAgB4nD,EAAa,CACxE,IAAItrD,EAAOxC,KAAK8G,IAAIzF,EAAO4uD,EAAIztD,MAAQnB,EAAOoB,EAAKzC,KAAKuO,IAAI/M,EAAKyuD,EAAIxtD,IAAMpB,EACvEmB,EAAOC,IAAO0rD,IAAUA,EAAQ,KAAK1vD,KAAKwxD,EAAIhtD,KAAKT,EAAMC,KAGjE,GAAI0rD,EAAO,CACT,IAAI+B,EAAW,IAAIhC,GAAcC,EAAMpuC,KAAK0vC,QAC5C,OAAOlyD,EAAQ,IAAI4yD,GAAgB,CAACD,EAAU3yD,IAAU2yD,EAE1D,OAAO3yD,GAAS6E,IAGlB8rD,GAAcvtD,UAAU2N,GAAK,SAASA,GAAIvH,GACxC,GAAIxG,MAAQwG,EAAS,OAAO,EAC5B,KAAMA,aAAiBmnD,KACnB3tD,KAAK4tD,MAAM/uD,QAAU2H,EAAMonD,MAAM/uD,QACjCmB,KAAKzE,SAASsD,QAAU2H,EAAMjL,SAASsD,OAAU,OAAO,EAC5D,IAAK,IAAIC,EAAI,EAAGA,EAAIkB,KAAK4tD,MAAM/uD,OAAQC,IACnC,IAAKkB,KAAK4tD,MAAM9uD,GAAGiP,GAAGvH,EAAMonD,MAAM9uD,IAAO,OAAO,EACpD,IAAK,IAAI+Q,EAAM,EAAGA,EAAM7P,KAAKzE,SAASsD,OAAQgR,GAAO,EACjD,GAAI7P,KAAKzE,SAASsU,IAAQrJ,EAAMjL,SAASsU,IACvC7P,KAAKzE,SAASsU,EAAM,IAAMrJ,EAAMjL,SAASsU,EAAM,KAC9C7P,KAAKzE,SAASsU,EAAM,GAAG9B,GAAGvH,EAAMjL,SAASsU,EAAM,IAAO,OAAO,EACpE,OAAO,GAGT89C,GAAcvtD,UAAU61C,OAAS,SAASA,OAAQtuC,GAChD,OAAOkoD,cAAc7vD,KAAK8vD,YAAYnoD,KAGxCgmD,GAAcvtD,UAAU0vD,YAAc,SAASA,YAAanoD,GAC1D,GAAI3H,MAAQ6B,GAAS,OAAO0d,GAC5B,GAAI5X,EAAKma,gBAAkB9hB,KAAK4tD,MAAM/iC,KAAK0iC,EAAWG,IAAO,OAAO1tD,KAAK4tD,MAEzE,IADA,IAAI1sD,EAAS,GACJpC,EAAI,EAAGA,EAAIkB,KAAK4tD,MAAM/uD,OAAQC,IAC/BkB,KAAK4tD,MAAM9uD,GAAG6G,gBAAgB4nD,GAChCrsD,EAAOhD,KAAK8B,KAAK4tD,MAAM9uD,IAE7B,OAAOoC,GAYT,IAAIW,GAAQ,IAAI8rD,GAIhBA,GAAc9rD,MAAQA,GAEtB8rD,GAAckC,cAAgBA,cAK9B,IAAID,GAAkB,SAASA,gBAAgBG,GAC7C/vD,KAAK+vD,QAAUA,GAgIjB,SAAST,UAAUU,EAAOruD,GACxB,IAAKA,IAAWquD,EAAMnxD,OAAU,OAAOmxD,EAEvC,IADA,IAAI9uD,EAAS,GACJpC,EAAI,EAAGA,EAAIkxD,EAAMnxD,OAAQC,IAAK,CACrC,IAAIquD,EAAO6C,EAAMlxD,GACjBoC,EAAOhD,KAAK,IAAImvD,GAAWF,EAAKlrD,KAAON,EAAQwrD,EAAKjrD,GAAKP,EAAQwrD,EAAKxnD,OAExE,OAAOzE,EAoBT,SAASmuD,iBAAiBW,EAAOroD,EAAMhG,GACrC,GAAIgG,EAAKI,OAAU,OAAO,KAE1B,IADA,IAAI9G,EAAMU,EAASgG,EAAKoF,SAAUmC,EAAQ,KACjCpQ,EAAI,EAAGquD,OAAO,EAAUruD,EAAIkxD,EAAMnxD,OAAQC,KAC5CquD,EAAO6C,EAAMlxD,KAAOquD,EAAKlrD,KAAON,GAAUwrD,EAAKjrD,GAAKjB,KAC5DiO,IAAUA,EAAQ,KAAKhR,KAAKivD,GACvB6C,EAAMlxD,GAAK,MAGf,OAAOoQ,EAGT,SAASqgD,aAAa3wC,GAEpB,IADA,IAAI1d,EAAS,GACJpC,EAAI,EAAGA,EAAI8f,EAAM/f,OAAQC,IACd,MAAZ8f,EAAM9f,IAAcoC,EAAOhD,KAAK0gB,EAAM9f,IAC9C,OAAOoC,EAQT,SAAS4sD,UAAUkC,EAAOroD,EAAMhG,EAAQ0nB,GACtC,IAAI9tB,EAAW,GAAI00D,GAAW,EAC9BtoD,EAAKxL,SAAQ,SAAU2yD,EAAWoB,GAChC,IAAIhhD,EAAQmgD,iBAAiBW,EAAOlB,EAAWoB,EAAavuD,GAC5D,GAAIuN,EAAO,CACT+gD,GAAW,EACX,IAAIlL,EAAU+I,UAAU5+C,EAAO4/C,EAAWntD,EAASuuD,EAAa,EAAG7mC,GAC/D07B,GAAWljD,IACXtG,EAAS2C,KAAKgyD,EAAYA,EAAapB,EAAU/hD,SAAUg4C,OAInE,IADA,IAAI9O,EAASqZ,UAAUW,EAAWV,aAAaS,GAASA,GAAQruD,GAAQ6d,KAAK0vC,OACpEpwD,EAAI,EAAGA,EAAIm3C,EAAOp3C,OAAQC,IAAYm3C,EAAOn3C,GAAG6G,KAAK2nD,MAAM3lD,EAAMsuC,EAAOn3C,MAC3EuqB,EAAQ+kC,UAAY/kC,EAAQ+kC,SAASnY,EAAOn3C,GAAG4J,MACnDutC,EAAO92C,OAAOL,IAAK,IAErB,OAAOm3C,EAAOp3C,QAAUtD,EAASsD,OAAS,IAAI8uD,GAAc1X,EAAQ16C,GAAYsG,GAOlF,SAASqtD,MAAMpkD,EAAGC,GAChB,OAAOD,EAAE7I,KAAO8I,EAAE9I,MAAQ6I,EAAE5I,GAAK6I,EAAE7I,GAQrC,SAAS2tD,cAAcG,GAErB,IADA,IAAIG,EAAUH,EACLlxD,EAAI,EAAGA,EAAIqxD,EAAQtxD,OAAS,EAAGC,IAAK,CAC3C,IAAIquD,EAAOgD,EAAQrxD,GACnB,GAAIquD,EAAKlrD,MAAQkrD,EAAKjrD,GAAM,IAAK,IAAImN,EAAIvQ,EAAI,EAAGuQ,EAAI8gD,EAAQtxD,OAAQwQ,IAAK,CACvE,IAAIxH,EAAOsoD,EAAQ9gD,GACnB,GAAIxH,EAAK5F,MAAQkrD,EAAKlrD,KAAtB,CAUM4F,EAAK5F,KAAOkrD,EAAKjrD,KACfiuD,GAAWH,IAASG,EAAUH,EAAMvtD,SAGxC0tD,EAAQrxD,GAAKquD,EAAKzqD,KAAKyqD,EAAKlrD,KAAM4F,EAAK5F,MACvCmuD,YAAYD,EAAS9gD,EAAG89C,EAAKzqD,KAAKmF,EAAK5F,KAAMkrD,EAAKjrD,MAEpD,MAhBI2F,EAAK3F,IAAMirD,EAAKjrD,KACdiuD,GAAWH,IAASG,EAAUH,EAAMvtD,SAGxC0tD,EAAQ9gD,GAAKxH,EAAKnF,KAAKmF,EAAK5F,KAAMkrD,EAAKjrD,IACvCkuD,YAAYD,EAAS9gD,EAAI,EAAGxH,EAAKnF,KAAKyqD,EAAKjrD,GAAI2F,EAAK3F,OAe5D,OAAOiuD,EAGT,SAASC,YAAYxxC,EAAO9f,EAAGg3C,GAC7B,KAAOh3C,EAAI8f,EAAM/f,QAAUqwD,MAAMpZ,EAAMl3B,EAAM9f,IAAM,GAAKA,IACxD8f,EAAMzf,OAAOL,EAAG,EAAGg3C,GAKrB,SAASua,gBAAgB9lB,GACvB,IAAIr7B,EAAQ,GAOZ,OANAq7B,EAAKG,SAAS,eAAe,SAAUtpC,GACrC,IAAIF,EAASE,EAAEmpC,EAAKz0B,OAChB5U,GAAUA,GAAUW,IAASqN,EAAMhR,KAAKgD,MAE1CqpC,EAAKsR,eACL3sC,EAAMhR,KAAKyvD,GAAchqD,OAAO4mC,EAAKz0B,MAAM/R,IAAK,CAACwmC,EAAKsR,cAAc/F,QACjE8Z,GAAgB3tD,KAAKiN,GA7P9B0gD,GAAgBxvD,UAAU5B,IAAM,SAASA,IAAKuE,EAASgB,GACrD,IAAIusD,EAActwD,KAAK+vD,QAAQvxD,KAC7B,SAAU+xD,GAAU,OAAOA,EAAO/xD,IAAIuE,EAASgB,EAAKmpD,OAEtD,OAAO0C,GAAgB3tD,KAAKquD,IAG9BV,GAAgBxvD,UAAU81C,SAAW,SAASA,SAAUv0C,EAAQ3E,GAC9D,GAAIA,EAAM+K,OAAU,OAAO4lD,GAAc9rD,MAEzC,IADA,IAAIqN,EAAQ,GACHpQ,EAAI,EAAGA,EAAIkB,KAAK+vD,QAAQlxD,OAAQC,IAAK,CAC5C,IAAIoC,EAASlB,KAAK+vD,QAAQjxD,GAAGo3C,SAASv0C,EAAQ3E,GAC1CkE,GAAUW,KACVX,aAAkB0uD,GAAmB1gD,EAAQA,EAAMrF,OAAO3I,EAAO6uD,SAC9D7gD,EAAMhR,KAAKgD,IAEpB,OAAO0uD,GAAgB3tD,KAAKiN,IAG9B0gD,GAAgBxvD,UAAU2N,GAAK,SAASA,GAAIvH,GAC1C,KAAMA,aAAiBopD,KACnBppD,EAAMupD,QAAQlxD,QAAUmB,KAAK+vD,QAAQlxD,OAAU,OAAO,EAC1D,IAAK,IAAIC,EAAI,EAAGA,EAAIkB,KAAK+vD,QAAQlxD,OAAQC,IACrC,IAAKkB,KAAK+vD,QAAQjxD,GAAGiP,GAAGvH,EAAMupD,QAAQjxD,IAAO,OAAO,EACxD,OAAO,GAGT8wD,GAAgBxvD,UAAU61C,OAAS,SAASA,OAAQtuC,GAElD,IADA,IAAIzG,EAAQsvD,GAAS,EACZ1xD,EAAI,EAAGA,EAAIkB,KAAK+vD,QAAQlxD,OAAQC,IAAK,CAC5C,IAAIm3C,OAASj2C,KAAK+vD,QAAQjxD,GAAGgxD,YAAYnoD,GACzC,GAAKsuC,OAAOp3C,OACZ,GAAKqC,EAEE,CACDsvD,IACFtvD,EAASA,EAAOuB,QAChB+tD,GAAS,GAEX,IAAK,IAAInhD,EAAI,EAAGA,EAAI4mC,OAAOp3C,OAAQwQ,IAAOnO,EAAOhD,KAAK+3C,OAAO5mC,SAN7DnO,EAAS+0C,OASb,OAAO/0C,EAAS2uD,cAAcW,EAAStvD,EAASA,EAAOse,KAAK0vC,QAAU3vC,IAMxEqwC,GAAgB3tD,KAAO,SAASA,KAAM8tD,GACpC,OAAQA,EAAQlxD,QACd,KAAK,EAAG,OAAOgD,GACf,KAAK,EAAG,OAAOkuD,EAAQ,GACvB,QAAS,OAAO,IAAIH,GAAgBG,KA+MxC,IAAIU,GAAa,SAASA,WAAWp0C,EAAOyb,GAC1C93B,KAAKg7B,OAASlD,EAGd93B,KAAK8V,MAAQgiB,EAAMhiB,MAEnB9V,KAAK0wD,cAAgB54B,EAAMgN,SAAW,GACtC9kC,KAAK0wD,cAAcv0D,QAAQw0D,qBAE3B3wD,KAAKu9C,SAAWv9C,KAAKu9C,SAAStzB,KAAKjqB,MAEnCA,KAAK4wD,MAAQ,KACb5wD,KAAKioD,SAAU,EAEfjoD,KAAKg5C,YAAc,KAKnBh5C,KAAK+qB,IAAO1O,GAASA,EAAMw0C,OAAUh8B,SAASgB,cAAc,OACxDxZ,IACEA,EAAMuV,YAAevV,EAAMuV,YAAY5xB,KAAK+qB,KACvC1O,EAAM1X,MAAS0X,EAAMrc,KAAK+qB,KAC1B1O,EAAMw0C,QAAS7wD,KAAK8wD,SAAU,IAKzC9wD,KAAKg7C,SAAW+V,YAAY/wD,MAC5BA,KAAKgrD,WAAa,KAClBhrD,KAAK67C,cAAgB,KACrBmV,oBAAoBhxD,MACpBA,KAAKy0C,UAAYwc,eAAejxD,MAChCA,KAAKguC,QAAU6K,YAAY74C,KAAK8V,MAAM/R,IAAKmtD,eAAelxD,MAAOqwD,gBAAgBrwD,MAAOA,KAAK+qB,IAAK/qB,MAElGA,KAAKm9C,qBAAuB,KAK5Bn9C,KAAKosD,SAAW,KAp8ClB,SAAS+E,UAAU5mB,GACjBA,EAAKsU,UAAW,EAChBtU,EAAK8Q,UAAY,KACjB9Q,EAAKmV,YAAc,KACnBnV,EAAK0V,gBAAkB,EACvB1V,EAAK+e,UAAY,CAACxmB,KAAM,EAAGjH,EAAG,EAAGwT,EAAG,EAAG1pC,KAAM,IAC7C4kC,EAAK4U,oBAAsB,KAC3B5U,EAAK2U,kBAAoB,EAEzB3U,EAAK+V,aAAe,EACpB/V,EAAKwe,4BAA8B,KACnCxe,EAAK6W,kBAAoB,EAEzB7W,EAAKgL,WAAY,EACjBhL,EAAKogB,iBAAmB,KACxBpgB,EAAK4N,iBAAmB,GACxB5N,EAAK6f,oBAAsB,IAE3B7f,EAAKiR,YAAc,IAAI0J,EAAY3a,GAAM,SAAUtoC,EAAMC,EAAI88C,EAAUvwC,GAAS,OAAOswC,cAAcxU,EAAMtoC,EAAMC,EAAI88C,EAAUvwC,MAC/H87B,EAAKiR,YAAY16C,QAEjBypC,EAAKkW,eAAiB,EAEtBlW,EAAKgd,cAAgB7jD,OAAOC,OAAO,MACnC,IAAI6hB,KAAO,SAAWikB,GACpB,IAAIge,EAAUP,EAASzd,GACvBc,EAAKxf,IAAIyxB,iBAAiB/S,EAAOc,EAAKgd,cAAc9d,GAAS,SAAUA,IA2C3E,SAAS2nB,mBAAmB7mB,EAAMd,GAChC,IAAKA,EAAM4nB,QAAW,OAAO,EAC7B,GAAI5nB,EAAMie,iBAAoB,OAAO,EACrC,IAAK,IAAI//C,EAAO8hC,EAAM39B,OAAQnE,GAAQ4iC,EAAKxf,IAAKpjB,EAAOA,EAAK0nB,WACxD,IAAK1nB,GAAyB,IAAjBA,EAAKkB,UACflB,EAAKqhC,YAAcrhC,EAAKqhC,WAAWyI,UAAUhI,GAC9C,OAAO,EACb,OAAO,EAjDC2nB,CAAmB7mB,EAAMd,IAAW+d,iBAAiBjd,EAAMd,KAC1Dc,EAAKyQ,UAAcvR,EAAM9jC,QAAQwhD,GAClCM,EAAQld,EAAMd,MAItB,IAAK,IAAIA,KAASyd,EAAU1hC,KAAMikB,GAI9BvoC,EAAOomC,QAAUiD,EAAKxf,IAAIyxB,iBAAiB,SAAS,WAAc,OAAO,QAE7E6K,gBAAgB9c,GA+5ChB4mB,CAAUnxD,MAEVA,KAAKsxD,kBAAoB,GACzBtxD,KAAKuxD,YAAc,GACnBvxD,KAAKwxD,qBAGHpwC,GAAuB,CAAE0W,MAAO,CAAE1zB,cAAc,GAAOspC,KAAM,CAAEtpC,cAAc,GAAOqtD,YAAa,CAAErtD,cAAc,IAmVrH,SAAS8sD,eAAe3mB,GACtB,IAAIzhC,EAAQpF,OAAOC,OAAO,MAkB1B,OAjBAmF,EAAM2wC,MAAQ,cACd3wC,EAAM4oD,gBAAkBr4C,OAAOkxB,EAAKyQ,UACpClyC,EAAM6oD,UAAY,KAElBpnB,EAAKG,SAAS,cAAc,SAAU7tC,GAEpC,GADoB,mBAATA,IAAuBA,EAAQA,EAAM0tC,EAAKz0B,QACjDjZ,EAAS,IAAK,IAAIirB,KAAQjrB,EAChB,SAARirB,IACAhf,EAAM2wC,OAAS,IAAM58C,EAAMirB,IACnB,SAARA,EACFhf,EAAMqG,OAASrG,EAAMqG,MAAQrG,EAAMqG,MAAQ,IAAM,IAAMtS,EAAMirB,GAErDhf,EAAMgf,IAAiB,mBAARA,GAAqC,YAARA,IAClDhf,EAAMgf,GAAQzO,OAAOxc,EAAMirB,QAI5B,CAACulC,GAAW1lD,KAAK,EAAG4iC,EAAKz0B,MAAM/R,IAAI6C,QAAQlK,KAAMoM,IAG1D,SAASkoD,oBAAoBzmB,GAC3B,GAAIA,EAAKygB,WAAY,CACnB,IAAIjgC,EAAM8J,SAASgB,cAAc,OACjC9K,EAAI+S,UAAY,wBAChB/S,EAAIiL,aAAa,mBAAoB,QACrCuU,EAAKsR,cAAgB,CAAC9wB,IAAKA,EAAK+qB,KAAMuX,GAAW9a,OAAOhI,EAAKz0B,MAAMusB,UAAUnU,KAAMnD,EAAK,CAACipB,KAAK,EAAMhnC,MAAOu9B,EAAKygB,mBAEhHzgB,EAAKsR,cAAgB,KAIzB,SAASkV,YAAYxmB,GACnB,OAAQA,EAAKG,SAAS,YAAY,SAAU7tC,GAAS,OAA6B,IAAtBA,EAAM0tC,EAAKz0B,UAQzE,SAASm7C,eAAe1mB,GACtB,IAAIrpC,EAAS,GAKb,OAJAqpC,EAAKG,SAAS,aAAa,SAAU9zB,GACnC,IAAK,IAAI6F,KAAQ7F,EAAYlT,OAAOtD,UAAUiX,eAAe9U,KAAKrB,EAAQub,KACtEvb,EAAOub,GAAQ7F,EAAI6F,OAElBvb,EAaT,SAASyvD,oBAAoB1rB,GAC3B,GAAIA,EAAOv8B,KAAKoN,OAASmvB,EAAOv8B,KAAK08B,mBAAqBH,EAAOv8B,KAAKi9B,kBAClE,MAAM,IAAIjgC,WAAW,uEAzY3B0b,GAAqB0W,MAAM74B,IAAM,WAC/B,GAAIe,KAAKg7B,OAAOllB,OAAS9V,KAAK8V,MAAO,CACnC,IAAI8uB,EAAO5kC,KAAKg7B,OAEhB,IAAK,IAAIn3B,KADT7D,KAAKg7B,OAAS,GACG4J,EAAQ5kC,KAAKg7B,OAAOn3B,GAAQ+gC,EAAK/gC,GAClD7D,KAAKg7B,OAAOllB,MAAQ9V,KAAK8V,MAE3B,OAAO9V,KAAKg7B,QAMdy1B,GAAWrwD,UAAUib,OAAS,SAASA,OAAQyc,GACzCA,EAAM85B,iBAAmB5xD,KAAKg7B,OAAO42B,iBAAmBvK,gBAAgBrnD,MAC5EA,KAAKg7B,OAASlD,EACVA,EAAMgN,UACRhN,EAAMgN,QAAQ3oC,QAAQw0D,qBACtB3wD,KAAK0wD,cAAgB54B,EAAMgN,SAE7B9kC,KAAK6xD,iBAAiB/5B,EAAMhiB,OAAO,IAOrC26C,GAAWrwD,UAAU0xD,SAAW,SAASA,SAAUh6B,GACjD,IAAIsL,EAAU,GACd,IAAK,IAAIv/B,KAAQ7D,KAAKg7B,OAAUoI,EAAQv/B,GAAQ7D,KAAKg7B,OAAOn3B,GAE5D,IAAK,IAAIioB,KADTsX,EAAQttB,MAAQ9V,KAAK8V,MACFgiB,EAASsL,EAAQtX,GAAUgM,EAAMhM,GACpD9rB,KAAKqb,OAAO+nB,IAMdqtB,GAAWrwD,UAAUqvC,YAAc,SAASA,YAAa35B,GACvD9V,KAAK6xD,iBAAiB/7C,EAAO9V,KAAK8V,MAAMgvB,SAAWhvB,EAAMgvB,UAG3D2rB,GAAWrwD,UAAUyxD,iBAAmB,SAASA,iBAAkB/7C,EAAOi8C,GACtE,IAAIxlD,EAASvM,KAEX4kC,EAAO5kC,KAAK8V,MAAOk8C,GAAS,EAAOC,GAAY,EAQnD,GALIn8C,EAAMqtB,aAAenjC,KAAKu1C,YAC5BqV,iBAAiB5qD,MACjBiyD,GAAY,GAEdjyD,KAAK8V,MAAQA,EACTi8C,EAAc,CAChB,IAAItd,EAAYwc,eAAejxD,OAuUnC,SAASkyD,iBAAiBpnD,EAAGC,GAC3B,IAAIonD,EAAK,EAAGC,EAAK,EACjB,IAAK,IAAI31C,KAAQ3R,EAAG,CAClB,GAAIA,EAAE2R,IAAS1R,EAAE0R,GAAS,OAAO,EACjC01C,IAEF,IAAK,IAAI31D,KAAKuO,EAAKqnD,IACnB,OAAOD,GAAMC,GA7UPF,CAAiBzd,EAAWz0C,KAAKy0C,aACnCz0C,KAAKy0C,UAAYA,EACjBud,GAAS,GAEX3K,gBAAgBrnD,MAGlBA,KAAKg7C,SAAW+V,YAAY/wD,MAC5BgxD,oBAAoBhxD,MACpB,IAAI80C,EAAYub,gBAAgBrwD,MAAO60C,EAAYqc,eAAelxD,MAE9DqyD,EAASN,EAAe,QACtBj8C,EAAMw8C,kBAAoB1tB,EAAK0tB,kBAAoB,eAAiB,WACtEC,EAAYP,IAAWhyD,KAAKguC,QAAQqD,YAAYv7B,EAAM/R,IAAK8wC,EAAWC,IACtEyd,GAAcz8C,EAAMusB,UAAUt0B,GAAG62B,EAAKvC,aAAc4vB,GAAY,GACpE,IAAIO,EAAyB,YAAVH,GAAwBJ,GAA8C,MAAjCjyD,KAAK+qB,IAAI5b,MAAMsjD,gBAntJzE,SAASC,eAAenoB,GAGtB,IAFA,IACIooB,EAAQC,EADR3oB,EAAOM,EAAKxf,IAAImU,wBAAyBkM,EAAS3rC,KAAK8G,IAAI,EAAG0jC,EAAKt3B,KAE9DkpB,GAAKoO,EAAK7S,KAAO6S,EAAK/S,OAAS,EAAGmY,EAAIjE,EAAS,EACnDiE,EAAI5vC,KAAKuO,IAAI2xB,YAAasK,EAAK9S,QAASkY,GAAK,EAAG,CACnD,IAAItkB,EAAMwf,EAAKmD,KAAKd,iBAAiB/Q,EAAGwT,GACxC,GAAItkB,GAAOwf,EAAKxf,KAAQwf,EAAKxf,IAAI6I,SAAS7I,GAA1C,CACA,IAAI8nC,EAAY9nC,EAAImU,wBACpB,GAAI2zB,EAAUlgD,KAAOy4B,EAAS,GAAI,CAChCunB,EAAS5nC,EACT6nC,EAASC,EAAUlgD,IACnB,QAGJ,MAAO,CAACggD,OAAQA,EAAQC,OAAQA,EAAQnnB,MAAOD,YAAYjB,EAAKxf,MAqsJiC2nC,CAAe1yD,MAEhH,GAAIiyD,EAAW,CACbjyD,KAAKw7C,YAAYtH,OAMjB,IAAI4e,EAAiBP,IAAcrxD,EAAO6lC,IAAM7lC,EAAOkmC,UAAYpnC,KAAKu1C,YACnE3Q,EAAKvC,UAAUxgC,QAAUiU,EAAMusB,UAAUxgC,OA+RlD,SAASkxD,wBAAwBC,EAAMC,GACrC,IAAIxrD,EAAQhI,KAAKuO,IAAIglD,EAAKzyB,QAAQ5yB,YAAYqlD,EAAK9kC,MAAO+kC,EAAK1yB,QAAQ5yB,YAAYslD,EAAK/kC,OACxF,OAAO8kC,EAAKzyB,QAAQz/B,MAAM2G,IAAUwrD,EAAK1yB,QAAQz/B,MAAM2G,GAjSEsrD,CAAwBnuB,EAAKvC,UAAWvsB,EAAMusB,WACrG,GAAIkwB,EAAW,CAKb,IAAIW,EAAehyD,EAAOkmC,OAAUpnC,KAAKg5C,YAAch5C,KAAK0tC,KAAKyC,eAAeI,UAAa,MACzFyhB,GAAWhyD,KAAKguC,QAAQ3yB,OAAOvF,EAAM/R,IAAK8wC,EAAWC,EAAW90C,QAClEA,KAAKguC,QAAQqK,gBAAgB,IAC7Br4C,KAAKguC,QAAQ0D,UACb1xC,KAAKguC,QAAU6K,YAAY/iC,EAAM/R,IAAK8wC,EAAWC,EAAW90C,KAAK+qB,IAAK/qB,OAEpEkzD,IAAiBlzD,KAAKg5C,cAAe8Z,GAAiB,GAMxDA,KACE9yD,KAAKq7C,WAAar7C,KAAKw7C,YAAYC,iBAAiB1tC,GAAG/N,KAAK0tC,KAAKyC,iBAxpF3E,SAASgjB,mBAAmB5oB,GAC1B,IAAIyI,EAAYzI,EAAKyD,QAAQU,WAAWnE,EAAKz0B,MAAMusB,UAAU3B,OAAQ,GACjEwI,EAASqB,EAAKmD,KAAKyC,eACvB,OAAO3H,qBAAqBwK,EAAUrrC,KAAMqrC,EAAUrxC,OAAQunC,EAAOkK,WAAYlK,EAAOmK,cAqpFI8f,CAAmBnzD,OAC3Gm7C,eAAen7C,KAAM8yD,IAErB1X,kBAAkBp7C,KAAM8V,EAAMusB,WAC9BriC,KAAKw7C,YAAYG,mBAEnB37C,KAAKw7C,YAAY16C,QAKnB,GAFAd,KAAKwxD,kBAAkB5sB,GAET,SAAVytB,EACFryD,KAAK+qB,IAAIsgB,UAAY,OAChB,GAAc,gBAAVgnB,EAA0B,CACnC,IAAI7nB,EAAWxqC,KAAK0tC,KAAKyC,eAAeI,UACpCvwC,KAAK0qC,SAAS,2BAA2B,SAAUtpC,GAAK,OAAOA,EAAEmL,QAE5DuJ,EAAMusB,qBAAqB,gBAChCiI,mBAAmBtqC,KAAMA,KAAKguC,QAAQ4C,YAAY96B,EAAMusB,UAAUpgC,MAAMi9B,wBAAyBsL,GAEjGF,mBAAmBtqC,KAAMA,KAAKyuC,YAAY34B,EAAMusB,UAAUnU,KAAM,GAAIsc,SAC/DgoB,GAzuJb,SAASY,eAAethD,GACtB,IAAI6gD,EAAS7gD,EAAI6gD,OACbC,EAAS9gD,EAAI8gD,OACbnnB,EAAQ35B,EAAI25B,MAEZ4nB,EAAYV,EAASA,EAAOzzB,wBAAwBvsB,IAAM,EAC9D+4B,mBAAmBD,EAAoB,GAAb4nB,EAAiB,EAAIA,EAAYT,GAouJzDQ,CAAeZ,IAInB/B,GAAWrwD,UAAUkzD,mBAAqB,SAASA,qBAEjD,IADA,IAAI/oB,EACGA,EAAOvqC,KAAKuxD,YAAYx+C,OAAaw3B,EAAKmH,SAAWnH,EAAKmH,WAGnE+e,GAAWrwD,UAAUoxD,kBAAoB,SAASA,kBAAmB/2B,GACnE,GAAKA,GAAaA,EAAUqK,SAAW9kC,KAAK8V,MAAMgvB,SAAW9kC,KAAK0wD,eAAiB1wD,KAAKsxD,kBAYtF,IAAK,IAAI7+C,EAAM,EAAGA,EAAMzS,KAAKuxD,YAAY1yD,OAAQ4T,IAAO,CACtD,IAAI8gD,EAAavzD,KAAKuxD,YAAY9+C,GAC9B8gD,EAAWl4C,QAAUk4C,EAAWl4C,OAAOrb,KAAMy6B,OAdsD,CACzGz6B,KAAKsxD,kBAAoBtxD,KAAK0wD,cAC9B1wD,KAAKszD,qBACL,IAAK,IAAIx0D,EAAI,EAAGA,EAAIkB,KAAK0wD,cAAc7xD,OAAQC,IAAK,CAClD,IAAImmC,EAASjlC,KAAK0wD,cAAc5xD,GAC5BmmC,EAAOv8B,KAAK6hC,MAAQvqC,KAAKuxD,YAAYrzD,KAAK+mC,EAAOv8B,KAAK6hC,KAAKvqC,OAEjE,IAAK,IAAI6P,EAAM,EAAGA,EAAM7P,KAAK8V,MAAMgvB,QAAQjmC,OAAQgR,IAAO,CACxD,IAAI2jD,EAAWxzD,KAAK8V,MAAMgvB,QAAQj1B,GAC9B2jD,EAAS9qD,KAAK6hC,MAAQvqC,KAAKuxD,YAAYrzD,KAAKs1D,EAAS9qD,KAAK6hC,KAAKvqC,UAiBzEywD,GAAWrwD,UAAUsqC,SAAW,SAASA,SAAUqd,EAAU3mD,GAC3D,IAAiDvE,EAA7C4f,EAAOzc,KAAKg7B,QAAUh7B,KAAKg7B,OAAO+sB,GACtC,GAAY,MAARtrC,IAAiB5f,EAAQuE,EAAIA,EAAEqb,GAAQA,GAAS,OAAO5f,EAC3D,IAAK,IAAIiC,EAAI,EAAGA,EAAIkB,KAAK0wD,cAAc7xD,OAAQC,IAAK,CAClD,IAAI6qB,EAAS3pB,KAAK0wD,cAAc5xD,GAAGg5B,MAAMiwB,GACzC,GAAc,MAAVp+B,IAAmB9sB,EAAQuE,EAAIA,EAAEuoB,GAAUA,GAAW,OAAO9sB,EAEnE,IAAIioC,EAAU9kC,KAAK8V,MAAMgvB,QACzB,GAAIA,EAAW,IAAK,IAAIj1B,EAAM,EAAGA,EAAMi1B,EAAQjmC,OAAQgR,IAAO,CAC5D,IAAIka,EAAS+a,EAAQj1B,GAAKioB,MAAMiwB,GAChC,GAAc,MAAVh+B,IAAmBltB,EAAQuE,EAAIA,EAAE2oB,GAAUA,GAAW,OAAOltB,IAMrE4zD,GAAWrwD,UAAU66C,SAAW,SAASA,WACvC,OAAOj7C,KAAK0tC,KAAK8B,eAAiBxvC,KAAK+qB,KAKzC0lC,GAAWrwD,UAAUo9B,MAAQ,SAASA,QACpCx9B,KAAKw7C,YAAYtH,OACbl0C,KAAKg7C,UA/wJX,SAASyY,mBAAmB1oC,GAC1B,GAAIA,EAAI2oC,UAAa,OAAO3oC,EAAI2oC,YAChC,GAAI9nB,EAA0B,OAAO7gB,EAAIyS,MAAMoO,GAE/C,IAAI+nB,EAASnoB,YAAYzgB,GACzBA,EAAIyS,MAAgC,MAA1BoO,EAAiC,CACzC,oBAEE,OADAA,EAAyB,CAACgoB,eAAe,IAClC,SAEPr3D,GACCqvC,IACHA,GAAyB,EACzBF,mBAAmBioB,EAAQ,IAkwJRF,CAAmBzzD,KAAK+qB,KAC7CowB,eAAen7C,MACfA,KAAKw7C,YAAY16C,SAQnBsgB,GAAqBssB,KAAKzuC,IAAM,WAC9B,IAAIojB,EAASriB,KAAK4wD,MAClB,GAAc,MAAVvuC,EAAkB,IAAK,IAAI6D,EAASlmB,KAAK+qB,IAAIsE,WAAYnJ,EAAQA,EAASA,EAAOmJ,WACnF,GAAuB,GAAnBnJ,EAAOrd,UAAqC,IAAnBqd,EAAOrd,UAAkBqd,EAAOgiB,KAE3D,OADKhiB,EAAOiqB,eAAgBzsC,OAAO81B,eAAetT,GAAQiqB,aAAe,WAAc,OAAOtb,SAASsb,iBAChGnwC,KAAK4wD,MAAQ1qC,EAGxB,OAAO7D,GAAUwS,UAWnB47B,GAAWrwD,UAAU6sC,YAAc,SAAS4mB,cAAe/nB,GACzD,OAAOmB,YAAYjtC,KAAM8rC,IAU3B2kB,GAAWrwD,UAAUquC,YAAc,SAASqlB,cAAej0D,EAAKkqC,GAG9D,YAFgB,IAATA,IAAkBA,EAAO,GAEzB0E,YAAYzuC,KAAMH,EAAKkqC,IAYhC0mB,GAAWrwD,UAAU2zD,SAAW,SAASA,SAAUl0D,EAAKkqC,GAGtD,YAFgB,IAATA,IAAkBA,EAAO,GAEzB/pC,KAAKguC,QAAQU,WAAW7uC,EAAKkqC,IAYtC0mB,GAAWrwD,UAAU+xC,QAAU,SAASA,QAAStyC,GAC/C,IAAI0kC,EAAOvkC,KAAKguC,QAAQoE,OAAOvyC,GAC/B,OAAO0kC,EAAOA,EAAK4N,QAAU,MAY/Bse,GAAWrwD,UAAU4zD,SAAW,SAASA,SAAUrsD,EAAMhG,EAAQ2J,QAC/C,IAATA,IAAkBA,GAAQ,GAEjC,IAAIzL,EAAMG,KAAKguC,QAAQI,WAAWzmC,EAAMhG,EAAQ2J,GAChD,GAAW,MAAPzL,EAAe,MAAM,IAAI6F,WAAW,sCACxC,OAAO7F,GAUT4wD,GAAWrwD,UAAU0vC,eAAiB,SAASmkB,iBAAkB/oD,EAAK4K,GACpE,OAAOg6B,eAAe9vC,KAAM8V,GAAS9V,KAAK8V,MAAO5K,IAMnDulD,GAAWrwD,UAAUsxC,QAAU,SAASA,UACjC1xC,KAAKguC,WAvsDZ,SAASkmB,aAAa3pB,GAEpB,IAAK,IAAI5kC,KADT4kC,EAAKiR,YAAYtH,OACA3J,EAAKgd,cAClBhd,EAAKxf,IAAIuxB,oBAAoB32C,EAAM4kC,EAAKgd,cAAc5hD,IAC1DsgD,aAAa1b,EAAKogB,kBAClB1E,aAAa1b,EAAKwe,6BAmsDlBmL,CAAal0D,MACbA,KAAKszD,qBACDtzD,KAAK8wD,SACP9wD,KAAKguC,QAAQ3yB,OAAOrb,KAAK8V,MAAM/R,IAAK,GAAIssD,gBAAgBrwD,MAAOA,MAC/DA,KAAK+qB,IAAInI,YAAc,IACd5iB,KAAK+qB,IAAIsE,YAClBrvB,KAAK+qB,IAAIsE,WAAW6oB,YAAYl4C,KAAK+qB,KAEvC/qB,KAAKguC,QAAQ0D,UACb1xC,KAAKguC,QAAU,OAOjB5sB,GAAqBqwC,YAAYxyD,IAAM,WACrC,OAAuB,MAAhBe,KAAKguC,SAIdyiB,GAAWrwD,UAAU+zD,cAAgB,SAASC,gBAAiB3qB,GAC7D,OA9rDF,SAAS0qB,cAAc5pB,EAAMd,GACtB+d,iBAAiBjd,EAAMd,KAAUyd,EAASzd,EAAM9jC,QAChD4kC,EAAKyQ,UAAcvR,EAAM9jC,QAAQwhD,GAClCD,EAASzd,EAAM9jC,MAAM4kC,EAAMd,GA2rDxB0qB,CAAcn0D,KAAMypC,IAW7BgnB,GAAWrwD,UAAUm9C,SAAW,SAASA,SAAU5c,GACjD,IAAI0zB,EAAsBr0D,KAAKg7B,OAAOq5B,oBAClCA,EAAuBA,EAAoB9xD,KAAKvC,KAAM2gC,GACnD3gC,KAAKyvC,YAAYzvC,KAAK8V,MAAMnR,MAAMg8B,KAG3Cj9B,OAAOoB,iBAAkB2rD,GAAWrwD,UAAWghB,K,oCChoK/C1d,OAAO2yB,eAAe/gB,EAAS,aAAc,CAC3CzY,OAAO,IAGT,IAEIy3D,EAEJ,SAAS/7B,uBAAuB3hB,GAAO,OAAOA,GAAOA,EAAIkiB,WAAaliB,EAAM,CAAEoR,QAASpR,GAFrE2hB,CAFD,EAAQ,SAMzBjjB,EAAQ0S,QAAUssC,EAAYtsC,S,kCCX9B,IAAIusC,EAAI,EAAQ,QACZC,EAAU,EAAQ,QAClBC,EAAsB,EAAQ,QAIlCF,EAAE,CAAEzoD,OAAQ,UAAW4oD,OAAO,EAAMC,MAAM,EAAMC,OAAQJ,GAAW,CACjEK,UAAW,SAASA,YAClB,OAAOJ,EAAoB9vD,MAAM3E,KAAMmV,e,qBCTzC,IAagBa,EAVhBX,EAAOC,SAUSU,EAVmB,EAAQ,QAY3C,SAAUvW,GAEP,IAAIqX,EAAId,EACJe,EAAQD,EAAEE,IACVW,EAAYZ,EAAMY,UAClBuD,EAASnE,EAAMmE,OACfD,EAASnE,EAAE+E,KAGXi5C,EAAI,IAGP,WACG,IAAK,IAAIh2D,EAAI,EAAGA,EAAI,GAAIA,IACpBg2D,EAAEh2D,GAAkC,WAA5BW,EAAKyqD,IAAIzqD,EAAKs1D,IAAIj2D,EAAI,IAAqB,EAF3D,GASA,IAAIk2D,EAAM/5C,EAAO+5C,IAAM95C,EAAOhE,OAAO,CACjCkE,SAAU,WACNpb,KAAKi1D,MAAQ,IAAIt9C,EAAU1C,KAAK,CAC5B,WAAY,WACZ,WAAY,aAIpB+F,gBAAiB,SAAUk6C,EAAGvzD,GAE1B,IAAK,IAAI7C,EAAI,EAAGA,EAAI,GAAIA,IAAK,CAEzB,IAAIq2D,EAAWxzD,EAAS7C,EACpBs2D,EAAaF,EAAEC,GAEnBD,EAAEC,GACgD,UAA3CC,GAAc,EAAOA,IAAe,IACO,YAA3CA,GAAc,GAAOA,IAAe,GAK/C,IAAIC,EAAIr1D,KAAKi1D,MAAMr9C,MAEf09C,EAAcJ,EAAEvzD,EAAS,GACzB4zD,EAAcL,EAAEvzD,EAAS,GACzB6zD,EAAcN,EAAEvzD,EAAS,GACzB8zD,EAAcP,EAAEvzD,EAAS,GACzB+zD,EAAcR,EAAEvzD,EAAS,GACzBg0D,EAAcT,EAAEvzD,EAAS,GACzBi0D,EAAcV,EAAEvzD,EAAS,GACzBk0D,EAAcX,EAAEvzD,EAAS,GACzBm0D,EAAcZ,EAAEvzD,EAAS,GACzBo0D,EAAcb,EAAEvzD,EAAS,GACzBq0D,EAAcd,EAAEvzD,EAAS,IACzBs0D,EAAcf,EAAEvzD,EAAS,IACzBu0D,EAAchB,EAAEvzD,EAAS,IACzBw0D,EAAcjB,EAAEvzD,EAAS,IACzBy0D,EAAclB,EAAEvzD,EAAS,IACzB00D,EAAcnB,EAAEvzD,EAAS,IAGzBmJ,EAAIuqD,EAAE,GACNtqD,EAAIsqD,EAAE,GACNiB,EAAIjB,EAAE,GACNjrD,EAAIirD,EAAE,GAGVvqD,EAAIyrD,GAAGzrD,EAAGC,EAAGurD,EAAGlsD,EAAGkrD,EAAa,EAAIR,EAAE,IACtC1qD,EAAImsD,GAAGnsD,EAAGU,EAAGC,EAAGurD,EAAGf,EAAa,GAAIT,EAAE,IACtCwB,EAAIC,GAAGD,EAAGlsD,EAAGU,EAAGC,EAAGyqD,EAAa,GAAIV,EAAE,IACtC/pD,EAAIwrD,GAAGxrD,EAAGurD,EAAGlsD,EAAGU,EAAG2qD,EAAa,GAAIX,EAAE,IACtChqD,EAAIyrD,GAAGzrD,EAAGC,EAAGurD,EAAGlsD,EAAGsrD,EAAa,EAAIZ,EAAE,IACtC1qD,EAAImsD,GAAGnsD,EAAGU,EAAGC,EAAGurD,EAAGX,EAAa,GAAIb,EAAE,IACtCwB,EAAIC,GAAGD,EAAGlsD,EAAGU,EAAGC,EAAG6qD,EAAa,GAAId,EAAE,IACtC/pD,EAAIwrD,GAAGxrD,EAAGurD,EAAGlsD,EAAGU,EAAG+qD,EAAa,GAAIf,EAAE,IACtChqD,EAAIyrD,GAAGzrD,EAAGC,EAAGurD,EAAGlsD,EAAG0rD,EAAa,EAAIhB,EAAE,IACtC1qD,EAAImsD,GAAGnsD,EAAGU,EAAGC,EAAGurD,EAAGP,EAAa,GAAIjB,EAAE,IACtCwB,EAAIC,GAAGD,EAAGlsD,EAAGU,EAAGC,EAAGirD,EAAa,GAAIlB,EAAE,KACtC/pD,EAAIwrD,GAAGxrD,EAAGurD,EAAGlsD,EAAGU,EAAGmrD,EAAa,GAAInB,EAAE,KACtChqD,EAAIyrD,GAAGzrD,EAAGC,EAAGurD,EAAGlsD,EAAG8rD,EAAa,EAAIpB,EAAE,KACtC1qD,EAAImsD,GAAGnsD,EAAGU,EAAGC,EAAGurD,EAAGH,EAAa,GAAIrB,EAAE,KACtCwB,EAAIC,GAAGD,EAAGlsD,EAAGU,EAAGC,EAAGqrD,EAAa,GAAItB,EAAE,KAGtChqD,EAAI0rD,GAAG1rD,EAFPC,EAAIwrD,GAAGxrD,EAAGurD,EAAGlsD,EAAGU,EAAGurD,EAAa,GAAIvB,EAAE,KAEzBwB,EAAGlsD,EAAGmrD,EAAa,EAAIT,EAAE,KACtC1qD,EAAIosD,GAAGpsD,EAAGU,EAAGC,EAAGurD,EAAGV,EAAa,EAAId,EAAE,KACtCwB,EAAIE,GAAGF,EAAGlsD,EAAGU,EAAGC,EAAGkrD,EAAa,GAAInB,EAAE,KACtC/pD,EAAIyrD,GAAGzrD,EAAGurD,EAAGlsD,EAAGU,EAAGwqD,EAAa,GAAIR,EAAE,KACtChqD,EAAI0rD,GAAG1rD,EAAGC,EAAGurD,EAAGlsD,EAAGurD,EAAa,EAAIb,EAAE,KACtC1qD,EAAIosD,GAAGpsD,EAAGU,EAAGC,EAAGurD,EAAGN,EAAa,EAAIlB,EAAE,KACtCwB,EAAIE,GAAGF,EAAGlsD,EAAGU,EAAGC,EAAGsrD,EAAa,GAAIvB,EAAE,KACtC/pD,EAAIyrD,GAAGzrD,EAAGurD,EAAGlsD,EAAGU,EAAG4qD,EAAa,GAAIZ,EAAE,KACtChqD,EAAI0rD,GAAG1rD,EAAGC,EAAGurD,EAAGlsD,EAAG2rD,EAAa,EAAIjB,EAAE,KACtC1qD,EAAIosD,GAAGpsD,EAAGU,EAAGC,EAAGurD,EAAGF,EAAa,EAAItB,EAAE,KACtCwB,EAAIE,GAAGF,EAAGlsD,EAAGU,EAAGC,EAAG0qD,EAAa,GAAIX,EAAE,KACtC/pD,EAAIyrD,GAAGzrD,EAAGurD,EAAGlsD,EAAGU,EAAGgrD,EAAa,GAAIhB,EAAE,KACtChqD,EAAI0rD,GAAG1rD,EAAGC,EAAGurD,EAAGlsD,EAAG+rD,EAAa,EAAIrB,EAAE,KACtC1qD,EAAIosD,GAAGpsD,EAAGU,EAAGC,EAAGurD,EAAGd,EAAa,EAAIV,EAAE,KACtCwB,EAAIE,GAAGF,EAAGlsD,EAAGU,EAAGC,EAAG8qD,EAAa,GAAIf,EAAE,KAGtChqD,EAAI2rD,GAAG3rD,EAFPC,EAAIyrD,GAAGzrD,EAAGurD,EAAGlsD,EAAGU,EAAGorD,EAAa,GAAIpB,EAAE,KAEzBwB,EAAGlsD,EAAGurD,EAAa,EAAIb,EAAE,KACtC1qD,EAAIqsD,GAAGrsD,EAAGU,EAAGC,EAAGurD,EAAGR,EAAa,GAAIhB,EAAE,KACtCwB,EAAIG,GAAGH,EAAGlsD,EAAGU,EAAGC,EAAGkrD,EAAa,GAAInB,EAAE,KACtC/pD,EAAI0rD,GAAG1rD,EAAGurD,EAAGlsD,EAAGU,EAAGsrD,EAAa,GAAItB,EAAE,KACtChqD,EAAI2rD,GAAG3rD,EAAGC,EAAGurD,EAAGlsD,EAAGmrD,EAAa,EAAIT,EAAE,KACtC1qD,EAAIqsD,GAAGrsD,EAAGU,EAAGC,EAAGurD,EAAGZ,EAAa,GAAIZ,EAAE,KACtCwB,EAAIG,GAAGH,EAAGlsD,EAAGU,EAAGC,EAAG8qD,EAAa,GAAIf,EAAE,KACtC/pD,EAAI0rD,GAAG1rD,EAAGurD,EAAGlsD,EAAGU,EAAGkrD,EAAa,GAAIlB,EAAE,KACtChqD,EAAI2rD,GAAG3rD,EAAGC,EAAGurD,EAAGlsD,EAAG+rD,EAAa,EAAIrB,EAAE,KACtC1qD,EAAIqsD,GAAGrsD,EAAGU,EAAGC,EAAGurD,EAAGhB,EAAa,GAAIR,EAAE,KACtCwB,EAAIG,GAAGH,EAAGlsD,EAAGU,EAAGC,EAAG0qD,EAAa,GAAIX,EAAE,KACtC/pD,EAAI0rD,GAAG1rD,EAAGurD,EAAGlsD,EAAGU,EAAG8qD,EAAa,GAAId,EAAE,KACtChqD,EAAI2rD,GAAG3rD,EAAGC,EAAGurD,EAAGlsD,EAAG2rD,EAAa,EAAIjB,EAAE,KACtC1qD,EAAIqsD,GAAGrsD,EAAGU,EAAGC,EAAGurD,EAAGJ,EAAa,GAAIpB,EAAE,KACtCwB,EAAIG,GAAGH,EAAGlsD,EAAGU,EAAGC,EAAGsrD,EAAa,GAAIvB,EAAE,KAGtChqD,EAAI4rD,GAAG5rD,EAFPC,EAAI0rD,GAAG1rD,EAAGurD,EAAGlsD,EAAGU,EAAG0qD,EAAa,GAAIV,EAAE,KAEzBwB,EAAGlsD,EAAGkrD,EAAa,EAAIR,EAAE,KACtC1qD,EAAIssD,GAAGtsD,EAAGU,EAAGC,EAAGurD,EAAGT,EAAa,GAAIf,EAAE,KACtCwB,EAAII,GAAGJ,EAAGlsD,EAAGU,EAAGC,EAAGqrD,EAAa,GAAItB,EAAE,KACtC/pD,EAAI2rD,GAAG3rD,EAAGurD,EAAGlsD,EAAGU,EAAG6qD,EAAa,GAAIb,EAAE,KACtChqD,EAAI4rD,GAAG5rD,EAAGC,EAAGurD,EAAGlsD,EAAG8rD,EAAa,EAAIpB,EAAE,KACtC1qD,EAAIssD,GAAGtsD,EAAGU,EAAGC,EAAGurD,EAAGb,EAAa,GAAIX,EAAE,KACtCwB,EAAII,GAAGJ,EAAGlsD,EAAGU,EAAGC,EAAGirD,EAAa,GAAIlB,EAAE,KACtC/pD,EAAI2rD,GAAG3rD,EAAGurD,EAAGlsD,EAAGU,EAAGyqD,EAAa,GAAIT,EAAE,KACtChqD,EAAI4rD,GAAG5rD,EAAGC,EAAGurD,EAAGlsD,EAAG0rD,EAAa,EAAIhB,EAAE,KACtC1qD,EAAIssD,GAAGtsD,EAAGU,EAAGC,EAAGurD,EAAGD,EAAa,GAAIvB,EAAE,KACtCwB,EAAII,GAAGJ,EAAGlsD,EAAGU,EAAGC,EAAG6qD,EAAa,GAAId,EAAE,KACtC/pD,EAAI2rD,GAAG3rD,EAAGurD,EAAGlsD,EAAGU,EAAGqrD,EAAa,GAAIrB,EAAE,KACtChqD,EAAI4rD,GAAG5rD,EAAGC,EAAGurD,EAAGlsD,EAAGsrD,EAAa,EAAIZ,EAAE,KACtC1qD,EAAIssD,GAAGtsD,EAAGU,EAAGC,EAAGurD,EAAGL,EAAa,GAAInB,EAAE,KACtCwB,EAAII,GAAGJ,EAAGlsD,EAAGU,EAAGC,EAAGyqD,EAAa,GAAIV,EAAE,KACtC/pD,EAAI2rD,GAAG3rD,EAAGurD,EAAGlsD,EAAGU,EAAGirD,EAAa,GAAIjB,EAAE,KAGtCO,EAAE,GAAMA,EAAE,GAAKvqD,EAAK,EACpBuqD,EAAE,GAAMA,EAAE,GAAKtqD,EAAK,EACpBsqD,EAAE,GAAMA,EAAE,GAAKiB,EAAK,EACpBjB,EAAE,GAAMA,EAAE,GAAKjrD,EAAK,GAGxBoR,YAAa,WAET,IAAInB,EAAOra,KAAKka,MACZO,EAAYJ,EAAKzC,MAEjB++C,EAAgC,EAAnB32D,KAAKma,YAClBy8C,EAA4B,EAAhBv8C,EAAKxC,SAGrB4C,EAAUm8C,IAAc,IAAM,KAAS,GAAKA,EAAY,GAExD,IAAIC,EAAcp3D,EAAKutC,MAAM2pB,EAAa,YACtCG,EAAcH,EAClBl8C,EAA4C,IAA/Bm8C,EAAY,KAAQ,GAAM,IACa,UAA7CC,GAAe,EAAOA,IAAgB,IACO,YAA7CA,GAAe,GAAOA,IAAgB,GAE7Cp8C,EAA4C,IAA/Bm8C,EAAY,KAAQ,GAAM,IACa,UAA7CE,GAAe,EAAOA,IAAgB,IACO,YAA7CA,GAAe,GAAOA,IAAgB,GAG7Cz8C,EAAKxC,SAAoC,GAAxB4C,EAAU5b,OAAS,GAGpCmB,KAAKsa,WAOL,IAJA,IAAIy8C,EAAO/2D,KAAKi1D,MACZI,EAAI0B,EAAKn/C,MAGJ9Y,EAAI,EAAGA,EAAI,EAAGA,IAAK,CAExB,IAAIk4D,EAAM3B,EAAEv2D,GAEZu2D,EAAEv2D,GAAqC,UAA7Bk4D,GAAO,EAAOA,IAAQ,IACO,YAA7BA,GAAO,GAAOA,IAAQ,GAIpC,OAAOD,GAGXr/C,MAAO,WACH,IAAIA,EAAQwD,EAAOxD,MAAMnV,KAAKvC,MAG9B,OAFA0X,EAAMu9C,MAAQj1D,KAAKi1D,MAAMv9C,QAElBA,KAIf,SAAS6+C,GAAGzrD,EAAGC,EAAGurD,EAAGlsD,EAAGyxB,EAAG/sB,EAAGmoD,GAC1B,IAAIr1D,EAAIkJ,GAAMC,EAAIurD,GAAOvrD,EAAIX,GAAMyxB,EAAIo7B,EACvC,OAASr1D,GAAKkN,EAAMlN,IAAO,GAAKkN,GAAO/D,EAG3C,SAASyrD,GAAG1rD,EAAGC,EAAGurD,EAAGlsD,EAAGyxB,EAAG/sB,EAAGmoD,GAC1B,IAAIr1D,EAAIkJ,GAAMC,EAAIX,EAAMksD,GAAKlsD,GAAMyxB,EAAIo7B,EACvC,OAASr1D,GAAKkN,EAAMlN,IAAO,GAAKkN,GAAO/D,EAG3C,SAAS0rD,GAAG3rD,EAAGC,EAAGurD,EAAGlsD,EAAGyxB,EAAG/sB,EAAGmoD,GAC1B,IAAIr1D,EAAIkJ,GAAKC,EAAIurD,EAAIlsD,GAAKyxB,EAAIo7B,EAC9B,OAASr1D,GAAKkN,EAAMlN,IAAO,GAAKkN,GAAO/D,EAG3C,SAAS2rD,GAAG5rD,EAAGC,EAAGurD,EAAGlsD,EAAGyxB,EAAG/sB,EAAGmoD,GAC1B,IAAIr1D,EAAIkJ,GAAKwrD,GAAKvrD,GAAKX,IAAMyxB,EAAIo7B,EACjC,OAASr1D,GAAKkN,EAAMlN,IAAO,GAAKkN,GAAO/D,EAiB3C+L,EAAEk+C,IAAM95C,EAAOO,cAAcu5C,GAgB7Bl+C,EAAEogD,QAAUh8C,EAAOS,kBAAkBq5C,GAtPzC,CAuPEv1D,MAGKuW,EAASg/C,M,kCCvQjBtxD,OAAO2yB,eAAe/gB,EAAS,aAAc,CAC3CzY,OAAO,IAGT,IAAIg7B,EAAe,WAAc,SAAS/yB,iBAAiBgH,EAAQgsB,GAAS,IAAK,IAAIh5B,EAAI,EAAGA,EAAIg5B,EAAMj5B,OAAQC,IAAK,CAAE,IAAIi5B,EAAaD,EAAMh5B,GAAIi5B,EAAWC,WAAaD,EAAWC,aAAc,EAAOD,EAAW3zB,cAAe,EAAU,UAAW2zB,IAAYA,EAAWE,UAAW,GAAMv0B,OAAO2yB,eAAevqB,EAAQisB,EAAWt7B,IAAKs7B,IAAiB,OAAO,SAAUG,EAAaC,EAAYC,GAAiJ,OAA9HD,GAAYrzB,iBAAiBozB,EAAY93B,UAAW+3B,GAAiBC,GAAatzB,iBAAiBozB,EAAaE,GAAqBF,GAA7gB,GAEfG,EAAS,EAAQ,QAEjBC,EAAUC,uBAAuBF,GAEjC8+B,EAAY,EAAQ,QAEpB3+B,EAAa,EAAQ,QAIrBC,EAAaF,uBAFD,EAAQ,SAIpBG,EAAW,EAAQ,QAEnBC,EAAkB,EAAQ,QAE9B,SAASJ,uBAAuB3hB,GAAO,OAAOA,GAAOA,EAAIkiB,WAAaliB,EAAM,CAAEoR,QAASpR,GAQvF,IAAIwgD,EAAgB,SAAUl+B,GAG5B,SAASk+B,iBATX,SAASj+B,gBAAgB5hB,EAAU2gB,GAAe,KAAM3gB,aAAoB2gB,GAAgB,MAAM,IAAIkB,UAAU,qCAU5GD,CAAgBn5B,KAAMo3D,eAEtB,IAAI/9B,EAVR,SAASC,2BAA2BnjB,EAAM5T,GAAQ,IAAK4T,EAAQ,MAAM,IAAIojB,eAAe,6DAAgE,OAAOh3B,GAAyB,iBAATA,GAAqC,mBAATA,EAA8B4T,EAAP5T,EAUlN+2B,CAA2Bt5B,MAAOo3D,cAAc50D,WAAakB,OAAO81B,eAAe49B,gBAAgB70D,KAAKvC,OAUpH,OARAq5B,EAAMg+B,QAAS,EAAI3+B,EAAS4+B,uBAAuB,OACnDj+B,EAAMuB,OAASvB,EAAMuB,OAAO3Q,KAAKoP,GACjCA,EAAMk+B,cAAgBl+B,EAAMk+B,cAActtC,KAAKoP,GAC/CA,EAAMS,eAAiBT,EAAMS,eAAe7P,KAAKoP,GACjDA,EAAMm+B,cAAgBn+B,EAAMm+B,cAAcvtC,KAAKoP,GAC/CA,EAAMo+B,kBAAoBp+B,EAAMo+B,kBAAkBxtC,KAAKoP,GACvDA,EAAMq+B,iBAAmBr+B,EAAMq+B,iBAAiBztC,KAAKoP,GACrDA,EAAMs+B,gBAAkBt+B,EAAMs+B,gBAAgB1tC,KAAKoP,GAC5CA,EAyHT,OA3IF,SAASc,UAAUC,EAAUC,GAAc,GAA0B,mBAAfA,GAA4C,OAAfA,EAAuB,MAAM,IAAIjB,UAAU,kEAAoEiB,GAAeD,EAASh6B,UAAYsD,OAAOC,OAAO02B,GAAcA,EAAWj6B,UAAW,CAAEwD,YAAa,CAAE/G,MAAOu9B,EAAUpC,YAAY,EAAOC,UAAU,EAAM7zB,cAAc,KAAei2B,IAAY32B,OAAO42B,eAAiB52B,OAAO42B,eAAeF,EAAUC,GAAcD,EAAS53B,UAAY63B,GAG/dF,CAAUi9B,cAAel+B,GAkBzBrB,EAAau/B,cAAe,CAAC,CAC3B36D,IAAK,oBACLI,MAAO,SAAS0hC,oBACd,IAAIxD,EAAS/6B,KAEbA,KAAK43D,YAAc1hD,OAAO0hD,YAC1B53D,KAAK63D,YAAcl5B,YAAW,WAC5BzoB,OAAOsmC,iBAAiB,SAAUzhB,EAAOw8B,eACzCrhD,OAAOsmC,iBAAiB,UAAWzhB,EAAOjB,gBAC1C5jB,OAAOsmC,iBAAiB,eAAgBzhB,EAAO08B,mBAC/CvhD,OAAOsmC,iBAAiB,cAAezhB,EAAO28B,kBAC9CxhD,OAAOsmC,iBAAiB,aAAczhB,EAAO48B,iBAC7CzhD,OAAOsmC,iBAAiB,gBAAiBzhB,EAAO48B,iBAChDzhD,OAAOsmC,iBAAiB,SAAUzhB,EAAOy8B,iBACxC/+B,EAAWzQ,QAAQyP,sBAEvB,CACDh7B,IAAK,uBACLI,MAAO,SAASi7D,uBACd7R,aAAajmD,KAAK63D,aAClB3hD,OAAOomC,oBAAoB,SAAUt8C,KAAKu3D,eAC1CrhD,OAAOomC,oBAAoB,UAAWt8C,KAAK85B,gBAC3C5jB,OAAOomC,oBAAoB,eAAgBt8C,KAAKy3D,mBAChDvhD,OAAOomC,oBAAoB,cAAet8C,KAAK03D,kBAC/CxhD,OAAOomC,oBAAoB,aAAct8C,KAAK23D,iBAC9CzhD,OAAOomC,oBAAoB,gBAAiBt8C,KAAK23D,iBACjDzhD,OAAOomC,oBAAoB,SAAUt8C,KAAKw3D,gBAC1C,EAAI9+B,EAASq/B,uBAAuB/3D,KAAKq3D,UAE1C,CACD56D,IAAK,SACLI,MAAO,SAASi+B,SACd,OAAO96B,KAAKq3D,QAAS,EAAIF,EAAUa,cAAc1/B,EAAQtQ,QAAQ6N,cAC/D,MACA,CAAE8F,QAAS37B,KAAK46B,QAChB56B,KAAKi4D,eACJj4D,KAAKq3D,QAAU,OAEnB,CACD56D,IAAK,SACLI,MAAO,SAAS+9B,SACd,IAAIoF,EAAO7qB,UAAUtW,OAAS,QAAsBtC,IAAjB4Y,UAAU,GAAmBA,UAAU,GAAK,GAC3E0lB,EAAQmF,EAAKnF,MACbuC,EAAe4C,EAAK5C,aAExB,OAAIp9B,KAAK83B,MAAMkE,oBAAsBnB,EAC5B76B,KAAK83B,MAAMkE,oBAGbh8B,KAAKhD,MAAM49B,OAAOwC,KAE1B,CACD3gC,IAAK,cACLI,MAAO,SAASo7D,cACd,IAAI56B,EAASr9B,KAEb,OAAOs4B,EAAQtQ,QAAQkwC,aAAa5/B,EAAQtQ,QAAQmwC,SAASC,KAAKp4D,KAAK83B,MAAMv8B,UAAW,CACtFuW,IAAK,SAASA,IAAI9U,GAChBqgC,EAAOrgC,MAAQA,OAIpB,CACDP,IAAK,iBACLI,MAAO,SAASi9B,eAAe3zB,GAC7B,IAAI,EAAIwyB,EAAgB0/B,UAAUlyD,GAChCA,EAAE82B,qBADJ,CAKA,IAEIq7B,EAF0Bt4D,KAAK83B,MAAMoE,0BAEc,EAAIvD,EAAgBqE,sBAAsB72B,GAC7FoyD,GAAkB,EAAI5/B,EAAgB6/B,aAAaryD,GAEnDmyD,GACFnyD,EAAE82B,kBAGAq7B,GAAyBC,IAC3Bv4D,KAAK46B,OAAO,CAAEwC,cAAc,OAG/B,CACD3gC,IAAK,gBACLI,MAAO,SAAS26D,gBACdx3D,KAAKnC,gBAEN,CACDpB,IAAK,gBACLI,MAAO,SAAS06D,gBACdv3D,KAAKnC,cACc4B,KAAKyqD,IAAIh0C,OAAO0hD,YAAc53D,KAAK43D,aACnC,IACjB53D,KAAK46B,WAGR,CACDn+B,IAAK,oBACLI,MAAO,SAAS46D,kBAAkBtxD,GAChCnG,KAAKy4D,eAAiBtyD,EAAEhF,QAAQ,GAAG0mD,UAEpC,CACDprD,IAAK,mBACLI,MAAO,SAAS66D,iBAAiBvxD,GAC/BnG,KAAKnC,cACa4B,KAAKyqD,IAAI/jD,EAAEhF,QAAQ,GAAG0mD,QAAU7nD,KAAKy4D,gBACrC,IAChBz4D,KAAK46B,WAGR,CACDn+B,IAAK,kBACLI,MAAO,SAAS86D,yBACP33D,KAAKy4D,mBAITrB,cAzIW,CA0IlB/+B,EAAOqF,WAETpoB,EAAQ0S,QAAUovC,EAGlBA,EAAcz5B,UAAY,CACxBpiC,SAAUi9B,EAAWqU,QAAQ9jB,WAC7B2vC,qBAAsBlgC,EAAWwF,O,qBCjLP,EAAQ,OAIpC26B,CAAsB,Y,kCCHtB,IAAIpE,EAAI,EAAQ,QACZC,EAAU,EAAQ,QAClBoE,EAAgB,EAAQ,QACxBC,EAAQ,EAAQ,QAChBC,EAAa,EAAQ,QACrBC,EAAqB,EAAQ,QAC7BC,EAAiB,EAAQ,QACzBC,EAAW,EAAQ,QASvB1E,EAAE,CAAEzoD,OAAQ,UAAW4oD,OAAO,EAAMC,MAAM,EAAMC,SAN5BgE,GAAiBC,GAAM,WACzCD,EAAcx4D,UAAmB,QAAEmC,KAAK,CAAE22D,KAAM,eAA+B,mBAKV,CACrE,QAAW,SAAUC,GACnB,IAAIriD,EAAIiiD,EAAmB/4D,KAAM84D,EAAW,YACxCM,EAAiC,mBAAbD,EACxB,OAAOn5D,KAAKk5D,KACVE,EAAa,SAAUv9B,GACrB,OAAOm9B,EAAeliD,EAAGqiD,KAAaD,MAAK,WAAc,OAAOr9B,MAC9Ds9B,EACJC,EAAa,SAAUjzD,GACrB,OAAO6yD,EAAeliD,EAAGqiD,KAAaD,MAAK,WAAc,MAAM/yD,MAC7DgzD,MAML3E,GAAmC,mBAAjBoE,GAAgCA,EAAcx4D,UAAmB,SACtF64D,EAASL,EAAcx4D,UAAW,UAAW04D,EAAW,WAAW14D,UAAmB,U,kCChCxFsD,OAAO2yB,eAAe/gB,EAAS,aAAc,CAC3CzY,OAAO,IAEmByY,EAAQgiD,sBAAwB,SAASA,sBAAsB3sC,GACzF,IAAI0sC,EAASxiC,SAASgB,cAAclL,GAEpC,OADAkK,SAAS2K,KAAK5N,YAAYylC,GACnBA,GAGmB/hD,EAAQyiD,sBAAwB,SAASA,sBAAsBV,GACzFxiC,SAAS2K,KAAK0Y,YAAYmf,IAGX/hD,EAAQopB,WAAa,SAASA,WAAWjI,EAAO4iC,GAC/D,IAAI1/B,EAAMlD,EAAMkD,IACZ8E,EAAShI,EAAMgI,OACf66B,EAAQ7iC,EAAM6iC,MAEdt6B,EAAM,IAAIu6B,MAWdv6B,EAAIwd,iBAAiB,QAVR,SAAS1gB,SACpBu9B,EAAGr6B,GAOHA,EAAIsd,oBAAoB,OAAQxgB,WAGlCkD,EAAIrF,IAAMA,EACN8E,IAAQO,EAAIw6B,OAAS/6B,GACrB66B,IAAOt6B,EAAIs6B,MAAQA,IA7BzB,IAoCIx5B,EAAWxqB,EAAQwqB,SAAW,SAASA,SAASE,GAClD,IAAIb,EAAQa,EAAKb,MACbC,EAASY,EAAKZ,OACdhE,EAAa4E,EAAK5E,WAElB8O,EAASh0B,OAAOujD,YAAct6B,EAAQ/D,GACtCgP,EAASl0B,OAAOypB,aAAeP,EAAShE,GAC5C,OAAO37B,KAAKuO,IAAIk8B,EAAQE,IAOC90B,EAAQuqB,qBAAuB,SAASA,qBAAqB65B,GACtF,IAAIv6B,EAAQu6B,EAAMv6B,MACdC,EAASs6B,EAAMt6B,OACfC,EAAeq6B,EAAMr6B,aACrBC,EAAgBo6B,EAAMp6B,cACtBlE,EAAas+B,EAAMt+B,WAEnBu+B,EAAQ75B,EAAS,CACnBX,MAAOE,EACPD,OAAQE,EACRlE,WAAYA,IAEVw+B,EAAQv6B,EAAeC,EAAgBD,EAAeF,EAAQG,EAAgBF,EAClF,OAAOu6B,EAAQ,EAAIC,EAAQD,EAAQC,GAGhBtkD,EAAQinB,eAAiB,SAASA,eAAeyC,GACpE,OAAOA,EAAIS,aAAeT,EAAIK,cAAgBL,EAAI6K,cAAgB7K,EAAIM,gB,oCCtExE57B,OAAO2yB,eAAe/gB,EAAS,aAAc,CAC3CzY,OAAO,IAGT,IAAI66B,EAAWh0B,OAAOi0B,QAAU,SAAU7rB,GAAU,IAAK,IAAIhN,EAAI,EAAGA,EAAIqW,UAAUtW,OAAQC,IAAK,CAAE,IAAI84B,EAASziB,UAAUrW,GAAI,IAAK,IAAIrC,KAAOm7B,EAAcl0B,OAAOtD,UAAUiX,eAAe9U,KAAKq1B,EAAQn7B,KAAQqP,EAAOrP,GAAOm7B,EAAOn7B,IAAY,OAAOqP,GAEnP+rB,EAAe,WAAc,SAAS/yB,iBAAiBgH,EAAQgsB,GAAS,IAAK,IAAIh5B,EAAI,EAAGA,EAAIg5B,EAAMj5B,OAAQC,IAAK,CAAE,IAAIi5B,EAAaD,EAAMh5B,GAAIi5B,EAAWC,WAAaD,EAAWC,aAAc,EAAOD,EAAW3zB,cAAe,EAAU,UAAW2zB,IAAYA,EAAWE,UAAW,GAAMv0B,OAAO2yB,eAAevqB,EAAQisB,EAAWt7B,IAAKs7B,IAAiB,OAAO,SAAUG,EAAaC,EAAYC,GAAiJ,OAA9HD,GAAYrzB,iBAAiBozB,EAAY93B,UAAW+3B,GAAiBC,GAAatzB,iBAAiBozB,EAAaE,GAAqBF,GAA7gB,GAEfG,EAAS,EAAQ,QAEjBC,EAAUC,uBAAuBF,GAEjCG,EAAa,EAAQ,QAIrBC,EAAaF,uBAFD,EAAQ,SAIxB,SAASA,uBAAuB3hB,GAAO,OAAOA,GAAOA,EAAIkiB,WAAaliB,EAAM,CAAEoR,QAASpR,GAQvF,IAAIijD,EAAU,SAAUC,GAGtB,SAASD,QAAQ/hC,IATnB,SAASqB,gBAAgB5hB,EAAU2gB,GAAe,KAAM3gB,aAAoB2gB,GAAgB,MAAM,IAAIkB,UAAU,qCAU5GD,CAAgBn5B,KAAM65D,SAEtB,IAAIxgC,EAVR,SAASC,2BAA2BnjB,EAAM5T,GAAQ,IAAK4T,EAAQ,MAAM,IAAIojB,eAAe,6DAAgE,OAAOh3B,GAAyB,iBAATA,GAAqC,mBAATA,EAA8B4T,EAAP5T,EAUlN+2B,CAA2Bt5B,MAAO65D,QAAQr3D,WAAakB,OAAO81B,eAAeqgC,UAAUt3D,KAAKvC,KAAM83B,IAK9G,OAHAuB,EAAMvjB,MAAQ,CACZikD,WAAW,GAEN1gC,EAsBT,OAnCF,SAASc,UAAUC,EAAUC,GAAc,GAA0B,mBAAfA,GAA4C,OAAfA,EAAuB,MAAM,IAAIjB,UAAU,kEAAoEiB,GAAeD,EAASh6B,UAAYsD,OAAOC,OAAO02B,GAAcA,EAAWj6B,UAAW,CAAEwD,YAAa,CAAE/G,MAAOu9B,EAAUpC,YAAY,EAAOC,UAAU,EAAM7zB,cAAc,KAAei2B,IAAY32B,OAAO42B,eAAiB52B,OAAO42B,eAAeF,EAAUC,GAAcD,EAAS53B,UAAY63B,GAG/dF,CAAU0/B,QAASC,GAanBjiC,EAAagiC,QAAS,CAAC,CACrBp9D,IAAK,oBACLI,MAAO,SAAS0hC,oBACdv+B,KAAKw8B,SAAS,CAAEu9B,WAAW,MAE5B,CACDt9D,IAAK,SACLI,MAAO,SAASi+B,SACd,OAAOxC,EAAQtQ,QAAQ6N,cAAc,MAAO,CAAE1mB,MAAOnP,KAAKg6D,gBAE3D,CACDv9D,IAAK,YACLI,MAAO,SAASm9D,YACd,IACIxiC,EAAsB,GADVx3B,KAAK8V,MAAMikD,WAAa/5D,KAAK83B,MAAMgH,WAEnD,OAAOpH,EAAS,GAAIe,EAAWzQ,QAAQyC,OAAO6M,QAAS,CAAEE,QAASA,GAAWx3B,KAAK83B,MAAMmD,cAAc3D,aAInGuiC,QAjCK,CAkCZxhC,EAAO4hC,eAET3kD,EAAQ0S,QAAU6xC,EAGlBA,EAAQl8B,UAAY,CAClBmB,UAAWtG,EAAWuF,KAAKhV,WAC3BkS,cAAezC,EAAWh0B,OAAOukB,a,kCCpEnC,IAAI1U,EAAc,EAAQ,QACtB6lD,EAAc,EAAQ,QAAkCA,YACxDC,EAAW,EAAQ,QACnB1lD,EAAW,EAAQ,QACnB2lD,EAAa,EAAQ,QACrBC,EAAU,EAAQ,QAClBC,EAAuB,EAAQ,QAC/BC,EAAO,EAAQ,QACfC,EAAsB,EAAQ,QAE9BC,EAAmBD,EAAoBv+D,IACvCy+D,EAAyBF,EAAoBG,UAC7C5+C,EAAOu+C,EAAqBv+C,KAC5B1c,EAAYi7D,EAAqBj7D,UACjCjE,EAAK,EAGLw/D,oBAAsB,SAAUC,GAClC,OAAOA,EAAM9kD,SAAW8kD,EAAM9kD,OAAS,IAAI+kD,sBAGzCA,oBAAsB,WACxB96D,KAAK+6D,QAAU,IAGbC,mBAAqB,SAAUH,EAAOp+D,GACxC,OAAOsf,EAAK8+C,EAAME,SAAS,SAAUE,GACnC,OAAOA,EAAG,KAAOx+D,MAIrBq+D,oBAAoB16D,UAAY,CAC9BnB,IAAK,SAAUxC,GACb,IAAIy+D,EAAQF,mBAAmBh7D,KAAMvD,GACrC,GAAIy+D,EAAO,OAAOA,EAAM,IAE1B37D,IAAK,SAAU9C,GACb,QAASu+D,mBAAmBh7D,KAAMvD,IAEpCR,IAAK,SAAUQ,EAAKI,GAClB,IAAIq+D,EAAQF,mBAAmBh7D,KAAMvD,GACjCy+D,EAAOA,EAAM,GAAKr+D,EACjBmD,KAAK+6D,QAAQ78D,KAAK,CAACzB,EAAKI,KAE/B,OAAU,SAAUJ,GAClB,IAAI6D,EAAQjB,EAAUW,KAAK+6D,SAAS,SAAUE,GAC5C,OAAOA,EAAG,KAAOx+D,KAGnB,OADK6D,GAAON,KAAK+6D,QAAQ57D,OAAOmB,EAAO,MAC7BA,IAId+U,EAAOC,QAAU,CACfC,eAAgB,SAAUP,EAASmmD,EAAkBC,EAAQC,GAC3D,IAAIvkD,EAAI9B,GAAQ,SAAUsmD,EAAMC,GAC9BnB,EAAWkB,EAAMxkD,EAAGqkD,GACpBV,EAAiBa,EAAM,CACrB31D,KAAMw1D,EACN//D,GAAIA,IACJ2a,YAAQxZ,IAEMA,MAAZg/D,GAAuBlB,EAAQkB,EAAUD,EAAKD,GAAQ,CAAEC,KAAMA,EAAME,WAAYJ,OAGlFK,EAAmBf,EAAuBS,GAE1CO,OAAS,SAAUJ,EAAM7+D,EAAKI,GAChC,IAAIiZ,EAAQ2lD,EAAiBH,GACzBjhD,EAAO6/C,EAAYC,EAAS19D,IAAM,GAGtC,OAFa,IAAT4d,EAAeugD,oBAAoB9kD,GAAO7Z,IAAIQ,EAAKI,GAClDwd,EAAKvE,EAAM1a,IAAMyB,EACfy+D,GA6CT,OA1CAjnD,EAAYyC,EAAE1W,UAAW,CAGvB,OAAU,SAAU3D,GAClB,IAAIqZ,EAAQ2lD,EAAiBz7D,MAC7B,IAAKyU,EAAShY,GAAM,OAAO,EAC3B,IAAI4d,EAAO6/C,EAAYz9D,GACvB,OAAa,IAAT4d,EAAsBugD,oBAAoB9kD,GAAe,OAAErZ,GACxD4d,GAAQkgD,EAAKlgD,EAAMvE,EAAM1a,YAAcif,EAAKvE,EAAM1a,KAI3DmE,IAAK,SAASA,IAAI9C,GAChB,IAAIqZ,EAAQ2lD,EAAiBz7D,MAC7B,IAAKyU,EAAShY,GAAM,OAAO,EAC3B,IAAI4d,EAAO6/C,EAAYz9D,GACvB,OAAa,IAAT4d,EAAsBugD,oBAAoB9kD,GAAOvW,IAAI9C,GAClD4d,GAAQkgD,EAAKlgD,EAAMvE,EAAM1a,OAIpCiZ,EAAYyC,EAAE1W,UAAWg7D,EAAS,CAEhCn8D,IAAK,SAASA,IAAIxC,GAChB,IAAIqZ,EAAQ2lD,EAAiBz7D,MAC7B,GAAIyU,EAAShY,GAAM,CACjB,IAAI4d,EAAO6/C,EAAYz9D,GACvB,OAAa,IAAT4d,EAAsBugD,oBAAoB9kD,GAAO7W,IAAIxC,GAClD4d,EAAOA,EAAKvE,EAAM1a,SAAMmB,IAInCN,IAAK,SAASA,IAAIQ,EAAKI,GACrB,OAAO6+D,OAAO17D,KAAMvD,EAAKI,KAEzB,CAEFmC,IAAK,SAASA,IAAInC,GAChB,OAAO6+D,OAAO17D,KAAMnD,GAAO,MAIxBia,K,kCCpHXpT,OAAO2yB,eAAe/gB,EAAS,aAAc,CAC3CzY,OAAO,IAET,IAAI8+D,EAAW,CACbz7B,KAAM,CAAC,SACPsJ,QAAS,IAmCLoyB,EAAQ,SAASA,MAAM57B,GAC3B,IAAIwJ,EAAUxJ,EAAKwJ,QACftJ,EAAOF,EAAKE,KAChB,OAAO,SAAU/5B,GACf,OAAOA,EAAEqjC,QAAUrjC,EAAEqjC,UAAYA,GAAmC,IAAzBtJ,EAAKnhC,QAAQoH,EAAE1J,OAS1Do/D,GAJuBvmD,EAAQ0nB,qBAAuB,SAASA,qBAAqB72B,GACtF,OAAOy1D,EAAMD,EAANC,CAAgBz1D,IAAM01D,EAAc11D,IAE9BmP,EAAQ+iD,SAAWuD,EA5CrB,CACX17B,KAAM,CAAC,OACPsJ,QAAS,IA2CSl0B,EAAQumD,cAAgBD,EAxC1B,CAChB17B,KAAM,CAAC,KACPsJ,QAAS,MAuCOl0B,EAAQkjD,YAAcoD,EApCxB,CACd17B,KAAM,CAAC,SAAU,OACjBsJ,QAAS,M,qBCtBX,IAAI+qB,EAAI,EAAQ,QACZ//B,EAAc,EAAQ,QAK1B+/B,EAAE,CAAEzoD,OAAQ,QAAS4oD,OAAO,EAAME,OAAQpgC,IAAgB,GAAGA,aAAe,CAC1EA,YAAaA,K,kCCNf,IAAI+/B,EAAI,EAAQ,QACZuH,EAAa,EAAQ,QAKzBvH,EAAE,CAAEzoD,OAAQ,SAAU4oD,OAAO,EAAME,OAJN,EAAQ,OAIMmH,CAAuB,UAAY,CAC5EC,MAAO,SAASA,QACd,OAAOF,EAAW97D,KAAM,KAAM,GAAI","file":"vendors~collection~document~shared-document.2870ed786ec0dc1c7436.js","sourcesContent":["import { useEffect } from 'react';\n\nfunction useUnmountEffect(callback) {\n    return useEffect(function () { return function () { return callback(); }; }, []);\n}\n\nexport { useUnmountEffect };\n","import * as React from 'react';\nimport { useMemo } from 'react';\nimport { PresenceContext } from '../../context/PresenceContext.js';\nimport { useConstant } from '../../utils/use-constant.js';\n\nvar presenceId = 0;\nfunction getPresenceId() {\n    var id = presenceId;\n    presenceId++;\n    return id;\n}\nvar PresenceChild = function (_a) {\n    var children = _a.children, initial = _a.initial, isPresent = _a.isPresent, onExitComplete = _a.onExitComplete, custom = _a.custom, presenceAffectsLayout = _a.presenceAffectsLayout;\n    var presenceChildren = useConstant(newChildrenMap);\n    var id = useConstant(getPresenceId);\n    var context = useMemo(function () { return ({\n        id: id,\n        initial: initial,\n        isPresent: isPresent,\n        custom: custom,\n        onExitComplete: function (childId) {\n            presenceChildren.set(childId, true);\n            var allComplete = true;\n            presenceChildren.forEach(function (isComplete) {\n                if (!isComplete)\n                    allComplete = false;\n            });\n            allComplete && (onExitComplete === null || onExitComplete === void 0 ? void 0 : onExitComplete());\n        },\n        register: function (childId) {\n            presenceChildren.set(childId, false);\n            return function () { return presenceChildren.delete(childId); };\n        },\n    }); }, \n    /**\n     * If the presence of a child affects the layout of the components around it,\n     * we want to make a new context value to ensure they get re-rendered\n     * so they can detect that layout change.\n     */\n    presenceAffectsLayout ? undefined : [isPresent]);\n    useMemo(function () {\n        presenceChildren.forEach(function (_, key) { return presenceChildren.set(key, false); });\n    }, [isPresent]);\n    /**\n     * If there's no `motion` components to fire exit animations, we want to remove this\n     * component immediately.\n     */\n    React.useEffect(function () {\n        !isPresent && !presenceChildren.size && (onExitComplete === null || onExitComplete === void 0 ? void 0 : onExitComplete());\n    }, [isPresent]);\n    return (React.createElement(PresenceContext.Provider, { value: context }, children));\n};\nfunction newChildrenMap() {\n    return new Map();\n}\n\nexport { PresenceChild };\n","import { __spreadArray, __read } from 'tslib';\nimport * as React from 'react';\nimport { useContext, useRef, cloneElement, Children, isValidElement } from 'react';\nimport { useForceUpdate } from '../../utils/use-force-update.js';\nimport { PresenceChild } from './PresenceChild.js';\nimport { SharedLayoutContext, isSharedLayout } from '../../context/SharedLayoutContext.js';\n\nfunction getChildKey(child) {\n    return child.key || \"\";\n}\nfunction updateChildLookup(children, allChildren) {\n    var seenChildren = process.env.NODE_ENV !== \"production\" ? new Set() : null;\n    children.forEach(function (child) {\n        var key = getChildKey(child);\n        if (process.env.NODE_ENV !== \"production\" && seenChildren) {\n            if (seenChildren.has(key)) {\n                console.warn(\"Children of AnimatePresence require unique keys. \\\"\" + key + \"\\\" is a duplicate.\");\n            }\n            seenChildren.add(key);\n        }\n        allChildren.set(key, child);\n    });\n}\nfunction onlyElements(children) {\n    var filtered = [];\n    // We use forEach here instead of map as map mutates the component key by preprending `.$`\n    Children.forEach(children, function (child) {\n        if (isValidElement(child))\n            filtered.push(child);\n    });\n    return filtered;\n}\n/**\n * `AnimatePresence` enables the animation of components that have been removed from the tree.\n *\n * When adding/removing more than a single child, every child **must** be given a unique `key` prop.\n *\n * @library\n *\n * Any `Frame` components that have an `exit` property defined will animate out when removed from\n * the tree.\n *\n * ```jsx\n * import { Frame, AnimatePresence } from 'framer'\n *\n * // As items are added and removed from `items`\n * export function Items({ items }) {\n *   return (\n *     <AnimatePresence>\n *       {items.map(item => (\n *         <Frame\n *           key={item.id}\n *           initial={{ opacity: 0 }}\n *           animate={{ opacity: 1 }}\n *           exit={{ opacity: 0 }}\n *         />\n *       ))}\n *     </AnimatePresence>\n *   )\n * }\n * ```\n *\n * You can sequence exit animations throughout a tree using variants.\n *\n * @motion\n *\n * Any `motion` components that have an `exit` property defined will animate out when removed from\n * the tree.\n *\n * ```jsx\n * import { motion, AnimatePresence } from 'framer-motion'\n *\n * export const Items = ({ items }) => (\n *   <AnimatePresence>\n *     {items.map(item => (\n *       <motion.div\n *         key={item.id}\n *         initial={{ opacity: 0 }}\n *         animate={{ opacity: 1 }}\n *         exit={{ opacity: 0 }}\n *       />\n *     ))}\n *   </AnimatePresence>\n * )\n * ```\n *\n * You can sequence exit animations throughout a tree using variants.\n *\n * If a child contains multiple `motion` components with `exit` props, it will only unmount the child\n * once all `motion` components have finished animating out. Likewise, any components using\n * `usePresence` all need to call `safeToRemove`.\n *\n * @public\n */\nvar AnimatePresence = function (_a) {\n    var children = _a.children, custom = _a.custom, _b = _a.initial, initial = _b === void 0 ? true : _b, onExitComplete = _a.onExitComplete, exitBeforeEnter = _a.exitBeforeEnter, _c = _a.presenceAffectsLayout, presenceAffectsLayout = _c === void 0 ? true : _c;\n    // We want to force a re-render once all exiting animations have finished. We\n    // either use a local forceRender function, or one from a parent context if it exists.\n    var forceRender = useForceUpdate();\n    var layoutContext = useContext(SharedLayoutContext);\n    if (isSharedLayout(layoutContext)) {\n        forceRender = layoutContext.forceUpdate;\n    }\n    var isInitialRender = useRef(true);\n    // Filter out any children that aren't ReactElements. We can only track ReactElements with a props.key\n    var filteredChildren = onlyElements(children);\n    // Keep a living record of the children we're actually rendering so we\n    // can diff to figure out which are entering and exiting\n    var presentChildren = useRef(filteredChildren);\n    // A lookup table to quickly reference components by key\n    var allChildren = useRef(new Map())\n        .current;\n    // A living record of all currently exiting components.\n    var exiting = useRef(new Set()).current;\n    updateChildLookup(filteredChildren, allChildren);\n    // If this is the initial component render, just deal with logic surrounding whether\n    // we play onMount animations or not.\n    if (isInitialRender.current) {\n        isInitialRender.current = false;\n        return (React.createElement(React.Fragment, null, filteredChildren.map(function (child) { return (React.createElement(PresenceChild, { key: getChildKey(child), isPresent: true, initial: initial ? undefined : false, presenceAffectsLayout: presenceAffectsLayout }, child)); })));\n    }\n    // If this is a subsequent render, deal with entering and exiting children\n    var childrenToRender = __spreadArray([], __read(filteredChildren));\n    // Diff the keys of the currently-present and target children to update our\n    // exiting list.\n    var presentKeys = presentChildren.current.map(getChildKey);\n    var targetKeys = filteredChildren.map(getChildKey);\n    // Diff the present children with our target children and mark those that are exiting\n    var numPresent = presentKeys.length;\n    for (var i = 0; i < numPresent; i++) {\n        var key = presentKeys[i];\n        if (targetKeys.indexOf(key) === -1) {\n            exiting.add(key);\n        }\n        else {\n            // In case this key has re-entered, remove from the exiting list\n            exiting.delete(key);\n        }\n    }\n    // If we currently have exiting children, and we're deferring rendering incoming children\n    // until after all current children have exiting, empty the childrenToRender array\n    if (exitBeforeEnter && exiting.size) {\n        childrenToRender = [];\n    }\n    // Loop through all currently exiting components and clone them to overwrite `animate`\n    // with any `exit` prop they might have defined.\n    exiting.forEach(function (key) {\n        // If this component is actually entering again, early return\n        if (targetKeys.indexOf(key) !== -1)\n            return;\n        var child = allChildren.get(key);\n        if (!child)\n            return;\n        var insertionIndex = presentKeys.indexOf(key);\n        var onExit = function () {\n            allChildren.delete(key);\n            exiting.delete(key);\n            // Remove this child from the present children\n            var removeIndex = presentChildren.current.findIndex(function (presentChild) { return presentChild.key === key; });\n            presentChildren.current.splice(removeIndex, 1);\n            // Defer re-rendering until all exiting children have indeed left\n            if (!exiting.size) {\n                presentChildren.current = filteredChildren;\n                forceRender();\n                onExitComplete && onExitComplete();\n            }\n        };\n        childrenToRender.splice(insertionIndex, 0, React.createElement(PresenceChild, { key: getChildKey(child), isPresent: false, onExitComplete: onExit, custom: custom, presenceAffectsLayout: presenceAffectsLayout }, child));\n    });\n    // Add `MotionContext` even to children that don't need it to ensure we're rendering\n    // the same tree between renders\n    childrenToRender = childrenToRender.map(function (child) {\n        var key = child.key;\n        return exiting.has(key) ? (child) : (React.createElement(PresenceChild, { key: getChildKey(child), isPresent: true, presenceAffectsLayout: presenceAffectsLayout }, child));\n    });\n    presentChildren.current = childrenToRender;\n    if (process.env.NODE_ENV !== \"production\" &&\n        exitBeforeEnter &&\n        childrenToRender.length > 1) {\n        console.warn(\"You're attempting to animate multiple children within AnimatePresence, but its exitBeforeEnter prop is set to true. This will lead to odd visual behaviour.\");\n    }\n    return (React.createElement(React.Fragment, null, exiting.size\n        ? childrenToRender\n        : childrenToRender.map(function (child) { return cloneElement(child); })));\n};\n\nexport { AnimatePresence };\n","import { __read } from 'tslib';\nimport { useCallback, useRef, useState } from 'react';\nimport { useUnmountEffect } from './use-unmount-effect.js';\n\nfunction useForceUpdate() {\n    var unloadingRef = useRef(false);\n    var _a = __read(useState(0), 2), forcedRenderCount = _a[0], setForcedRenderCount = _a[1];\n    useUnmountEffect(function () { return (unloadingRef.current = true); });\n    return useCallback(function () {\n        !unloadingRef.current && setForcedRenderCount(forcedRenderCount + 1);\n    }, [forcedRenderCount]);\n}\n\nexport { useForceUpdate };\n","import { ReplaceError, Slice, Fragment, MarkType } from 'prosemirror-model';\n\n// Mappable:: interface\n// There are several things that positions can be mapped through.\n// Such objects conform to this interface.\n//\n//   map:: (pos: number, assoc: ?number) → number\n//   Map a position through this object. When given, `assoc` (should\n//   be -1 or 1, defaults to 1) determines with which side the\n//   position is associated, which determines in which direction to\n//   move when a chunk of content is inserted at the mapped position.\n//\n//   mapResult:: (pos: number, assoc: ?number) → MapResult\n//   Map a position, and return an object containing additional\n//   information about the mapping. The result's `deleted` field tells\n//   you whether the position was deleted (completely enclosed in a\n//   replaced range) during the mapping. When content on only one side\n//   is deleted, the position itself is only considered deleted when\n//   `assoc` points in the direction of the deleted content.\n\n// Recovery values encode a range index and an offset. They are\n// represented as numbers, because tons of them will be created when\n// mapping, for example, a large number of decorations. The number's\n// lower 16 bits provide the index, the remaining bits the offset.\n//\n// Note: We intentionally don't use bit shift operators to en- and\n// decode these, since those clip to 32 bits, which we might in rare\n// cases want to overflow. A 64-bit float can represent 48-bit\n// integers precisely.\n\nvar lower16 = 0xffff;\nvar factor16 = Math.pow(2, 16);\n\nfunction makeRecover(index, offset) { return index + offset * factor16 }\nfunction recoverIndex(value) { return value & lower16 }\nfunction recoverOffset(value) { return (value - (value & lower16)) / factor16 }\n\n// ::- An object representing a mapped position with extra\n// information.\nvar MapResult = function MapResult(pos, deleted, recover) {\n  if ( deleted === void 0 ) deleted = false;\n  if ( recover === void 0 ) recover = null;\n\n  // :: number The mapped version of the position.\n  this.pos = pos;\n  // :: bool Tells you whether the position was deleted, that is,\n  // whether the step removed its surroundings from the document.\n  this.deleted = deleted;\n  this.recover = recover;\n};\n\n// :: class extends Mappable\n// A map describing the deletions and insertions made by a step, which\n// can be used to find the correspondence between positions in the\n// pre-step version of a document and the same position in the\n// post-step version.\nvar StepMap = function StepMap(ranges, inverted) {\n  if ( inverted === void 0 ) inverted = false;\n\n  this.ranges = ranges;\n  this.inverted = inverted;\n};\n\nStepMap.prototype.recover = function recover (value) {\n  var diff = 0, index = recoverIndex(value);\n  if (!this.inverted) { for (var i = 0; i < index; i++)\n    { diff += this.ranges[i * 3 + 2] - this.ranges[i * 3 + 1]; } }\n  return this.ranges[index * 3] + diff + recoverOffset(value)\n};\n\n// : (number, ?number) → MapResult\nStepMap.prototype.mapResult = function mapResult (pos, assoc) {\n  if ( assoc === void 0 ) assoc = 1;\n return this._map(pos, assoc, false) };\n\n// : (number, ?number) → number\nStepMap.prototype.map = function map (pos, assoc) {\n  if ( assoc === void 0 ) assoc = 1;\n return this._map(pos, assoc, true) };\n\nStepMap.prototype._map = function _map (pos, assoc, simple) {\n  var diff = 0, oldIndex = this.inverted ? 2 : 1, newIndex = this.inverted ? 1 : 2;\n  for (var i = 0; i < this.ranges.length; i += 3) {\n    var start = this.ranges[i] - (this.inverted ? diff : 0);\n    if (start > pos) { break }\n    var oldSize = this.ranges[i + oldIndex], newSize = this.ranges[i + newIndex], end = start + oldSize;\n    if (pos <= end) {\n      var side = !oldSize ? assoc : pos == start ? -1 : pos == end ? 1 : assoc;\n      var result = start + diff + (side < 0 ? 0 : newSize);\n      if (simple) { return result }\n      var recover = makeRecover(i / 3, pos - start);\n      return new MapResult(result, assoc < 0 ? pos != start : pos != end, recover)\n    }\n    diff += newSize - oldSize;\n  }\n  return simple ? pos + diff : new MapResult(pos + diff)\n};\n\nStepMap.prototype.touches = function touches (pos, recover) {\n  var diff = 0, index = recoverIndex(recover);\n  var oldIndex = this.inverted ? 2 : 1, newIndex = this.inverted ? 1 : 2;\n  for (var i = 0; i < this.ranges.length; i += 3) {\n    var start = this.ranges[i] - (this.inverted ? diff : 0);\n    if (start > pos) { break }\n    var oldSize = this.ranges[i + oldIndex], end = start + oldSize;\n    if (pos <= end && i == index * 3) { return true }\n    diff += this.ranges[i + newIndex] - oldSize;\n  }\n  return false\n};\n\n// :: ((oldStart: number, oldEnd: number, newStart: number, newEnd: number))\n// Calls the given function on each of the changed ranges included in\n// this map.\nStepMap.prototype.forEach = function forEach (f) {\n  var oldIndex = this.inverted ? 2 : 1, newIndex = this.inverted ? 1 : 2;\n  for (var i = 0, diff = 0; i < this.ranges.length; i += 3) {\n    var start = this.ranges[i], oldStart = start - (this.inverted ? diff : 0), newStart = start + (this.inverted ? 0 : diff);\n    var oldSize = this.ranges[i + oldIndex], newSize = this.ranges[i + newIndex];\n    f(oldStart, oldStart + oldSize, newStart, newStart + newSize);\n    diff += newSize - oldSize;\n  }\n};\n\n// :: () → StepMap\n// Create an inverted version of this map. The result can be used to\n// map positions in the post-step document to the pre-step document.\nStepMap.prototype.invert = function invert () {\n  return new StepMap(this.ranges, !this.inverted)\n};\n\nStepMap.prototype.toString = function toString () {\n  return (this.inverted ? \"-\" : \"\") + JSON.stringify(this.ranges)\n};\n\n// :: (n: number) → StepMap\n// Create a map that moves all positions by offset `n` (which may be\n// negative). This can be useful when applying steps meant for a\n// sub-document to a larger document, or vice-versa.\nStepMap.offset = function offset (n) {\n  return n == 0 ? StepMap.empty : new StepMap(n < 0 ? [0, -n, 0] : [0, 0, n])\n};\n\nStepMap.empty = new StepMap([]);\n\n// :: class extends Mappable\n// A mapping represents a pipeline of zero or more [step\n// maps](#transform.StepMap). It has special provisions for losslessly\n// handling mapping positions through a series of steps in which some\n// steps are inverted versions of earlier steps. (This comes up when\n// ‘[rebasing](/docs/guide/#transform.rebasing)’ steps for\n// collaboration or history management.)\nvar Mapping = function Mapping(maps, mirror, from, to) {\n  // :: [StepMap]\n  // The step maps in this mapping.\n  this.maps = maps || [];\n  // :: number\n  // The starting position in the `maps` array, used when `map` or\n  // `mapResult` is called.\n  this.from = from || 0;\n  // :: number\n  // The end position in the `maps` array.\n  this.to = to == null ? this.maps.length : to;\n  this.mirror = mirror;\n};\n\n// :: (?number, ?number) → Mapping\n// Create a mapping that maps only through a part of this one.\nMapping.prototype.slice = function slice (from, to) {\n    if ( from === void 0 ) from = 0;\n    if ( to === void 0 ) to = this.maps.length;\n\n  return new Mapping(this.maps, this.mirror, from, to)\n};\n\nMapping.prototype.copy = function copy () {\n  return new Mapping(this.maps.slice(), this.mirror && this.mirror.slice(), this.from, this.to)\n};\n\n// :: (StepMap, ?number)\n// Add a step map to the end of this mapping. If `mirrors` is\n// given, it should be the index of the step map that is the mirror\n// image of this one.\nMapping.prototype.appendMap = function appendMap (map, mirrors) {\n  this.to = this.maps.push(map);\n  if (mirrors != null) { this.setMirror(this.maps.length - 1, mirrors); }\n};\n\n// :: (Mapping)\n// Add all the step maps in a given mapping to this one (preserving\n// mirroring information).\nMapping.prototype.appendMapping = function appendMapping (mapping) {\n  for (var i = 0, startSize = this.maps.length; i < mapping.maps.length; i++) {\n    var mirr = mapping.getMirror(i);\n    this.appendMap(mapping.maps[i], mirr != null && mirr < i ? startSize + mirr : null);\n  }\n};\n\n// :: (number) → ?number\n// Finds the offset of the step map that mirrors the map at the\n// given offset, in this mapping (as per the second argument to\n// `appendMap`).\nMapping.prototype.getMirror = function getMirror (n) {\n  if (this.mirror) { for (var i = 0; i < this.mirror.length; i++)\n    { if (this.mirror[i] == n) { return this.mirror[i + (i % 2 ? -1 : 1)] } } }\n};\n\nMapping.prototype.setMirror = function setMirror (n, m) {\n  if (!this.mirror) { this.mirror = []; }\n  this.mirror.push(n, m);\n};\n\n// :: (Mapping)\n// Append the inverse of the given mapping to this one.\nMapping.prototype.appendMappingInverted = function appendMappingInverted (mapping) {\n  for (var i = mapping.maps.length - 1, totalSize = this.maps.length + mapping.maps.length; i >= 0; i--) {\n    var mirr = mapping.getMirror(i);\n    this.appendMap(mapping.maps[i].invert(), mirr != null && mirr > i ? totalSize - mirr - 1 : null);\n  }\n};\n\n// :: () → Mapping\n// Create an inverted version of this mapping.\nMapping.prototype.invert = function invert () {\n  var inverse = new Mapping;\n  inverse.appendMappingInverted(this);\n  return inverse\n};\n\n// : (number, ?number) → number\n// Map a position through this mapping.\nMapping.prototype.map = function map (pos, assoc) {\n    if ( assoc === void 0 ) assoc = 1;\n\n  if (this.mirror) { return this._map(pos, assoc, true) }\n  for (var i = this.from; i < this.to; i++)\n    { pos = this.maps[i].map(pos, assoc); }\n  return pos\n};\n\n// : (number, ?number) → MapResult\n// Map a position through this mapping, returning a mapping\n// result.\nMapping.prototype.mapResult = function mapResult (pos, assoc) {\n  if ( assoc === void 0 ) assoc = 1;\n return this._map(pos, assoc, false) };\n\nMapping.prototype._map = function _map (pos, assoc, simple) {\n  var deleted = false, recoverables = null;\n\n  for (var i = this.from; i < this.to; i++) {\n    var map = this.maps[i], rec = recoverables && recoverables[i];\n    if (rec != null && map.touches(pos, rec)) {\n      pos = map.recover(rec);\n      continue\n    }\n\n    var result = map.mapResult(pos, assoc);\n    if (result.recover != null) {\n      var corr = this.getMirror(i);\n      if (corr != null && corr > i && corr < this.to) {\n        if (result.deleted) {\n          i = corr;\n          pos = this.maps[corr].recover(result.recover);\n          continue\n        } else {\n(recoverables || (recoverables = Object.create(null)))[corr] = result.recover;\n        }\n      }\n    }\n\n    if (result.deleted) { deleted = true; }\n    pos = result.pos;\n  }\n\n  return simple ? pos : new MapResult(pos, deleted)\n};\n\nfunction TransformError(message) {\n  var err = Error.call(this, message);\n  err.__proto__ = TransformError.prototype;\n  return err\n}\n\nTransformError.prototype = Object.create(Error.prototype);\nTransformError.prototype.constructor = TransformError;\nTransformError.prototype.name = \"TransformError\";\n\n// ::- Abstraction to build up and track an array of\n// [steps](#transform.Step) representing a document transformation.\n//\n// Most transforming methods return the `Transform` object itself, so\n// that they can be chained.\nvar Transform = function Transform(doc) {\n  // :: Node\n  // The current document (the result of applying the steps in the\n  // transform).\n  this.doc = doc;\n  // :: [Step]\n  // The steps in this transform.\n  this.steps = [];\n  // :: [Node]\n  // The documents before each of the steps.\n  this.docs = [];\n  // :: Mapping\n  // A mapping with the maps for each of the steps in this transform.\n  this.mapping = new Mapping;\n};\n\nvar prototypeAccessors = { before: { configurable: true },docChanged: { configurable: true } };\n\n// :: Node The starting document.\nprototypeAccessors.before.get = function () { return this.docs.length ? this.docs[0] : this.doc };\n\n// :: (step: Step) → this\n// Apply a new step in this transform, saving the result. Throws an\n// error when the step fails.\nTransform.prototype.step = function step (object) {\n  var result = this.maybeStep(object);\n  if (result.failed) { throw new TransformError(result.failed) }\n  return this\n};\n\n// :: (Step) → StepResult\n// Try to apply a step in this transformation, ignoring it if it\n// fails. Returns the step result.\nTransform.prototype.maybeStep = function maybeStep (step) {\n  var result = step.apply(this.doc);\n  if (!result.failed) { this.addStep(step, result.doc); }\n  return result\n};\n\n// :: bool\n// True when the document has been changed (when there are any\n// steps).\nprototypeAccessors.docChanged.get = function () {\n  return this.steps.length > 0\n};\n\nTransform.prototype.addStep = function addStep (step, doc) {\n  this.docs.push(this.doc);\n  this.steps.push(step);\n  this.mapping.appendMap(step.getMap());\n  this.doc = doc;\n};\n\nObject.defineProperties( Transform.prototype, prototypeAccessors );\n\nfunction mustOverride() { throw new Error(\"Override me\") }\n\nvar stepsByID = Object.create(null);\n\n// ::- A step object represents an atomic change. It generally applies\n// only to the document it was created for, since the positions\n// stored in it will only make sense for that document.\n//\n// New steps are defined by creating classes that extend `Step`,\n// overriding the `apply`, `invert`, `map`, `getMap` and `fromJSON`\n// methods, and registering your class with a unique\n// JSON-serialization identifier using\n// [`Step.jsonID`](#transform.Step^jsonID).\nvar Step = function Step () {};\n\nStep.prototype.apply = function apply (_doc) { return mustOverride() };\n\n// :: () → StepMap\n// Get the step map that represents the changes made by this step,\n// and which can be used to transform between positions in the old\n// and the new document.\nStep.prototype.getMap = function getMap () { return StepMap.empty };\n\n// :: (doc: Node) → Step\n// Create an inverted version of this step. Needs the document as it\n// was before the step as argument.\nStep.prototype.invert = function invert (_doc) { return mustOverride() };\n\n// :: (mapping: Mappable) → ?Step\n// Map this step through a mappable thing, returning either a\n// version of that step with its positions adjusted, or `null` if\n// the step was entirely deleted by the mapping.\nStep.prototype.map = function map (_mapping) { return mustOverride() };\n\n// :: (other: Step) → ?Step\n// Try to merge this step with another one, to be applied directly\n// after it. Returns the merged step when possible, null if the\n// steps can't be merged.\nStep.prototype.merge = function merge (_other) { return null };\n\n// :: () → Object\n// Create a JSON-serializeable representation of this step. When\n// defining this for a custom subclass, make sure the result object\n// includes the step type's [JSON id](#transform.Step^jsonID) under\n// the `stepType` property.\nStep.prototype.toJSON = function toJSON () { return mustOverride() };\n\n// :: (Schema, Object) → Step\n// Deserialize a step from its JSON representation. Will call\n// through to the step class' own implementation of this method.\nStep.fromJSON = function fromJSON (schema, json) {\n  if (!json || !json.stepType) { throw new RangeError(\"Invalid input for Step.fromJSON\") }\n  var type = stepsByID[json.stepType];\n  if (!type) { throw new RangeError((\"No step type \" + (json.stepType) + \" defined\")) }\n  return type.fromJSON(schema, json)\n};\n\n// :: (string, constructor<Step>)\n// To be able to serialize steps to JSON, each step needs a string\n// ID to attach to its JSON representation. Use this method to\n// register an ID for your step classes. Try to pick something\n// that's unlikely to clash with steps from other modules.\nStep.jsonID = function jsonID (id, stepClass) {\n  if (id in stepsByID) { throw new RangeError(\"Duplicate use of step JSON ID \" + id) }\n  stepsByID[id] = stepClass;\n  stepClass.prototype.jsonID = id;\n  return stepClass\n};\n\n// ::- The result of [applying](#transform.Step.apply) a step. Contains either a\n// new document or a failure value.\nvar StepResult = function StepResult(doc, failed) {\n  // :: ?Node The transformed document.\n  this.doc = doc;\n  // :: ?string Text providing information about a failed step.\n  this.failed = failed;\n};\n\n// :: (Node) → StepResult\n// Create a successful step result.\nStepResult.ok = function ok (doc) { return new StepResult(doc, null) };\n\n// :: (string) → StepResult\n// Create a failed step result.\nStepResult.fail = function fail (message) { return new StepResult(null, message) };\n\n// :: (Node, number, number, Slice) → StepResult\n// Call [`Node.replace`](#model.Node.replace) with the given\n// arguments. Create a successful result if it succeeds, and a\n// failed one if it throws a `ReplaceError`.\nStepResult.fromReplace = function fromReplace (doc, from, to, slice) {\n  try {\n    return StepResult.ok(doc.replace(from, to, slice))\n  } catch (e) {\n    if (e instanceof ReplaceError) { return StepResult.fail(e.message) }\n    throw e\n  }\n};\n\n// ::- Replace a part of the document with a slice of new content.\nvar ReplaceStep = /*@__PURE__*/(function (Step) {\n  function ReplaceStep(from, to, slice, structure) {\n    Step.call(this);\n    this.from = from;\n    this.to = to;\n    this.slice = slice;\n    this.structure = !!structure;\n  }\n\n  if ( Step ) ReplaceStep.__proto__ = Step;\n  ReplaceStep.prototype = Object.create( Step && Step.prototype );\n  ReplaceStep.prototype.constructor = ReplaceStep;\n\n  ReplaceStep.prototype.apply = function apply (doc) {\n    if (this.structure && contentBetween(doc, this.from, this.to))\n      { return StepResult.fail(\"Structure replace would overwrite content\") }\n    return StepResult.fromReplace(doc, this.from, this.to, this.slice)\n  };\n\n  ReplaceStep.prototype.getMap = function getMap () {\n    return new StepMap([this.from, this.to - this.from, this.slice.size])\n  };\n\n  ReplaceStep.prototype.invert = function invert (doc) {\n    return new ReplaceStep(this.from, this.from + this.slice.size, doc.slice(this.from, this.to))\n  };\n\n  ReplaceStep.prototype.map = function map (mapping) {\n    var from = mapping.mapResult(this.from, 1), to = mapping.mapResult(this.to, -1);\n    if (from.deleted && to.deleted) { return null }\n    return new ReplaceStep(from.pos, Math.max(from.pos, to.pos), this.slice)\n  };\n\n  ReplaceStep.prototype.merge = function merge (other) {\n    if (!(other instanceof ReplaceStep) || other.structure != this.structure) { return null }\n\n    if (this.from + this.slice.size == other.from && !this.slice.openEnd && !other.slice.openStart) {\n      var slice = this.slice.size + other.slice.size == 0 ? Slice.empty\n          : new Slice(this.slice.content.append(other.slice.content), this.slice.openStart, other.slice.openEnd);\n      return new ReplaceStep(this.from, this.to + (other.to - other.from), slice, this.structure)\n    } else if (other.to == this.from && !this.slice.openStart && !other.slice.openEnd) {\n      var slice$1 = this.slice.size + other.slice.size == 0 ? Slice.empty\n          : new Slice(other.slice.content.append(this.slice.content), other.slice.openStart, this.slice.openEnd);\n      return new ReplaceStep(other.from, this.to, slice$1, this.structure)\n    } else {\n      return null\n    }\n  };\n\n  ReplaceStep.prototype.toJSON = function toJSON () {\n    var json = {stepType: \"replace\", from: this.from, to: this.to};\n    if (this.slice.size) { json.slice = this.slice.toJSON(); }\n    if (this.structure) { json.structure = true; }\n    return json\n  };\n\n  ReplaceStep.fromJSON = function fromJSON (schema, json) {\n    if (typeof json.from != \"number\" || typeof json.to != \"number\")\n      { throw new RangeError(\"Invalid input for ReplaceStep.fromJSON\") }\n    return new ReplaceStep(json.from, json.to, Slice.fromJSON(schema, json.slice), !!json.structure)\n  };\n\n  return ReplaceStep;\n}(Step));\n\nStep.jsonID(\"replace\", ReplaceStep);\n\n// ::- Replace a part of the document with a slice of content, but\n// preserve a range of the replaced content by moving it into the\n// slice.\nvar ReplaceAroundStep = /*@__PURE__*/(function (Step) {\n  function ReplaceAroundStep(from, to, gapFrom, gapTo, slice, insert, structure) {\n    Step.call(this);\n    this.from = from;\n    this.to = to;\n    this.gapFrom = gapFrom;\n    this.gapTo = gapTo;\n    this.slice = slice;\n    this.insert = insert;\n    this.structure = !!structure;\n  }\n\n  if ( Step ) ReplaceAroundStep.__proto__ = Step;\n  ReplaceAroundStep.prototype = Object.create( Step && Step.prototype );\n  ReplaceAroundStep.prototype.constructor = ReplaceAroundStep;\n\n  ReplaceAroundStep.prototype.apply = function apply (doc) {\n    if (this.structure && (contentBetween(doc, this.from, this.gapFrom) ||\n                           contentBetween(doc, this.gapTo, this.to)))\n      { return StepResult.fail(\"Structure gap-replace would overwrite content\") }\n\n    var gap = doc.slice(this.gapFrom, this.gapTo);\n    if (gap.openStart || gap.openEnd)\n      { return StepResult.fail(\"Gap is not a flat range\") }\n    var inserted = this.slice.insertAt(this.insert, gap.content);\n    if (!inserted) { return StepResult.fail(\"Content does not fit in gap\") }\n    return StepResult.fromReplace(doc, this.from, this.to, inserted)\n  };\n\n  ReplaceAroundStep.prototype.getMap = function getMap () {\n    return new StepMap([this.from, this.gapFrom - this.from, this.insert,\n                        this.gapTo, this.to - this.gapTo, this.slice.size - this.insert])\n  };\n\n  ReplaceAroundStep.prototype.invert = function invert (doc) {\n    var gap = this.gapTo - this.gapFrom;\n    return new ReplaceAroundStep(this.from, this.from + this.slice.size + gap,\n                                 this.from + this.insert, this.from + this.insert + gap,\n                                 doc.slice(this.from, this.to).removeBetween(this.gapFrom - this.from, this.gapTo - this.from),\n                                 this.gapFrom - this.from, this.structure)\n  };\n\n  ReplaceAroundStep.prototype.map = function map (mapping) {\n    var from = mapping.mapResult(this.from, 1), to = mapping.mapResult(this.to, -1);\n    var gapFrom = mapping.map(this.gapFrom, -1), gapTo = mapping.map(this.gapTo, 1);\n    if ((from.deleted && to.deleted) || gapFrom < from.pos || gapTo > to.pos) { return null }\n    return new ReplaceAroundStep(from.pos, to.pos, gapFrom, gapTo, this.slice, this.insert, this.structure)\n  };\n\n  ReplaceAroundStep.prototype.toJSON = function toJSON () {\n    var json = {stepType: \"replaceAround\", from: this.from, to: this.to,\n                gapFrom: this.gapFrom, gapTo: this.gapTo, insert: this.insert};\n    if (this.slice.size) { json.slice = this.slice.toJSON(); }\n    if (this.structure) { json.structure = true; }\n    return json\n  };\n\n  ReplaceAroundStep.fromJSON = function fromJSON (schema, json) {\n    if (typeof json.from != \"number\" || typeof json.to != \"number\" ||\n        typeof json.gapFrom != \"number\" || typeof json.gapTo != \"number\" || typeof json.insert != \"number\")\n      { throw new RangeError(\"Invalid input for ReplaceAroundStep.fromJSON\") }\n    return new ReplaceAroundStep(json.from, json.to, json.gapFrom, json.gapTo,\n                                 Slice.fromJSON(schema, json.slice), json.insert, !!json.structure)\n  };\n\n  return ReplaceAroundStep;\n}(Step));\n\nStep.jsonID(\"replaceAround\", ReplaceAroundStep);\n\nfunction contentBetween(doc, from, to) {\n  var $from = doc.resolve(from), dist = to - from, depth = $from.depth;\n  while (dist > 0 && depth > 0 && $from.indexAfter(depth) == $from.node(depth).childCount) {\n    depth--;\n    dist--;\n  }\n  if (dist > 0) {\n    var next = $from.node(depth).maybeChild($from.indexAfter(depth));\n    while (dist > 0) {\n      if (!next || next.isLeaf) { return true }\n      next = next.firstChild;\n      dist--;\n    }\n  }\n  return false\n}\n\nfunction canCut(node, start, end) {\n  return (start == 0 || node.canReplace(start, node.childCount)) &&\n    (end == node.childCount || node.canReplace(0, end))\n}\n\n// :: (NodeRange) → ?number\n// Try to find a target depth to which the content in the given range\n// can be lifted. Will not go across\n// [isolating](#model.NodeSpec.isolating) parent nodes.\nfunction liftTarget(range) {\n  var parent = range.parent;\n  var content = parent.content.cutByIndex(range.startIndex, range.endIndex);\n  for (var depth = range.depth;; --depth) {\n    var node = range.$from.node(depth);\n    var index = range.$from.index(depth), endIndex = range.$to.indexAfter(depth);\n    if (depth < range.depth && node.canReplace(index, endIndex, content))\n      { return depth }\n    if (depth == 0 || node.type.spec.isolating || !canCut(node, index, endIndex)) { break }\n  }\n}\n\n// :: (NodeRange, number) → this\n// Split the content in the given range off from its parent, if there\n// is sibling content before or after it, and move it up the tree to\n// the depth specified by `target`. You'll probably want to use\n// [`liftTarget`](#transform.liftTarget) to compute `target`, to make\n// sure the lift is valid.\nTransform.prototype.lift = function(range, target) {\n  var $from = range.$from;\n  var $to = range.$to;\n  var depth = range.depth;\n\n  var gapStart = $from.before(depth + 1), gapEnd = $to.after(depth + 1);\n  var start = gapStart, end = gapEnd;\n\n  var before = Fragment.empty, openStart = 0;\n  for (var d = depth, splitting = false; d > target; d--)\n    { if (splitting || $from.index(d) > 0) {\n      splitting = true;\n      before = Fragment.from($from.node(d).copy(before));\n      openStart++;\n    } else {\n      start--;\n    } }\n  var after = Fragment.empty, openEnd = 0;\n  for (var d$1 = depth, splitting$1 = false; d$1 > target; d$1--)\n    { if (splitting$1 || $to.after(d$1 + 1) < $to.end(d$1)) {\n      splitting$1 = true;\n      after = Fragment.from($to.node(d$1).copy(after));\n      openEnd++;\n    } else {\n      end++;\n    } }\n\n  return this.step(new ReplaceAroundStep(start, end, gapStart, gapEnd,\n                                         new Slice(before.append(after), openStart, openEnd),\n                                         before.size - openStart, true))\n};\n\n// :: (NodeRange, NodeType, ?Object, ?NodeRange) → ?[{type: NodeType, attrs: ?Object}]\n// Try to find a valid way to wrap the content in the given range in a\n// node of the given type. May introduce extra nodes around and inside\n// the wrapper node, if necessary. Returns null if no valid wrapping\n// could be found. When `innerRange` is given, that range's content is\n// used as the content to fit into the wrapping, instead of the\n// content of `range`.\nfunction findWrapping(range, nodeType, attrs, innerRange) {\n  if ( innerRange === void 0 ) innerRange = range;\n\n  var around = findWrappingOutside(range, nodeType);\n  var inner = around && findWrappingInside(innerRange, nodeType);\n  if (!inner) { return null }\n  return around.map(withAttrs).concat({type: nodeType, attrs: attrs}).concat(inner.map(withAttrs))\n}\n\nfunction withAttrs(type) { return {type: type, attrs: null} }\n\nfunction findWrappingOutside(range, type) {\n  var parent = range.parent;\n  var startIndex = range.startIndex;\n  var endIndex = range.endIndex;\n  var around = parent.contentMatchAt(startIndex).findWrapping(type);\n  if (!around) { return null }\n  var outer = around.length ? around[0] : type;\n  return parent.canReplaceWith(startIndex, endIndex, outer) ? around : null\n}\n\nfunction findWrappingInside(range, type) {\n  var parent = range.parent;\n  var startIndex = range.startIndex;\n  var endIndex = range.endIndex;\n  var inner = parent.child(startIndex);\n  var inside = type.contentMatch.findWrapping(inner.type);\n  if (!inside) { return null }\n  var lastType = inside.length ? inside[inside.length - 1] : type;\n  var innerMatch = lastType.contentMatch;\n  for (var i = startIndex; innerMatch && i < endIndex; i++)\n    { innerMatch = innerMatch.matchType(parent.child(i).type); }\n  if (!innerMatch || !innerMatch.validEnd) { return null }\n  return inside\n}\n\n// :: (NodeRange, [{type: NodeType, attrs: ?Object}]) → this\n// Wrap the given [range](#model.NodeRange) in the given set of wrappers.\n// The wrappers are assumed to be valid in this position, and should\n// probably be computed with [`findWrapping`](#transform.findWrapping).\nTransform.prototype.wrap = function(range, wrappers) {\n  var content = Fragment.empty;\n  for (var i = wrappers.length - 1; i >= 0; i--)\n    { content = Fragment.from(wrappers[i].type.create(wrappers[i].attrs, content)); }\n\n  var start = range.start, end = range.end;\n  return this.step(new ReplaceAroundStep(start, end, start, end, new Slice(content, 0, 0), wrappers.length, true))\n};\n\n// :: (number, ?number, NodeType, ?Object) → this\n// Set the type of all textblocks (partly) between `from` and `to` to\n// the given node type with the given attributes.\nTransform.prototype.setBlockType = function(from, to, type, attrs) {\n  var this$1 = this;\n  if ( to === void 0 ) to = from;\n\n  if (!type.isTextblock) { throw new RangeError(\"Type given to setBlockType should be a textblock\") }\n  var mapFrom = this.steps.length;\n  this.doc.nodesBetween(from, to, function (node, pos) {\n    if (node.isTextblock && !node.hasMarkup(type, attrs) && canChangeType(this$1.doc, this$1.mapping.slice(mapFrom).map(pos), type)) {\n      // Ensure all markup that isn't allowed in the new node type is cleared\n      this$1.clearIncompatible(this$1.mapping.slice(mapFrom).map(pos, 1), type);\n      var mapping = this$1.mapping.slice(mapFrom);\n      var startM = mapping.map(pos, 1), endM = mapping.map(pos + node.nodeSize, 1);\n      this$1.step(new ReplaceAroundStep(startM, endM, startM + 1, endM - 1,\n                                      new Slice(Fragment.from(type.create(attrs, null, node.marks)), 0, 0), 1, true));\n      return false\n    }\n  });\n  return this\n};\n\nfunction canChangeType(doc, pos, type) {\n  var $pos = doc.resolve(pos), index = $pos.index();\n  return $pos.parent.canReplaceWith(index, index + 1, type)\n}\n\n// :: (number, ?NodeType, ?Object, ?[Mark]) → this\n// Change the type, attributes, and/or marks of the node at `pos`.\n// When `type` isn't given, the existing node type is preserved,\nTransform.prototype.setNodeMarkup = function(pos, type, attrs, marks) {\n  var node = this.doc.nodeAt(pos);\n  if (!node) { throw new RangeError(\"No node at given position\") }\n  if (!type) { type = node.type; }\n  var newNode = type.create(attrs, null, marks || node.marks);\n  if (node.isLeaf)\n    { return this.replaceWith(pos, pos + node.nodeSize, newNode) }\n\n  if (!type.validContent(node.content))\n    { throw new RangeError(\"Invalid content for node type \" + type.name) }\n\n  return this.step(new ReplaceAroundStep(pos, pos + node.nodeSize, pos + 1, pos + node.nodeSize - 1,\n                                         new Slice(Fragment.from(newNode), 0, 0), 1, true))\n};\n\n// :: (Node, number, number, ?[?{type: NodeType, attrs: ?Object}]) → bool\n// Check whether splitting at the given position is allowed.\nfunction canSplit(doc, pos, depth, typesAfter) {\n  if ( depth === void 0 ) depth = 1;\n\n  var $pos = doc.resolve(pos), base = $pos.depth - depth;\n  var innerType = (typesAfter && typesAfter[typesAfter.length - 1]) || $pos.parent;\n  if (base < 0 || $pos.parent.type.spec.isolating ||\n      !$pos.parent.canReplace($pos.index(), $pos.parent.childCount) ||\n      !innerType.type.validContent($pos.parent.content.cutByIndex($pos.index(), $pos.parent.childCount)))\n    { return false }\n  for (var d = $pos.depth - 1, i = depth - 2; d > base; d--, i--) {\n    var node = $pos.node(d), index$1 = $pos.index(d);\n    if (node.type.spec.isolating) { return false }\n    var rest = node.content.cutByIndex(index$1, node.childCount);\n    var after = (typesAfter && typesAfter[i]) || node;\n    if (after != node) { rest = rest.replaceChild(0, after.type.create(after.attrs)); }\n    if (!node.canReplace(index$1 + 1, node.childCount) || !after.type.validContent(rest))\n      { return false }\n  }\n  var index = $pos.indexAfter(base);\n  var baseType = typesAfter && typesAfter[0];\n  return $pos.node(base).canReplaceWith(index, index, baseType ? baseType.type : $pos.node(base + 1).type)\n}\n\n// :: (number, ?number, ?[?{type: NodeType, attrs: ?Object}]) → this\n// Split the node at the given position, and optionally, if `depth` is\n// greater than one, any number of nodes above that. By default, the\n// parts split off will inherit the node type of the original node.\n// This can be changed by passing an array of types and attributes to\n// use after the split.\nTransform.prototype.split = function(pos, depth, typesAfter) {\n  if ( depth === void 0 ) depth = 1;\n\n  var $pos = this.doc.resolve(pos), before = Fragment.empty, after = Fragment.empty;\n  for (var d = $pos.depth, e = $pos.depth - depth, i = depth - 1; d > e; d--, i--) {\n    before = Fragment.from($pos.node(d).copy(before));\n    var typeAfter = typesAfter && typesAfter[i];\n    after = Fragment.from(typeAfter ? typeAfter.type.create(typeAfter.attrs, after) : $pos.node(d).copy(after));\n  }\n  return this.step(new ReplaceStep(pos, pos, new Slice(before.append(after), depth, depth), true))\n};\n\n// :: (Node, number) → bool\n// Test whether the blocks before and after a given position can be\n// joined.\nfunction canJoin(doc, pos) {\n  var $pos = doc.resolve(pos), index = $pos.index();\n  return joinable($pos.nodeBefore, $pos.nodeAfter) &&\n    $pos.parent.canReplace(index, index + 1)\n}\n\nfunction joinable(a, b) {\n  return a && b && !a.isLeaf && a.canAppend(b)\n}\n\n// :: (Node, number, ?number) → ?number\n// Find an ancestor of the given position that can be joined to the\n// block before (or after if `dir` is positive). Returns the joinable\n// point, if any.\nfunction joinPoint(doc, pos, dir) {\n  if ( dir === void 0 ) dir = -1;\n\n  var $pos = doc.resolve(pos);\n  for (var d = $pos.depth;; d--) {\n    var before = (void 0), after = (void 0), index = $pos.index(d);\n    if (d == $pos.depth) {\n      before = $pos.nodeBefore;\n      after = $pos.nodeAfter;\n    } else if (dir > 0) {\n      before = $pos.node(d + 1);\n      index++;\n      after = $pos.node(d).maybeChild(index);\n    } else {\n      before = $pos.node(d).maybeChild(index - 1);\n      after = $pos.node(d + 1);\n    }\n    if (before && !before.isTextblock && joinable(before, after) &&\n        $pos.node(d).canReplace(index, index + 1)) { return pos }\n    if (d == 0) { break }\n    pos = dir < 0 ? $pos.before(d) : $pos.after(d);\n  }\n}\n\n// :: (number, ?number) → this\n// Join the blocks around the given position. If depth is 2, their\n// last and first siblings are also joined, and so on.\nTransform.prototype.join = function(pos, depth) {\n  if ( depth === void 0 ) depth = 1;\n\n  var step = new ReplaceStep(pos - depth, pos + depth, Slice.empty, true);\n  return this.step(step)\n};\n\n// :: (Node, number, NodeType) → ?number\n// Try to find a point where a node of the given type can be inserted\n// near `pos`, by searching up the node hierarchy when `pos` itself\n// isn't a valid place but is at the start or end of a node. Return\n// null if no position was found.\nfunction insertPoint(doc, pos, nodeType) {\n  var $pos = doc.resolve(pos);\n  if ($pos.parent.canReplaceWith($pos.index(), $pos.index(), nodeType)) { return pos }\n\n  if ($pos.parentOffset == 0)\n    { for (var d = $pos.depth - 1; d >= 0; d--) {\n      var index = $pos.index(d);\n      if ($pos.node(d).canReplaceWith(index, index, nodeType)) { return $pos.before(d + 1) }\n      if (index > 0) { return null }\n    } }\n  if ($pos.parentOffset == $pos.parent.content.size)\n    { for (var d$1 = $pos.depth - 1; d$1 >= 0; d$1--) {\n      var index$1 = $pos.indexAfter(d$1);\n      if ($pos.node(d$1).canReplaceWith(index$1, index$1, nodeType)) { return $pos.after(d$1 + 1) }\n      if (index$1 < $pos.node(d$1).childCount) { return null }\n    } }\n}\n\n// :: (Node, number, Slice) → ?number\n// Finds a position at or around the given position where the given\n// slice can be inserted. Will look at parent nodes' nearest boundary\n// and try there, even if the original position wasn't directly at the\n// start or end of that node. Returns null when no position was found.\nfunction dropPoint(doc, pos, slice) {\n  var $pos = doc.resolve(pos);\n  if (!slice.content.size) { return pos }\n  var content = slice.content;\n  for (var i = 0; i < slice.openStart; i++) { content = content.firstChild.content; }\n  for (var pass = 1; pass <= (slice.openStart == 0 && slice.size ? 2 : 1); pass++) {\n    for (var d = $pos.depth; d >= 0; d--) {\n      var bias = d == $pos.depth ? 0 : $pos.pos <= ($pos.start(d + 1) + $pos.end(d + 1)) / 2 ? -1 : 1;\n      var insertPos = $pos.index(d) + (bias > 0 ? 1 : 0);\n      if (pass == 1\n          ? $pos.node(d).canReplace(insertPos, insertPos, content)\n          : $pos.node(d).contentMatchAt(insertPos).findWrapping(content.firstChild.type))\n        { return bias == 0 ? $pos.pos : bias < 0 ? $pos.before(d + 1) : $pos.after(d + 1) }\n    }\n  }\n  return null\n}\n\nfunction mapFragment(fragment, f, parent) {\n  var mapped = [];\n  for (var i = 0; i < fragment.childCount; i++) {\n    var child = fragment.child(i);\n    if (child.content.size) { child = child.copy(mapFragment(child.content, f, child)); }\n    if (child.isInline) { child = f(child, parent, i); }\n    mapped.push(child);\n  }\n  return Fragment.fromArray(mapped)\n}\n\n// ::- Add a mark to all inline content between two positions.\nvar AddMarkStep = /*@__PURE__*/(function (Step) {\n  function AddMarkStep(from, to, mark) {\n    Step.call(this);\n    this.from = from;\n    this.to = to;\n    this.mark = mark;\n  }\n\n  if ( Step ) AddMarkStep.__proto__ = Step;\n  AddMarkStep.prototype = Object.create( Step && Step.prototype );\n  AddMarkStep.prototype.constructor = AddMarkStep;\n\n  AddMarkStep.prototype.apply = function apply (doc) {\n    var this$1 = this;\n\n    var oldSlice = doc.slice(this.from, this.to), $from = doc.resolve(this.from);\n    var parent = $from.node($from.sharedDepth(this.to));\n    var slice = new Slice(mapFragment(oldSlice.content, function (node, parent) {\n      if (!parent.type.allowsMarkType(this$1.mark.type)) { return node }\n      return node.mark(this$1.mark.addToSet(node.marks))\n    }, parent), oldSlice.openStart, oldSlice.openEnd);\n    return StepResult.fromReplace(doc, this.from, this.to, slice)\n  };\n\n  AddMarkStep.prototype.invert = function invert () {\n    return new RemoveMarkStep(this.from, this.to, this.mark)\n  };\n\n  AddMarkStep.prototype.map = function map (mapping) {\n    var from = mapping.mapResult(this.from, 1), to = mapping.mapResult(this.to, -1);\n    if (from.deleted && to.deleted || from.pos >= to.pos) { return null }\n    return new AddMarkStep(from.pos, to.pos, this.mark)\n  };\n\n  AddMarkStep.prototype.merge = function merge (other) {\n    if (other instanceof AddMarkStep &&\n        other.mark.eq(this.mark) &&\n        this.from <= other.to && this.to >= other.from)\n      { return new AddMarkStep(Math.min(this.from, other.from),\n                             Math.max(this.to, other.to), this.mark) }\n  };\n\n  AddMarkStep.prototype.toJSON = function toJSON () {\n    return {stepType: \"addMark\", mark: this.mark.toJSON(),\n            from: this.from, to: this.to}\n  };\n\n  AddMarkStep.fromJSON = function fromJSON (schema, json) {\n    if (typeof json.from != \"number\" || typeof json.to != \"number\")\n      { throw new RangeError(\"Invalid input for AddMarkStep.fromJSON\") }\n    return new AddMarkStep(json.from, json.to, schema.markFromJSON(json.mark))\n  };\n\n  return AddMarkStep;\n}(Step));\n\nStep.jsonID(\"addMark\", AddMarkStep);\n\n// ::- Remove a mark from all inline content between two positions.\nvar RemoveMarkStep = /*@__PURE__*/(function (Step) {\n  function RemoveMarkStep(from, to, mark) {\n    Step.call(this);\n    this.from = from;\n    this.to = to;\n    this.mark = mark;\n  }\n\n  if ( Step ) RemoveMarkStep.__proto__ = Step;\n  RemoveMarkStep.prototype = Object.create( Step && Step.prototype );\n  RemoveMarkStep.prototype.constructor = RemoveMarkStep;\n\n  RemoveMarkStep.prototype.apply = function apply (doc) {\n    var this$1 = this;\n\n    var oldSlice = doc.slice(this.from, this.to);\n    var slice = new Slice(mapFragment(oldSlice.content, function (node) {\n      return node.mark(this$1.mark.removeFromSet(node.marks))\n    }), oldSlice.openStart, oldSlice.openEnd);\n    return StepResult.fromReplace(doc, this.from, this.to, slice)\n  };\n\n  RemoveMarkStep.prototype.invert = function invert () {\n    return new AddMarkStep(this.from, this.to, this.mark)\n  };\n\n  RemoveMarkStep.prototype.map = function map (mapping) {\n    var from = mapping.mapResult(this.from, 1), to = mapping.mapResult(this.to, -1);\n    if (from.deleted && to.deleted || from.pos >= to.pos) { return null }\n    return new RemoveMarkStep(from.pos, to.pos, this.mark)\n  };\n\n  RemoveMarkStep.prototype.merge = function merge (other) {\n    if (other instanceof RemoveMarkStep &&\n        other.mark.eq(this.mark) &&\n        this.from <= other.to && this.to >= other.from)\n      { return new RemoveMarkStep(Math.min(this.from, other.from),\n                                Math.max(this.to, other.to), this.mark) }\n  };\n\n  RemoveMarkStep.prototype.toJSON = function toJSON () {\n    return {stepType: \"removeMark\", mark: this.mark.toJSON(),\n            from: this.from, to: this.to}\n  };\n\n  RemoveMarkStep.fromJSON = function fromJSON (schema, json) {\n    if (typeof json.from != \"number\" || typeof json.to != \"number\")\n      { throw new RangeError(\"Invalid input for RemoveMarkStep.fromJSON\") }\n    return new RemoveMarkStep(json.from, json.to, schema.markFromJSON(json.mark))\n  };\n\n  return RemoveMarkStep;\n}(Step));\n\nStep.jsonID(\"removeMark\", RemoveMarkStep);\n\n// :: (number, number, Mark) → this\n// Add the given mark to the inline content between `from` and `to`.\nTransform.prototype.addMark = function(from, to, mark) {\n  var this$1 = this;\n\n  var removed = [], added = [], removing = null, adding = null;\n  this.doc.nodesBetween(from, to, function (node, pos, parent) {\n    if (!node.isInline) { return }\n    var marks = node.marks;\n    if (!mark.isInSet(marks) && parent.type.allowsMarkType(mark.type)) {\n      var start = Math.max(pos, from), end = Math.min(pos + node.nodeSize, to);\n      var newSet = mark.addToSet(marks);\n\n      for (var i = 0; i < marks.length; i++) {\n        if (!marks[i].isInSet(newSet)) {\n          if (removing && removing.to == start && removing.mark.eq(marks[i]))\n            { removing.to = end; }\n          else\n            { removed.push(removing = new RemoveMarkStep(start, end, marks[i])); }\n        }\n      }\n\n      if (adding && adding.to == start)\n        { adding.to = end; }\n      else\n        { added.push(adding = new AddMarkStep(start, end, mark)); }\n    }\n  });\n\n  removed.forEach(function (s) { return this$1.step(s); });\n  added.forEach(function (s) { return this$1.step(s); });\n  return this\n};\n\n// :: (number, number, ?union<Mark, MarkType>) → this\n// Remove marks from inline nodes between `from` and `to`. When `mark`\n// is a single mark, remove precisely that mark. When it is a mark type,\n// remove all marks of that type. When it is null, remove all marks of\n// any type.\nTransform.prototype.removeMark = function(from, to, mark) {\n  var this$1 = this;\n  if ( mark === void 0 ) mark = null;\n\n  var matched = [], step = 0;\n  this.doc.nodesBetween(from, to, function (node, pos) {\n    if (!node.isInline) { return }\n    step++;\n    var toRemove = null;\n    if (mark instanceof MarkType) {\n      var found = mark.isInSet(node.marks);\n      if (found) { toRemove = [found]; }\n    } else if (mark) {\n      if (mark.isInSet(node.marks)) { toRemove = [mark]; }\n    } else {\n      toRemove = node.marks;\n    }\n    if (toRemove && toRemove.length) {\n      var end = Math.min(pos + node.nodeSize, to);\n      for (var i = 0; i < toRemove.length; i++) {\n        var style = toRemove[i], found$1 = (void 0);\n        for (var j = 0; j < matched.length; j++) {\n          var m = matched[j];\n          if (m.step == step - 1 && style.eq(matched[j].style)) { found$1 = m; }\n        }\n        if (found$1) {\n          found$1.to = end;\n          found$1.step = step;\n        } else {\n          matched.push({style: style, from: Math.max(pos, from), to: end, step: step});\n        }\n      }\n    }\n  });\n  matched.forEach(function (m) { return this$1.step(new RemoveMarkStep(m.from, m.to, m.style)); });\n  return this\n};\n\n// :: (number, NodeType, ?ContentMatch) → this\n// Removes all marks and nodes from the content of the node at `pos`\n// that don't match the given new parent node type. Accepts an\n// optional starting [content match](#model.ContentMatch) as third\n// argument.\nTransform.prototype.clearIncompatible = function(pos, parentType, match) {\n  if ( match === void 0 ) match = parentType.contentMatch;\n\n  var node = this.doc.nodeAt(pos);\n  var delSteps = [], cur = pos + 1;\n  for (var i = 0; i < node.childCount; i++) {\n    var child = node.child(i), end = cur + child.nodeSize;\n    var allowed = match.matchType(child.type, child.attrs);\n    if (!allowed) {\n      delSteps.push(new ReplaceStep(cur, end, Slice.empty));\n    } else {\n      match = allowed;\n      for (var j = 0; j < child.marks.length; j++) { if (!parentType.allowsMarkType(child.marks[j].type))\n        { this.step(new RemoveMarkStep(cur, end, child.marks[j])); } }\n    }\n    cur = end;\n  }\n  if (!match.validEnd) {\n    var fill = match.fillBefore(Fragment.empty, true);\n    this.replace(cur, cur, new Slice(fill, 0, 0));\n  }\n  for (var i$1 = delSteps.length - 1; i$1 >= 0; i$1--) { this.step(delSteps[i$1]); }\n  return this\n};\n\n// :: (Node, number, ?number, ?Slice) → ?Step\n// ‘Fit’ a slice into a given position in the document, producing a\n// [step](#transform.Step) that inserts it. Will return null if\n// there's no meaningful way to insert the slice here, or inserting it\n// would be a no-op (an empty slice over an empty range).\nfunction replaceStep(doc, from, to, slice) {\n  if ( to === void 0 ) to = from;\n  if ( slice === void 0 ) slice = Slice.empty;\n\n  if (from == to && !slice.size) { return null }\n\n  var $from = doc.resolve(from), $to = doc.resolve(to);\n  // Optimization -- avoid work if it's obvious that it's not needed.\n  if (fitsTrivially($from, $to, slice)) { return new ReplaceStep(from, to, slice) }\n  return new Fitter($from, $to, slice).fit()\n}\n\n// :: (number, ?number, ?Slice) → this\n// Replace the part of the document between `from` and `to` with the\n// given `slice`.\nTransform.prototype.replace = function(from, to, slice) {\n  if ( to === void 0 ) to = from;\n  if ( slice === void 0 ) slice = Slice.empty;\n\n  var step = replaceStep(this.doc, from, to, slice);\n  if (step) { this.step(step); }\n  return this\n};\n\n// :: (number, number, union<Fragment, Node, [Node]>) → this\n// Replace the given range with the given content, which may be a\n// fragment, node, or array of nodes.\nTransform.prototype.replaceWith = function(from, to, content) {\n  return this.replace(from, to, new Slice(Fragment.from(content), 0, 0))\n};\n\n// :: (number, number) → this\n// Delete the content between the given positions.\nTransform.prototype.delete = function(from, to) {\n  return this.replace(from, to, Slice.empty)\n};\n\n// :: (number, union<Fragment, Node, [Node]>) → this\n// Insert the given content at the given position.\nTransform.prototype.insert = function(pos, content) {\n  return this.replaceWith(pos, pos, content)\n};\n\nfunction fitsTrivially($from, $to, slice) {\n  return !slice.openStart && !slice.openEnd && $from.start() == $to.start() &&\n    $from.parent.canReplace($from.index(), $to.index(), slice.content)\n}\n\n// Algorithm for 'placing' the elements of a slice into a gap:\n//\n// We consider the content of each node that is open to the left to be\n// independently placeable. I.e. in <p(\"foo\"), p(\"bar\")>, when the\n// paragraph on the left is open, \"foo\" can be placed (somewhere on\n// the left side of the replacement gap) independently from p(\"bar\").\n//\n// This class tracks the state of the placement progress in the\n// following properties:\n//\n//  - `frontier` holds a stack of `{type, match}` objects that\n//    represent the open side of the replacement. It starts at\n//    `$from`, then moves forward as content is placed, and is finally\n//    reconciled with `$to`.\n//\n//  - `unplaced` is a slice that represents the content that hasn't\n//    been placed yet.\n//\n//  - `placed` is a fragment of placed content. Its open-start value\n//    is implicit in `$from`, and its open-end value in `frontier`.\nvar Fitter = function Fitter($from, $to, slice) {\n  this.$to = $to;\n  this.$from = $from;\n  this.unplaced = slice;\n\n  this.frontier = [];\n  for (var i = 0; i <= $from.depth; i++) {\n    var node = $from.node(i);\n    this.frontier.push({\n      type: node.type,\n      match: node.contentMatchAt($from.indexAfter(i))\n    });\n  }\n\n  this.placed = Fragment.empty;\n  for (var i$1 = $from.depth; i$1 > 0; i$1--)\n    { this.placed = Fragment.from($from.node(i$1).copy(this.placed)); }\n};\n\nvar prototypeAccessors$1 = { depth: { configurable: true } };\n\nprototypeAccessors$1.depth.get = function () { return this.frontier.length - 1 };\n\nFitter.prototype.fit = function fit () {\n  // As long as there's unplaced content, try to place some of it.\n  // If that fails, either increase the open score of the unplaced\n  // slice, or drop nodes from it, and then try again.\n  while (this.unplaced.size) {\n    var fit = this.findFittable();\n    if (fit) { this.placeNodes(fit); }\n    else { this.openMore() || this.dropNode(); }\n  }\n  // When there's inline content directly after the frontier _and_\n  // directly after `this.$to`, we must generate a `ReplaceAround`\n  // step that pulls that content into the node after the frontier.\n  // That means the fitting must be done to the end of the textblock\n  // node after `this.$to`, not `this.$to` itself.\n  var moveInline = this.mustMoveInline(), placedSize = this.placed.size - this.depth - this.$from.depth;\n  var $from = this.$from, $to = moveInline < 0 ? this.$to : $from.doc.resolve(moveInline);\n  if (this.close($to)) { // If closing to `$to` succeeded, create a step\n    var content = this.placed, openStart = $from.depth, openEnd = $to.depth;\n    while (openStart && openEnd && content.childCount == 1) { // Normalize by dropping open parent nodes\n      content = content.firstChild.content;\n      openStart--; openEnd--;\n    }\n    var slice = new Slice(content, openStart, openEnd);\n    if (moveInline > -1)\n      { return new ReplaceAroundStep($from.pos, moveInline, this.$to.pos, this.$to.end(), slice, placedSize) }\n    if (slice.size || $from.pos != this.$to.pos) // Don't generate no-op steps\n      { return new ReplaceStep($from.pos, $to.pos, slice) }\n  }\n  return null\n};\n\n// Find a position on the start spine of `this.unplaced` that has\n// content that can be moved somewhere on the frontier. Returns two\n// depths, one for the slice and one for the frontier.\nFitter.prototype.findFittable = function findFittable () {\n  // Only try wrapping nodes (pass 2) after finding a place without\n  // wrapping failed.\n  for (var pass = 1; pass <= 2; pass++) {\n    for (var sliceDepth = this.unplaced.openStart; sliceDepth >= 0; sliceDepth--) {\n      var fragment = (void 0), parent = (void 0);\n      if (sliceDepth) {\n        parent = contentAt(this.unplaced.content, sliceDepth - 1).firstChild;\n        fragment = parent.content;\n      } else {\n        fragment = this.unplaced.content;\n      }\n      var first = fragment.firstChild;\n      for (var frontierDepth = this.depth; frontierDepth >= 0; frontierDepth--) {\n        var ref = this.frontier[frontierDepth];\n          var type = ref.type;\n          var match = ref.match;\n          var wrap = (void 0), inject = (void 0);\n        // In pass 1, if the next node matches, or there is no next\n        // node but the parents look compatible, we've found a\n        // place.\n        if (pass == 1 && (first ? match.matchType(first.type) || (inject = match.fillBefore(Fragment.from(first), false))\n                          : type.compatibleContent(parent.type)))\n          { return {sliceDepth: sliceDepth, frontierDepth: frontierDepth, parent: parent, inject: inject} }\n        // In pass 2, look for a set of wrapping nodes that make\n        // `first` fit here.\n        else if (pass == 2 && first && (wrap = match.findWrapping(first.type)))\n          { return {sliceDepth: sliceDepth, frontierDepth: frontierDepth, parent: parent, wrap: wrap} }\n        // Don't continue looking further up if the parent node\n        // would fit here.\n        if (parent && match.matchType(parent.type)) { break }\n      }\n    }\n  }\n};\n\nFitter.prototype.openMore = function openMore () {\n  var ref = this.unplaced;\n    var content = ref.content;\n    var openStart = ref.openStart;\n    var openEnd = ref.openEnd;\n  var inner = contentAt(content, openStart);\n  if (!inner.childCount || inner.firstChild.isLeaf) { return false }\n  this.unplaced = new Slice(content, openStart + 1,\n                            Math.max(openEnd, inner.size + openStart >= content.size - openEnd ? openStart + 1 : 0));\n  return true\n};\n\nFitter.prototype.dropNode = function dropNode () {\n  var ref = this.unplaced;\n    var content = ref.content;\n    var openStart = ref.openStart;\n    var openEnd = ref.openEnd;\n  var inner = contentAt(content, openStart);\n  if (inner.childCount <= 1 && openStart > 0) {\n    var openAtEnd = content.size - openStart <= openStart + inner.size;\n    this.unplaced = new Slice(dropFromFragment(content, openStart - 1, 1), openStart - 1,\n                              openAtEnd ? openStart - 1 : openEnd);\n  } else {\n    this.unplaced = new Slice(dropFromFragment(content, openStart, 1), openStart, openEnd);\n  }\n};\n\n// : ({sliceDepth: number, frontierDepth: number, parent: ?Node, wrap: ?[NodeType], inject: ?Fragment})\n// Move content from the unplaced slice at `sliceDepth` to the\n// frontier node at `frontierDepth`. Close that frontier node when\n// applicable.\nFitter.prototype.placeNodes = function placeNodes (ref) {\n    var sliceDepth = ref.sliceDepth;\n    var frontierDepth = ref.frontierDepth;\n    var parent = ref.parent;\n    var inject = ref.inject;\n    var wrap = ref.wrap;\n\n  while (this.depth > frontierDepth) { this.closeFrontierNode(); }\n  if (wrap) { for (var i = 0; i < wrap.length; i++) { this.openFrontierNode(wrap[i]); } }\n\n  var slice = this.unplaced, fragment = parent ? parent.content : slice.content;\n  var openStart = slice.openStart - sliceDepth;\n  var taken = 0, add = [];\n  var ref$1 = this.frontier[frontierDepth];\n    var match = ref$1.match;\n    var type = ref$1.type;\n  if (inject) {\n    for (var i$1 = 0; i$1 < inject.childCount; i$1++) { add.push(inject.child(i$1)); }\n    match = match.matchFragment(inject);\n  }\n  // Computes the amount of (end) open nodes at the end of the\n  // fragment. When 0, the parent is open, but no more. When\n  // negative, nothing is open.\n  var openEndCount = (fragment.size + sliceDepth) - (slice.content.size - slice.openEnd);\n  // Scan over the fragment, fitting as many child nodes as\n  // possible.\n  while (taken < fragment.childCount) {\n    var next = fragment.child(taken), matches = match.matchType(next.type);\n    if (!matches) { break }\n    taken++;\n    if (taken > 1 || openStart == 0 || next.content.size) { // Drop empty open nodes\n      match = matches;\n      add.push(closeNodeStart(next.mark(type.allowedMarks(next.marks)), taken == 1 ? openStart : 0,\n                              taken == fragment.childCount ? openEndCount : -1));\n    }\n  }\n  var toEnd = taken == fragment.childCount;\n  if (!toEnd) { openEndCount = -1; }\n\n  // If the parent types match, and the entire node was moved, and\n  // it's not open, close this frontier node right away.\n  if (toEnd && openEndCount < 0 && parent && parent.type == this.frontier[this.depth].type) { this.closeFrontierNode(); }\n  else { this.frontier[frontierDepth].match = match; }\n\n  // Add new frontier nodes for any open nodes at the end.\n  for (var i$2 = 0, cur = fragment; i$2 < openEndCount; i$2++) {\n    var node = cur.lastChild;\n    this.frontier.push({type: node.type, match: node.contentMatchAt(node.childCount)});\n    cur = node.content;\n  }\n\n  // Update `this.unplaced`. Drop the entire node from which we\n  // placed it we got to its end, otherwise just drop the placed\n  // nodes.\n  this.unplaced = !toEnd ? new Slice(dropFromFragment(slice.content, sliceDepth, taken), slice.openStart, slice.openEnd)\n    : sliceDepth == 0 ? Slice.empty\n    : new Slice(dropFromFragment(slice.content, sliceDepth - 1, 1),\n                sliceDepth - 1, openEndCount < 0 ? slice.openEnd : sliceDepth - 1);\n  this.placed = addToFragment(this.placed, frontierDepth, Fragment.from(add));\n};\n\nFitter.prototype.mustMoveInline = function mustMoveInline () {\n  if (!this.$to.parent.isTextblock) { return -1 }\n  var top = this.frontier[this.depth], level;\n  if (!top.type.isTextblock || !contentAfterFits(this.$to, this.$to.depth, top.type, top.match, false) ||\n      (this.$to.depth == this.depth && (level = this.findCloseLevel(this.$to)) && level.depth == this.depth)) { return -1 }\n\n  var ref = this.$to;\n    var depth = ref.depth;\n    var after = this.$to.after(depth);\n  while (depth > 1 && after == this.$to.end(--depth)) { ++after; }\n  return after\n};\n\nFitter.prototype.findCloseLevel = function findCloseLevel ($to) {\n  scan: for (var i = Math.min(this.depth, $to.depth); i >= 0; i--) {\n    var ref = this.frontier[i];\n      var match = ref.match;\n      var type = ref.type;\n    var fit = contentAfterFits($to, i, type, match, false);\n    if (!fit) { continue }\n    for (var d = i - 1; d >= 0; d--) {\n      var ref$1 = this.frontier[d];\n        var match$1 = ref$1.match;\n        var type$1 = ref$1.type;\n      var matches = contentAfterFits($to, d, type$1, match$1, true);\n      if (!matches || matches.childCount) { continue scan }\n    }\n    return {depth: i, fit: fit}\n  }\n};\n\nFitter.prototype.close = function close ($to) {\n  var close = this.findCloseLevel($to);\n  if (!close) { return false }\n\n  while (this.depth > close.depth) { this.closeFrontierNode(); }\n  if (close.fit.childCount) { this.placed = addToFragment(this.placed, close.depth, close.fit); }\n  for (var d = close.depth + 1; d <= $to.depth; d++) {\n    var node = $to.node(d), add = node.type.contentMatch.fillBefore(node.content, true, $to.index(d));\n    this.openFrontierNode(node.type, node.attrs, add);\n  }\n  return true\n};\n\nFitter.prototype.openFrontierNode = function openFrontierNode (type, attrs, content) {\n  var top = this.frontier[this.depth];\n  top.match = top.match.matchType(type);\n  this.placed = addToFragment(this.placed, this.depth, Fragment.from(type.create(attrs, content)));\n  this.frontier.push({type: type, match: type.contentMatch});\n};\n\nFitter.prototype.closeFrontierNode = function closeFrontierNode () {\n  var open = this.frontier.pop();\n  var add = open.match.fillBefore(Fragment.empty, true);\n  if (add.childCount) { this.placed = addToFragment(this.placed, this.frontier.length, add); }\n};\n\nObject.defineProperties( Fitter.prototype, prototypeAccessors$1 );\n\nfunction dropFromFragment(fragment, depth, count) {\n  if (depth == 0) { return fragment.cutByIndex(count) }\n  return fragment.replaceChild(0, fragment.firstChild.copy(dropFromFragment(fragment.firstChild.content, depth - 1, count)))\n}\n\nfunction addToFragment(fragment, depth, content) {\n  if (depth == 0) { return fragment.append(content) }\n  return fragment.replaceChild(fragment.childCount - 1,\n                               fragment.lastChild.copy(addToFragment(fragment.lastChild.content, depth - 1, content)))\n}\n\nfunction contentAt(fragment, depth) {\n  for (var i = 0; i < depth; i++) { fragment = fragment.firstChild.content; }\n  return fragment\n}\n\nfunction closeNodeStart(node, openStart, openEnd) {\n  if (openStart <= 0) { return node }\n  var frag = node.content;\n  if (openStart > 1)\n    { frag = frag.replaceChild(0, closeNodeStart(frag.firstChild, openStart - 1, frag.childCount == 1 ? openEnd - 1 : 0)); }\n  if (openStart > 0) {\n    frag = node.type.contentMatch.fillBefore(frag).append(frag);\n    if (openEnd <= 0) { frag = frag.append(node.type.contentMatch.matchFragment(frag).fillBefore(Fragment.empty, true)); }\n  }\n  return node.copy(frag)\n}\n\nfunction contentAfterFits($to, depth, type, match, open) {\n  var node = $to.node(depth), index = open ? $to.indexAfter(depth) : $to.index(depth);\n  if (index == node.childCount && !type.compatibleContent(node.type)) { return null }\n  var fit = match.fillBefore(node.content, true, index);\n  return fit && !invalidMarks(type, node.content, index) ? fit : null\n}\n\nfunction invalidMarks(type, fragment, start) {\n  for (var i = start; i < fragment.childCount; i++)\n    { if (!type.allowsMarks(fragment.child(i).marks)) { return true } }\n  return false\n}\n\n// :: (number, number, Slice) → this\n// Replace a range of the document with a given slice, using `from`,\n// `to`, and the slice's [`openStart`](#model.Slice.openStart) property\n// as hints, rather than fixed start and end points. This method may\n// grow the replaced area or close open nodes in the slice in order to\n// get a fit that is more in line with WYSIWYG expectations, by\n// dropping fully covered parent nodes of the replaced region when\n// they are marked [non-defining](#model.NodeSpec.defining), or\n// including an open parent node from the slice that _is_ marked as\n// [defining](#model.NodeSpec.defining).\n//\n// This is the method, for example, to handle paste. The similar\n// [`replace`](#transform.Transform.replace) method is a more\n// primitive tool which will _not_ move the start and end of its given\n// range, and is useful in situations where you need more precise\n// control over what happens.\nTransform.prototype.replaceRange = function(from, to, slice) {\n  if (!slice.size) { return this.deleteRange(from, to) }\n\n  var $from = this.doc.resolve(from), $to = this.doc.resolve(to);\n  if (fitsTrivially($from, $to, slice))\n    { return this.step(new ReplaceStep(from, to, slice)) }\n\n  var targetDepths = coveredDepths($from, this.doc.resolve(to));\n  // Can't replace the whole document, so remove 0 if it's present\n  if (targetDepths[targetDepths.length - 1] == 0) { targetDepths.pop(); }\n  // Negative numbers represent not expansion over the whole node at\n  // that depth, but replacing from $from.before(-D) to $to.pos.\n  var preferredTarget = -($from.depth + 1);\n  targetDepths.unshift(preferredTarget);\n  // This loop picks a preferred target depth, if one of the covering\n  // depths is not outside of a defining node, and adds negative\n  // depths for any depth that has $from at its start and does not\n  // cross a defining node.\n  for (var d = $from.depth, pos = $from.pos - 1; d > 0; d--, pos--) {\n    var spec = $from.node(d).type.spec;\n    if (spec.defining || spec.isolating) { break }\n    if (targetDepths.indexOf(d) > -1) { preferredTarget = d; }\n    else if ($from.before(d) == pos) { targetDepths.splice(1, 0, -d); }\n  }\n  // Try to fit each possible depth of the slice into each possible\n  // target depth, starting with the preferred depths.\n  var preferredTargetIndex = targetDepths.indexOf(preferredTarget);\n\n  var leftNodes = [], preferredDepth = slice.openStart;\n  for (var content = slice.content, i = 0;; i++) {\n    var node = content.firstChild;\n    leftNodes.push(node);\n    if (i == slice.openStart) { break }\n    content = node.content;\n  }\n  // Back up if the node directly above openStart, or the node above\n  // that separated only by a non-defining textblock node, is defining.\n  if (preferredDepth > 0 && leftNodes[preferredDepth - 1].type.spec.defining &&\n      $from.node(preferredTargetIndex).type != leftNodes[preferredDepth - 1].type)\n    { preferredDepth -= 1; }\n  else if (preferredDepth >= 2 && leftNodes[preferredDepth - 1].isTextblock && leftNodes[preferredDepth - 2].type.spec.defining &&\n           $from.node(preferredTargetIndex).type != leftNodes[preferredDepth - 2].type)\n    { preferredDepth -= 2; }\n\n  for (var j = slice.openStart; j >= 0; j--) {\n    var openDepth = (j + preferredDepth + 1) % (slice.openStart + 1);\n    var insert = leftNodes[openDepth];\n    if (!insert) { continue }\n    for (var i$1 = 0; i$1 < targetDepths.length; i$1++) {\n      // Loop over possible expansion levels, starting with the\n      // preferred one\n      var targetDepth = targetDepths[(i$1 + preferredTargetIndex) % targetDepths.length], expand = true;\n      if (targetDepth < 0) { expand = false; targetDepth = -targetDepth; }\n      var parent = $from.node(targetDepth - 1), index = $from.index(targetDepth - 1);\n      if (parent.canReplaceWith(index, index, insert.type, insert.marks))\n        { return this.replace($from.before(targetDepth), expand ? $to.after(targetDepth) : to,\n                            new Slice(closeFragment(slice.content, 0, slice.openStart, openDepth),\n                                      openDepth, slice.openEnd)) }\n    }\n  }\n\n  var startSteps = this.steps.length;\n  for (var i$2 = targetDepths.length - 1; i$2 >= 0; i$2--) {\n    this.replace(from, to, slice);\n    if (this.steps.length > startSteps) { break }\n    var depth = targetDepths[i$2];\n    if (i$2 < 0) { continue }\n    from = $from.before(depth); to = $to.after(depth);\n  }\n  return this\n};\n\nfunction closeFragment(fragment, depth, oldOpen, newOpen, parent) {\n  if (depth < oldOpen) {\n    var first = fragment.firstChild;\n    fragment = fragment.replaceChild(0, first.copy(closeFragment(first.content, depth + 1, oldOpen, newOpen, first)));\n  }\n  if (depth > newOpen) {\n    var match = parent.contentMatchAt(0);\n    var start = match.fillBefore(fragment).append(fragment);\n    fragment = start.append(match.matchFragment(start).fillBefore(Fragment.empty, true));\n  }\n  return fragment\n}\n\n// :: (number, number, Node) → this\n// Replace the given range with a node, but use `from` and `to` as\n// hints, rather than precise positions. When from and to are the same\n// and are at the start or end of a parent node in which the given\n// node doesn't fit, this method may _move_ them out towards a parent\n// that does allow the given node to be placed. When the given range\n// completely covers a parent node, this method may completely replace\n// that parent node.\nTransform.prototype.replaceRangeWith = function(from, to, node) {\n  if (!node.isInline && from == to && this.doc.resolve(from).parent.content.size) {\n    var point = insertPoint(this.doc, from, node.type);\n    if (point != null) { from = to = point; }\n  }\n  return this.replaceRange(from, to, new Slice(Fragment.from(node), 0, 0))\n};\n\n// :: (number, number) → this\n// Delete the given range, expanding it to cover fully covered\n// parent nodes until a valid replace is found.\nTransform.prototype.deleteRange = function(from, to) {\n  var $from = this.doc.resolve(from), $to = this.doc.resolve(to);\n  var covered = coveredDepths($from, $to);\n  for (var i = 0; i < covered.length; i++) {\n    var depth = covered[i], last = i == covered.length - 1;\n    if ((last && depth == 0) || $from.node(depth).type.contentMatch.validEnd)\n      { return this.delete($from.start(depth), $to.end(depth)) }\n    if (depth > 0 && (last || $from.node(depth - 1).canReplace($from.index(depth - 1), $to.indexAfter(depth - 1))))\n      { return this.delete($from.before(depth), $to.after(depth)) }\n  }\n  for (var d = 1; d <= $from.depth && d <= $to.depth; d++) {\n    if (from - $from.start(d) == $from.depth - d && to > $from.end(d) && $to.end(d) - to != $to.depth - d)\n      { return this.delete($from.before(d), to) }\n  }\n  return this.delete(from, to)\n};\n\n// : (ResolvedPos, ResolvedPos) → [number]\n// Returns an array of all depths for which $from - $to spans the\n// whole content of the nodes at that depth.\nfunction coveredDepths($from, $to) {\n  var result = [], minDepth = Math.min($from.depth, $to.depth);\n  for (var d = minDepth; d >= 0; d--) {\n    var start = $from.start(d);\n    if (start < $from.pos - ($from.depth - d) ||\n        $to.end(d) > $to.pos + ($to.depth - d) ||\n        $from.node(d).type.spec.isolating ||\n        $to.node(d).type.spec.isolating) { break }\n    if (start == $to.start(d)) { result.push(d); }\n  }\n  return result\n}\n\nexport { AddMarkStep, MapResult, Mapping, RemoveMarkStep, ReplaceAroundStep, ReplaceStep, Step, StepMap, StepResult, Transform, TransformError, canJoin, canSplit, dropPoint, findWrapping, insertPoint, joinPoint, liftTarget, replaceStep };\n//# sourceMappingURL=index.es.js.map\n","'use strict';\nvar global = require('../internals/global');\nvar redefineAll = require('../internals/redefine-all');\nvar InternalMetadataModule = require('../internals/internal-metadata');\nvar collection = require('../internals/collection');\nvar collectionWeak = require('../internals/collection-weak');\nvar isObject = require('../internals/is-object');\nvar enforceIternalState = require('../internals/internal-state').enforce;\nvar NATIVE_WEAK_MAP = require('../internals/native-weak-map');\n\nvar IS_IE11 = !global.ActiveXObject && 'ActiveXObject' in global;\n// eslint-disable-next-line es/no-object-isextensible -- safe\nvar isExtensible = Object.isExtensible;\nvar InternalWeakMap;\n\nvar wrapper = function (init) {\n  return function WeakMap() {\n    return init(this, arguments.length ? arguments[0] : undefined);\n  };\n};\n\n// `WeakMap` constructor\n// https://tc39.es/ecma262/#sec-weakmap-constructor\nvar $WeakMap = module.exports = collection('WeakMap', wrapper, collectionWeak);\n\n// IE11 WeakMap frozen keys fix\n// We can't use feature detection because it crash some old IE builds\n// https://github.com/zloirock/core-js/issues/485\nif (NATIVE_WEAK_MAP && IS_IE11) {\n  InternalWeakMap = collectionWeak.getConstructor(wrapper, 'WeakMap', true);\n  InternalMetadataModule.REQUIRED = true;\n  var WeakMapPrototype = $WeakMap.prototype;\n  var nativeDelete = WeakMapPrototype['delete'];\n  var nativeHas = WeakMapPrototype.has;\n  var nativeGet = WeakMapPrototype.get;\n  var nativeSet = WeakMapPrototype.set;\n  redefineAll(WeakMapPrototype, {\n    'delete': function (key) {\n      if (isObject(key) && !isExtensible(key)) {\n        var state = enforceIternalState(this);\n        if (!state.frozen) state.frozen = new InternalWeakMap();\n        return nativeDelete.call(this, key) || state.frozen['delete'](key);\n      } return nativeDelete.call(this, key);\n    },\n    has: function has(key) {\n      if (isObject(key) && !isExtensible(key)) {\n        var state = enforceIternalState(this);\n        if (!state.frozen) state.frozen = new InternalWeakMap();\n        return nativeHas.call(this, key) || state.frozen.has(key);\n      } return nativeHas.call(this, key);\n    },\n    get: function get(key) {\n      if (isObject(key) && !isExtensible(key)) {\n        var state = enforceIternalState(this);\n        if (!state.frozen) state.frozen = new InternalWeakMap();\n        return nativeHas.call(this, key) ? nativeGet.call(this, key) : state.frozen.get(key);\n      } return nativeGet.call(this, key);\n    },\n    set: function set(key, value) {\n      if (isObject(key) && !isExtensible(key)) {\n        var state = enforceIternalState(this);\n        if (!state.frozen) state.frozen = new InternalWeakMap();\n        nativeHas.call(this, key) ? nativeSet.call(this, key, value) : state.frozen.set(key, value);\n      } else nativeSet.call(this, key, value);\n      return this;\n    }\n  });\n}\n",";(function (root, factory) {\n\tif (typeof exports === \"object\") {\n\t\t// CommonJS\n\t\tmodule.exports = exports = factory();\n\t}\n\telse if (typeof define === \"function\" && define.amd) {\n\t\t// AMD\n\t\tdefine([], factory);\n\t}\n\telse {\n\t\t// Global (browser)\n\t\troot.CryptoJS = factory();\n\t}\n}(this, function () {\n\n\t/*globals window, global, require*/\n\n\t/**\n\t * CryptoJS core components.\n\t */\n\tvar CryptoJS = CryptoJS || (function (Math, undefined) {\n\n\t    var crypto;\n\n\t    // Native crypto from window (Browser)\n\t    if (typeof window !== 'undefined' && window.crypto) {\n\t        crypto = window.crypto;\n\t    }\n\n\t    // Native crypto in web worker (Browser)\n\t    if (typeof self !== 'undefined' && self.crypto) {\n\t        crypto = self.crypto;\n\t    }\n\n\t    // Native crypto from worker\n\t    if (typeof globalThis !== 'undefined' && globalThis.crypto) {\n\t        crypto = globalThis.crypto;\n\t    }\n\n\t    // Native (experimental IE 11) crypto from window (Browser)\n\t    if (!crypto && typeof window !== 'undefined' && window.msCrypto) {\n\t        crypto = window.msCrypto;\n\t    }\n\n\t    // Native crypto from global (NodeJS)\n\t    if (!crypto && typeof global !== 'undefined' && global.crypto) {\n\t        crypto = global.crypto;\n\t    }\n\n\t    // Native crypto import via require (NodeJS)\n\t    if (!crypto && typeof require === 'function') {\n\t        try {\n\t            crypto = require('crypto');\n\t        } catch (err) {}\n\t    }\n\n\t    /*\n\t     * Cryptographically secure pseudorandom number generator\n\t     *\n\t     * As Math.random() is cryptographically not safe to use\n\t     */\n\t    var cryptoSecureRandomInt = function () {\n\t        if (crypto) {\n\t            // Use getRandomValues method (Browser)\n\t            if (typeof crypto.getRandomValues === 'function') {\n\t                try {\n\t                    return crypto.getRandomValues(new Uint32Array(1))[0];\n\t                } catch (err) {}\n\t            }\n\n\t            // Use randomBytes method (NodeJS)\n\t            if (typeof crypto.randomBytes === 'function') {\n\t                try {\n\t                    return crypto.randomBytes(4).readInt32LE();\n\t                } catch (err) {}\n\t            }\n\t        }\n\n\t        throw new Error('Native crypto module could not be used to get secure random number.');\n\t    };\n\n\t    /*\n\t     * Local polyfill of Object.create\n\n\t     */\n\t    var create = Object.create || (function () {\n\t        function F() {}\n\n\t        return function (obj) {\n\t            var subtype;\n\n\t            F.prototype = obj;\n\n\t            subtype = new F();\n\n\t            F.prototype = null;\n\n\t            return subtype;\n\t        };\n\t    }());\n\n\t    /**\n\t     * CryptoJS namespace.\n\t     */\n\t    var C = {};\n\n\t    /**\n\t     * Library namespace.\n\t     */\n\t    var C_lib = C.lib = {};\n\n\t    /**\n\t     * Base object for prototypal inheritance.\n\t     */\n\t    var Base = C_lib.Base = (function () {\n\n\n\t        return {\n\t            /**\n\t             * Creates a new object that inherits from this object.\n\t             *\n\t             * @param {Object} overrides Properties to copy into the new object.\n\t             *\n\t             * @return {Object} The new object.\n\t             *\n\t             * @static\n\t             *\n\t             * @example\n\t             *\n\t             *     var MyType = CryptoJS.lib.Base.extend({\n\t             *         field: 'value',\n\t             *\n\t             *         method: function () {\n\t             *         }\n\t             *     });\n\t             */\n\t            extend: function (overrides) {\n\t                // Spawn\n\t                var subtype = create(this);\n\n\t                // Augment\n\t                if (overrides) {\n\t                    subtype.mixIn(overrides);\n\t                }\n\n\t                // Create default initializer\n\t                if (!subtype.hasOwnProperty('init') || this.init === subtype.init) {\n\t                    subtype.init = function () {\n\t                        subtype.$super.init.apply(this, arguments);\n\t                    };\n\t                }\n\n\t                // Initializer's prototype is the subtype object\n\t                subtype.init.prototype = subtype;\n\n\t                // Reference supertype\n\t                subtype.$super = this;\n\n\t                return subtype;\n\t            },\n\n\t            /**\n\t             * Extends this object and runs the init method.\n\t             * Arguments to create() will be passed to init().\n\t             *\n\t             * @return {Object} The new object.\n\t             *\n\t             * @static\n\t             *\n\t             * @example\n\t             *\n\t             *     var instance = MyType.create();\n\t             */\n\t            create: function () {\n\t                var instance = this.extend();\n\t                instance.init.apply(instance, arguments);\n\n\t                return instance;\n\t            },\n\n\t            /**\n\t             * Initializes a newly created object.\n\t             * Override this method to add some logic when your objects are created.\n\t             *\n\t             * @example\n\t             *\n\t             *     var MyType = CryptoJS.lib.Base.extend({\n\t             *         init: function () {\n\t             *             // ...\n\t             *         }\n\t             *     });\n\t             */\n\t            init: function () {\n\t            },\n\n\t            /**\n\t             * Copies properties into this object.\n\t             *\n\t             * @param {Object} properties The properties to mix in.\n\t             *\n\t             * @example\n\t             *\n\t             *     MyType.mixIn({\n\t             *         field: 'value'\n\t             *     });\n\t             */\n\t            mixIn: function (properties) {\n\t                for (var propertyName in properties) {\n\t                    if (properties.hasOwnProperty(propertyName)) {\n\t                        this[propertyName] = properties[propertyName];\n\t                    }\n\t                }\n\n\t                // IE won't copy toString using the loop above\n\t                if (properties.hasOwnProperty('toString')) {\n\t                    this.toString = properties.toString;\n\t                }\n\t            },\n\n\t            /**\n\t             * Creates a copy of this object.\n\t             *\n\t             * @return {Object} The clone.\n\t             *\n\t             * @example\n\t             *\n\t             *     var clone = instance.clone();\n\t             */\n\t            clone: function () {\n\t                return this.init.prototype.extend(this);\n\t            }\n\t        };\n\t    }());\n\n\t    /**\n\t     * An array of 32-bit words.\n\t     *\n\t     * @property {Array} words The array of 32-bit words.\n\t     * @property {number} sigBytes The number of significant bytes in this word array.\n\t     */\n\t    var WordArray = C_lib.WordArray = Base.extend({\n\t        /**\n\t         * Initializes a newly created word array.\n\t         *\n\t         * @param {Array} words (Optional) An array of 32-bit words.\n\t         * @param {number} sigBytes (Optional) The number of significant bytes in the words.\n\t         *\n\t         * @example\n\t         *\n\t         *     var wordArray = CryptoJS.lib.WordArray.create();\n\t         *     var wordArray = CryptoJS.lib.WordArray.create([0x00010203, 0x04050607]);\n\t         *     var wordArray = CryptoJS.lib.WordArray.create([0x00010203, 0x04050607], 6);\n\t         */\n\t        init: function (words, sigBytes) {\n\t            words = this.words = words || [];\n\n\t            if (sigBytes != undefined) {\n\t                this.sigBytes = sigBytes;\n\t            } else {\n\t                this.sigBytes = words.length * 4;\n\t            }\n\t        },\n\n\t        /**\n\t         * Converts this word array to a string.\n\t         *\n\t         * @param {Encoder} encoder (Optional) The encoding strategy to use. Default: CryptoJS.enc.Hex\n\t         *\n\t         * @return {string} The stringified word array.\n\t         *\n\t         * @example\n\t         *\n\t         *     var string = wordArray + '';\n\t         *     var string = wordArray.toString();\n\t         *     var string = wordArray.toString(CryptoJS.enc.Utf8);\n\t         */\n\t        toString: function (encoder) {\n\t            return (encoder || Hex).stringify(this);\n\t        },\n\n\t        /**\n\t         * Concatenates a word array to this word array.\n\t         *\n\t         * @param {WordArray} wordArray The word array to append.\n\t         *\n\t         * @return {WordArray} This word array.\n\t         *\n\t         * @example\n\t         *\n\t         *     wordArray1.concat(wordArray2);\n\t         */\n\t        concat: function (wordArray) {\n\t            // Shortcuts\n\t            var thisWords = this.words;\n\t            var thatWords = wordArray.words;\n\t            var thisSigBytes = this.sigBytes;\n\t            var thatSigBytes = wordArray.sigBytes;\n\n\t            // Clamp excess bits\n\t            this.clamp();\n\n\t            // Concat\n\t            if (thisSigBytes % 4) {\n\t                // Copy one byte at a time\n\t                for (var i = 0; i < thatSigBytes; i++) {\n\t                    var thatByte = (thatWords[i >>> 2] >>> (24 - (i % 4) * 8)) & 0xff;\n\t                    thisWords[(thisSigBytes + i) >>> 2] |= thatByte << (24 - ((thisSigBytes + i) % 4) * 8);\n\t                }\n\t            } else {\n\t                // Copy one word at a time\n\t                for (var j = 0; j < thatSigBytes; j += 4) {\n\t                    thisWords[(thisSigBytes + j) >>> 2] = thatWords[j >>> 2];\n\t                }\n\t            }\n\t            this.sigBytes += thatSigBytes;\n\n\t            // Chainable\n\t            return this;\n\t        },\n\n\t        /**\n\t         * Removes insignificant bits.\n\t         *\n\t         * @example\n\t         *\n\t         *     wordArray.clamp();\n\t         */\n\t        clamp: function () {\n\t            // Shortcuts\n\t            var words = this.words;\n\t            var sigBytes = this.sigBytes;\n\n\t            // Clamp\n\t            words[sigBytes >>> 2] &= 0xffffffff << (32 - (sigBytes % 4) * 8);\n\t            words.length = Math.ceil(sigBytes / 4);\n\t        },\n\n\t        /**\n\t         * Creates a copy of this word array.\n\t         *\n\t         * @return {WordArray} The clone.\n\t         *\n\t         * @example\n\t         *\n\t         *     var clone = wordArray.clone();\n\t         */\n\t        clone: function () {\n\t            var clone = Base.clone.call(this);\n\t            clone.words = this.words.slice(0);\n\n\t            return clone;\n\t        },\n\n\t        /**\n\t         * Creates a word array filled with random bytes.\n\t         *\n\t         * @param {number} nBytes The number of random bytes to generate.\n\t         *\n\t         * @return {WordArray} The random word array.\n\t         *\n\t         * @static\n\t         *\n\t         * @example\n\t         *\n\t         *     var wordArray = CryptoJS.lib.WordArray.random(16);\n\t         */\n\t        random: function (nBytes) {\n\t            var words = [];\n\n\t            for (var i = 0; i < nBytes; i += 4) {\n\t                words.push(cryptoSecureRandomInt());\n\t            }\n\n\t            return new WordArray.init(words, nBytes);\n\t        }\n\t    });\n\n\t    /**\n\t     * Encoder namespace.\n\t     */\n\t    var C_enc = C.enc = {};\n\n\t    /**\n\t     * Hex encoding strategy.\n\t     */\n\t    var Hex = C_enc.Hex = {\n\t        /**\n\t         * Converts a word array to a hex string.\n\t         *\n\t         * @param {WordArray} wordArray The word array.\n\t         *\n\t         * @return {string} The hex string.\n\t         *\n\t         * @static\n\t         *\n\t         * @example\n\t         *\n\t         *     var hexString = CryptoJS.enc.Hex.stringify(wordArray);\n\t         */\n\t        stringify: function (wordArray) {\n\t            // Shortcuts\n\t            var words = wordArray.words;\n\t            var sigBytes = wordArray.sigBytes;\n\n\t            // Convert\n\t            var hexChars = [];\n\t            for (var i = 0; i < sigBytes; i++) {\n\t                var bite = (words[i >>> 2] >>> (24 - (i % 4) * 8)) & 0xff;\n\t                hexChars.push((bite >>> 4).toString(16));\n\t                hexChars.push((bite & 0x0f).toString(16));\n\t            }\n\n\t            return hexChars.join('');\n\t        },\n\n\t        /**\n\t         * Converts a hex string to a word array.\n\t         *\n\t         * @param {string} hexStr The hex string.\n\t         *\n\t         * @return {WordArray} The word array.\n\t         *\n\t         * @static\n\t         *\n\t         * @example\n\t         *\n\t         *     var wordArray = CryptoJS.enc.Hex.parse(hexString);\n\t         */\n\t        parse: function (hexStr) {\n\t            // Shortcut\n\t            var hexStrLength = hexStr.length;\n\n\t            // Convert\n\t            var words = [];\n\t            for (var i = 0; i < hexStrLength; i += 2) {\n\t                words[i >>> 3] |= parseInt(hexStr.substr(i, 2), 16) << (24 - (i % 8) * 4);\n\t            }\n\n\t            return new WordArray.init(words, hexStrLength / 2);\n\t        }\n\t    };\n\n\t    /**\n\t     * Latin1 encoding strategy.\n\t     */\n\t    var Latin1 = C_enc.Latin1 = {\n\t        /**\n\t         * Converts a word array to a Latin1 string.\n\t         *\n\t         * @param {WordArray} wordArray The word array.\n\t         *\n\t         * @return {string} The Latin1 string.\n\t         *\n\t         * @static\n\t         *\n\t         * @example\n\t         *\n\t         *     var latin1String = CryptoJS.enc.Latin1.stringify(wordArray);\n\t         */\n\t        stringify: function (wordArray) {\n\t            // Shortcuts\n\t            var words = wordArray.words;\n\t            var sigBytes = wordArray.sigBytes;\n\n\t            // Convert\n\t            var latin1Chars = [];\n\t            for (var i = 0; i < sigBytes; i++) {\n\t                var bite = (words[i >>> 2] >>> (24 - (i % 4) * 8)) & 0xff;\n\t                latin1Chars.push(String.fromCharCode(bite));\n\t            }\n\n\t            return latin1Chars.join('');\n\t        },\n\n\t        /**\n\t         * Converts a Latin1 string to a word array.\n\t         *\n\t         * @param {string} latin1Str The Latin1 string.\n\t         *\n\t         * @return {WordArray} The word array.\n\t         *\n\t         * @static\n\t         *\n\t         * @example\n\t         *\n\t         *     var wordArray = CryptoJS.enc.Latin1.parse(latin1String);\n\t         */\n\t        parse: function (latin1Str) {\n\t            // Shortcut\n\t            var latin1StrLength = latin1Str.length;\n\n\t            // Convert\n\t            var words = [];\n\t            for (var i = 0; i < latin1StrLength; i++) {\n\t                words[i >>> 2] |= (latin1Str.charCodeAt(i) & 0xff) << (24 - (i % 4) * 8);\n\t            }\n\n\t            return new WordArray.init(words, latin1StrLength);\n\t        }\n\t    };\n\n\t    /**\n\t     * UTF-8 encoding strategy.\n\t     */\n\t    var Utf8 = C_enc.Utf8 = {\n\t        /**\n\t         * Converts a word array to a UTF-8 string.\n\t         *\n\t         * @param {WordArray} wordArray The word array.\n\t         *\n\t         * @return {string} The UTF-8 string.\n\t         *\n\t         * @static\n\t         *\n\t         * @example\n\t         *\n\t         *     var utf8String = CryptoJS.enc.Utf8.stringify(wordArray);\n\t         */\n\t        stringify: function (wordArray) {\n\t            try {\n\t                return decodeURIComponent(escape(Latin1.stringify(wordArray)));\n\t            } catch (e) {\n\t                throw new Error('Malformed UTF-8 data');\n\t            }\n\t        },\n\n\t        /**\n\t         * Converts a UTF-8 string to a word array.\n\t         *\n\t         * @param {string} utf8Str The UTF-8 string.\n\t         *\n\t         * @return {WordArray} The word array.\n\t         *\n\t         * @static\n\t         *\n\t         * @example\n\t         *\n\t         *     var wordArray = CryptoJS.enc.Utf8.parse(utf8String);\n\t         */\n\t        parse: function (utf8Str) {\n\t            return Latin1.parse(unescape(encodeURIComponent(utf8Str)));\n\t        }\n\t    };\n\n\t    /**\n\t     * Abstract buffered block algorithm template.\n\t     *\n\t     * The property blockSize must be implemented in a concrete subtype.\n\t     *\n\t     * @property {number} _minBufferSize The number of blocks that should be kept unprocessed in the buffer. Default: 0\n\t     */\n\t    var BufferedBlockAlgorithm = C_lib.BufferedBlockAlgorithm = Base.extend({\n\t        /**\n\t         * Resets this block algorithm's data buffer to its initial state.\n\t         *\n\t         * @example\n\t         *\n\t         *     bufferedBlockAlgorithm.reset();\n\t         */\n\t        reset: function () {\n\t            // Initial values\n\t            this._data = new WordArray.init();\n\t            this._nDataBytes = 0;\n\t        },\n\n\t        /**\n\t         * Adds new data to this block algorithm's buffer.\n\t         *\n\t         * @param {WordArray|string} data The data to append. Strings are converted to a WordArray using UTF-8.\n\t         *\n\t         * @example\n\t         *\n\t         *     bufferedBlockAlgorithm._append('data');\n\t         *     bufferedBlockAlgorithm._append(wordArray);\n\t         */\n\t        _append: function (data) {\n\t            // Convert string to WordArray, else assume WordArray already\n\t            if (typeof data == 'string') {\n\t                data = Utf8.parse(data);\n\t            }\n\n\t            // Append\n\t            this._data.concat(data);\n\t            this._nDataBytes += data.sigBytes;\n\t        },\n\n\t        /**\n\t         * Processes available data blocks.\n\t         *\n\t         * This method invokes _doProcessBlock(offset), which must be implemented by a concrete subtype.\n\t         *\n\t         * @param {boolean} doFlush Whether all blocks and partial blocks should be processed.\n\t         *\n\t         * @return {WordArray} The processed data.\n\t         *\n\t         * @example\n\t         *\n\t         *     var processedData = bufferedBlockAlgorithm._process();\n\t         *     var processedData = bufferedBlockAlgorithm._process(!!'flush');\n\t         */\n\t        _process: function (doFlush) {\n\t            var processedWords;\n\n\t            // Shortcuts\n\t            var data = this._data;\n\t            var dataWords = data.words;\n\t            var dataSigBytes = data.sigBytes;\n\t            var blockSize = this.blockSize;\n\t            var blockSizeBytes = blockSize * 4;\n\n\t            // Count blocks ready\n\t            var nBlocksReady = dataSigBytes / blockSizeBytes;\n\t            if (doFlush) {\n\t                // Round up to include partial blocks\n\t                nBlocksReady = Math.ceil(nBlocksReady);\n\t            } else {\n\t                // Round down to include only full blocks,\n\t                // less the number of blocks that must remain in the buffer\n\t                nBlocksReady = Math.max((nBlocksReady | 0) - this._minBufferSize, 0);\n\t            }\n\n\t            // Count words ready\n\t            var nWordsReady = nBlocksReady * blockSize;\n\n\t            // Count bytes ready\n\t            var nBytesReady = Math.min(nWordsReady * 4, dataSigBytes);\n\n\t            // Process blocks\n\t            if (nWordsReady) {\n\t                for (var offset = 0; offset < nWordsReady; offset += blockSize) {\n\t                    // Perform concrete-algorithm logic\n\t                    this._doProcessBlock(dataWords, offset);\n\t                }\n\n\t                // Remove processed words\n\t                processedWords = dataWords.splice(0, nWordsReady);\n\t                data.sigBytes -= nBytesReady;\n\t            }\n\n\t            // Return processed words\n\t            return new WordArray.init(processedWords, nBytesReady);\n\t        },\n\n\t        /**\n\t         * Creates a copy of this object.\n\t         *\n\t         * @return {Object} The clone.\n\t         *\n\t         * @example\n\t         *\n\t         *     var clone = bufferedBlockAlgorithm.clone();\n\t         */\n\t        clone: function () {\n\t            var clone = Base.clone.call(this);\n\t            clone._data = this._data.clone();\n\n\t            return clone;\n\t        },\n\n\t        _minBufferSize: 0\n\t    });\n\n\t    /**\n\t     * Abstract hasher template.\n\t     *\n\t     * @property {number} blockSize The number of 32-bit words this hasher operates on. Default: 16 (512 bits)\n\t     */\n\t    var Hasher = C_lib.Hasher = BufferedBlockAlgorithm.extend({\n\t        /**\n\t         * Configuration options.\n\t         */\n\t        cfg: Base.extend(),\n\n\t        /**\n\t         * Initializes a newly created hasher.\n\t         *\n\t         * @param {Object} cfg (Optional) The configuration options to use for this hash computation.\n\t         *\n\t         * @example\n\t         *\n\t         *     var hasher = CryptoJS.algo.SHA256.create();\n\t         */\n\t        init: function (cfg) {\n\t            // Apply config defaults\n\t            this.cfg = this.cfg.extend(cfg);\n\n\t            // Set initial values\n\t            this.reset();\n\t        },\n\n\t        /**\n\t         * Resets this hasher to its initial state.\n\t         *\n\t         * @example\n\t         *\n\t         *     hasher.reset();\n\t         */\n\t        reset: function () {\n\t            // Reset data buffer\n\t            BufferedBlockAlgorithm.reset.call(this);\n\n\t            // Perform concrete-hasher logic\n\t            this._doReset();\n\t        },\n\n\t        /**\n\t         * Updates this hasher with a message.\n\t         *\n\t         * @param {WordArray|string} messageUpdate The message to append.\n\t         *\n\t         * @return {Hasher} This hasher.\n\t         *\n\t         * @example\n\t         *\n\t         *     hasher.update('message');\n\t         *     hasher.update(wordArray);\n\t         */\n\t        update: function (messageUpdate) {\n\t            // Append\n\t            this._append(messageUpdate);\n\n\t            // Update the hash\n\t            this._process();\n\n\t            // Chainable\n\t            return this;\n\t        },\n\n\t        /**\n\t         * Finalizes the hash computation.\n\t         * Note that the finalize operation is effectively a destructive, read-once operation.\n\t         *\n\t         * @param {WordArray|string} messageUpdate (Optional) A final message update.\n\t         *\n\t         * @return {WordArray} The hash.\n\t         *\n\t         * @example\n\t         *\n\t         *     var hash = hasher.finalize();\n\t         *     var hash = hasher.finalize('message');\n\t         *     var hash = hasher.finalize(wordArray);\n\t         */\n\t        finalize: function (messageUpdate) {\n\t            // Final message update\n\t            if (messageUpdate) {\n\t                this._append(messageUpdate);\n\t            }\n\n\t            // Perform concrete-hasher logic\n\t            var hash = this._doFinalize();\n\n\t            return hash;\n\t        },\n\n\t        blockSize: 512/32,\n\n\t        /**\n\t         * Creates a shortcut function to a hasher's object interface.\n\t         *\n\t         * @param {Hasher} hasher The hasher to create a helper for.\n\t         *\n\t         * @return {Function} The shortcut function.\n\t         *\n\t         * @static\n\t         *\n\t         * @example\n\t         *\n\t         *     var SHA256 = CryptoJS.lib.Hasher._createHelper(CryptoJS.algo.SHA256);\n\t         */\n\t        _createHelper: function (hasher) {\n\t            return function (message, cfg) {\n\t                return new hasher.init(cfg).finalize(message);\n\t            };\n\t        },\n\n\t        /**\n\t         * Creates a shortcut function to the HMAC's object interface.\n\t         *\n\t         * @param {Hasher} hasher The hasher to use in this HMAC helper.\n\t         *\n\t         * @return {Function} The shortcut function.\n\t         *\n\t         * @static\n\t         *\n\t         * @example\n\t         *\n\t         *     var HmacSHA256 = CryptoJS.lib.Hasher._createHmacHelper(CryptoJS.algo.SHA256);\n\t         */\n\t        _createHmacHelper: function (hasher) {\n\t            return function (message, key) {\n\t                return new C_algo.HMAC.init(hasher, key).finalize(message);\n\t            };\n\t        }\n\t    });\n\n\t    /**\n\t     * Algorithm namespace.\n\t     */\n\t    var C_algo = C.algo = {};\n\n\t    return C;\n\t}(Math));\n\n\n\treturn CryptoJS;\n\n}));","// ::- Persistent data structure representing an ordered mapping from\n// strings to values, with some convenient update methods.\nfunction OrderedMap(content) {\n  this.content = content;\n}\n\nOrderedMap.prototype = {\n  constructor: OrderedMap,\n\n  find: function(key) {\n    for (var i = 0; i < this.content.length; i += 2)\n      if (this.content[i] === key) return i\n    return -1\n  },\n\n  // :: (string) → ?any\n  // Retrieve the value stored under `key`, or return undefined when\n  // no such key exists.\n  get: function(key) {\n    var found = this.find(key);\n    return found == -1 ? undefined : this.content[found + 1]\n  },\n\n  // :: (string, any, ?string) → OrderedMap\n  // Create a new map by replacing the value of `key` with a new\n  // value, or adding a binding to the end of the map. If `newKey` is\n  // given, the key of the binding will be replaced with that key.\n  update: function(key, value, newKey) {\n    var self = newKey && newKey != key ? this.remove(newKey) : this;\n    var found = self.find(key), content = self.content.slice();\n    if (found == -1) {\n      content.push(newKey || key, value);\n    } else {\n      content[found + 1] = value;\n      if (newKey) content[found] = newKey;\n    }\n    return new OrderedMap(content)\n  },\n\n  // :: (string) → OrderedMap\n  // Return a map with the given key removed, if it existed.\n  remove: function(key) {\n    var found = this.find(key);\n    if (found == -1) return this\n    var content = this.content.slice();\n    content.splice(found, 2);\n    return new OrderedMap(content)\n  },\n\n  // :: (string, any) → OrderedMap\n  // Add a new key to the start of the map.\n  addToStart: function(key, value) {\n    return new OrderedMap([key, value].concat(this.remove(key).content))\n  },\n\n  // :: (string, any) → OrderedMap\n  // Add a new key to the end of the map.\n  addToEnd: function(key, value) {\n    var content = this.remove(key).content.slice();\n    content.push(key, value);\n    return new OrderedMap(content)\n  },\n\n  // :: (string, string, any) → OrderedMap\n  // Add a key after the given key. If `place` is not found, the new\n  // key is added to the end.\n  addBefore: function(place, key, value) {\n    var without = this.remove(key), content = without.content.slice();\n    var found = without.find(place);\n    content.splice(found == -1 ? content.length : found, 0, key, value);\n    return new OrderedMap(content)\n  },\n\n  // :: ((key: string, value: any))\n  // Call the given function for each key/value pair in the map, in\n  // order.\n  forEach: function(f) {\n    for (var i = 0; i < this.content.length; i += 2)\n      f(this.content[i], this.content[i + 1]);\n  },\n\n  // :: (union<Object, OrderedMap>) → OrderedMap\n  // Create a new map by prepending the keys in this map that don't\n  // appear in `map` before the keys in `map`.\n  prepend: function(map) {\n    map = OrderedMap.from(map);\n    if (!map.size) return this\n    return new OrderedMap(map.content.concat(this.subtract(map).content))\n  },\n\n  // :: (union<Object, OrderedMap>) → OrderedMap\n  // Create a new map by appending the keys in this map that don't\n  // appear in `map` after the keys in `map`.\n  append: function(map) {\n    map = OrderedMap.from(map);\n    if (!map.size) return this\n    return new OrderedMap(this.subtract(map).content.concat(map.content))\n  },\n\n  // :: (union<Object, OrderedMap>) → OrderedMap\n  // Create a map containing all the keys in this map that don't\n  // appear in `map`.\n  subtract: function(map) {\n    var result = this;\n    map = OrderedMap.from(map);\n    for (var i = 0; i < map.content.length; i += 2)\n      result = result.remove(map.content[i]);\n    return result\n  },\n\n  // :: number\n  // The amount of keys in this map.\n  get size() {\n    return this.content.length >> 1\n  }\n};\n\n// :: (?union<Object, OrderedMap>) → OrderedMap\n// Return a map with the given content. If null, create an empty\n// map. If given an ordered map, return that map itself. If given an\n// object, create a map from the object's properties.\nOrderedMap.from = function(value) {\n  if (value instanceof OrderedMap) return value\n  var content = [];\n  if (value) for (var prop in value) content.push(prop, value[prop]);\n  return new OrderedMap(content)\n};\n\nvar orderedmap = OrderedMap;\n\nexport default orderedmap;\n","import OrderedMap from 'orderedmap';\n\nfunction findDiffStart(a, b, pos) {\n  for (var i = 0;; i++) {\n    if (i == a.childCount || i == b.childCount)\n      { return a.childCount == b.childCount ? null : pos }\n\n    var childA = a.child(i), childB = b.child(i);\n    if (childA == childB) { pos += childA.nodeSize; continue }\n\n    if (!childA.sameMarkup(childB)) { return pos }\n\n    if (childA.isText && childA.text != childB.text) {\n      for (var j = 0; childA.text[j] == childB.text[j]; j++)\n        { pos++; }\n      return pos\n    }\n    if (childA.content.size || childB.content.size) {\n      var inner = findDiffStart(childA.content, childB.content, pos + 1);\n      if (inner != null) { return inner }\n    }\n    pos += childA.nodeSize;\n  }\n}\n\nfunction findDiffEnd(a, b, posA, posB) {\n  for (var iA = a.childCount, iB = b.childCount;;) {\n    if (iA == 0 || iB == 0)\n      { return iA == iB ? null : {a: posA, b: posB} }\n\n    var childA = a.child(--iA), childB = b.child(--iB), size = childA.nodeSize;\n    if (childA == childB) {\n      posA -= size; posB -= size;\n      continue\n    }\n\n    if (!childA.sameMarkup(childB)) { return {a: posA, b: posB} }\n\n    if (childA.isText && childA.text != childB.text) {\n      var same = 0, minSize = Math.min(childA.text.length, childB.text.length);\n      while (same < minSize && childA.text[childA.text.length - same - 1] == childB.text[childB.text.length - same - 1]) {\n        same++; posA--; posB--;\n      }\n      return {a: posA, b: posB}\n    }\n    if (childA.content.size || childB.content.size) {\n      var inner = findDiffEnd(childA.content, childB.content, posA - 1, posB - 1);\n      if (inner) { return inner }\n    }\n    posA -= size; posB -= size;\n  }\n}\n\n// ::- A fragment represents a node's collection of child nodes.\n//\n// Like nodes, fragments are persistent data structures, and you\n// should not mutate them or their content. Rather, you create new\n// instances whenever needed. The API tries to make this easy.\nvar Fragment = function Fragment(content, size) {\n  this.content = content;\n  // :: number\n  // The size of the fragment, which is the total of the size of its\n  // content nodes.\n  this.size = size || 0;\n  if (size == null) { for (var i = 0; i < content.length; i++)\n    { this.size += content[i].nodeSize; } }\n};\n\nvar prototypeAccessors = { firstChild: { configurable: true },lastChild: { configurable: true },childCount: { configurable: true } };\n\n// :: (number, number, (node: Node, start: number, parent: Node, index: number) → ?bool, ?number)\n// Invoke a callback for all descendant nodes between the given two\n// positions (relative to start of this fragment). Doesn't descend\n// into a node when the callback returns `false`.\nFragment.prototype.nodesBetween = function nodesBetween (from, to, f, nodeStart, parent) {\n    if ( nodeStart === void 0 ) nodeStart = 0;\n\n  for (var i = 0, pos = 0; pos < to; i++) {\n    var child = this.content[i], end = pos + child.nodeSize;\n    if (end > from && f(child, nodeStart + pos, parent, i) !== false && child.content.size) {\n      var start = pos + 1;\n      child.nodesBetween(Math.max(0, from - start),\n                         Math.min(child.content.size, to - start),\n                         f, nodeStart + start);\n    }\n    pos = end;\n  }\n};\n\n// :: ((node: Node, pos: number, parent: Node) → ?bool)\n// Call the given callback for every descendant node. The callback\n// may return `false` to prevent traversal of a given node's children.\nFragment.prototype.descendants = function descendants (f) {\n  this.nodesBetween(0, this.size, f);\n};\n\n// :: (number, number, ?string, ?union<string, (leafNode: Node) → string>) → string\n// Extract the text between `from` and `to`. See the same method on\n// [`Node`](#model.Node.textBetween).\nFragment.prototype.textBetween = function textBetween (from, to, blockSeparator, leafText) {\n  var text = \"\", separated = true;\n  this.nodesBetween(from, to, function (node, pos) {\n    if (node.isText) {\n      text += node.text.slice(Math.max(from, pos) - pos, to - pos);\n      separated = !blockSeparator;\n    } else if (node.isLeaf && leafText) {\n      text += typeof leafText === 'function' ? leafText(node): leafText;\n      separated = !blockSeparator;\n    } else if (!separated && node.isBlock) {\n      text += blockSeparator;\n      separated = true;\n    }\n  }, 0);\n  return text\n};\n\n// :: (Fragment) → Fragment\n// Create a new fragment containing the combined content of this\n// fragment and the other.\nFragment.prototype.append = function append (other) {\n  if (!other.size) { return this }\n  if (!this.size) { return other }\n  var last = this.lastChild, first = other.firstChild, content = this.content.slice(), i = 0;\n  if (last.isText && last.sameMarkup(first)) {\n    content[content.length - 1] = last.withText(last.text + first.text);\n    i = 1;\n  }\n  for (; i < other.content.length; i++) { content.push(other.content[i]); }\n  return new Fragment(content, this.size + other.size)\n};\n\n// :: (number, ?number) → Fragment\n// Cut out the sub-fragment between the two given positions.\nFragment.prototype.cut = function cut (from, to) {\n  if (to == null) { to = this.size; }\n  if (from == 0 && to == this.size) { return this }\n  var result = [], size = 0;\n  if (to > from) { for (var i = 0, pos = 0; pos < to; i++) {\n    var child = this.content[i], end = pos + child.nodeSize;\n    if (end > from) {\n      if (pos < from || end > to) {\n        if (child.isText)\n          { child = child.cut(Math.max(0, from - pos), Math.min(child.text.length, to - pos)); }\n        else\n          { child = child.cut(Math.max(0, from - pos - 1), Math.min(child.content.size, to - pos - 1)); }\n      }\n      result.push(child);\n      size += child.nodeSize;\n    }\n    pos = end;\n  } }\n  return new Fragment(result, size)\n};\n\nFragment.prototype.cutByIndex = function cutByIndex (from, to) {\n  if (from == to) { return Fragment.empty }\n  if (from == 0 && to == this.content.length) { return this }\n  return new Fragment(this.content.slice(from, to))\n};\n\n// :: (number, Node) → Fragment\n// Create a new fragment in which the node at the given index is\n// replaced by the given node.\nFragment.prototype.replaceChild = function replaceChild (index, node) {\n  var current = this.content[index];\n  if (current == node) { return this }\n  var copy = this.content.slice();\n  var size = this.size + node.nodeSize - current.nodeSize;\n  copy[index] = node;\n  return new Fragment(copy, size)\n};\n\n// : (Node) → Fragment\n// Create a new fragment by prepending the given node to this\n// fragment.\nFragment.prototype.addToStart = function addToStart (node) {\n  return new Fragment([node].concat(this.content), this.size + node.nodeSize)\n};\n\n// : (Node) → Fragment\n// Create a new fragment by appending the given node to this\n// fragment.\nFragment.prototype.addToEnd = function addToEnd (node) {\n  return new Fragment(this.content.concat(node), this.size + node.nodeSize)\n};\n\n// :: (Fragment) → bool\n// Compare this fragment to another one.\nFragment.prototype.eq = function eq (other) {\n  if (this.content.length != other.content.length) { return false }\n  for (var i = 0; i < this.content.length; i++)\n    { if (!this.content[i].eq(other.content[i])) { return false } }\n  return true\n};\n\n// :: ?Node\n// The first child of the fragment, or `null` if it is empty.\nprototypeAccessors.firstChild.get = function () { return this.content.length ? this.content[0] : null };\n\n// :: ?Node\n// The last child of the fragment, or `null` if it is empty.\nprototypeAccessors.lastChild.get = function () { return this.content.length ? this.content[this.content.length - 1] : null };\n\n// :: number\n// The number of child nodes in this fragment.\nprototypeAccessors.childCount.get = function () { return this.content.length };\n\n// :: (number) → Node\n// Get the child node at the given index. Raise an error when the\n// index is out of range.\nFragment.prototype.child = function child (index) {\n  var found = this.content[index];\n  if (!found) { throw new RangeError(\"Index \" + index + \" out of range for \" + this) }\n  return found\n};\n\n// :: (number) → ?Node\n// Get the child node at the given index, if it exists.\nFragment.prototype.maybeChild = function maybeChild (index) {\n  return this.content[index]\n};\n\n// :: ((node: Node, offset: number, index: number))\n// Call `f` for every child node, passing the node, its offset\n// into this parent node, and its index.\nFragment.prototype.forEach = function forEach (f) {\n  for (var i = 0, p = 0; i < this.content.length; i++) {\n    var child = this.content[i];\n    f(child, p, i);\n    p += child.nodeSize;\n  }\n};\n\n// :: (Fragment) → ?number\n// Find the first position at which this fragment and another\n// fragment differ, or `null` if they are the same.\nFragment.prototype.findDiffStart = function findDiffStart$1 (other, pos) {\n    if ( pos === void 0 ) pos = 0;\n\n  return findDiffStart(this, other, pos)\n};\n\n// :: (Fragment) → ?{a: number, b: number}\n// Find the first position, searching from the end, at which this\n// fragment and the given fragment differ, or `null` if they are the\n// same. Since this position will not be the same in both nodes, an\n// object with two separate positions is returned.\nFragment.prototype.findDiffEnd = function findDiffEnd$1 (other, pos, otherPos) {\n    if ( pos === void 0 ) pos = this.size;\n    if ( otherPos === void 0 ) otherPos = other.size;\n\n  return findDiffEnd(this, other, pos, otherPos)\n};\n\n// : (number, ?number) → {index: number, offset: number}\n// Find the index and inner offset corresponding to a given relative\n// position in this fragment. The result object will be reused\n// (overwritten) the next time the function is called. (Not public.)\nFragment.prototype.findIndex = function findIndex (pos, round) {\n    if ( round === void 0 ) round = -1;\n\n  if (pos == 0) { return retIndex(0, pos) }\n  if (pos == this.size) { return retIndex(this.content.length, pos) }\n  if (pos > this.size || pos < 0) { throw new RangeError((\"Position \" + pos + \" outside of fragment (\" + (this) + \")\")) }\n  for (var i = 0, curPos = 0;; i++) {\n    var cur = this.child(i), end = curPos + cur.nodeSize;\n    if (end >= pos) {\n      if (end == pos || round > 0) { return retIndex(i + 1, end) }\n      return retIndex(i, curPos)\n    }\n    curPos = end;\n  }\n};\n\n// :: () → string\n// Return a debugging string that describes this fragment.\nFragment.prototype.toString = function toString () { return \"<\" + this.toStringInner() + \">\" };\n\nFragment.prototype.toStringInner = function toStringInner () { return this.content.join(\", \") };\n\n// :: () → ?Object\n// Create a JSON-serializeable representation of this fragment.\nFragment.prototype.toJSON = function toJSON () {\n  return this.content.length ? this.content.map(function (n) { return n.toJSON(); }) : null\n};\n\n// :: (Schema, ?Object) → Fragment\n// Deserialize a fragment from its JSON representation.\nFragment.fromJSON = function fromJSON (schema, value) {\n  if (!value) { return Fragment.empty }\n  if (!Array.isArray(value)) { throw new RangeError(\"Invalid input for Fragment.fromJSON\") }\n  return new Fragment(value.map(schema.nodeFromJSON))\n};\n\n// :: ([Node]) → Fragment\n// Build a fragment from an array of nodes. Ensures that adjacent\n// text nodes with the same marks are joined together.\nFragment.fromArray = function fromArray (array) {\n  if (!array.length) { return Fragment.empty }\n  var joined, size = 0;\n  for (var i = 0; i < array.length; i++) {\n    var node = array[i];\n    size += node.nodeSize;\n    if (i && node.isText && array[i - 1].sameMarkup(node)) {\n      if (!joined) { joined = array.slice(0, i); }\n      joined[joined.length - 1] = node.withText(joined[joined.length - 1].text + node.text);\n    } else if (joined) {\n      joined.push(node);\n    }\n  }\n  return new Fragment(joined || array, size)\n};\n\n// :: (?union<Fragment, Node, [Node]>) → Fragment\n// Create a fragment from something that can be interpreted as a set\n// of nodes. For `null`, it returns the empty fragment. For a\n// fragment, the fragment itself. For a node or array of nodes, a\n// fragment containing those nodes.\nFragment.from = function from (nodes) {\n  if (!nodes) { return Fragment.empty }\n  if (nodes instanceof Fragment) { return nodes }\n  if (Array.isArray(nodes)) { return this.fromArray(nodes) }\n  if (nodes.attrs) { return new Fragment([nodes], nodes.nodeSize) }\n  throw new RangeError(\"Can not convert \" + nodes + \" to a Fragment\" +\n                       (nodes.nodesBetween ? \" (looks like multiple versions of prosemirror-model were loaded)\" : \"\"))\n};\n\nObject.defineProperties( Fragment.prototype, prototypeAccessors );\n\nvar found = {index: 0, offset: 0};\nfunction retIndex(index, offset) {\n  found.index = index;\n  found.offset = offset;\n  return found\n}\n\n// :: Fragment\n// An empty fragment. Intended to be reused whenever a node doesn't\n// contain anything (rather than allocating a new empty fragment for\n// each leaf node).\nFragment.empty = new Fragment([], 0);\n\nfunction compareDeep(a, b) {\n  if (a === b) { return true }\n  if (!(a && typeof a == \"object\") ||\n      !(b && typeof b == \"object\")) { return false }\n  var array = Array.isArray(a);\n  if (Array.isArray(b) != array) { return false }\n  if (array) {\n    if (a.length != b.length) { return false }\n    for (var i = 0; i < a.length; i++) { if (!compareDeep(a[i], b[i])) { return false } }\n  } else {\n    for (var p in a) { if (!(p in b) || !compareDeep(a[p], b[p])) { return false } }\n    for (var p$1 in b) { if (!(p$1 in a)) { return false } }\n  }\n  return true\n}\n\n// ::- A mark is a piece of information that can be attached to a node,\n// such as it being emphasized, in code font, or a link. It has a type\n// and optionally a set of attributes that provide further information\n// (such as the target of the link). Marks are created through a\n// `Schema`, which controls which types exist and which\n// attributes they have.\nvar Mark = function Mark(type, attrs) {\n  // :: MarkType\n  // The type of this mark.\n  this.type = type;\n  // :: Object\n  // The attributes associated with this mark.\n  this.attrs = attrs;\n};\n\n// :: ([Mark]) → [Mark]\n// Given a set of marks, create a new set which contains this one as\n// well, in the right position. If this mark is already in the set,\n// the set itself is returned. If any marks that are set to be\n// [exclusive](#model.MarkSpec.excludes) with this mark are present,\n// those are replaced by this one.\nMark.prototype.addToSet = function addToSet (set) {\n  var copy, placed = false;\n  for (var i = 0; i < set.length; i++) {\n    var other = set[i];\n    if (this.eq(other)) { return set }\n    if (this.type.excludes(other.type)) {\n      if (!copy) { copy = set.slice(0, i); }\n    } else if (other.type.excludes(this.type)) {\n      return set\n    } else {\n      if (!placed && other.type.rank > this.type.rank) {\n        if (!copy) { copy = set.slice(0, i); }\n        copy.push(this);\n        placed = true;\n      }\n      if (copy) { copy.push(other); }\n    }\n  }\n  if (!copy) { copy = set.slice(); }\n  if (!placed) { copy.push(this); }\n  return copy\n};\n\n// :: ([Mark]) → [Mark]\n// Remove this mark from the given set, returning a new set. If this\n// mark is not in the set, the set itself is returned.\nMark.prototype.removeFromSet = function removeFromSet (set) {\n  for (var i = 0; i < set.length; i++)\n    { if (this.eq(set[i]))\n      { return set.slice(0, i).concat(set.slice(i + 1)) } }\n  return set\n};\n\n// :: ([Mark]) → bool\n// Test whether this mark is in the given set of marks.\nMark.prototype.isInSet = function isInSet (set) {\n  for (var i = 0; i < set.length; i++)\n    { if (this.eq(set[i])) { return true } }\n  return false\n};\n\n// :: (Mark) → bool\n// Test whether this mark has the same type and attributes as\n// another mark.\nMark.prototype.eq = function eq (other) {\n  return this == other ||\n    (this.type == other.type && compareDeep(this.attrs, other.attrs))\n};\n\n// :: () → Object\n// Convert this mark to a JSON-serializeable representation.\nMark.prototype.toJSON = function toJSON () {\n  var obj = {type: this.type.name};\n  for (var _ in this.attrs) {\n    obj.attrs = this.attrs;\n    break\n  }\n  return obj\n};\n\n// :: (Schema, Object) → Mark\nMark.fromJSON = function fromJSON (schema, json) {\n  if (!json) { throw new RangeError(\"Invalid input for Mark.fromJSON\") }\n  var type = schema.marks[json.type];\n  if (!type) { throw new RangeError((\"There is no mark type \" + (json.type) + \" in this schema\")) }\n  return type.create(json.attrs)\n};\n\n// :: ([Mark], [Mark]) → bool\n// Test whether two sets of marks are identical.\nMark.sameSet = function sameSet (a, b) {\n  if (a == b) { return true }\n  if (a.length != b.length) { return false }\n  for (var i = 0; i < a.length; i++)\n    { if (!a[i].eq(b[i])) { return false } }\n  return true\n};\n\n// :: (?union<Mark, [Mark]>) → [Mark]\n// Create a properly sorted mark set from null, a single mark, or an\n// unsorted array of marks.\nMark.setFrom = function setFrom (marks) {\n  if (!marks || marks.length == 0) { return Mark.none }\n  if (marks instanceof Mark) { return [marks] }\n  var copy = marks.slice();\n  copy.sort(function (a, b) { return a.type.rank - b.type.rank; });\n  return copy\n};\n\n// :: [Mark] The empty set of marks.\nMark.none = [];\n\n// ReplaceError:: class extends Error\n// Error type raised by [`Node.replace`](#model.Node.replace) when\n// given an invalid replacement.\n\nfunction ReplaceError(message) {\n  var err = Error.call(this, message);\n  err.__proto__ = ReplaceError.prototype;\n  return err\n}\n\nReplaceError.prototype = Object.create(Error.prototype);\nReplaceError.prototype.constructor = ReplaceError;\nReplaceError.prototype.name = \"ReplaceError\";\n\n// ::- A slice represents a piece cut out of a larger document. It\n// stores not only a fragment, but also the depth up to which nodes on\n// both side are ‘open’ (cut through).\nvar Slice = function Slice(content, openStart, openEnd) {\n  // :: Fragment The slice's content.\n  this.content = content;\n  // :: number The open depth at the start.\n  this.openStart = openStart;\n  // :: number The open depth at the end.\n  this.openEnd = openEnd;\n};\n\nvar prototypeAccessors$1 = { size: { configurable: true } };\n\n// :: number\n// The size this slice would add when inserted into a document.\nprototypeAccessors$1.size.get = function () {\n  return this.content.size - this.openStart - this.openEnd\n};\n\nSlice.prototype.insertAt = function insertAt (pos, fragment) {\n  var content = insertInto(this.content, pos + this.openStart, fragment, null);\n  return content && new Slice(content, this.openStart, this.openEnd)\n};\n\nSlice.prototype.removeBetween = function removeBetween (from, to) {\n  return new Slice(removeRange(this.content, from + this.openStart, to + this.openStart), this.openStart, this.openEnd)\n};\n\n// :: (Slice) → bool\n// Tests whether this slice is equal to another slice.\nSlice.prototype.eq = function eq (other) {\n  return this.content.eq(other.content) && this.openStart == other.openStart && this.openEnd == other.openEnd\n};\n\nSlice.prototype.toString = function toString () {\n  return this.content + \"(\" + this.openStart + \",\" + this.openEnd + \")\"\n};\n\n// :: () → ?Object\n// Convert a slice to a JSON-serializable representation.\nSlice.prototype.toJSON = function toJSON () {\n  if (!this.content.size) { return null }\n  var json = {content: this.content.toJSON()};\n  if (this.openStart > 0) { json.openStart = this.openStart; }\n  if (this.openEnd > 0) { json.openEnd = this.openEnd; }\n  return json\n};\n\n// :: (Schema, ?Object) → Slice\n// Deserialize a slice from its JSON representation.\nSlice.fromJSON = function fromJSON (schema, json) {\n  if (!json) { return Slice.empty }\n  var openStart = json.openStart || 0, openEnd = json.openEnd || 0;\n  if (typeof openStart != \"number\" || typeof openEnd != \"number\")\n    { throw new RangeError(\"Invalid input for Slice.fromJSON\") }\n  return new Slice(Fragment.fromJSON(schema, json.content), openStart, openEnd)\n};\n\n// :: (Fragment, ?bool) → Slice\n// Create a slice from a fragment by taking the maximum possible\n// open value on both side of the fragment.\nSlice.maxOpen = function maxOpen (fragment, openIsolating) {\n    if ( openIsolating === void 0 ) openIsolating=true;\n\n  var openStart = 0, openEnd = 0;\n  for (var n = fragment.firstChild; n && !n.isLeaf && (openIsolating || !n.type.spec.isolating); n = n.firstChild) { openStart++; }\n  for (var n$1 = fragment.lastChild; n$1 && !n$1.isLeaf && (openIsolating || !n$1.type.spec.isolating); n$1 = n$1.lastChild) { openEnd++; }\n  return new Slice(fragment, openStart, openEnd)\n};\n\nObject.defineProperties( Slice.prototype, prototypeAccessors$1 );\n\nfunction removeRange(content, from, to) {\n  var ref = content.findIndex(from);\n  var index = ref.index;\n  var offset = ref.offset;\n  var child = content.maybeChild(index);\n  var ref$1 = content.findIndex(to);\n  var indexTo = ref$1.index;\n  var offsetTo = ref$1.offset;\n  if (offset == from || child.isText) {\n    if (offsetTo != to && !content.child(indexTo).isText) { throw new RangeError(\"Removing non-flat range\") }\n    return content.cut(0, from).append(content.cut(to))\n  }\n  if (index != indexTo) { throw new RangeError(\"Removing non-flat range\") }\n  return content.replaceChild(index, child.copy(removeRange(child.content, from - offset - 1, to - offset - 1)))\n}\n\nfunction insertInto(content, dist, insert, parent) {\n  var ref = content.findIndex(dist);\n  var index = ref.index;\n  var offset = ref.offset;\n  var child = content.maybeChild(index);\n  if (offset == dist || child.isText) {\n    if (parent && !parent.canReplace(index, index, insert)) { return null }\n    return content.cut(0, dist).append(insert).append(content.cut(dist))\n  }\n  var inner = insertInto(child.content, dist - offset - 1, insert);\n  return inner && content.replaceChild(index, child.copy(inner))\n}\n\n// :: Slice\n// The empty slice.\nSlice.empty = new Slice(Fragment.empty, 0, 0);\n\nfunction replace($from, $to, slice) {\n  if (slice.openStart > $from.depth)\n    { throw new ReplaceError(\"Inserted content deeper than insertion position\") }\n  if ($from.depth - slice.openStart != $to.depth - slice.openEnd)\n    { throw new ReplaceError(\"Inconsistent open depths\") }\n  return replaceOuter($from, $to, slice, 0)\n}\n\nfunction replaceOuter($from, $to, slice, depth) {\n  var index = $from.index(depth), node = $from.node(depth);\n  if (index == $to.index(depth) && depth < $from.depth - slice.openStart) {\n    var inner = replaceOuter($from, $to, slice, depth + 1);\n    return node.copy(node.content.replaceChild(index, inner))\n  } else if (!slice.content.size) {\n    return close(node, replaceTwoWay($from, $to, depth))\n  } else if (!slice.openStart && !slice.openEnd && $from.depth == depth && $to.depth == depth) { // Simple, flat case\n    var parent = $from.parent, content = parent.content;\n    return close(parent, content.cut(0, $from.parentOffset).append(slice.content).append(content.cut($to.parentOffset)))\n  } else {\n    var ref = prepareSliceForReplace(slice, $from);\n    var start = ref.start;\n    var end = ref.end;\n    return close(node, replaceThreeWay($from, start, end, $to, depth))\n  }\n}\n\nfunction checkJoin(main, sub) {\n  if (!sub.type.compatibleContent(main.type))\n    { throw new ReplaceError(\"Cannot join \" + sub.type.name + \" onto \" + main.type.name) }\n}\n\nfunction joinable($before, $after, depth) {\n  var node = $before.node(depth);\n  checkJoin(node, $after.node(depth));\n  return node\n}\n\nfunction addNode(child, target) {\n  var last = target.length - 1;\n  if (last >= 0 && child.isText && child.sameMarkup(target[last]))\n    { target[last] = child.withText(target[last].text + child.text); }\n  else\n    { target.push(child); }\n}\n\nfunction addRange($start, $end, depth, target) {\n  var node = ($end || $start).node(depth);\n  var startIndex = 0, endIndex = $end ? $end.index(depth) : node.childCount;\n  if ($start) {\n    startIndex = $start.index(depth);\n    if ($start.depth > depth) {\n      startIndex++;\n    } else if ($start.textOffset) {\n      addNode($start.nodeAfter, target);\n      startIndex++;\n    }\n  }\n  for (var i = startIndex; i < endIndex; i++) { addNode(node.child(i), target); }\n  if ($end && $end.depth == depth && $end.textOffset)\n    { addNode($end.nodeBefore, target); }\n}\n\nfunction close(node, content) {\n  if (!node.type.validContent(content))\n    { throw new ReplaceError(\"Invalid content for node \" + node.type.name) }\n  return node.copy(content)\n}\n\nfunction replaceThreeWay($from, $start, $end, $to, depth) {\n  var openStart = $from.depth > depth && joinable($from, $start, depth + 1);\n  var openEnd = $to.depth > depth && joinable($end, $to, depth + 1);\n\n  var content = [];\n  addRange(null, $from, depth, content);\n  if (openStart && openEnd && $start.index(depth) == $end.index(depth)) {\n    checkJoin(openStart, openEnd);\n    addNode(close(openStart, replaceThreeWay($from, $start, $end, $to, depth + 1)), content);\n  } else {\n    if (openStart)\n      { addNode(close(openStart, replaceTwoWay($from, $start, depth + 1)), content); }\n    addRange($start, $end, depth, content);\n    if (openEnd)\n      { addNode(close(openEnd, replaceTwoWay($end, $to, depth + 1)), content); }\n  }\n  addRange($to, null, depth, content);\n  return new Fragment(content)\n}\n\nfunction replaceTwoWay($from, $to, depth) {\n  var content = [];\n  addRange(null, $from, depth, content);\n  if ($from.depth > depth) {\n    var type = joinable($from, $to, depth + 1);\n    addNode(close(type, replaceTwoWay($from, $to, depth + 1)), content);\n  }\n  addRange($to, null, depth, content);\n  return new Fragment(content)\n}\n\nfunction prepareSliceForReplace(slice, $along) {\n  var extra = $along.depth - slice.openStart, parent = $along.node(extra);\n  var node = parent.copy(slice.content);\n  for (var i = extra - 1; i >= 0; i--)\n    { node = $along.node(i).copy(Fragment.from(node)); }\n  return {start: node.resolveNoCache(slice.openStart + extra),\n          end: node.resolveNoCache(node.content.size - slice.openEnd - extra)}\n}\n\n// ::- You can [_resolve_](#model.Node.resolve) a position to get more\n// information about it. Objects of this class represent such a\n// resolved position, providing various pieces of context information,\n// and some helper methods.\n//\n// Throughout this interface, methods that take an optional `depth`\n// parameter will interpret undefined as `this.depth` and negative\n// numbers as `this.depth + value`.\nvar ResolvedPos = function ResolvedPos(pos, path, parentOffset) {\n  // :: number The position that was resolved.\n  this.pos = pos;\n  this.path = path;\n  // :: number\n  // The number of levels the parent node is from the root. If this\n  // position points directly into the root node, it is 0. If it\n  // points into a top-level paragraph, 1, and so on.\n  this.depth = path.length / 3 - 1;\n  // :: number The offset this position has into its parent node.\n  this.parentOffset = parentOffset;\n};\n\nvar prototypeAccessors$2 = { parent: { configurable: true },doc: { configurable: true },textOffset: { configurable: true },nodeAfter: { configurable: true },nodeBefore: { configurable: true } };\n\nResolvedPos.prototype.resolveDepth = function resolveDepth (val) {\n  if (val == null) { return this.depth }\n  if (val < 0) { return this.depth + val }\n  return val\n};\n\n// :: Node\n// The parent node that the position points into. Note that even if\n// a position points into a text node, that node is not considered\n// the parent—text nodes are ‘flat’ in this model, and have no content.\nprototypeAccessors$2.parent.get = function () { return this.node(this.depth) };\n\n// :: Node\n// The root node in which the position was resolved.\nprototypeAccessors$2.doc.get = function () { return this.node(0) };\n\n// :: (?number) → Node\n// The ancestor node at the given level. `p.node(p.depth)` is the\n// same as `p.parent`.\nResolvedPos.prototype.node = function node (depth) { return this.path[this.resolveDepth(depth) * 3] };\n\n// :: (?number) → number\n// The index into the ancestor at the given level. If this points at\n// the 3rd node in the 2nd paragraph on the top level, for example,\n// `p.index(0)` is 1 and `p.index(1)` is 2.\nResolvedPos.prototype.index = function index (depth) { return this.path[this.resolveDepth(depth) * 3 + 1] };\n\n// :: (?number) → number\n// The index pointing after this position into the ancestor at the\n// given level.\nResolvedPos.prototype.indexAfter = function indexAfter (depth) {\n  depth = this.resolveDepth(depth);\n  return this.index(depth) + (depth == this.depth && !this.textOffset ? 0 : 1)\n};\n\n// :: (?number) → number\n// The (absolute) position at the start of the node at the given\n// level.\nResolvedPos.prototype.start = function start (depth) {\n  depth = this.resolveDepth(depth);\n  return depth == 0 ? 0 : this.path[depth * 3 - 1] + 1\n};\n\n// :: (?number) → number\n// The (absolute) position at the end of the node at the given\n// level.\nResolvedPos.prototype.end = function end (depth) {\n  depth = this.resolveDepth(depth);\n  return this.start(depth) + this.node(depth).content.size\n};\n\n// :: (?number) → number\n// The (absolute) position directly before the wrapping node at the\n// given level, or, when `depth` is `this.depth + 1`, the original\n// position.\nResolvedPos.prototype.before = function before (depth) {\n  depth = this.resolveDepth(depth);\n  if (!depth) { throw new RangeError(\"There is no position before the top-level node\") }\n  return depth == this.depth + 1 ? this.pos : this.path[depth * 3 - 1]\n};\n\n// :: (?number) → number\n// The (absolute) position directly after the wrapping node at the\n// given level, or the original position when `depth` is `this.depth + 1`.\nResolvedPos.prototype.after = function after (depth) {\n  depth = this.resolveDepth(depth);\n  if (!depth) { throw new RangeError(\"There is no position after the top-level node\") }\n  return depth == this.depth + 1 ? this.pos : this.path[depth * 3 - 1] + this.path[depth * 3].nodeSize\n};\n\n// :: number\n// When this position points into a text node, this returns the\n// distance between the position and the start of the text node.\n// Will be zero for positions that point between nodes.\nprototypeAccessors$2.textOffset.get = function () { return this.pos - this.path[this.path.length - 1] };\n\n// :: ?Node\n// Get the node directly after the position, if any. If the position\n// points into a text node, only the part of that node after the\n// position is returned.\nprototypeAccessors$2.nodeAfter.get = function () {\n  var parent = this.parent, index = this.index(this.depth);\n  if (index == parent.childCount) { return null }\n  var dOff = this.pos - this.path[this.path.length - 1], child = parent.child(index);\n  return dOff ? parent.child(index).cut(dOff) : child\n};\n\n// :: ?Node\n// Get the node directly before the position, if any. If the\n// position points into a text node, only the part of that node\n// before the position is returned.\nprototypeAccessors$2.nodeBefore.get = function () {\n  var index = this.index(this.depth);\n  var dOff = this.pos - this.path[this.path.length - 1];\n  if (dOff) { return this.parent.child(index).cut(0, dOff) }\n  return index == 0 ? null : this.parent.child(index - 1)\n};\n\n// :: (number, ?number) → number\n// Get the position at the given index in the parent node at the\n// given depth (which defaults to `this.depth`).\nResolvedPos.prototype.posAtIndex = function posAtIndex (index, depth) {\n  depth = this.resolveDepth(depth);\n  var node = this.path[depth * 3], pos = depth == 0 ? 0 : this.path[depth * 3 - 1] + 1;\n  for (var i = 0; i < index; i++) { pos += node.child(i).nodeSize; }\n  return pos\n};\n\n// :: () → [Mark]\n// Get the marks at this position, factoring in the surrounding\n// marks' [`inclusive`](#model.MarkSpec.inclusive) property. If the\n// position is at the start of a non-empty node, the marks of the\n// node after it (if any) are returned.\nResolvedPos.prototype.marks = function marks () {\n  var parent = this.parent, index = this.index();\n\n  // In an empty parent, return the empty array\n  if (parent.content.size == 0) { return Mark.none }\n\n  // When inside a text node, just return the text node's marks\n  if (this.textOffset) { return parent.child(index).marks }\n\n  var main = parent.maybeChild(index - 1), other = parent.maybeChild(index);\n  // If the `after` flag is true of there is no node before, make\n  // the node after this position the main reference.\n  if (!main) { var tmp = main; main = other; other = tmp; }\n\n  // Use all marks in the main node, except those that have\n  // `inclusive` set to false and are not present in the other node.\n  var marks = main.marks;\n  for (var i = 0; i < marks.length; i++)\n    { if (marks[i].type.spec.inclusive === false && (!other || !marks[i].isInSet(other.marks)))\n      { marks = marks[i--].removeFromSet(marks); } }\n\n  return marks\n};\n\n// :: (ResolvedPos) → ?[Mark]\n// Get the marks after the current position, if any, except those\n// that are non-inclusive and not present at position `$end`. This\n// is mostly useful for getting the set of marks to preserve after a\n// deletion. Will return `null` if this position is at the end of\n// its parent node or its parent node isn't a textblock (in which\n// case no marks should be preserved).\nResolvedPos.prototype.marksAcross = function marksAcross ($end) {\n  var after = this.parent.maybeChild(this.index());\n  if (!after || !after.isInline) { return null }\n\n  var marks = after.marks, next = $end.parent.maybeChild($end.index());\n  for (var i = 0; i < marks.length; i++)\n    { if (marks[i].type.spec.inclusive === false && (!next || !marks[i].isInSet(next.marks)))\n      { marks = marks[i--].removeFromSet(marks); } }\n  return marks\n};\n\n// :: (number) → number\n// The depth up to which this position and the given (non-resolved)\n// position share the same parent nodes.\nResolvedPos.prototype.sharedDepth = function sharedDepth (pos) {\n  for (var depth = this.depth; depth > 0; depth--)\n    { if (this.start(depth) <= pos && this.end(depth) >= pos) { return depth } }\n  return 0\n};\n\n// :: (?ResolvedPos, ?(Node) → bool) → ?NodeRange\n// Returns a range based on the place where this position and the\n// given position diverge around block content. If both point into\n// the same textblock, for example, a range around that textblock\n// will be returned. If they point into different blocks, the range\n// around those blocks in their shared ancestor is returned. You can\n// pass in an optional predicate that will be called with a parent\n// node to see if a range into that parent is acceptable.\nResolvedPos.prototype.blockRange = function blockRange (other, pred) {\n    if ( other === void 0 ) other = this;\n\n  if (other.pos < this.pos) { return other.blockRange(this) }\n  for (var d = this.depth - (this.parent.inlineContent || this.pos == other.pos ? 1 : 0); d >= 0; d--)\n    { if (other.pos <= this.end(d) && (!pred || pred(this.node(d))))\n      { return new NodeRange(this, other, d) } }\n};\n\n// :: (ResolvedPos) → bool\n// Query whether the given position shares the same parent node.\nResolvedPos.prototype.sameParent = function sameParent (other) {\n  return this.pos - this.parentOffset == other.pos - other.parentOffset\n};\n\n// :: (ResolvedPos) → ResolvedPos\n// Return the greater of this and the given position.\nResolvedPos.prototype.max = function max (other) {\n  return other.pos > this.pos ? other : this\n};\n\n// :: (ResolvedPos) → ResolvedPos\n// Return the smaller of this and the given position.\nResolvedPos.prototype.min = function min (other) {\n  return other.pos < this.pos ? other : this\n};\n\nResolvedPos.prototype.toString = function toString () {\n  var str = \"\";\n  for (var i = 1; i <= this.depth; i++)\n    { str += (str ? \"/\" : \"\") + this.node(i).type.name + \"_\" + this.index(i - 1); }\n  return str + \":\" + this.parentOffset\n};\n\nResolvedPos.resolve = function resolve (doc, pos) {\n  if (!(pos >= 0 && pos <= doc.content.size)) { throw new RangeError(\"Position \" + pos + \" out of range\") }\n  var path = [];\n  var start = 0, parentOffset = pos;\n  for (var node = doc;;) {\n    var ref = node.content.findIndex(parentOffset);\n      var index = ref.index;\n      var offset = ref.offset;\n    var rem = parentOffset - offset;\n    path.push(node, index, start + offset);\n    if (!rem) { break }\n    node = node.child(index);\n    if (node.isText) { break }\n    parentOffset = rem - 1;\n    start += offset + 1;\n  }\n  return new ResolvedPos(pos, path, parentOffset)\n};\n\nResolvedPos.resolveCached = function resolveCached (doc, pos) {\n  for (var i = 0; i < resolveCache.length; i++) {\n    var cached = resolveCache[i];\n    if (cached.pos == pos && cached.doc == doc) { return cached }\n  }\n  var result = resolveCache[resolveCachePos] = ResolvedPos.resolve(doc, pos);\n  resolveCachePos = (resolveCachePos + 1) % resolveCacheSize;\n  return result\n};\n\nObject.defineProperties( ResolvedPos.prototype, prototypeAccessors$2 );\n\nvar resolveCache = [], resolveCachePos = 0, resolveCacheSize = 12;\n\n// ::- Represents a flat range of content, i.e. one that starts and\n// ends in the same node.\nvar NodeRange = function NodeRange($from, $to, depth) {\n  // :: ResolvedPos A resolved position along the start of the\n  // content. May have a `depth` greater than this object's `depth`\n  // property, since these are the positions that were used to\n  // compute the range, not re-resolved positions directly at its\n  // boundaries.\n  this.$from = $from;\n  // :: ResolvedPos A position along the end of the content. See\n  // caveat for [`$from`](#model.NodeRange.$from).\n  this.$to = $to;\n  // :: number The depth of the node that this range points into.\n  this.depth = depth;\n};\n\nvar prototypeAccessors$1$1 = { start: { configurable: true },end: { configurable: true },parent: { configurable: true },startIndex: { configurable: true },endIndex: { configurable: true } };\n\n// :: number The position at the start of the range.\nprototypeAccessors$1$1.start.get = function () { return this.$from.before(this.depth + 1) };\n// :: number The position at the end of the range.\nprototypeAccessors$1$1.end.get = function () { return this.$to.after(this.depth + 1) };\n\n// :: Node The parent node that the range points into.\nprototypeAccessors$1$1.parent.get = function () { return this.$from.node(this.depth) };\n// :: number The start index of the range in the parent node.\nprototypeAccessors$1$1.startIndex.get = function () { return this.$from.index(this.depth) };\n// :: number The end index of the range in the parent node.\nprototypeAccessors$1$1.endIndex.get = function () { return this.$to.indexAfter(this.depth) };\n\nObject.defineProperties( NodeRange.prototype, prototypeAccessors$1$1 );\n\nvar emptyAttrs = Object.create(null);\n\n// ::- This class represents a node in the tree that makes up a\n// ProseMirror document. So a document is an instance of `Node`, with\n// children that are also instances of `Node`.\n//\n// Nodes are persistent data structures. Instead of changing them, you\n// create new ones with the content you want. Old ones keep pointing\n// at the old document shape. This is made cheaper by sharing\n// structure between the old and new data as much as possible, which a\n// tree shape like this (without back pointers) makes easy.\n//\n// **Do not** directly mutate the properties of a `Node` object. See\n// [the guide](/docs/guide/#doc) for more information.\nvar Node = function Node(type, attrs, content, marks) {\n  // :: NodeType\n  // The type of node that this is.\n  this.type = type;\n\n  // :: Object\n  // An object mapping attribute names to values. The kind of\n  // attributes allowed and required are\n  // [determined](#model.NodeSpec.attrs) by the node type.\n  this.attrs = attrs;\n\n  // :: Fragment\n  // A container holding the node's children.\n  this.content = content || Fragment.empty;\n\n  // :: [Mark]\n  // The marks (things like whether it is emphasized or part of a\n  // link) applied to this node.\n  this.marks = marks || Mark.none;\n};\n\nvar prototypeAccessors$3 = { nodeSize: { configurable: true },childCount: { configurable: true },textContent: { configurable: true },firstChild: { configurable: true },lastChild: { configurable: true },isBlock: { configurable: true },isTextblock: { configurable: true },inlineContent: { configurable: true },isInline: { configurable: true },isText: { configurable: true },isLeaf: { configurable: true },isAtom: { configurable: true } };\n\n// text:: ?string\n// For text nodes, this contains the node's text content.\n\n// :: number\n// The size of this node, as defined by the integer-based [indexing\n// scheme](/docs/guide/#doc.indexing). For text nodes, this is the\n// amount of characters. For other leaf nodes, it is one. For\n// non-leaf nodes, it is the size of the content plus two (the start\n// and end token).\nprototypeAccessors$3.nodeSize.get = function () { return this.isLeaf ? 1 : 2 + this.content.size };\n\n// :: number\n// The number of children that the node has.\nprototypeAccessors$3.childCount.get = function () { return this.content.childCount };\n\n// :: (number) → Node\n// Get the child node at the given index. Raises an error when the\n// index is out of range.\nNode.prototype.child = function child (index) { return this.content.child(index) };\n\n// :: (number) → ?Node\n// Get the child node at the given index, if it exists.\nNode.prototype.maybeChild = function maybeChild (index) { return this.content.maybeChild(index) };\n\n// :: ((node: Node, offset: number, index: number))\n// Call `f` for every child node, passing the node, its offset\n// into this parent node, and its index.\nNode.prototype.forEach = function forEach (f) { this.content.forEach(f); };\n\n// :: (number, number, (node: Node, pos: number, parent: Node, index: number) → ?bool, ?number)\n// Invoke a callback for all descendant nodes recursively between\n// the given two positions that are relative to start of this node's\n// content. The callback is invoked with the node, its\n// parent-relative position, its parent node, and its child index.\n// When the callback returns false for a given node, that node's\n// children will not be recursed over. The last parameter can be\n// used to specify a starting position to count from.\nNode.prototype.nodesBetween = function nodesBetween (from, to, f, startPos) {\n    if ( startPos === void 0 ) startPos = 0;\n\n  this.content.nodesBetween(from, to, f, startPos, this);\n};\n\n// :: ((node: Node, pos: number, parent: Node, index: number) → ?bool)\n// Call the given callback for every descendant node. Doesn't\n// descend into a node when the callback returns `false`.\nNode.prototype.descendants = function descendants (f) {\n  this.nodesBetween(0, this.content.size, f);\n};\n\n// :: string\n// Concatenates all the text nodes found in this fragment and its\n// children.\nprototypeAccessors$3.textContent.get = function () { return this.textBetween(0, this.content.size, \"\") };\n\n// :: (number, number, ?string, ?union<string, ?(leafNode: Node) -> string>) → string\n// Get all text between positions `from` and `to`. When\n// `blockSeparator` is given, it will be inserted to separate text\n// from different block nodes. When `leafText` is given, it'll be\n// inserted for every non-text leaf node encountered.\nNode.prototype.textBetween = function textBetween (from, to, blockSeparator, leafText) {\n  return this.content.textBetween(from, to, blockSeparator, leafText)\n};\n\n// :: ?Node\n// Returns this node's first child, or `null` if there are no\n// children.\nprototypeAccessors$3.firstChild.get = function () { return this.content.firstChild };\n\n// :: ?Node\n// Returns this node's last child, or `null` if there are no\n// children.\nprototypeAccessors$3.lastChild.get = function () { return this.content.lastChild };\n\n// :: (Node) → bool\n// Test whether two nodes represent the same piece of document.\nNode.prototype.eq = function eq (other) {\n  return this == other || (this.sameMarkup(other) && this.content.eq(other.content))\n};\n\n// :: (Node) → bool\n// Compare the markup (type, attributes, and marks) of this node to\n// those of another. Returns `true` if both have the same markup.\nNode.prototype.sameMarkup = function sameMarkup (other) {\n  return this.hasMarkup(other.type, other.attrs, other.marks)\n};\n\n// :: (NodeType, ?Object, ?[Mark]) → bool\n// Check whether this node's markup correspond to the given type,\n// attributes, and marks.\nNode.prototype.hasMarkup = function hasMarkup (type, attrs, marks) {\n  return this.type == type &&\n    compareDeep(this.attrs, attrs || type.defaultAttrs || emptyAttrs) &&\n    Mark.sameSet(this.marks, marks || Mark.none)\n};\n\n// :: (?Fragment) → Node\n// Create a new node with the same markup as this node, containing\n// the given content (or empty, if no content is given).\nNode.prototype.copy = function copy (content) {\n    if ( content === void 0 ) content = null;\n\n  if (content == this.content) { return this }\n  return new this.constructor(this.type, this.attrs, content, this.marks)\n};\n\n// :: ([Mark]) → Node\n// Create a copy of this node, with the given set of marks instead\n// of the node's own marks.\nNode.prototype.mark = function mark (marks) {\n  return marks == this.marks ? this : new this.constructor(this.type, this.attrs, this.content, marks)\n};\n\n// :: (number, ?number) → Node\n// Create a copy of this node with only the content between the\n// given positions. If `to` is not given, it defaults to the end of\n// the node.\nNode.prototype.cut = function cut (from, to) {\n  if (from == 0 && to == this.content.size) { return this }\n  return this.copy(this.content.cut(from, to))\n};\n\n// :: (number, ?number) → Slice\n// Cut out the part of the document between the given positions, and\n// return it as a `Slice` object.\nNode.prototype.slice = function slice (from, to, includeParents) {\n    if ( to === void 0 ) to = this.content.size;\n    if ( includeParents === void 0 ) includeParents = false;\n\n  if (from == to) { return Slice.empty }\n\n  var $from = this.resolve(from), $to = this.resolve(to);\n  var depth = includeParents ? 0 : $from.sharedDepth(to);\n  var start = $from.start(depth), node = $from.node(depth);\n  var content = node.content.cut($from.pos - start, $to.pos - start);\n  return new Slice(content, $from.depth - depth, $to.depth - depth)\n};\n\n// :: (number, number, Slice) → Node\n// Replace the part of the document between the given positions with\n// the given slice. The slice must 'fit', meaning its open sides\n// must be able to connect to the surrounding content, and its\n// content nodes must be valid children for the node they are placed\n// into. If any of this is violated, an error of type\n// [`ReplaceError`](#model.ReplaceError) is thrown.\nNode.prototype.replace = function replace$1 (from, to, slice) {\n  return replace(this.resolve(from), this.resolve(to), slice)\n};\n\n// :: (number) → ?Node\n// Find the node directly after the given position.\nNode.prototype.nodeAt = function nodeAt (pos) {\n  for (var node = this;;) {\n    var ref = node.content.findIndex(pos);\n      var index = ref.index;\n      var offset = ref.offset;\n    node = node.maybeChild(index);\n    if (!node) { return null }\n    if (offset == pos || node.isText) { return node }\n    pos -= offset + 1;\n  }\n};\n\n// :: (number) → {node: ?Node, index: number, offset: number}\n// Find the (direct) child node after the given offset, if any,\n// and return it along with its index and offset relative to this\n// node.\nNode.prototype.childAfter = function childAfter (pos) {\n  var ref = this.content.findIndex(pos);\n    var index = ref.index;\n    var offset = ref.offset;\n  return {node: this.content.maybeChild(index), index: index, offset: offset}\n};\n\n// :: (number) → {node: ?Node, index: number, offset: number}\n// Find the (direct) child node before the given offset, if any,\n// and return it along with its index and offset relative to this\n// node.\nNode.prototype.childBefore = function childBefore (pos) {\n  if (pos == 0) { return {node: null, index: 0, offset: 0} }\n  var ref = this.content.findIndex(pos);\n    var index = ref.index;\n    var offset = ref.offset;\n  if (offset < pos) { return {node: this.content.child(index), index: index, offset: offset} }\n  var node = this.content.child(index - 1);\n  return {node: node, index: index - 1, offset: offset - node.nodeSize}\n};\n\n// :: (number) → ResolvedPos\n// Resolve the given position in the document, returning an\n// [object](#model.ResolvedPos) with information about its context.\nNode.prototype.resolve = function resolve (pos) { return ResolvedPos.resolveCached(this, pos) };\n\nNode.prototype.resolveNoCache = function resolveNoCache (pos) { return ResolvedPos.resolve(this, pos) };\n\n// :: (number, number, union<Mark, MarkType>) → bool\n// Test whether a given mark or mark type occurs in this document\n// between the two given positions.\nNode.prototype.rangeHasMark = function rangeHasMark (from, to, type) {\n  var found = false;\n  if (to > from) { this.nodesBetween(from, to, function (node) {\n    if (type.isInSet(node.marks)) { found = true; }\n    return !found\n  }); }\n  return found\n};\n\n// :: bool\n// True when this is a block (non-inline node)\nprototypeAccessors$3.isBlock.get = function () { return this.type.isBlock };\n\n// :: bool\n// True when this is a textblock node, a block node with inline\n// content.\nprototypeAccessors$3.isTextblock.get = function () { return this.type.isTextblock };\n\n// :: bool\n// True when this node allows inline content.\nprototypeAccessors$3.inlineContent.get = function () { return this.type.inlineContent };\n\n// :: bool\n// True when this is an inline node (a text node or a node that can\n// appear among text).\nprototypeAccessors$3.isInline.get = function () { return this.type.isInline };\n\n// :: bool\n// True when this is a text node.\nprototypeAccessors$3.isText.get = function () { return this.type.isText };\n\n// :: bool\n// True when this is a leaf node.\nprototypeAccessors$3.isLeaf.get = function () { return this.type.isLeaf };\n\n// :: bool\n// True when this is an atom, i.e. when it does not have directly\n// editable content. This is usually the same as `isLeaf`, but can\n// be configured with the [`atom` property](#model.NodeSpec.atom) on\n// a node's spec (typically used when the node is displayed as an\n// uneditable [node view](#view.NodeView)).\nprototypeAccessors$3.isAtom.get = function () { return this.type.isAtom };\n\n// :: () → string\n// Return a string representation of this node for debugging\n// purposes.\nNode.prototype.toString = function toString () {\n  if (this.type.spec.toDebugString) { return this.type.spec.toDebugString(this) }\n  var name = this.type.name;\n  if (this.content.size)\n    { name += \"(\" + this.content.toStringInner() + \")\"; }\n  return wrapMarks(this.marks, name)\n};\n\n// :: (number) → ContentMatch\n// Get the content match in this node at the given index.\nNode.prototype.contentMatchAt = function contentMatchAt (index) {\n  var match = this.type.contentMatch.matchFragment(this.content, 0, index);\n  if (!match) { throw new Error(\"Called contentMatchAt on a node with invalid content\") }\n  return match\n};\n\n// :: (number, number, ?Fragment, ?number, ?number) → bool\n// Test whether replacing the range between `from` and `to` (by\n// child index) with the given replacement fragment (which defaults\n// to the empty fragment) would leave the node's content valid. You\n// can optionally pass `start` and `end` indices into the\n// replacement fragment.\nNode.prototype.canReplace = function canReplace (from, to, replacement, start, end) {\n    if ( replacement === void 0 ) replacement = Fragment.empty;\n    if ( start === void 0 ) start = 0;\n    if ( end === void 0 ) end = replacement.childCount;\n\n  var one = this.contentMatchAt(from).matchFragment(replacement, start, end);\n  var two = one && one.matchFragment(this.content, to);\n  if (!two || !two.validEnd) { return false }\n  for (var i = start; i < end; i++) { if (!this.type.allowsMarks(replacement.child(i).marks)) { return false } }\n  return true\n};\n\n// :: (number, number, NodeType, ?[Mark]) → bool\n// Test whether replacing the range `from` to `to` (by index) with a\n// node of the given type would leave the node's content valid.\nNode.prototype.canReplaceWith = function canReplaceWith (from, to, type, marks) {\n  if (marks && !this.type.allowsMarks(marks)) { return false }\n  var start = this.contentMatchAt(from).matchType(type);\n  var end = start && start.matchFragment(this.content, to);\n  return end ? end.validEnd : false\n};\n\n// :: (Node) → bool\n// Test whether the given node's content could be appended to this\n// node. If that node is empty, this will only return true if there\n// is at least one node type that can appear in both nodes (to avoid\n// merging completely incompatible nodes).\nNode.prototype.canAppend = function canAppend (other) {\n  if (other.content.size) { return this.canReplace(this.childCount, this.childCount, other.content) }\n  else { return this.type.compatibleContent(other.type) }\n};\n\n// :: ()\n// Check whether this node and its descendants conform to the\n// schema, and raise error when they do not.\nNode.prototype.check = function check () {\n  if (!this.type.validContent(this.content))\n    { throw new RangeError((\"Invalid content for node \" + (this.type.name) + \": \" + (this.content.toString().slice(0, 50)))) }\n  var copy = Mark.none;\n  for (var i = 0; i < this.marks.length; i++) { copy = this.marks[i].addToSet(copy); }\n  if (!Mark.sameSet(copy, this.marks))\n    { throw new RangeError((\"Invalid collection of marks for node \" + (this.type.name) + \": \" + (this.marks.map(function (m) { return m.type.name; })))) }\n  this.content.forEach(function (node) { return node.check(); });\n};\n\n// :: () → Object\n// Return a JSON-serializeable representation of this node.\nNode.prototype.toJSON = function toJSON () {\n  var obj = {type: this.type.name};\n  for (var _ in this.attrs) {\n    obj.attrs = this.attrs;\n    break\n  }\n  if (this.content.size)\n    { obj.content = this.content.toJSON(); }\n  if (this.marks.length)\n    { obj.marks = this.marks.map(function (n) { return n.toJSON(); }); }\n  return obj\n};\n\n// :: (Schema, Object) → Node\n// Deserialize a node from its JSON representation.\nNode.fromJSON = function fromJSON (schema, json) {\n  if (!json) { throw new RangeError(\"Invalid input for Node.fromJSON\") }\n  var marks = null;\n  if (json.marks) {\n    if (!Array.isArray(json.marks)) { throw new RangeError(\"Invalid mark data for Node.fromJSON\") }\n    marks = json.marks.map(schema.markFromJSON);\n  }\n  if (json.type == \"text\") {\n    if (typeof json.text != \"string\") { throw new RangeError(\"Invalid text node in JSON\") }\n    return schema.text(json.text, marks)\n  }\n  var content = Fragment.fromJSON(schema, json.content);\n  return schema.nodeType(json.type).create(json.attrs, content, marks)\n};\n\nObject.defineProperties( Node.prototype, prototypeAccessors$3 );\n\nvar TextNode = /*@__PURE__*/(function (Node) {\n  function TextNode(type, attrs, content, marks) {\n    Node.call(this, type, attrs, null, marks);\n\n    if (!content) { throw new RangeError(\"Empty text nodes are not allowed\") }\n\n    this.text = content;\n  }\n\n  if ( Node ) TextNode.__proto__ = Node;\n  TextNode.prototype = Object.create( Node && Node.prototype );\n  TextNode.prototype.constructor = TextNode;\n\n  var prototypeAccessors$1 = { textContent: { configurable: true },nodeSize: { configurable: true } };\n\n  TextNode.prototype.toString = function toString () {\n    if (this.type.spec.toDebugString) { return this.type.spec.toDebugString(this) }\n    return wrapMarks(this.marks, JSON.stringify(this.text))\n  };\n\n  prototypeAccessors$1.textContent.get = function () { return this.text };\n\n  TextNode.prototype.textBetween = function textBetween (from, to) { return this.text.slice(from, to) };\n\n  prototypeAccessors$1.nodeSize.get = function () { return this.text.length };\n\n  TextNode.prototype.mark = function mark (marks) {\n    return marks == this.marks ? this : new TextNode(this.type, this.attrs, this.text, marks)\n  };\n\n  TextNode.prototype.withText = function withText (text) {\n    if (text == this.text) { return this }\n    return new TextNode(this.type, this.attrs, text, this.marks)\n  };\n\n  TextNode.prototype.cut = function cut (from, to) {\n    if ( from === void 0 ) from = 0;\n    if ( to === void 0 ) to = this.text.length;\n\n    if (from == 0 && to == this.text.length) { return this }\n    return this.withText(this.text.slice(from, to))\n  };\n\n  TextNode.prototype.eq = function eq (other) {\n    return this.sameMarkup(other) && this.text == other.text\n  };\n\n  TextNode.prototype.toJSON = function toJSON () {\n    var base = Node.prototype.toJSON.call(this);\n    base.text = this.text;\n    return base\n  };\n\n  Object.defineProperties( TextNode.prototype, prototypeAccessors$1 );\n\n  return TextNode;\n}(Node));\n\nfunction wrapMarks(marks, str) {\n  for (var i = marks.length - 1; i >= 0; i--)\n    { str = marks[i].type.name + \"(\" + str + \")\"; }\n  return str\n}\n\n// ::- Instances of this class represent a match state of a node\n// type's [content expression](#model.NodeSpec.content), and can be\n// used to find out whether further content matches here, and whether\n// a given position is a valid end of the node.\nvar ContentMatch = function ContentMatch(validEnd) {\n  // :: bool\n  // True when this match state represents a valid end of the node.\n  this.validEnd = validEnd;\n  this.next = [];\n  this.wrapCache = [];\n};\n\nvar prototypeAccessors$4 = { inlineContent: { configurable: true },defaultType: { configurable: true },edgeCount: { configurable: true } };\n\nContentMatch.parse = function parse (string, nodeTypes) {\n  var stream = new TokenStream(string, nodeTypes);\n  if (stream.next == null) { return ContentMatch.empty }\n  var expr = parseExpr(stream);\n  if (stream.next) { stream.err(\"Unexpected trailing text\"); }\n  var match = dfa(nfa(expr));\n  checkForDeadEnds(match, stream);\n  return match\n};\n\n// :: (NodeType) → ?ContentMatch\n// Match a node type, returning a match after that node if\n// successful.\nContentMatch.prototype.matchType = function matchType (type) {\n  for (var i = 0; i < this.next.length; i += 2)\n    { if (this.next[i] == type) { return this.next[i + 1] } }\n  return null\n};\n\n// :: (Fragment, ?number, ?number) → ?ContentMatch\n// Try to match a fragment. Returns the resulting match when\n// successful.\nContentMatch.prototype.matchFragment = function matchFragment (frag, start, end) {\n    if ( start === void 0 ) start = 0;\n    if ( end === void 0 ) end = frag.childCount;\n\n  var cur = this;\n  for (var i = start; cur && i < end; i++)\n    { cur = cur.matchType(frag.child(i).type); }\n  return cur\n};\n\nprototypeAccessors$4.inlineContent.get = function () {\n  var first = this.next[0];\n  return first ? first.isInline : false\n};\n\n// :: ?NodeType\n// Get the first matching node type at this match position that can\n// be generated.\nprototypeAccessors$4.defaultType.get = function () {\n  for (var i = 0; i < this.next.length; i += 2) {\n    var type = this.next[i];\n    if (!(type.isText || type.hasRequiredAttrs())) { return type }\n  }\n};\n\nContentMatch.prototype.compatible = function compatible (other) {\n  for (var i = 0; i < this.next.length; i += 2)\n    { for (var j = 0; j < other.next.length; j += 2)\n      { if (this.next[i] == other.next[j]) { return true } } }\n  return false\n};\n\n// :: (Fragment, bool, ?number) → ?Fragment\n// Try to match the given fragment, and if that fails, see if it can\n// be made to match by inserting nodes in front of it. When\n// successful, return a fragment of inserted nodes (which may be\n// empty if nothing had to be inserted). When `toEnd` is true, only\n// return a fragment if the resulting match goes to the end of the\n// content expression.\nContentMatch.prototype.fillBefore = function fillBefore (after, toEnd, startIndex) {\n    if ( toEnd === void 0 ) toEnd = false;\n    if ( startIndex === void 0 ) startIndex = 0;\n\n  var seen = [this];\n  function search(match, types) {\n    var finished = match.matchFragment(after, startIndex);\n    if (finished && (!toEnd || finished.validEnd))\n      { return Fragment.from(types.map(function (tp) { return tp.createAndFill(); })) }\n\n    for (var i = 0; i < match.next.length; i += 2) {\n      var type = match.next[i], next = match.next[i + 1];\n      if (!(type.isText || type.hasRequiredAttrs()) && seen.indexOf(next) == -1) {\n        seen.push(next);\n        var found = search(next, types.concat(type));\n        if (found) { return found }\n      }\n    }\n  }\n\n  return search(this, [])\n};\n\n// :: (NodeType) → ?[NodeType]\n// Find a set of wrapping node types that would allow a node of the\n// given type to appear at this position. The result may be empty\n// (when it fits directly) and will be null when no such wrapping\n// exists.\nContentMatch.prototype.findWrapping = function findWrapping (target) {\n  for (var i = 0; i < this.wrapCache.length; i += 2)\n    { if (this.wrapCache[i] == target) { return this.wrapCache[i + 1] } }\n  var computed = this.computeWrapping(target);\n  this.wrapCache.push(target, computed);\n  return computed\n};\n\nContentMatch.prototype.computeWrapping = function computeWrapping (target) {\n  var seen = Object.create(null), active = [{match: this, type: null, via: null}];\n  while (active.length) {\n    var current = active.shift(), match = current.match;\n    if (match.matchType(target)) {\n      var result = [];\n      for (var obj = current; obj.type; obj = obj.via)\n        { result.push(obj.type); }\n      return result.reverse()\n    }\n    for (var i = 0; i < match.next.length; i += 2) {\n      var type = match.next[i];\n      if (!type.isLeaf && !type.hasRequiredAttrs() && !(type.name in seen) && (!current.type || match.next[i + 1].validEnd)) {\n        active.push({match: type.contentMatch, type: type, via: current});\n        seen[type.name] = true;\n      }\n    }\n  }\n};\n\n// :: number\n// The number of outgoing edges this node has in the finite\n// automaton that describes the content expression.\nprototypeAccessors$4.edgeCount.get = function () {\n  return this.next.length >> 1\n};\n\n// :: (number) → {type: NodeType, next: ContentMatch}\n// Get the _n_​th outgoing edge from this node in the finite\n// automaton that describes the content expression.\nContentMatch.prototype.edge = function edge (n) {\n  var i = n << 1;\n  if (i >= this.next.length) { throw new RangeError((\"There's no \" + n + \"th edge in this content match\")) }\n  return {type: this.next[i], next: this.next[i + 1]}\n};\n\nContentMatch.prototype.toString = function toString () {\n  var seen = [];\n  function scan(m) {\n    seen.push(m);\n    for (var i = 1; i < m.next.length; i += 2)\n      { if (seen.indexOf(m.next[i]) == -1) { scan(m.next[i]); } }\n  }\n  scan(this);\n  return seen.map(function (m, i) {\n    var out = i + (m.validEnd ? \"*\" : \" \") + \" \";\n    for (var i$1 = 0; i$1 < m.next.length; i$1 += 2)\n      { out += (i$1 ? \", \" : \"\") + m.next[i$1].name + \"->\" + seen.indexOf(m.next[i$1 + 1]); }\n    return out\n  }).join(\"\\n\")\n};\n\nObject.defineProperties( ContentMatch.prototype, prototypeAccessors$4 );\n\nContentMatch.empty = new ContentMatch(true);\n\nvar TokenStream = function TokenStream(string, nodeTypes) {\n  this.string = string;\n  this.nodeTypes = nodeTypes;\n  this.inline = null;\n  this.pos = 0;\n  this.tokens = string.split(/\\s*(?=\\b|\\W|$)/);\n  if (this.tokens[this.tokens.length - 1] == \"\") { this.tokens.pop(); }\n  if (this.tokens[0] == \"\") { this.tokens.shift(); }\n};\n\nvar prototypeAccessors$1$2 = { next: { configurable: true } };\n\nprototypeAccessors$1$2.next.get = function () { return this.tokens[this.pos] };\n\nTokenStream.prototype.eat = function eat (tok) { return this.next == tok && (this.pos++ || true) };\n\nTokenStream.prototype.err = function err (str) { throw new SyntaxError(str + \" (in content expression '\" + this.string + \"')\") };\n\nObject.defineProperties( TokenStream.prototype, prototypeAccessors$1$2 );\n\nfunction parseExpr(stream) {\n  var exprs = [];\n  do { exprs.push(parseExprSeq(stream)); }\n  while (stream.eat(\"|\"))\n  return exprs.length == 1 ? exprs[0] : {type: \"choice\", exprs: exprs}\n}\n\nfunction parseExprSeq(stream) {\n  var exprs = [];\n  do { exprs.push(parseExprSubscript(stream)); }\n  while (stream.next && stream.next != \")\" && stream.next != \"|\")\n  return exprs.length == 1 ? exprs[0] : {type: \"seq\", exprs: exprs}\n}\n\nfunction parseExprSubscript(stream) {\n  var expr = parseExprAtom(stream);\n  for (;;) {\n    if (stream.eat(\"+\"))\n      { expr = {type: \"plus\", expr: expr}; }\n    else if (stream.eat(\"*\"))\n      { expr = {type: \"star\", expr: expr}; }\n    else if (stream.eat(\"?\"))\n      { expr = {type: \"opt\", expr: expr}; }\n    else if (stream.eat(\"{\"))\n      { expr = parseExprRange(stream, expr); }\n    else { break }\n  }\n  return expr\n}\n\nfunction parseNum(stream) {\n  if (/\\D/.test(stream.next)) { stream.err(\"Expected number, got '\" + stream.next + \"'\"); }\n  var result = Number(stream.next);\n  stream.pos++;\n  return result\n}\n\nfunction parseExprRange(stream, expr) {\n  var min = parseNum(stream), max = min;\n  if (stream.eat(\",\")) {\n    if (stream.next != \"}\") { max = parseNum(stream); }\n    else { max = -1; }\n  }\n  if (!stream.eat(\"}\")) { stream.err(\"Unclosed braced range\"); }\n  return {type: \"range\", min: min, max: max, expr: expr}\n}\n\nfunction resolveName(stream, name) {\n  var types = stream.nodeTypes, type = types[name];\n  if (type) { return [type] }\n  var result = [];\n  for (var typeName in types) {\n    var type$1 = types[typeName];\n    if (type$1.groups.indexOf(name) > -1) { result.push(type$1); }\n  }\n  if (result.length == 0) { stream.err(\"No node type or group '\" + name + \"' found\"); }\n  return result\n}\n\nfunction parseExprAtom(stream) {\n  if (stream.eat(\"(\")) {\n    var expr = parseExpr(stream);\n    if (!stream.eat(\")\")) { stream.err(\"Missing closing paren\"); }\n    return expr\n  } else if (!/\\W/.test(stream.next)) {\n    var exprs = resolveName(stream, stream.next).map(function (type) {\n      if (stream.inline == null) { stream.inline = type.isInline; }\n      else if (stream.inline != type.isInline) { stream.err(\"Mixing inline and block content\"); }\n      return {type: \"name\", value: type}\n    });\n    stream.pos++;\n    return exprs.length == 1 ? exprs[0] : {type: \"choice\", exprs: exprs}\n  } else {\n    stream.err(\"Unexpected token '\" + stream.next + \"'\");\n  }\n}\n\n// The code below helps compile a regular-expression-like language\n// into a deterministic finite automaton. For a good introduction to\n// these concepts, see https://swtch.com/~rsc/regexp/regexp1.html\n\n// : (Object) → [[{term: ?any, to: number}]]\n// Construct an NFA from an expression as returned by the parser. The\n// NFA is represented as an array of states, which are themselves\n// arrays of edges, which are `{term, to}` objects. The first state is\n// the entry state and the last node is the success state.\n//\n// Note that unlike typical NFAs, the edge ordering in this one is\n// significant, in that it is used to contruct filler content when\n// necessary.\nfunction nfa(expr) {\n  var nfa = [[]];\n  connect(compile(expr, 0), node());\n  return nfa\n\n  function node() { return nfa.push([]) - 1 }\n  function edge(from, to, term) {\n    var edge = {term: term, to: to};\n    nfa[from].push(edge);\n    return edge\n  }\n  function connect(edges, to) { edges.forEach(function (edge) { return edge.to = to; }); }\n\n  function compile(expr, from) {\n    if (expr.type == \"choice\") {\n      return expr.exprs.reduce(function (out, expr) { return out.concat(compile(expr, from)); }, [])\n    } else if (expr.type == \"seq\") {\n      for (var i = 0;; i++) {\n        var next = compile(expr.exprs[i], from);\n        if (i == expr.exprs.length - 1) { return next }\n        connect(next, from = node());\n      }\n    } else if (expr.type == \"star\") {\n      var loop = node();\n      edge(from, loop);\n      connect(compile(expr.expr, loop), loop);\n      return [edge(loop)]\n    } else if (expr.type == \"plus\") {\n      var loop$1 = node();\n      connect(compile(expr.expr, from), loop$1);\n      connect(compile(expr.expr, loop$1), loop$1);\n      return [edge(loop$1)]\n    } else if (expr.type == \"opt\") {\n      return [edge(from)].concat(compile(expr.expr, from))\n    } else if (expr.type == \"range\") {\n      var cur = from;\n      for (var i$1 = 0; i$1 < expr.min; i$1++) {\n        var next$1 = node();\n        connect(compile(expr.expr, cur), next$1);\n        cur = next$1;\n      }\n      if (expr.max == -1) {\n        connect(compile(expr.expr, cur), cur);\n      } else {\n        for (var i$2 = expr.min; i$2 < expr.max; i$2++) {\n          var next$2 = node();\n          edge(cur, next$2);\n          connect(compile(expr.expr, cur), next$2);\n          cur = next$2;\n        }\n      }\n      return [edge(cur)]\n    } else if (expr.type == \"name\") {\n      return [edge(from, null, expr.value)]\n    }\n  }\n}\n\nfunction cmp(a, b) { return b - a }\n\n// Get the set of nodes reachable by null edges from `node`. Omit\n// nodes with only a single null-out-edge, since they may lead to\n// needless duplicated nodes.\nfunction nullFrom(nfa, node) {\n  var result = [];\n  scan(node);\n  return result.sort(cmp)\n\n  function scan(node) {\n    var edges = nfa[node];\n    if (edges.length == 1 && !edges[0].term) { return scan(edges[0].to) }\n    result.push(node);\n    for (var i = 0; i < edges.length; i++) {\n      var ref = edges[i];\n      var term = ref.term;\n      var to = ref.to;\n      if (!term && result.indexOf(to) == -1) { scan(to); }\n    }\n  }\n}\n\n// : ([[{term: ?any, to: number}]]) → ContentMatch\n// Compiles an NFA as produced by `nfa` into a DFA, modeled as a set\n// of state objects (`ContentMatch` instances) with transitions\n// between them.\nfunction dfa(nfa) {\n  var labeled = Object.create(null);\n  return explore(nullFrom(nfa, 0))\n\n  function explore(states) {\n    var out = [];\n    states.forEach(function (node) {\n      nfa[node].forEach(function (ref) {\n        var term = ref.term;\n        var to = ref.to;\n\n        if (!term) { return }\n        var known = out.indexOf(term), set = known > -1 && out[known + 1];\n        nullFrom(nfa, to).forEach(function (node) {\n          if (!set) { out.push(term, set = []); }\n          if (set.indexOf(node) == -1) { set.push(node); }\n        });\n      });\n    });\n    var state = labeled[states.join(\",\")] = new ContentMatch(states.indexOf(nfa.length - 1) > -1);\n    for (var i = 0; i < out.length; i += 2) {\n      var states$1 = out[i + 1].sort(cmp);\n      state.next.push(out[i], labeled[states$1.join(\",\")] || explore(states$1));\n    }\n    return state\n  }\n}\n\nfunction checkForDeadEnds(match, stream) {\n  for (var i = 0, work = [match]; i < work.length; i++) {\n    var state = work[i], dead = !state.validEnd, nodes = [];\n    for (var j = 0; j < state.next.length; j += 2) {\n      var node = state.next[j], next = state.next[j + 1];\n      nodes.push(node.name);\n      if (dead && !(node.isText || node.hasRequiredAttrs())) { dead = false; }\n      if (work.indexOf(next) == -1) { work.push(next); }\n    }\n    if (dead) { stream.err(\"Only non-generatable nodes (\" + nodes.join(\", \") + \") in a required position (see https://prosemirror.net/docs/guide/#generatable)\"); }\n  }\n}\n\n// For node types where all attrs have a default value (or which don't\n// have any attributes), build up a single reusable default attribute\n// object, and use it for all nodes that don't specify specific\n// attributes.\nfunction defaultAttrs(attrs) {\n  var defaults = Object.create(null);\n  for (var attrName in attrs) {\n    var attr = attrs[attrName];\n    if (!attr.hasDefault) { return null }\n    defaults[attrName] = attr.default;\n  }\n  return defaults\n}\n\nfunction computeAttrs(attrs, value) {\n  var built = Object.create(null);\n  for (var name in attrs) {\n    var given = value && value[name];\n    if (given === undefined) {\n      var attr = attrs[name];\n      if (attr.hasDefault) { given = attr.default; }\n      else { throw new RangeError(\"No value supplied for attribute \" + name) }\n    }\n    built[name] = given;\n  }\n  return built\n}\n\nfunction initAttrs(attrs) {\n  var result = Object.create(null);\n  if (attrs) { for (var name in attrs) { result[name] = new Attribute(attrs[name]); } }\n  return result\n}\n\n// ::- Node types are objects allocated once per `Schema` and used to\n// [tag](#model.Node.type) `Node` instances. They contain information\n// about the node type, such as its name and what kind of node it\n// represents.\nvar NodeType = function NodeType(name, schema, spec) {\n  // :: string\n  // The name the node type has in this schema.\n  this.name = name;\n\n  // :: Schema\n  // A link back to the `Schema` the node type belongs to.\n  this.schema = schema;\n\n  // :: NodeSpec\n  // The spec that this type is based on\n  this.spec = spec;\n\n  this.groups = spec.group ? spec.group.split(\" \") : [];\n  this.attrs = initAttrs(spec.attrs);\n\n  this.defaultAttrs = defaultAttrs(this.attrs);\n\n  // :: ContentMatch\n  // The starting match of the node type's content expression.\n  this.contentMatch = null;\n\n  // : ?[MarkType]\n  // The set of marks allowed in this node. `null` means all marks\n  // are allowed.\n  this.markSet = null;\n\n  // :: bool\n  // True if this node type has inline content.\n  this.inlineContent = null;\n\n  // :: bool\n  // True if this is a block type\n  this.isBlock = !(spec.inline || name == \"text\");\n\n  // :: bool\n  // True if this is the text node type.\n  this.isText = name == \"text\";\n};\n\nvar prototypeAccessors$5 = { isInline: { configurable: true },isTextblock: { configurable: true },isLeaf: { configurable: true },isAtom: { configurable: true },whitespace: { configurable: true } };\n\n// :: bool\n// True if this is an inline type.\nprototypeAccessors$5.isInline.get = function () { return !this.isBlock };\n\n// :: bool\n// True if this is a textblock type, a block that contains inline\n// content.\nprototypeAccessors$5.isTextblock.get = function () { return this.isBlock && this.inlineContent };\n\n// :: bool\n// True for node types that allow no content.\nprototypeAccessors$5.isLeaf.get = function () { return this.contentMatch == ContentMatch.empty };\n\n// :: bool\n// True when this node is an atom, i.e. when it does not have\n// directly editable content.\nprototypeAccessors$5.isAtom.get = function () { return this.isLeaf || this.spec.atom };\n\n// :: union<\"pre\", \"normal\">\n// The node type's [whitespace](#view.NodeSpec.whitespace) option.\nprototypeAccessors$5.whitespace.get = function () { return this.spec.whitespace || (this.spec.code ? \"pre\" : \"normal\") };\n\n// :: () → bool\n// Tells you whether this node type has any required attributes.\nNodeType.prototype.hasRequiredAttrs = function hasRequiredAttrs () {\n  for (var n in this.attrs) { if (this.attrs[n].isRequired) { return true } }\n  return false\n};\n\nNodeType.prototype.compatibleContent = function compatibleContent (other) {\n  return this == other || this.contentMatch.compatible(other.contentMatch)\n};\n\nNodeType.prototype.computeAttrs = function computeAttrs$1 (attrs) {\n  if (!attrs && this.defaultAttrs) { return this.defaultAttrs }\n  else { return computeAttrs(this.attrs, attrs) }\n};\n\n// :: (?Object, ?union<Fragment, Node, [Node]>, ?[Mark]) → Node\n// Create a `Node` of this type. The given attributes are\n// checked and defaulted (you can pass `null` to use the type's\n// defaults entirely, if no required attributes exist). `content`\n// may be a `Fragment`, a node, an array of nodes, or\n// `null`. Similarly `marks` may be `null` to default to the empty\n// set of marks.\nNodeType.prototype.create = function create (attrs, content, marks) {\n  if (this.isText) { throw new Error(\"NodeType.create can't construct text nodes\") }\n  return new Node(this, this.computeAttrs(attrs), Fragment.from(content), Mark.setFrom(marks))\n};\n\n// :: (?Object, ?union<Fragment, Node, [Node]>, ?[Mark]) → Node\n// Like [`create`](#model.NodeType.create), but check the given content\n// against the node type's content restrictions, and throw an error\n// if it doesn't match.\nNodeType.prototype.createChecked = function createChecked (attrs, content, marks) {\n  content = Fragment.from(content);\n  if (!this.validContent(content))\n    { throw new RangeError(\"Invalid content for node \" + this.name) }\n  return new Node(this, this.computeAttrs(attrs), content, Mark.setFrom(marks))\n};\n\n// :: (?Object, ?union<Fragment, Node, [Node]>, ?[Mark]) → ?Node\n// Like [`create`](#model.NodeType.create), but see if it is necessary to\n// add nodes to the start or end of the given fragment to make it\n// fit the node. If no fitting wrapping can be found, return null.\n// Note that, due to the fact that required nodes can always be\n// created, this will always succeed if you pass null or\n// `Fragment.empty` as content.\nNodeType.prototype.createAndFill = function createAndFill (attrs, content, marks) {\n  attrs = this.computeAttrs(attrs);\n  content = Fragment.from(content);\n  if (content.size) {\n    var before = this.contentMatch.fillBefore(content);\n    if (!before) { return null }\n    content = before.append(content);\n  }\n  var after = this.contentMatch.matchFragment(content).fillBefore(Fragment.empty, true);\n  if (!after) { return null }\n  return new Node(this, attrs, content.append(after), Mark.setFrom(marks))\n};\n\n// :: (Fragment) → bool\n// Returns true if the given fragment is valid content for this node\n// type with the given attributes.\nNodeType.prototype.validContent = function validContent (content) {\n  var result = this.contentMatch.matchFragment(content);\n  if (!result || !result.validEnd) { return false }\n  for (var i = 0; i < content.childCount; i++)\n    { if (!this.allowsMarks(content.child(i).marks)) { return false } }\n  return true\n};\n\n// :: (MarkType) → bool\n// Check whether the given mark type is allowed in this node.\nNodeType.prototype.allowsMarkType = function allowsMarkType (markType) {\n  return this.markSet == null || this.markSet.indexOf(markType) > -1\n};\n\n// :: ([Mark]) → bool\n// Test whether the given set of marks are allowed in this node.\nNodeType.prototype.allowsMarks = function allowsMarks (marks) {\n  if (this.markSet == null) { return true }\n  for (var i = 0; i < marks.length; i++) { if (!this.allowsMarkType(marks[i].type)) { return false } }\n  return true\n};\n\n// :: ([Mark]) → [Mark]\n// Removes the marks that are not allowed in this node from the given set.\nNodeType.prototype.allowedMarks = function allowedMarks (marks) {\n  if (this.markSet == null) { return marks }\n  var copy;\n  for (var i = 0; i < marks.length; i++) {\n    if (!this.allowsMarkType(marks[i].type)) {\n      if (!copy) { copy = marks.slice(0, i); }\n    } else if (copy) {\n      copy.push(marks[i]);\n    }\n  }\n  return !copy ? marks : copy.length ? copy : Mark.empty\n};\n\nNodeType.compile = function compile (nodes, schema) {\n  var result = Object.create(null);\n  nodes.forEach(function (name, spec) { return result[name] = new NodeType(name, schema, spec); });\n\n  var topType = schema.spec.topNode || \"doc\";\n  if (!result[topType]) { throw new RangeError(\"Schema is missing its top node type ('\" + topType + \"')\") }\n  if (!result.text) { throw new RangeError(\"Every schema needs a 'text' type\") }\n  for (var _ in result.text.attrs) { throw new RangeError(\"The text node type should not have attributes\") }\n\n  return result\n};\n\nObject.defineProperties( NodeType.prototype, prototypeAccessors$5 );\n\n// Attribute descriptors\n\nvar Attribute = function Attribute(options) {\n  this.hasDefault = Object.prototype.hasOwnProperty.call(options, \"default\");\n  this.default = options.default;\n};\n\nvar prototypeAccessors$1$3 = { isRequired: { configurable: true } };\n\nprototypeAccessors$1$3.isRequired.get = function () {\n  return !this.hasDefault\n};\n\nObject.defineProperties( Attribute.prototype, prototypeAccessors$1$3 );\n\n// Marks\n\n// ::- Like nodes, marks (which are associated with nodes to signify\n// things like emphasis or being part of a link) are\n// [tagged](#model.Mark.type) with type objects, which are\n// instantiated once per `Schema`.\nvar MarkType = function MarkType(name, rank, schema, spec) {\n  // :: string\n  // The name of the mark type.\n  this.name = name;\n\n  // :: Schema\n  // The schema that this mark type instance is part of.\n  this.schema = schema;\n\n  // :: MarkSpec\n  // The spec on which the type is based.\n  this.spec = spec;\n\n  this.attrs = initAttrs(spec.attrs);\n\n  this.rank = rank;\n  this.excluded = null;\n  var defaults = defaultAttrs(this.attrs);\n  this.instance = defaults && new Mark(this, defaults);\n};\n\n// :: (?Object) → Mark\n// Create a mark of this type. `attrs` may be `null` or an object\n// containing only some of the mark's attributes. The others, if\n// they have defaults, will be added.\nMarkType.prototype.create = function create (attrs) {\n  if (!attrs && this.instance) { return this.instance }\n  return new Mark(this, computeAttrs(this.attrs, attrs))\n};\n\nMarkType.compile = function compile (marks, schema) {\n  var result = Object.create(null), rank = 0;\n  marks.forEach(function (name, spec) { return result[name] = new MarkType(name, rank++, schema, spec); });\n  return result\n};\n\n// :: ([Mark]) → [Mark]\n// When there is a mark of this type in the given set, a new set\n// without it is returned. Otherwise, the input set is returned.\nMarkType.prototype.removeFromSet = function removeFromSet (set) {\n  for (var i = 0; i < set.length; i++) { if (set[i].type == this) {\n    set = set.slice(0, i).concat(set.slice(i + 1));\n    i--;\n  } }\n  return set\n};\n\n// :: ([Mark]) → ?Mark\n// Tests whether there is a mark of this type in the given set.\nMarkType.prototype.isInSet = function isInSet (set) {\n  for (var i = 0; i < set.length; i++)\n    { if (set[i].type == this) { return set[i] } }\n};\n\n// :: (MarkType) → bool\n// Queries whether a given mark type is\n// [excluded](#model.MarkSpec.excludes) by this one.\nMarkType.prototype.excludes = function excludes (other) {\n  return this.excluded.indexOf(other) > -1\n};\n\n// SchemaSpec:: interface\n// An object describing a schema, as passed to the [`Schema`](#model.Schema)\n// constructor.\n//\n//   nodes:: union<Object<NodeSpec>, OrderedMap<NodeSpec>>\n//   The node types in this schema. Maps names to\n//   [`NodeSpec`](#model.NodeSpec) objects that describe the node type\n//   associated with that name. Their order is significant—it\n//   determines which [parse rules](#model.NodeSpec.parseDOM) take\n//   precedence by default, and which nodes come first in a given\n//   [group](#model.NodeSpec.group).\n//\n//   marks:: ?union<Object<MarkSpec>, OrderedMap<MarkSpec>>\n//   The mark types that exist in this schema. The order in which they\n//   are provided determines the order in which [mark\n//   sets](#model.Mark.addToSet) are sorted and in which [parse\n//   rules](#model.MarkSpec.parseDOM) are tried.\n//\n//   topNode:: ?string\n//   The name of the default top-level node for the schema. Defaults\n//   to `\"doc\"`.\n\n// NodeSpec:: interface\n//\n//   content:: ?string\n//   The content expression for this node, as described in the [schema\n//   guide](/docs/guide/#schema.content_expressions). When not given,\n//   the node does not allow any content.\n//\n//   marks:: ?string\n//   The marks that are allowed inside of this node. May be a\n//   space-separated string referring to mark names or groups, `\"_\"`\n//   to explicitly allow all marks, or `\"\"` to disallow marks. When\n//   not given, nodes with inline content default to allowing all\n//   marks, other nodes default to not allowing marks.\n//\n//   group:: ?string\n//   The group or space-separated groups to which this node belongs,\n//   which can be referred to in the content expressions for the\n//   schema.\n//\n//   inline:: ?bool\n//   Should be set to true for inline nodes. (Implied for text nodes.)\n//\n//   atom:: ?bool\n//   Can be set to true to indicate that, though this isn't a [leaf\n//   node](#model.NodeType.isLeaf), it doesn't have directly editable\n//   content and should be treated as a single unit in the view.\n//\n//   attrs:: ?Object<AttributeSpec>\n//   The attributes that nodes of this type get.\n//\n//   selectable:: ?bool\n//   Controls whether nodes of this type can be selected as a [node\n//   selection](#state.NodeSelection). Defaults to true for non-text\n//   nodes.\n//\n//   draggable:: ?bool\n//   Determines whether nodes of this type can be dragged without\n//   being selected. Defaults to false.\n//\n//   code:: ?bool\n//   Can be used to indicate that this node contains code, which\n//   causes some commands to behave differently.\n//\n//   whitespace:: ?union<\"pre\", \"normal\">\n//   Controls way whitespace in this a node is parsed. The default is\n//   `\"normal\"`, which causes the [DOM parser](#model.DOMParser) to\n//   collapse whitespace in normal mode, and normalize it (replacing\n//   newlines and such with spaces) otherwise. `\"pre\"` causes the\n//   parser to preserve spaces inside the node. When this option isn't\n//   given, but [`code`](#model.NodeSpec.code) is true, `whitespace`\n//   will default to `\"pre\"`. Note that this option doesn't influence\n//   the way the node is rendered—that should be handled by `toDOM`\n//   and/or styling.\n//\n//   defining:: ?bool\n//   Determines whether this node is considered an important parent\n//   node during replace operations (such as paste). Non-defining (the\n//   default) nodes get dropped when their entire content is replaced,\n//   whereas defining nodes persist and wrap the inserted content.\n//   Likewise, in _inserted_ content the defining parents of the\n//   content are preserved when possible. Typically,\n//   non-default-paragraph textblock types, and possibly list items,\n//   are marked as defining.\n//\n//   isolating:: ?bool\n//   When enabled (default is false), the sides of nodes of this type\n//   count as boundaries that regular editing operations, like\n//   backspacing or lifting, won't cross. An example of a node that\n//   should probably have this enabled is a table cell.\n//\n//   toDOM:: ?(node: Node) → DOMOutputSpec\n//   Defines the default way a node of this type should be serialized\n//   to DOM/HTML (as used by\n//   [`DOMSerializer.fromSchema`](#model.DOMSerializer^fromSchema)).\n//   Should return a DOM node or an [array\n//   structure](#model.DOMOutputSpec) that describes one, with an\n//   optional number zero (“hole”) in it to indicate where the node's\n//   content should be inserted.\n//\n//   For text nodes, the default is to create a text DOM node. Though\n//   it is possible to create a serializer where text is rendered\n//   differently, this is not supported inside the editor, so you\n//   shouldn't override that in your text node spec.\n//\n//   parseDOM:: ?[ParseRule]\n//   Associates DOM parser information with this node, which can be\n//   used by [`DOMParser.fromSchema`](#model.DOMParser^fromSchema) to\n//   automatically derive a parser. The `node` field in the rules is\n//   implied (the name of this node will be filled in automatically).\n//   If you supply your own parser, you do not need to also specify\n//   parsing rules in your schema.\n//\n//   toDebugString:: ?(node: Node) -> string\n//   Defines the default way a node of this type should be serialized\n//   to a string representation for debugging (e.g. in error messages).\n\n// MarkSpec:: interface\n//\n//   attrs:: ?Object<AttributeSpec>\n//   The attributes that marks of this type get.\n//\n//   inclusive:: ?bool\n//   Whether this mark should be active when the cursor is positioned\n//   at its end (or at its start when that is also the start of the\n//   parent node). Defaults to true.\n//\n//   excludes:: ?string\n//   Determines which other marks this mark can coexist with. Should\n//   be a space-separated strings naming other marks or groups of marks.\n//   When a mark is [added](#model.Mark.addToSet) to a set, all marks\n//   that it excludes are removed in the process. If the set contains\n//   any mark that excludes the new mark but is not, itself, excluded\n//   by the new mark, the mark can not be added an the set. You can\n//   use the value `\"_\"` to indicate that the mark excludes all\n//   marks in the schema.\n//\n//   Defaults to only being exclusive with marks of the same type. You\n//   can set it to an empty string (or any string not containing the\n//   mark's own name) to allow multiple marks of a given type to\n//   coexist (as long as they have different attributes).\n//\n//   group:: ?string\n//   The group or space-separated groups to which this mark belongs.\n//\n//   spanning:: ?bool\n//   Determines whether marks of this type can span multiple adjacent\n//   nodes when serialized to DOM/HTML. Defaults to true.\n//\n//   toDOM:: ?(mark: Mark, inline: bool) → DOMOutputSpec\n//   Defines the default way marks of this type should be serialized\n//   to DOM/HTML. When the resulting spec contains a hole, that is\n//   where the marked content is placed. Otherwise, it is appended to\n//   the top node.\n//\n//   parseDOM:: ?[ParseRule]\n//   Associates DOM parser information with this mark (see the\n//   corresponding [node spec field](#model.NodeSpec.parseDOM)). The\n//   `mark` field in the rules is implied.\n\n// AttributeSpec:: interface\n//\n// Used to [define](#model.NodeSpec.attrs) attributes on nodes or\n// marks.\n//\n//   default:: ?any\n//   The default value for this attribute, to use when no explicit\n//   value is provided. Attributes that have no default must be\n//   provided whenever a node or mark of a type that has them is\n//   created.\n\n// ::- A document schema. Holds [node](#model.NodeType) and [mark\n// type](#model.MarkType) objects for the nodes and marks that may\n// occur in conforming documents, and provides functionality for\n// creating and deserializing such documents.\nvar Schema = function Schema(spec) {\n  // :: SchemaSpec\n  // The [spec](#model.SchemaSpec) on which the schema is based,\n  // with the added guarantee that its `nodes` and `marks`\n  // properties are\n  // [`OrderedMap`](https://github.com/marijnh/orderedmap) instances\n  // (not raw objects).\n  this.spec = {};\n  for (var prop in spec) { this.spec[prop] = spec[prop]; }\n  this.spec.nodes = OrderedMap.from(spec.nodes);\n  this.spec.marks = OrderedMap.from(spec.marks);\n\n  // :: Object<NodeType>\n  // An object mapping the schema's node names to node type objects.\n  this.nodes = NodeType.compile(this.spec.nodes, this);\n\n  // :: Object<MarkType>\n  // A map from mark names to mark type objects.\n  this.marks = MarkType.compile(this.spec.marks, this);\n\n  var contentExprCache = Object.create(null);\n  for (var prop$1 in this.nodes) {\n    if (prop$1 in this.marks)\n      { throw new RangeError(prop$1 + \" can not be both a node and a mark\") }\n    var type = this.nodes[prop$1], contentExpr = type.spec.content || \"\", markExpr = type.spec.marks;\n    type.contentMatch = contentExprCache[contentExpr] ||\n      (contentExprCache[contentExpr] = ContentMatch.parse(contentExpr, this.nodes));\n    type.inlineContent = type.contentMatch.inlineContent;\n    type.markSet = markExpr == \"_\" ? null :\n      markExpr ? gatherMarks(this, markExpr.split(\" \")) :\n      markExpr == \"\" || !type.inlineContent ? [] : null;\n  }\n  for (var prop$2 in this.marks) {\n    var type$1 = this.marks[prop$2], excl = type$1.spec.excludes;\n    type$1.excluded = excl == null ? [type$1] : excl == \"\" ? [] : gatherMarks(this, excl.split(\" \"));\n  }\n\n  this.nodeFromJSON = this.nodeFromJSON.bind(this);\n  this.markFromJSON = this.markFromJSON.bind(this);\n\n  // :: NodeType\n  // The type of the [default top node](#model.SchemaSpec.topNode)\n  // for this schema.\n  this.topNodeType = this.nodes[this.spec.topNode || \"doc\"];\n\n  // :: Object\n  // An object for storing whatever values modules may want to\n  // compute and cache per schema. (If you want to store something\n  // in it, try to use property names unlikely to clash.)\n  this.cached = Object.create(null);\n  this.cached.wrappings = Object.create(null);\n};\n\n// :: (union<string, NodeType>, ?Object, ?union<Fragment, Node, [Node]>, ?[Mark]) → Node\n// Create a node in this schema. The `type` may be a string or a\n// `NodeType` instance. Attributes will be extended\n// with defaults, `content` may be a `Fragment`,\n// `null`, a `Node`, or an array of nodes.\nSchema.prototype.node = function node (type, attrs, content, marks) {\n  if (typeof type == \"string\")\n    { type = this.nodeType(type); }\n  else if (!(type instanceof NodeType))\n    { throw new RangeError(\"Invalid node type: \" + type) }\n  else if (type.schema != this)\n    { throw new RangeError(\"Node type from different schema used (\" + type.name + \")\") }\n\n  return type.createChecked(attrs, content, marks)\n};\n\n// :: (string, ?[Mark]) → Node\n// Create a text node in the schema. Empty text nodes are not\n// allowed.\nSchema.prototype.text = function text (text$1, marks) {\n  var type = this.nodes.text;\n  return new TextNode(type, type.defaultAttrs, text$1, Mark.setFrom(marks))\n};\n\n// :: (union<string, MarkType>, ?Object) → Mark\n// Create a mark with the given type and attributes.\nSchema.prototype.mark = function mark (type, attrs) {\n  if (typeof type == \"string\") { type = this.marks[type]; }\n  return type.create(attrs)\n};\n\n// :: (Object) → Node\n// Deserialize a node from its JSON representation. This method is\n// bound.\nSchema.prototype.nodeFromJSON = function nodeFromJSON (json) {\n  return Node.fromJSON(this, json)\n};\n\n// :: (Object) → Mark\n// Deserialize a mark from its JSON representation. This method is\n// bound.\nSchema.prototype.markFromJSON = function markFromJSON (json) {\n  return Mark.fromJSON(this, json)\n};\n\nSchema.prototype.nodeType = function nodeType (name) {\n  var found = this.nodes[name];\n  if (!found) { throw new RangeError(\"Unknown node type: \" + name) }\n  return found\n};\n\nfunction gatherMarks(schema, marks) {\n  var found = [];\n  for (var i = 0; i < marks.length; i++) {\n    var name = marks[i], mark = schema.marks[name], ok = mark;\n    if (mark) {\n      found.push(mark);\n    } else {\n      for (var prop in schema.marks) {\n        var mark$1 = schema.marks[prop];\n        if (name == \"_\" || (mark$1.spec.group && mark$1.spec.group.split(\" \").indexOf(name) > -1))\n          { found.push(ok = mark$1); }\n      }\n    }\n    if (!ok) { throw new SyntaxError(\"Unknown mark type: '\" + marks[i] + \"'\") }\n  }\n  return found\n}\n\n// ParseOptions:: interface\n// These are the options recognized by the\n// [`parse`](#model.DOMParser.parse) and\n// [`parseSlice`](#model.DOMParser.parseSlice) methods.\n//\n//   preserveWhitespace:: ?union<bool, \"full\">\n//   By default, whitespace is collapsed as per HTML's rules. Pass\n//   `true` to preserve whitespace, but normalize newlines to\n//   spaces, and `\"full\"` to preserve whitespace entirely.\n//\n//   findPositions:: ?[{node: dom.Node, offset: number}]\n//   When given, the parser will, beside parsing the content,\n//   record the document positions of the given DOM positions. It\n//   will do so by writing to the objects, adding a `pos` property\n//   that holds the document position. DOM positions that are not\n//   in the parsed content will not be written to.\n//\n//   from:: ?number\n//   The child node index to start parsing from.\n//\n//   to:: ?number\n//   The child node index to stop parsing at.\n//\n//   topNode:: ?Node\n//   By default, the content is parsed into the schema's default\n//   [top node type](#model.Schema.topNodeType). You can pass this\n//   option to use the type and attributes from a different node\n//   as the top container.\n//\n//   topMatch:: ?ContentMatch\n//   Provide the starting content match that content parsed into the\n//   top node is matched against.\n//\n//   context:: ?ResolvedPos\n//   A set of additional nodes to count as\n//   [context](#model.ParseRule.context) when parsing, above the\n//   given [top node](#model.ParseOptions.topNode).\n\n// ParseRule:: interface\n// A value that describes how to parse a given DOM node or inline\n// style as a ProseMirror node or mark.\n//\n//   tag:: ?string\n//   A CSS selector describing the kind of DOM elements to match. A\n//   single rule should have _either_ a `tag` or a `style` property.\n//\n//   namespace:: ?string\n//   The namespace to match. This should be used with `tag`.\n//   Nodes are only matched when the namespace matches or this property\n//   is null.\n//\n//   style:: ?string\n//   A CSS property name to match. When given, this rule matches\n//   inline styles that list that property. May also have the form\n//   `\"property=value\"`, in which case the rule only matches if the\n//   property's value exactly matches the given value. (For more\n//   complicated filters, use [`getAttrs`](#model.ParseRule.getAttrs)\n//   and return false to indicate that the match failed.) Rules\n//   matching styles may only produce [marks](#model.ParseRule.mark),\n//   not nodes.\n//\n//   priority:: ?number\n//   Can be used to change the order in which the parse rules in a\n//   schema are tried. Those with higher priority come first. Rules\n//   without a priority are counted as having priority 50. This\n//   property is only meaningful in a schema—when directly\n//   constructing a parser, the order of the rule array is used.\n//\n//   consuming:: ?boolean\n//   By default, when a rule matches an element or style, no further\n//   rules get a chance to match it. By setting this to `false`, you\n//   indicate that even when this rule matches, other rules that come\n//   after it should also run.\n//\n//   context:: ?string\n//   When given, restricts this rule to only match when the current\n//   context—the parent nodes into which the content is being\n//   parsed—matches this expression. Should contain one or more node\n//   names or node group names followed by single or double slashes.\n//   For example `\"paragraph/\"` means the rule only matches when the\n//   parent node is a paragraph, `\"blockquote/paragraph/\"` restricts\n//   it to be in a paragraph that is inside a blockquote, and\n//   `\"section//\"` matches any position inside a section—a double\n//   slash matches any sequence of ancestor nodes. To allow multiple\n//   different contexts, they can be separated by a pipe (`|`)\n//   character, as in `\"blockquote/|list_item/\"`.\n//\n//   node:: ?string\n//   The name of the node type to create when this rule matches. Only\n//   valid for rules with a `tag` property, not for style rules. Each\n//   rule should have one of a `node`, `mark`, or `ignore` property\n//   (except when it appears in a [node](#model.NodeSpec.parseDOM) or\n//   [mark spec](#model.MarkSpec.parseDOM), in which case the `node`\n//   or `mark` property will be derived from its position).\n//\n//   mark:: ?string\n//   The name of the mark type to wrap the matched content in.\n//\n//   ignore:: ?bool\n//   When true, ignore content that matches this rule.\n//\n//   closeParent:: ?bool\n//   When true, finding an element that matches this rule will close\n//   the current node.\n//\n//   skip:: ?bool\n//   When true, ignore the node that matches this rule, but do parse\n//   its content.\n//\n//   attrs:: ?Object\n//   Attributes for the node or mark created by this rule. When\n//   `getAttrs` is provided, it takes precedence.\n//\n//   getAttrs:: ?(union<dom.Node, string>) → ?union<Object, false>\n//   A function used to compute the attributes for the node or mark\n//   created by this rule. Can also be used to describe further\n//   conditions the DOM element or style must match. When it returns\n//   `false`, the rule won't match. When it returns null or undefined,\n//   that is interpreted as an empty/default set of attributes.\n//\n//   Called with a DOM Element for `tag` rules, and with a string (the\n//   style's value) for `style` rules.\n//\n//   contentElement:: ?union<string, (dom.Node) → dom.Node>\n//   For `tag` rules that produce non-leaf nodes or marks, by default\n//   the content of the DOM element is parsed as content of the mark\n//   or node. If the child nodes are in a descendent node, this may be\n//   a CSS selector string that the parser must use to find the actual\n//   content element, or a function that returns the actual content\n//   element to the parser.\n//\n//   getContent:: ?(dom.Node, schema: Schema) → Fragment\n//   Can be used to override the content of a matched node. When\n//   present, instead of parsing the node's child nodes, the result of\n//   this function is used.\n//\n//   preserveWhitespace:: ?union<bool, \"full\">\n//   Controls whether whitespace should be preserved when parsing the\n//   content inside the matched element. `false` means whitespace may\n//   be collapsed, `true` means that whitespace should be preserved\n//   but newlines normalized to spaces, and `\"full\"` means that\n//   newlines should also be preserved.\n\n// ::- A DOM parser represents a strategy for parsing DOM content into\n// a ProseMirror document conforming to a given schema. Its behavior\n// is defined by an array of [rules](#model.ParseRule).\nvar DOMParser = function DOMParser(schema, rules) {\n  var this$1 = this;\n\n  // :: Schema\n  // The schema into which the parser parses.\n  this.schema = schema;\n  // :: [ParseRule]\n  // The set of [parse rules](#model.ParseRule) that the parser\n  // uses, in order of precedence.\n  this.rules = rules;\n  this.tags = [];\n  this.styles = [];\n\n  rules.forEach(function (rule) {\n    if (rule.tag) { this$1.tags.push(rule); }\n    else if (rule.style) { this$1.styles.push(rule); }\n  });\n\n  // Only normalize list elements when lists in the schema can't directly contain themselves\n  this.normalizeLists = !this.tags.some(function (r) {\n    if (!/^(ul|ol)\\b/.test(r.tag) || !r.node) { return false }\n    var node = schema.nodes[r.node];\n    return node.contentMatch.matchType(node)\n  });\n};\n\n// :: (dom.Node, ?ParseOptions) → Node\n// Parse a document from the content of a DOM node.\nDOMParser.prototype.parse = function parse (dom, options) {\n    if ( options === void 0 ) options = {};\n\n  var context = new ParseContext(this, options, false);\n  context.addAll(dom, null, options.from, options.to);\n  return context.finish()\n};\n\n// :: (dom.Node, ?ParseOptions) → Slice\n// Parses the content of the given DOM node, like\n// [`parse`](#model.DOMParser.parse), and takes the same set of\n// options. But unlike that method, which produces a whole node,\n// this one returns a slice that is open at the sides, meaning that\n// the schema constraints aren't applied to the start of nodes to\n// the left of the input and the end of nodes at the end.\nDOMParser.prototype.parseSlice = function parseSlice (dom, options) {\n    if ( options === void 0 ) options = {};\n\n  var context = new ParseContext(this, options, true);\n  context.addAll(dom, null, options.from, options.to);\n  return Slice.maxOpen(context.finish())\n};\n\nDOMParser.prototype.matchTag = function matchTag (dom, context, after) {\n  for (var i = after ? this.tags.indexOf(after) + 1 : 0; i < this.tags.length; i++) {\n    var rule = this.tags[i];\n    if (matches(dom, rule.tag) &&\n        (rule.namespace === undefined || dom.namespaceURI == rule.namespace) &&\n        (!rule.context || context.matchesContext(rule.context))) {\n      if (rule.getAttrs) {\n        var result = rule.getAttrs(dom);\n        if (result === false) { continue }\n        rule.attrs = result;\n      }\n      return rule\n    }\n  }\n};\n\nDOMParser.prototype.matchStyle = function matchStyle (prop, value, context, after) {\n  for (var i = after ? this.styles.indexOf(after) + 1 : 0; i < this.styles.length; i++) {\n    var rule = this.styles[i];\n    if (rule.style.indexOf(prop) != 0 ||\n        rule.context && !context.matchesContext(rule.context) ||\n        // Test that the style string either precisely matches the prop,\n        // or has an '=' sign after the prop, followed by the given\n        // value.\n        rule.style.length > prop.length &&\n        (rule.style.charCodeAt(prop.length) != 61 || rule.style.slice(prop.length + 1) != value))\n      { continue }\n    if (rule.getAttrs) {\n      var result = rule.getAttrs(value);\n      if (result === false) { continue }\n      rule.attrs = result;\n    }\n    return rule\n  }\n};\n\n// : (Schema) → [ParseRule]\nDOMParser.schemaRules = function schemaRules (schema) {\n  var result = [];\n  function insert(rule) {\n    var priority = rule.priority == null ? 50 : rule.priority, i = 0;\n    for (; i < result.length; i++) {\n      var next = result[i], nextPriority = next.priority == null ? 50 : next.priority;\n      if (nextPriority < priority) { break }\n    }\n    result.splice(i, 0, rule);\n  }\n\n  var loop = function ( name ) {\n    var rules = schema.marks[name].spec.parseDOM;\n    if (rules) { rules.forEach(function (rule) {\n      insert(rule = copy(rule));\n      rule.mark = name;\n    }); }\n  };\n\n    for (var name in schema.marks) loop( name );\n  var loop$1 = function ( name ) {\n    var rules$1 = schema.nodes[name$1].spec.parseDOM;\n    if (rules$1) { rules$1.forEach(function (rule) {\n      insert(rule = copy(rule));\n      rule.node = name$1;\n    }); }\n  };\n\n    for (var name$1 in schema.nodes) loop$1();\n  return result\n};\n\n// :: (Schema) → DOMParser\n// Construct a DOM parser using the parsing rules listed in a\n// schema's [node specs](#model.NodeSpec.parseDOM), reordered by\n// [priority](#model.ParseRule.priority).\nDOMParser.fromSchema = function fromSchema (schema) {\n  return schema.cached.domParser ||\n    (schema.cached.domParser = new DOMParser(schema, DOMParser.schemaRules(schema)))\n};\n\n// : Object<bool> The block-level tags in HTML5\nvar blockTags = {\n  address: true, article: true, aside: true, blockquote: true, canvas: true,\n  dd: true, div: true, dl: true, fieldset: true, figcaption: true, figure: true,\n  footer: true, form: true, h1: true, h2: true, h3: true, h4: true, h5: true,\n  h6: true, header: true, hgroup: true, hr: true, li: true, noscript: true, ol: true,\n  output: true, p: true, pre: true, section: true, table: true, tfoot: true, ul: true\n};\n\n// : Object<bool> The tags that we normally ignore.\nvar ignoreTags = {\n  head: true, noscript: true, object: true, script: true, style: true, title: true\n};\n\n// : Object<bool> List tags.\nvar listTags = {ol: true, ul: true};\n\n// Using a bitfield for node context options\nvar OPT_PRESERVE_WS = 1, OPT_PRESERVE_WS_FULL = 2, OPT_OPEN_LEFT = 4;\n\nfunction wsOptionsFor(type, preserveWhitespace, base) {\n  if (preserveWhitespace != null) { return (preserveWhitespace ? OPT_PRESERVE_WS : 0) |\n    (preserveWhitespace === \"full\" ? OPT_PRESERVE_WS_FULL : 0) }\n  return type && type.whitespace == \"pre\" ? OPT_PRESERVE_WS | OPT_PRESERVE_WS_FULL : base & ~OPT_OPEN_LEFT\n}\n\nvar NodeContext = function NodeContext(type, attrs, marks, pendingMarks, solid, match, options) {\n  this.type = type;\n  this.attrs = attrs;\n  this.solid = solid;\n  this.match = match || (options & OPT_OPEN_LEFT ? null : type.contentMatch);\n  this.options = options;\n  this.content = [];\n  // Marks applied to this node itself\n  this.marks = marks;\n  // Marks applied to its children\n  this.activeMarks = Mark.none;\n  // Marks that can't apply here, but will be used in children if possible\n  this.pendingMarks = pendingMarks;\n  // Nested Marks with same type\n  this.stashMarks = [];\n};\n\nNodeContext.prototype.findWrapping = function findWrapping (node) {\n  if (!this.match) {\n    if (!this.type) { return [] }\n    var fill = this.type.contentMatch.fillBefore(Fragment.from(node));\n    if (fill) {\n      this.match = this.type.contentMatch.matchFragment(fill);\n    } else {\n      var start = this.type.contentMatch, wrap;\n      if (wrap = start.findWrapping(node.type)) {\n        this.match = start;\n        return wrap\n      } else {\n        return null\n      }\n    }\n  }\n  return this.match.findWrapping(node.type)\n};\n\nNodeContext.prototype.finish = function finish (openEnd) {\n  if (!(this.options & OPT_PRESERVE_WS)) { // Strip trailing whitespace\n    var last = this.content[this.content.length - 1], m;\n    if (last && last.isText && (m = /[ \\t\\r\\n\\u000c]+$/.exec(last.text))) {\n      if (last.text.length == m[0].length) { this.content.pop(); }\n      else { this.content[this.content.length - 1] = last.withText(last.text.slice(0, last.text.length - m[0].length)); }\n    }\n  }\n  var content = Fragment.from(this.content);\n  if (!openEnd && this.match)\n    { content = content.append(this.match.fillBefore(Fragment.empty, true)); }\n  return this.type ? this.type.create(this.attrs, content, this.marks) : content\n};\n\nNodeContext.prototype.popFromStashMark = function popFromStashMark (mark) {\n  for (var i = this.stashMarks.length - 1; i >= 0; i--)\n    { if (mark.eq(this.stashMarks[i])) { return this.stashMarks.splice(i, 1)[0] } }\n};\n\nNodeContext.prototype.applyPending = function applyPending (nextType) {\n  for (var i = 0, pending = this.pendingMarks; i < pending.length; i++) {\n    var mark = pending[i];\n    if ((this.type ? this.type.allowsMarkType(mark.type) : markMayApply(mark.type, nextType)) &&\n        !mark.isInSet(this.activeMarks)) {\n      this.activeMarks = mark.addToSet(this.activeMarks);\n      this.pendingMarks = mark.removeFromSet(this.pendingMarks);\n    }\n  }\n};\n\nNodeContext.prototype.inlineContext = function inlineContext (node) {\n  if (this.type) { return this.type.inlineContent }\n  if (this.content.length) { return this.content[0].isInline }\n  return node.parentNode && !blockTags.hasOwnProperty(node.parentNode.nodeName.toLowerCase())\n};\n\nvar ParseContext = function ParseContext(parser, options, open) {\n  // : DOMParser The parser we are using.\n  this.parser = parser;\n  // : Object The options passed to this parse.\n  this.options = options;\n  this.isOpen = open;\n  var topNode = options.topNode, topContext;\n  var topOptions = wsOptionsFor(null, options.preserveWhitespace, 0) | (open ? OPT_OPEN_LEFT : 0);\n  if (topNode)\n    { topContext = new NodeContext(topNode.type, topNode.attrs, Mark.none, Mark.none, true,\n                                 options.topMatch || topNode.type.contentMatch, topOptions); }\n  else if (open)\n    { topContext = new NodeContext(null, null, Mark.none, Mark.none, true, null, topOptions); }\n  else\n    { topContext = new NodeContext(parser.schema.topNodeType, null, Mark.none, Mark.none, true, null, topOptions); }\n  this.nodes = [topContext];\n  // : [Mark] The current set of marks\n  this.open = 0;\n  this.find = options.findPositions;\n  this.needsBlock = false;\n};\n\nvar prototypeAccessors$6 = { top: { configurable: true },currentPos: { configurable: true } };\n\nprototypeAccessors$6.top.get = function () {\n  return this.nodes[this.open]\n};\n\n// : (dom.Node)\n// Add a DOM node to the content. Text is inserted as text node,\n// otherwise, the node is passed to `addElement` or, if it has a\n// `style` attribute, `addElementWithStyles`.\nParseContext.prototype.addDOM = function addDOM (dom) {\n  if (dom.nodeType == 3) {\n    this.addTextNode(dom);\n  } else if (dom.nodeType == 1) {\n    var style = dom.getAttribute(\"style\");\n    var marks = style ? this.readStyles(parseStyles(style)) : null, top = this.top;\n    if (marks != null) { for (var i = 0; i < marks.length; i++) { this.addPendingMark(marks[i]); } }\n    this.addElement(dom);\n    if (marks != null) { for (var i$1 = 0; i$1 < marks.length; i$1++) { this.removePendingMark(marks[i$1], top); } }\n  }\n};\n\nParseContext.prototype.addTextNode = function addTextNode (dom) {\n  var value = dom.nodeValue;\n  var top = this.top;\n  if (top.options & OPT_PRESERVE_WS_FULL ||\n      top.inlineContext(dom) ||\n      /[^ \\t\\r\\n\\u000c]/.test(value)) {\n    if (!(top.options & OPT_PRESERVE_WS)) {\n      value = value.replace(/[ \\t\\r\\n\\u000c]+/g, \" \");\n      // If this starts with whitespace, and there is no node before it, or\n      // a hard break, or a text node that ends with whitespace, strip the\n      // leading space.\n      if (/^[ \\t\\r\\n\\u000c]/.test(value) && this.open == this.nodes.length - 1) {\n        var nodeBefore = top.content[top.content.length - 1];\n        var domNodeBefore = dom.previousSibling;\n        if (!nodeBefore ||\n            (domNodeBefore && domNodeBefore.nodeName == 'BR') ||\n            (nodeBefore.isText && /[ \\t\\r\\n\\u000c]$/.test(nodeBefore.text)))\n          { value = value.slice(1); }\n      }\n    } else if (!(top.options & OPT_PRESERVE_WS_FULL)) {\n      value = value.replace(/\\r?\\n|\\r/g, \" \");\n    } else {\n      value = value.replace(/\\r\\n?/g, \"\\n\");\n    }\n    if (value) { this.insertNode(this.parser.schema.text(value)); }\n    this.findInText(dom);\n  } else {\n    this.findInside(dom);\n  }\n};\n\n// : (dom.Element, ?ParseRule)\n// Try to find a handler for the given tag and use that to parse. If\n// none is found, the element's content nodes are added directly.\nParseContext.prototype.addElement = function addElement (dom, matchAfter) {\n  var name = dom.nodeName.toLowerCase(), ruleID;\n  if (listTags.hasOwnProperty(name) && this.parser.normalizeLists) { normalizeList(dom); }\n  var rule = (this.options.ruleFromNode && this.options.ruleFromNode(dom)) ||\n      (ruleID = this.parser.matchTag(dom, this, matchAfter));\n  if (rule ? rule.ignore : ignoreTags.hasOwnProperty(name)) {\n    this.findInside(dom);\n    this.ignoreFallback(dom);\n  } else if (!rule || rule.skip || rule.closeParent) {\n    if (rule && rule.closeParent) { this.open = Math.max(0, this.open - 1); }\n    else if (rule && rule.skip.nodeType) { dom = rule.skip; }\n    var sync, top = this.top, oldNeedsBlock = this.needsBlock;\n    if (blockTags.hasOwnProperty(name)) {\n      sync = true;\n      if (!top.type) { this.needsBlock = true; }\n    } else if (!dom.firstChild) {\n      this.leafFallback(dom);\n      return\n    }\n    this.addAll(dom);\n    if (sync) { this.sync(top); }\n    this.needsBlock = oldNeedsBlock;\n  } else {\n    this.addElementByRule(dom, rule, rule.consuming === false ? ruleID : null);\n  }\n};\n\n// Called for leaf DOM nodes that would otherwise be ignored\nParseContext.prototype.leafFallback = function leafFallback (dom) {\n  if (dom.nodeName == \"BR\" && this.top.type && this.top.type.inlineContent)\n    { this.addTextNode(dom.ownerDocument.createTextNode(\"\\n\")); }\n};\n\n// Called for ignored nodes\nParseContext.prototype.ignoreFallback = function ignoreFallback (dom) {\n  // Ignored BR nodes should at least create an inline context\n  if (dom.nodeName == \"BR\" && (!this.top.type || !this.top.type.inlineContent))\n    { this.findPlace(this.parser.schema.text(\"-\")); }\n};\n\n// Run any style parser associated with the node's styles. Either\n// return an array of marks, or null to indicate some of the styles\n// had a rule with `ignore` set.\nParseContext.prototype.readStyles = function readStyles (styles) {\n  var marks = Mark.none;\n  style: for (var i = 0; i < styles.length; i += 2) {\n    for (var after = null;;) {\n      var rule = this.parser.matchStyle(styles[i], styles[i + 1], this, after);\n      if (!rule) { continue style }\n      if (rule.ignore) { return null }\n      marks = this.parser.schema.marks[rule.mark].create(rule.attrs).addToSet(marks);\n      if (rule.consuming === false) { after = rule; }\n      else { break }\n    }\n  }\n  return marks\n};\n\n// : (dom.Element, ParseRule) → bool\n// Look up a handler for the given node. If none are found, return\n// false. Otherwise, apply it, use its return value to drive the way\n// the node's content is wrapped, and return true.\nParseContext.prototype.addElementByRule = function addElementByRule (dom, rule, continueAfter) {\n    var this$1 = this;\n\n  var sync, nodeType, markType, mark;\n  if (rule.node) {\n    nodeType = this.parser.schema.nodes[rule.node];\n    if (!nodeType.isLeaf) {\n      sync = this.enter(nodeType, rule.attrs, rule.preserveWhitespace);\n    } else if (!this.insertNode(nodeType.create(rule.attrs))) {\n      this.leafFallback(dom);\n    }\n  } else {\n    markType = this.parser.schema.marks[rule.mark];\n    mark = markType.create(rule.attrs);\n    this.addPendingMark(mark);\n  }\n  var startIn = this.top;\n\n  if (nodeType && nodeType.isLeaf) {\n    this.findInside(dom);\n  } else if (continueAfter) {\n    this.addElement(dom, continueAfter);\n  } else if (rule.getContent) {\n    this.findInside(dom);\n    rule.getContent(dom, this.parser.schema).forEach(function (node) { return this$1.insertNode(node); });\n  } else {\n    var contentDOM = rule.contentElement;\n    if (typeof contentDOM == \"string\") { contentDOM = dom.querySelector(contentDOM); }\n    else if (typeof contentDOM == \"function\") { contentDOM = contentDOM(dom); }\n    if (!contentDOM) { contentDOM = dom; }\n    this.findAround(dom, contentDOM, true);\n    this.addAll(contentDOM, sync);\n  }\n  if (sync) { this.sync(startIn); this.open--; }\n  if (mark) { this.removePendingMark(mark, startIn); }\n};\n\n// : (dom.Node, ?NodeBuilder, ?number, ?number)\n// Add all child nodes between `startIndex` and `endIndex` (or the\n// whole node, if not given). If `sync` is passed, use it to\n// synchronize after every block element.\nParseContext.prototype.addAll = function addAll (parent, sync, startIndex, endIndex) {\n  var index = startIndex || 0;\n  for (var dom = startIndex ? parent.childNodes[startIndex] : parent.firstChild,\n           end = endIndex == null ? null : parent.childNodes[endIndex];\n       dom != end; dom = dom.nextSibling, ++index) {\n    this.findAtPoint(parent, index);\n    this.addDOM(dom);\n    if (sync && blockTags.hasOwnProperty(dom.nodeName.toLowerCase()))\n      { this.sync(sync); }\n  }\n  this.findAtPoint(parent, index);\n};\n\n// Try to find a way to fit the given node type into the current\n// context. May add intermediate wrappers and/or leave non-solid\n// nodes that we're in.\nParseContext.prototype.findPlace = function findPlace (node) {\n  var route, sync;\n  for (var depth = this.open; depth >= 0; depth--) {\n    var cx = this.nodes[depth];\n    var found = cx.findWrapping(node);\n    if (found && (!route || route.length > found.length)) {\n      route = found;\n      sync = cx;\n      if (!found.length) { break }\n    }\n    if (cx.solid) { break }\n  }\n  if (!route) { return false }\n  this.sync(sync);\n  for (var i = 0; i < route.length; i++)\n    { this.enterInner(route[i], null, false); }\n  return true\n};\n\n// : (Node) → ?Node\n// Try to insert the given node, adjusting the context when needed.\nParseContext.prototype.insertNode = function insertNode (node) {\n  if (node.isInline && this.needsBlock && !this.top.type) {\n    var block = this.textblockFromContext();\n    if (block) { this.enterInner(block); }\n  }\n  if (this.findPlace(node)) {\n    this.closeExtra();\n    var top = this.top;\n    top.applyPending(node.type);\n    if (top.match) { top.match = top.match.matchType(node.type); }\n    var marks = top.activeMarks;\n    for (var i = 0; i < node.marks.length; i++)\n      { if (!top.type || top.type.allowsMarkType(node.marks[i].type))\n        { marks = node.marks[i].addToSet(marks); } }\n    top.content.push(node.mark(marks));\n    return true\n  }\n  return false\n};\n\n// : (NodeType, ?Object) → bool\n// Try to start a node of the given type, adjusting the context when\n// necessary.\nParseContext.prototype.enter = function enter (type, attrs, preserveWS) {\n  var ok = this.findPlace(type.create(attrs));\n  if (ok) { this.enterInner(type, attrs, true, preserveWS); }\n  return ok\n};\n\n// Open a node of the given type\nParseContext.prototype.enterInner = function enterInner (type, attrs, solid, preserveWS) {\n  this.closeExtra();\n  var top = this.top;\n  top.applyPending(type);\n  top.match = top.match && top.match.matchType(type, attrs);\n  var options = wsOptionsFor(type, preserveWS, top.options);\n  if ((top.options & OPT_OPEN_LEFT) && top.content.length == 0) { options |= OPT_OPEN_LEFT; }\n  this.nodes.push(new NodeContext(type, attrs, top.activeMarks, top.pendingMarks, solid, null, options));\n  this.open++;\n};\n\n// Make sure all nodes above this.open are finished and added to\n// their parents\nParseContext.prototype.closeExtra = function closeExtra (openEnd) {\n  var i = this.nodes.length - 1;\n  if (i > this.open) {\n    for (; i > this.open; i--) { this.nodes[i - 1].content.push(this.nodes[i].finish(openEnd)); }\n    this.nodes.length = this.open + 1;\n  }\n};\n\nParseContext.prototype.finish = function finish () {\n  this.open = 0;\n  this.closeExtra(this.isOpen);\n  return this.nodes[0].finish(this.isOpen || this.options.topOpen)\n};\n\nParseContext.prototype.sync = function sync (to) {\n  for (var i = this.open; i >= 0; i--) { if (this.nodes[i] == to) {\n    this.open = i;\n    return\n  } }\n};\n\nprototypeAccessors$6.currentPos.get = function () {\n  this.closeExtra();\n  var pos = 0;\n  for (var i = this.open; i >= 0; i--) {\n    var content = this.nodes[i].content;\n    for (var j = content.length - 1; j >= 0; j--)\n      { pos += content[j].nodeSize; }\n    if (i) { pos++; }\n  }\n  return pos\n};\n\nParseContext.prototype.findAtPoint = function findAtPoint (parent, offset) {\n  if (this.find) { for (var i = 0; i < this.find.length; i++) {\n    if (this.find[i].node == parent && this.find[i].offset == offset)\n      { this.find[i].pos = this.currentPos; }\n  } }\n};\n\nParseContext.prototype.findInside = function findInside (parent) {\n  if (this.find) { for (var i = 0; i < this.find.length; i++) {\n    if (this.find[i].pos == null && parent.nodeType == 1 && parent.contains(this.find[i].node))\n      { this.find[i].pos = this.currentPos; }\n  } }\n};\n\nParseContext.prototype.findAround = function findAround (parent, content, before) {\n  if (parent != content && this.find) { for (var i = 0; i < this.find.length; i++) {\n    if (this.find[i].pos == null && parent.nodeType == 1 && parent.contains(this.find[i].node)) {\n      var pos = content.compareDocumentPosition(this.find[i].node);\n      if (pos & (before ? 2 : 4))\n        { this.find[i].pos = this.currentPos; }\n    }\n  } }\n};\n\nParseContext.prototype.findInText = function findInText (textNode) {\n  if (this.find) { for (var i = 0; i < this.find.length; i++) {\n    if (this.find[i].node == textNode)\n      { this.find[i].pos = this.currentPos - (textNode.nodeValue.length - this.find[i].offset); }\n  } }\n};\n\n// : (string) → bool\n// Determines whether the given [context\n// string](#ParseRule.context) matches this context.\nParseContext.prototype.matchesContext = function matchesContext (context) {\n    var this$1 = this;\n\n  if (context.indexOf(\"|\") > -1)\n    { return context.split(/\\s*\\|\\s*/).some(this.matchesContext, this) }\n\n  var parts = context.split(\"/\");\n  var option = this.options.context;\n  var useRoot = !this.isOpen && (!option || option.parent.type == this.nodes[0].type);\n  var minDepth = -(option ? option.depth + 1 : 0) + (useRoot ? 0 : 1);\n  var match = function (i, depth) {\n    for (; i >= 0; i--) {\n      var part = parts[i];\n      if (part == \"\") {\n        if (i == parts.length - 1 || i == 0) { continue }\n        for (; depth >= minDepth; depth--)\n          { if (match(i - 1, depth)) { return true } }\n        return false\n      } else {\n        var next = depth > 0 || (depth == 0 && useRoot) ? this$1.nodes[depth].type\n            : option && depth >= minDepth ? option.node(depth - minDepth).type\n            : null;\n        if (!next || (next.name != part && next.groups.indexOf(part) == -1))\n          { return false }\n        depth--;\n      }\n    }\n    return true\n  };\n  return match(parts.length - 1, this.open)\n};\n\nParseContext.prototype.textblockFromContext = function textblockFromContext () {\n  var $context = this.options.context;\n  if ($context) { for (var d = $context.depth; d >= 0; d--) {\n    var deflt = $context.node(d).contentMatchAt($context.indexAfter(d)).defaultType;\n    if (deflt && deflt.isTextblock && deflt.defaultAttrs) { return deflt }\n  } }\n  for (var name in this.parser.schema.nodes) {\n    var type = this.parser.schema.nodes[name];\n    if (type.isTextblock && type.defaultAttrs) { return type }\n  }\n};\n\nParseContext.prototype.addPendingMark = function addPendingMark (mark) {\n  var found = findSameMarkInSet(mark, this.top.pendingMarks);\n  if (found) { this.top.stashMarks.push(found); }\n  this.top.pendingMarks = mark.addToSet(this.top.pendingMarks);\n};\n\nParseContext.prototype.removePendingMark = function removePendingMark (mark, upto) {\n  for (var depth = this.open; depth >= 0; depth--) {\n    var level = this.nodes[depth];\n    var found = level.pendingMarks.lastIndexOf(mark);\n    if (found > -1) {\n      level.pendingMarks = mark.removeFromSet(level.pendingMarks);\n    } else {\n      level.activeMarks = mark.removeFromSet(level.activeMarks);\n      var stashMark = level.popFromStashMark(mark);\n      if (stashMark && level.type && level.type.allowsMarkType(stashMark.type))\n        { level.activeMarks = stashMark.addToSet(level.activeMarks); }\n    }\n    if (level == upto) { break }\n  }\n};\n\nObject.defineProperties( ParseContext.prototype, prototypeAccessors$6 );\n\n// Kludge to work around directly nested list nodes produced by some\n// tools and allowed by browsers to mean that the nested list is\n// actually part of the list item above it.\nfunction normalizeList(dom) {\n  for (var child = dom.firstChild, prevItem = null; child; child = child.nextSibling) {\n    var name = child.nodeType == 1 ? child.nodeName.toLowerCase() : null;\n    if (name && listTags.hasOwnProperty(name) && prevItem) {\n      prevItem.appendChild(child);\n      child = prevItem;\n    } else if (name == \"li\") {\n      prevItem = child;\n    } else if (name) {\n      prevItem = null;\n    }\n  }\n}\n\n// Apply a CSS selector.\nfunction matches(dom, selector) {\n  return (dom.matches || dom.msMatchesSelector || dom.webkitMatchesSelector || dom.mozMatchesSelector).call(dom, selector)\n}\n\n// : (string) → [string]\n// Tokenize a style attribute into property/value pairs.\nfunction parseStyles(style) {\n  var re = /\\s*([\\w-]+)\\s*:\\s*([^;]+)/g, m, result = [];\n  while (m = re.exec(style)) { result.push(m[1], m[2].trim()); }\n  return result\n}\n\nfunction copy(obj) {\n  var copy = {};\n  for (var prop in obj) { copy[prop] = obj[prop]; }\n  return copy\n}\n\n// Used when finding a mark at the top level of a fragment parse.\n// Checks whether it would be reasonable to apply a given mark type to\n// a given node, by looking at the way the mark occurs in the schema.\nfunction markMayApply(markType, nodeType) {\n  var nodes = nodeType.schema.nodes;\n  var loop = function ( name ) {\n    var parent = nodes[name];\n    if (!parent.allowsMarkType(markType)) { return }\n    var seen = [], scan = function (match) {\n      seen.push(match);\n      for (var i = 0; i < match.edgeCount; i++) {\n        var ref = match.edge(i);\n        var type = ref.type;\n        var next = ref.next;\n        if (type == nodeType) { return true }\n        if (seen.indexOf(next) < 0 && scan(next)) { return true }\n      }\n    };\n    if (scan(parent.contentMatch)) { return { v: true } }\n  };\n\n  for (var name in nodes) {\n    var returned = loop( name );\n\n    if ( returned ) return returned.v;\n  }\n}\n\nfunction findSameMarkInSet(mark, set) {\n  for (var i = 0; i < set.length; i++) {\n    if (mark.eq(set[i])) { return set[i] }\n  }\n}\n\n// DOMOutputSpec:: interface\n// A description of a DOM structure. Can be either a string, which is\n// interpreted as a text node, a DOM node, which is interpreted as\n// itself, a `{dom: Node, contentDOM: ?Node}` object, or an array.\n//\n// An array describes a DOM element. The first value in the array\n// should be a string—the name of the DOM element, optionally prefixed\n// by a namespace URL and a space. If the second element is plain\n// object, it is interpreted as a set of attributes for the element.\n// Any elements after that (including the 2nd if it's not an attribute\n// object) are interpreted as children of the DOM elements, and must\n// either be valid `DOMOutputSpec` values, or the number zero.\n//\n// The number zero (pronounced “hole”) is used to indicate the place\n// where a node's child nodes should be inserted. If it occurs in an\n// output spec, it should be the only child element in its parent\n// node.\n\n// ::- A DOM serializer knows how to convert ProseMirror nodes and\n// marks of various types to DOM nodes.\nvar DOMSerializer = function DOMSerializer(nodes, marks) {\n  // :: Object<(node: Node) → DOMOutputSpec>\n  // The node serialization functions.\n  this.nodes = nodes || {};\n  // :: Object<?(mark: Mark, inline: bool) → DOMOutputSpec>\n  // The mark serialization functions.\n  this.marks = marks || {};\n};\n\n// :: (Fragment, ?Object) → dom.DocumentFragment\n// Serialize the content of this fragment to a DOM fragment. When\n// not in the browser, the `document` option, containing a DOM\n// document, should be passed so that the serializer can create\n// nodes.\nDOMSerializer.prototype.serializeFragment = function serializeFragment (fragment, options, target) {\n    var this$1 = this;\n    if ( options === void 0 ) options = {};\n\n  if (!target) { target = doc(options).createDocumentFragment(); }\n\n  var top = target, active = null;\n  fragment.forEach(function (node) {\n    if (active || node.marks.length) {\n      if (!active) { active = []; }\n      var keep = 0, rendered = 0;\n      while (keep < active.length && rendered < node.marks.length) {\n        var next = node.marks[rendered];\n        if (!this$1.marks[next.type.name]) { rendered++; continue }\n        if (!next.eq(active[keep]) || next.type.spec.spanning === false) { break }\n        keep += 2; rendered++;\n      }\n      while (keep < active.length) {\n        top = active.pop();\n        active.pop();\n      }\n      while (rendered < node.marks.length) {\n        var add = node.marks[rendered++];\n        var markDOM = this$1.serializeMark(add, node.isInline, options);\n        if (markDOM) {\n          active.push(add, top);\n          top.appendChild(markDOM.dom);\n          top = markDOM.contentDOM || markDOM.dom;\n        }\n      }\n    }\n    top.appendChild(this$1.serializeNodeInner(node, options));\n  });\n\n  return target\n};\n\nDOMSerializer.prototype.serializeNodeInner = function serializeNodeInner (node, options) {\n    if ( options === void 0 ) options = {};\n\n  var ref =\n      DOMSerializer.renderSpec(doc(options), this.nodes[node.type.name](node));\n    var dom = ref.dom;\n    var contentDOM = ref.contentDOM;\n  if (contentDOM) {\n    if (node.isLeaf)\n      { throw new RangeError(\"Content hole not allowed in a leaf node spec\") }\n    if (options.onContent)\n      { options.onContent(node, contentDOM, options); }\n    else\n      { this.serializeFragment(node.content, options, contentDOM); }\n  }\n  return dom\n};\n\n// :: (Node, ?Object) → dom.Node\n// Serialize this node to a DOM node. This can be useful when you\n// need to serialize a part of a document, as opposed to the whole\n// document. To serialize a whole document, use\n// [`serializeFragment`](#model.DOMSerializer.serializeFragment) on\n// its [content](#model.Node.content).\nDOMSerializer.prototype.serializeNode = function serializeNode (node, options) {\n    if ( options === void 0 ) options = {};\n\n  var dom = this.serializeNodeInner(node, options);\n  for (var i = node.marks.length - 1; i >= 0; i--) {\n    var wrap = this.serializeMark(node.marks[i], node.isInline, options);\n    if (wrap) {\n(wrap.contentDOM || wrap.dom).appendChild(dom);\n      dom = wrap.dom;\n    }\n  }\n  return dom\n};\n\nDOMSerializer.prototype.serializeMark = function serializeMark (mark, inline, options) {\n    if ( options === void 0 ) options = {};\n\n  var toDOM = this.marks[mark.type.name];\n  return toDOM && DOMSerializer.renderSpec(doc(options), toDOM(mark, inline))\n};\n\n// :: (dom.Document, DOMOutputSpec) → {dom: dom.Node, contentDOM: ?dom.Node}\n// Render an [output spec](#model.DOMOutputSpec) to a DOM node. If\n// the spec has a hole (zero) in it, `contentDOM` will point at the\n// node with the hole.\nDOMSerializer.renderSpec = function renderSpec (doc, structure, xmlNS) {\n    if ( xmlNS === void 0 ) xmlNS = null;\n\n  if (typeof structure == \"string\")\n    { return {dom: doc.createTextNode(structure)} }\n  if (structure.nodeType != null)\n    { return {dom: structure} }\n  if (structure.dom && structure.dom.nodeType != null)\n    { return structure }\n  var tagName = structure[0], space = tagName.indexOf(\" \");\n  if (space > 0) {\n    xmlNS = tagName.slice(0, space);\n    tagName = tagName.slice(space + 1);\n  }\n  var contentDOM = null, dom = xmlNS ? doc.createElementNS(xmlNS, tagName) : doc.createElement(tagName);\n  var attrs = structure[1], start = 1;\n  if (attrs && typeof attrs == \"object\" && attrs.nodeType == null && !Array.isArray(attrs)) {\n    start = 2;\n    for (var name in attrs) { if (attrs[name] != null) {\n      var space$1 = name.indexOf(\" \");\n      if (space$1 > 0) { dom.setAttributeNS(name.slice(0, space$1), name.slice(space$1 + 1), attrs[name]); }\n      else { dom.setAttribute(name, attrs[name]); }\n    } }\n  }\n  for (var i = start; i < structure.length; i++) {\n    var child = structure[i];\n    if (child === 0) {\n      if (i < structure.length - 1 || i > start)\n        { throw new RangeError(\"Content hole must be the only child of its parent node\") }\n      return {dom: dom, contentDOM: dom}\n    } else {\n      var ref = DOMSerializer.renderSpec(doc, child, xmlNS);\n        var inner = ref.dom;\n        var innerContent = ref.contentDOM;\n      dom.appendChild(inner);\n      if (innerContent) {\n        if (contentDOM) { throw new RangeError(\"Multiple content holes\") }\n        contentDOM = innerContent;\n      }\n    }\n  }\n  return {dom: dom, contentDOM: contentDOM}\n};\n\n// :: (Schema) → DOMSerializer\n// Build a serializer using the [`toDOM`](#model.NodeSpec.toDOM)\n// properties in a schema's node and mark specs.\nDOMSerializer.fromSchema = function fromSchema (schema) {\n  return schema.cached.domSerializer ||\n    (schema.cached.domSerializer = new DOMSerializer(this.nodesFromSchema(schema), this.marksFromSchema(schema)))\n};\n\n// : (Schema) → Object<(node: Node) → DOMOutputSpec>\n// Gather the serializers in a schema's node specs into an object.\n// This can be useful as a base to build a custom serializer from.\nDOMSerializer.nodesFromSchema = function nodesFromSchema (schema) {\n  var result = gatherToDOM(schema.nodes);\n  if (!result.text) { result.text = function (node) { return node.text; }; }\n  return result\n};\n\n// : (Schema) → Object<(mark: Mark) → DOMOutputSpec>\n// Gather the serializers in a schema's mark specs into an object.\nDOMSerializer.marksFromSchema = function marksFromSchema (schema) {\n  return gatherToDOM(schema.marks)\n};\n\nfunction gatherToDOM(obj) {\n  var result = {};\n  for (var name in obj) {\n    var toDOM = obj[name].spec.toDOM;\n    if (toDOM) { result[name] = toDOM; }\n  }\n  return result\n}\n\nfunction doc(options) {\n  // declare global: window\n  return options.document || window.document\n}\n\nexport { ContentMatch, DOMParser, DOMSerializer, Fragment, Mark, MarkType, Node, NodeRange, NodeType, ReplaceError, ResolvedPos, Schema, Slice };\n//# sourceMappingURL=index.es.js.map\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar transitionDuration = 300;\n\nvar defaults = {\n  errors: {\n    controlled: 'A component is changing a react-medium-image-zoom component from a controlled component to an uncontrolled one. ImageZoom elements should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled image zoom element for the lifetime of the component.',\n    uncontrolled: 'A component is changing a react-medium-image-zoom component from an uncontrolled component to a controlled one. ImageZoom elements should not switch from uncontrolled to controlled (or vice versa). Decide between using a controlled or uncontrolled image zoom element for the lifetime of the component.'\n  },\n  styles: {\n    image: {\n      cursor: 'zoom-in'\n    },\n    zoomImage: {\n      cursor: 'zoom-out',\n      position: 'absolute',\n      transition: 'transform ' + transitionDuration + 'ms',\n      transform: 'translate3d(0, 0, 0) scale(1)',\n      transformOrigin: 'center center',\n      willChange: 'transform, top, left'\n    },\n    zoomContainer: {\n      position: 'fixed',\n      top: 0,\n      right: 0,\n      bottom: 0,\n      left: 0,\n      zIndex: 999\n    },\n    overlay: {\n      position: 'absolute',\n      top: 0,\n      right: 0,\n      bottom: 0,\n      left: 0,\n      backgroundColor: '#fff',\n      opacity: 0,\n      transition: 'opacity ' + transitionDuration + 'ms'\n    }\n  },\n  transitionDuration: transitionDuration\n};\n\nexports.default = defaults;","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require('prop-types');\n\nvar _defaults = require('./defaults');\n\nvar _defaults2 = _interopRequireDefault(_defaults);\n\nvar _helpers = require('./helpers');\n\nvar _keyboardEvents = require('./keyboardEvents');\n\nvar _EventsWrapper = require('./EventsWrapper');\n\nvar _EventsWrapper2 = _interopRequireDefault(_EventsWrapper);\n\nvar _Zoom = require('./Zoom');\n\nvar _Zoom2 = _interopRequireDefault(_Zoom);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar isControlled = function isControlled(isZoomed) {\n  return isZoomed !== null && isZoomed !== undefined;\n};\nvar focusableTabIndex = 0;\nvar unfocusableTabIndex = -1;\n\nvar ImageZoom = function (_Component) {\n  _inherits(ImageZoom, _Component);\n\n  function ImageZoom(props) {\n    _classCallCheck(this, ImageZoom);\n\n    var _this = _possibleConstructorReturn(this, (ImageZoom.__proto__ || Object.getPrototypeOf(ImageZoom)).call(this, props));\n\n    _this.state = {\n      isDisabled: false,\n      isZoomed: false,\n      wasZoomed: false,\n      src: props.image.src,\n      prevSrc: props.image.src,\n      isClosing: false\n    };\n\n    _this._handleKeyDown = _this._handleKeyDown.bind(_this);\n    _this._handleLoad = _this._handleLoad.bind(_this);\n    _this._handleLoadError = _this._handleLoadError.bind(_this);\n    _this._handleUnzoom = _this._handleUnzoom.bind(_this);\n    _this._handleZoom = _this._handleZoom.bind(_this);\n    return _this;\n  }\n\n  _createClass(ImageZoom, [{\n    key: 'componentDidUpdate',\n\n\n    /**\n     * When the component's state updates, check for changes\n     * and either zoom or start the unzoom procedure.\n     * NOTE: We need to differentiate whether this is a\n     * controlled or uncontrolled component and do the check\n     * based off of that.\n     */\n    value: function componentDidUpdate(prevProps, prevState) {\n      if (!isControlled(prevProps.isZoomed) && isControlled(this.props.isZoomed)) {\n        throw new Error(_defaults2.default.errors.uncontrolled);\n      } else if (isControlled(prevProps.isZoomed) && !isControlled(this.props.isZoomed)) {\n        throw new Error(_defaults2.default.errors.controlled);\n      }\n\n      var prevIsZoomed = isControlled(prevProps.isZoomed) ? prevProps.isZoomed : prevState.isZoomed;\n      var isZoomed = isControlled(this.props.isZoomed) ? this.props.isZoomed : this.state.isZoomed;\n      if (prevIsZoomed !== isZoomed && !isZoomed && this.portalInstance) {\n        this.portalInstance.unzoom({ force: true });\n      }\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _this2 = this;\n\n      var _props = this.props,\n          defaultStyles = _props.defaultStyles,\n          image = _props.image,\n          propsIsZoomed = _props.isZoomed,\n          shouldRespectMaxDimension = _props.shouldRespectMaxDimension,\n          zoomImage = _props.zoomImage,\n          zoomMargin = _props.zoomMargin,\n          _state = this.state,\n          isDisabled = _state.isDisabled,\n          stateIsZoomed = _state.isZoomed,\n          src = _state.src,\n          isClosing = _state.isClosing;\n\n      /**\n       * Take whatever attributes you want to pass the image\n       * and then override with the properties we need,\n       * including using state as source of truth for hi/low-res\n       * version img src.\n       * Also, disable any clicking if the component is\n       * already at its maximum dimensions.\n       */\n\n      var attrs = _extends({}, !isDisabled && { tabIndex: focusableTabIndex }, image, { src: src, style: this._getImageStyle() }, !isDisabled && {\n        onMouseDown: this._preventFocus,\n        onClick: this._handleZoom,\n        onKeyDown: this._handleKeyDown\n      });\n      var isZoomed = isControlled(propsIsZoomed) ? propsIsZoomed : stateIsZoomed;\n\n      return _react2.default.createElement(\n        _react.Fragment,\n        null,\n        _react2.default.createElement('img', _extends({}, attrs, {\n          key: 'image',\n          ref: function ref(x) {\n            _this2.image = x;\n          },\n          onLoad: this._handleLoad,\n          onError: this._handleLoadError\n        })),\n        this.image && (isZoomed || isClosing) ? _react2.default.createElement(\n          _EventsWrapper2.default,\n          {\n            key: 'portal',\n            ref: function ref(node) {\n              _this2.portalInstance = node;\n            },\n            controlledEventFn: this._getControlledEventFn(),\n            allowAccessibilityClose: this._allowTabNavigation()\n          },\n          _react2.default.createElement(_Zoom2.default, {\n            defaultStyles: defaultStyles,\n            image: this.image,\n            shouldRespectMaxDimension: shouldRespectMaxDimension,\n            zoomImage: zoomImage,\n            zoomMargin: Number(zoomMargin),\n            onUnzoom: this._handleUnzoom\n          })\n        ) : null\n      );\n    }\n\n    /**\n     * If the image should not exceed its original\n     * dimensions AND there is no zoomImage AND the\n     * image is already rendered at its maximum dimensions,\n     * then we shouldn't try to zoom it at all. We currently\n     * only do this on componentDidMount, though on window\n     * resize could be something to consider if necessary.\n     */\n\n  }, {\n    key: '_checkShouldDisableComponent',\n    value: function _checkShouldDisableComponent() {\n      var _props2 = this.props,\n          shouldRespectMaxDimension = _props2.shouldRespectMaxDimension,\n          zoomImage = _props2.zoomImage;\n\n      var isDisabled = shouldRespectMaxDimension && !zoomImage && (0, _helpers.isMaxDimension)(this.image);\n\n      this.setState({ isDisabled: isDisabled });\n    }\n  }, {\n    key: '_getImageStyle',\n    value: function _getImageStyle() {\n      var _props3 = this.props,\n          defaultStyles = _props3.defaultStyles,\n          image = _props3.image,\n          isZoomedP = _props3.isZoomed,\n          _state2 = this.state,\n          isDisabled = _state2.isDisabled,\n          isZoomedSt = _state2.isZoomed,\n          isClosing = _state2.isClosing;\n\n\n      var isHidden = isZoomedSt || isZoomedP || isClosing;\n\n      return _extends({}, _defaults2.default.styles.image, isHidden && { visibility: 'hidden' }, defaultStyles.image, image.style, isDisabled && { cursor: 'inherit' });\n    }\n\n    /**\n     * We need to wait for the main image\n     * to load before we can do any width/height\n     * checks on it.\n     */\n\n  }, {\n    key: '_handleLoad',\n    value: function _handleLoad(e) {\n      this._checkShouldDisableComponent();\n\n      var cb = this.props.image.onLoad || Function.prototype;\n      cb(e);\n    }\n  }, {\n    key: '_handleLoadError',\n    value: function _handleLoadError(e) {\n      this.setState({ isDisabled: true });\n\n      var cb = this.props.image.onError || Function.prototype;\n      cb(e);\n    }\n  }, {\n    key: '_handleKeyDown',\n    value: function _handleKeyDown(e) {\n      if ((0, _keyboardEvents.isEnterOrSpaceBarKey)(e)) {\n        e.preventDefault();\n        this._handleZoom(e);\n      }\n    }\n  }, {\n    key: '_preventFocus',\n    value: function _preventFocus(e) {\n      e.preventDefault();\n    }\n  }, {\n    key: '_handleZoom',\n    value: function _handleZoom(e) {\n      if (!isControlled(this.props.isZoomed) && this.props.shouldHandleZoom(e)) {\n        this.setState({ isZoomed: true }, this.props.onZoom);\n      } else {\n        this.props.onZoom();\n      }\n    }\n\n    /**\n     * This gets passed to the zoomed component as a callback\n     * to trigger when the time is right to shut down the zoom.\n     * If `shouldReplaceImage`, update the normal image we're showing\n     * with the zoomed image -- useful when wanting to replace a low-res\n     * image with a high-res one once it's already been downloaded.\n     * It also cleans up the zoom references and then updates state.\n     */\n\n  }, {\n    key: '_handleUnzoom',\n    value: function _handleUnzoom(src, allowRefocus) {\n      var _this3 = this;\n\n      return function () {\n        var changes = _extends({ isZoomed: false, isClosing: false }, _this3.props.shouldReplaceImage && { src: src });\n\n        _this3.setState(changes, _this3.props.onUnzoom);\n\n        if (allowRefocus && _this3._allowTabNavigation()) {\n          _this3.image.focus();\n        }\n      };\n    }\n  }, {\n    key: '_getControlledEventFn',\n    value: function _getControlledEventFn() {\n      return isControlled(this.props.isZoomed) ? this.props.onUnzoom : null;\n    }\n  }, {\n    key: '_allowTabNavigation',\n    value: function _allowTabNavigation() {\n      return this.image && this.image.tabIndex !== unfocusableTabIndex;\n    }\n  }], [{\n    key: 'getDerivedStateFromProps',\n    value: function getDerivedStateFromProps(props, state) {\n      /**\n       * When component is controlled, we need a flag\n       * set when it's about to close in order to keep\n       * hiding the original image on the page until the\n       * unzooming is complete\n       */\n      var isClosing = state.wasZoomed && !props.isZoomed || state.isClosing;\n      // If the consumer wants to change the image's src, then so be it.\n      var src = props.image.src !== state.prevSrc ? props.image.src : state.src;\n\n      return {\n        src: src,\n        isClosing: isClosing,\n        // Keep track of previous props\n        wasZoomed: props.isZoomed,\n        prevSrc: props.image.src\n      };\n    }\n  }, {\n    key: 'defaultProps',\n    get: function get() {\n      return {\n        shouldReplaceImage: true,\n        shouldRespectMaxDimension: false,\n        zoomMargin: 40,\n        defaultStyles: {\n          zoomContainer: {},\n          overlay: {},\n          image: {},\n          zoomImage: {}\n        },\n        shouldHandleZoom: function shouldHandleZoom() {\n          return true;\n        },\n        onZoom: function onZoom() {},\n        onUnzoom: function onUnzoom() {}\n      };\n    }\n  }]);\n\n  return ImageZoom;\n}(_react.Component);\n\nexports.default = ImageZoom;\n\n\nImageZoom.propTypes = {\n  image: (0, _propTypes.shape)({\n    src: _propTypes.string.isRequired,\n    alt: _propTypes.string,\n    className: _propTypes.string,\n    style: _propTypes.object\n  }).isRequired,\n  zoomImage: (0, _propTypes.shape)({\n    src: _propTypes.string,\n    alt: _propTypes.string,\n    className: _propTypes.string,\n    style: _propTypes.object\n  }),\n  defaultStyles: _propTypes.object,\n  isZoomed: _propTypes.bool,\n  shouldHandleZoom: _propTypes.func,\n  shouldReplaceImage: _propTypes.bool,\n  shouldRespectMaxDimension: _propTypes.bool,\n  onZoom: _propTypes.func,\n  onUnzoom: _propTypes.func\n};","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require('prop-types');\n\nvar _defaults = require('./defaults');\n\nvar _defaults2 = _interopRequireDefault(_defaults);\n\nvar _helpers = require('./helpers');\n\nvar _Overlay = require('./Overlay');\n\nvar _Overlay2 = _interopRequireDefault(_Overlay);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _objectWithoutProperties(obj, keys) { var target = {}; for (var i in obj) { if (keys.indexOf(i) >= 0) continue; if (!Object.prototype.hasOwnProperty.call(obj, i)) continue; target[i] = obj[i]; } return target; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\n/**\n * The `tmpSrc` and `TmpImg` code here is a workaround\n * for a longstanding Firefox issue where replacing the\n * `src` of an `<img>` tag requires calculations and\n * results in a \"flicker\" of sorts.\n *\n * See https://github.com/rpearce/react-medium-image-zoom/issues/96\n * for further details.\n */\n\nvar Zoom = function (_Component) {\n  _inherits(Zoom, _Component);\n\n  function Zoom(props) {\n    _classCallCheck(this, Zoom);\n\n    var _this = _possibleConstructorReturn(this, (Zoom.__proto__ || Object.getPrototypeOf(Zoom)).call(this, props));\n\n    _this.state = {\n      hasLoaded: false,\n      isZoomed: true,\n      src: props.image.currentSrc || props.image.src,\n      tmpSrc: null\n    };\n\n    _this.unzoom = _this.unzoom.bind(_this);\n    _this._handleImageLoad = _this._handleImageLoad.bind(_this);\n    return _this;\n  }\n\n  _createClass(Zoom, [{\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      var _props$zoomImage = this.props.zoomImage,\n          src = _props$zoomImage.src,\n          srcSet = _props$zoomImage.srcSet;\n\n\n      this.setState({ hasLoaded: true });\n\n      if (src || srcSet) {\n        (0, _helpers.fetchImage)(this.props.zoomImage, this._handleImageLoad);\n      }\n    }\n  }, {\n    key: 'componentDidUpdate',\n    value: function componentDidUpdate(prevProps, prevState) {\n      var _this2 = this;\n\n      // If we have a `tmpSrc`, wait and then give it to `src`\n      if (!prevState.tmpSrc && this.state.tmpSrc) {\n        setTimeout(function () {\n          _this2.setState({ src: _this2.state.tmpSrc, tmpSrc: null });\n        }, 100);\n      }\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _props = this.props,\n          defaultStyles = _props.defaultStyles,\n          zoomImage = _props.zoomImage,\n          _state = this.state,\n          tmpSrc = _state.tmpSrc,\n          isZoomed = _state.isZoomed,\n          src = _state.src;\n\n\n      var style = this._getZoomImageStyle();\n\n      return _react2.default.createElement(\n        'div',\n        { style: this._getZoomContainerStyle() },\n        _react2.default.createElement(_Overlay2.default, { isVisible: isZoomed, defaultStyles: defaultStyles }),\n        _react2.default.createElement('img', _extends({}, zoomImage, { src: src, style: style })),\n        _react2.default.createElement(TmpImg, _extends({}, zoomImage, { src: tmpSrc, style: style }))\n      );\n    }\n  }, {\n    key: 'unzoom',\n    value: function unzoom(allowRefocus) {\n      var onUnzoom = this.props.onUnzoom(this.state.src, allowRefocus);\n      this.setState({ isZoomed: false }, function () {\n        return setTimeout(onUnzoom, _defaults2.default.transitionDuration);\n      });\n    }\n  }, {\n    key: '_handleImageLoad',\n    value: function _handleImageLoad(img) {\n      // Only set state if component is still mounted\n      if (this.state.isZoomed) {\n        this.setState({ tmpSrc: img.currentSrc || img.src });\n      }\n    }\n  }, {\n    key: '_getZoomContainerStyle',\n    value: function _getZoomContainerStyle() {\n      return _extends({}, _defaults2.default.styles.zoomContainer, this.props.defaultStyles.zoomContainer);\n    }\n  }, {\n    key: '_getZoomImageStyle',\n    value: function _getZoomImageStyle() {\n      var _props2 = this.props,\n          image = _props2.image,\n          shouldRespectMaxDimension = _props2.shouldRespectMaxDimension,\n          src = _props2.src,\n          zoomMargin = _props2.zoomMargin;\n\n      var imageOffset = image.getBoundingClientRect();\n\n      var top = imageOffset.top,\n          left = imageOffset.left;\n      var width = image.width,\n          height = image.height,\n          naturalWidth = image.naturalWidth,\n          naturalHeight = image.naturalHeight;\n\n\n      var style = { top: top, left: left, width: width, height: height };\n\n      if (!this.state.hasLoaded || !this.state.isZoomed) {\n        return _extends({}, _defaults2.default.styles.zoomImage, this.props.defaultStyles.zoomImage, this.props.style, style);\n      }\n\n      // Get the the coords for center of the viewport\n      var viewportX = document.body.clientWidth / 2;\n      var viewportY = window.innerHeight / 2;\n\n      // Get the coords for center of the original image\n      var imageCenterX = imageOffset.left + width / 2;\n      var imageCenterY = imageOffset.top + height / 2;\n\n      // Get offset amounts for image coords to be centered on screen\n      var translateX = viewportX - imageCenterX;\n      var translateY = viewportY - imageCenterY;\n\n      // Figure out how much to scale the image\n      var scale = shouldRespectMaxDimension && !src ? (0, _helpers.getMaxDimensionScale)({\n        width: width,\n        height: height,\n        naturalWidth: naturalWidth,\n        naturalHeight: naturalHeight,\n        zoomMargin: zoomMargin\n      }) : (0, _helpers.getScale)({ width: width, height: height, zoomMargin: zoomMargin });\n\n      var zoomStyle = {\n        transform: 'translate3d(' + translateX + 'px, ' + translateY + 'px, 0) scale(' + scale + ')'\n      };\n\n      return _extends({}, _defaults2.default.styles.zoomImage, this.props.defaultStyles.zoomImage, this.props.style, style, zoomStyle);\n    }\n  }], [{\n    key: 'defaultProps',\n    get: function get() {\n      return {\n        zoomImage: {}\n      };\n    }\n  }]);\n\n  return Zoom;\n}(_react.Component);\n\nexports.default = Zoom;\n\n\nZoom.propTypes = {\n  defaultStyles: _propTypes.object.isRequired,\n  image: _propTypes.object.isRequired,\n  shouldRespectMaxDimension: _propTypes.bool,\n  zoomImage: (0, _propTypes.shape)({\n    src: _propTypes.string,\n    alt: _propTypes.string,\n    className: _propTypes.string,\n    style: _propTypes.object\n  }).isRequired,\n  zoomMargin: _propTypes.number.isRequired,\n  onUnzoom: _propTypes.func.isRequired\n};\n\nvar TmpImg = function TmpImg(_ref) {\n  var src = _ref.src,\n      style = _ref.style,\n      props = _objectWithoutProperties(_ref, ['src', 'style']);\n\n  return src ? _react2.default.createElement('img', _extends({}, props, { src: src, style: getTmpStyle(style) })) : null;\n};\n\nvar tmpStyle = {\n  position: 'fixed',\n  visibility: 'hidden'\n};\n\nvar getTmpStyle = function getTmpStyle(style) {\n  return _extends({}, style, tmpStyle);\n};","import { Slice, Fragment, Mark, Node } from 'prosemirror-model';\nimport { ReplaceStep, ReplaceAroundStep, Transform } from 'prosemirror-transform';\n\nvar classesById = Object.create(null);\n\n// ::- Superclass for editor selections. Every selection type should\n// extend this. Should not be instantiated directly.\nvar Selection = function Selection($anchor, $head, ranges) {\n  // :: [SelectionRange]\n  // The ranges covered by the selection.\n  this.ranges = ranges || [new SelectionRange($anchor.min($head), $anchor.max($head))];\n  // :: ResolvedPos\n  // The resolved anchor of the selection (the side that stays in\n  // place when the selection is modified).\n  this.$anchor = $anchor;\n  // :: ResolvedPos\n  // The resolved head of the selection (the side that moves when\n  // the selection is modified).\n  this.$head = $head;\n};\n\nvar prototypeAccessors = { anchor: { configurable: true },head: { configurable: true },from: { configurable: true },to: { configurable: true },$from: { configurable: true },$to: { configurable: true },empty: { configurable: true } };\n\n// :: number\n// The selection's anchor, as an unresolved position.\nprototypeAccessors.anchor.get = function () { return this.$anchor.pos };\n\n// :: number\n// The selection's head.\nprototypeAccessors.head.get = function () { return this.$head.pos };\n\n// :: number\n// The lower bound of the selection's main range.\nprototypeAccessors.from.get = function () { return this.$from.pos };\n\n// :: number\n// The upper bound of the selection's main range.\nprototypeAccessors.to.get = function () { return this.$to.pos };\n\n// :: ResolvedPos\n// The resolved lowerbound of the selection's main range.\nprototypeAccessors.$from.get = function () {\n  return this.ranges[0].$from\n};\n\n// :: ResolvedPos\n// The resolved upper bound of the selection's main range.\nprototypeAccessors.$to.get = function () {\n  return this.ranges[0].$to\n};\n\n// :: bool\n// Indicates whether the selection contains any content.\nprototypeAccessors.empty.get = function () {\n  var ranges = this.ranges;\n  for (var i = 0; i < ranges.length; i++)\n    { if (ranges[i].$from.pos != ranges[i].$to.pos) { return false } }\n  return true\n};\n\n// eq:: (Selection) → bool\n// Test whether the selection is the same as another selection.\n\n// map:: (doc: Node, mapping: Mappable) → Selection\n// Map this selection through a [mappable](#transform.Mappable) thing. `doc`\n// should be the new document to which we are mapping.\n\n// :: () → Slice\n// Get the content of this selection as a slice.\nSelection.prototype.content = function content () {\n  return this.$from.node(0).slice(this.from, this.to, true)\n};\n\n// :: (Transaction, ?Slice)\n// Replace the selection with a slice or, if no slice is given,\n// delete the selection. Will append to the given transaction.\nSelection.prototype.replace = function replace (tr, content) {\n    if ( content === void 0 ) content = Slice.empty;\n\n  // Put the new selection at the position after the inserted\n  // content. When that ended in an inline node, search backwards,\n  // to get the position after that node. If not, search forward.\n  var lastNode = content.content.lastChild, lastParent = null;\n  for (var i = 0; i < content.openEnd; i++) {\n    lastParent = lastNode;\n    lastNode = lastNode.lastChild;\n  }\n\n  var mapFrom = tr.steps.length, ranges = this.ranges;\n  for (var i$1 = 0; i$1 < ranges.length; i$1++) {\n    var ref = ranges[i$1];\n      var $from = ref.$from;\n      var $to = ref.$to;\n      var mapping = tr.mapping.slice(mapFrom);\n    tr.replaceRange(mapping.map($from.pos), mapping.map($to.pos), i$1 ? Slice.empty : content);\n    if (i$1 == 0)\n      { selectionToInsertionEnd(tr, mapFrom, (lastNode ? lastNode.isInline : lastParent && lastParent.isTextblock) ? -1 : 1); }\n  }\n};\n\n// :: (Transaction, Node)\n// Replace the selection with the given node, appending the changes\n// to the given transaction.\nSelection.prototype.replaceWith = function replaceWith (tr, node) {\n  var mapFrom = tr.steps.length, ranges = this.ranges;\n  for (var i = 0; i < ranges.length; i++) {\n    var ref = ranges[i];\n      var $from = ref.$from;\n      var $to = ref.$to;\n      var mapping = tr.mapping.slice(mapFrom);\n    var from = mapping.map($from.pos), to = mapping.map($to.pos);\n    if (i) {\n      tr.deleteRange(from, to);\n    } else {\n      tr.replaceRangeWith(from, to, node);\n      selectionToInsertionEnd(tr, mapFrom, node.isInline ? -1 : 1);\n    }\n  }\n};\n\n// toJSON:: () → Object\n// Convert the selection to a JSON representation. When implementing\n// this for a custom selection class, make sure to give the object a\n// `type` property whose value matches the ID under which you\n// [registered](#state.Selection^jsonID) your class.\n\n// :: (ResolvedPos, number, ?bool) → ?Selection\n// Find a valid cursor or leaf node selection starting at the given\n// position and searching back if `dir` is negative, and forward if\n// positive. When `textOnly` is true, only consider cursor\n// selections. Will return null when no valid selection position is\n// found.\nSelection.findFrom = function findFrom ($pos, dir, textOnly) {\n  var inner = $pos.parent.inlineContent ? new TextSelection($pos)\n      : findSelectionIn($pos.node(0), $pos.parent, $pos.pos, $pos.index(), dir, textOnly);\n  if (inner) { return inner }\n\n  for (var depth = $pos.depth - 1; depth >= 0; depth--) {\n    var found = dir < 0\n        ? findSelectionIn($pos.node(0), $pos.node(depth), $pos.before(depth + 1), $pos.index(depth), dir, textOnly)\n        : findSelectionIn($pos.node(0), $pos.node(depth), $pos.after(depth + 1), $pos.index(depth) + 1, dir, textOnly);\n    if (found) { return found }\n  }\n};\n\n// :: (ResolvedPos, ?number) → Selection\n// Find a valid cursor or leaf node selection near the given\n// position. Searches forward first by default, but if `bias` is\n// negative, it will search backwards first.\nSelection.near = function near ($pos, bias) {\n    if ( bias === void 0 ) bias = 1;\n\n  return this.findFrom($pos, bias) || this.findFrom($pos, -bias) || new AllSelection($pos.node(0))\n};\n\n// :: (Node) → Selection\n// Find the cursor or leaf node selection closest to the start of\n// the given document. Will return an\n// [`AllSelection`](#state.AllSelection) if no valid position\n// exists.\nSelection.atStart = function atStart (doc) {\n  return findSelectionIn(doc, doc, 0, 0, 1) || new AllSelection(doc)\n};\n\n// :: (Node) → Selection\n// Find the cursor or leaf node selection closest to the end of the\n// given document.\nSelection.atEnd = function atEnd (doc) {\n  return findSelectionIn(doc, doc, doc.content.size, doc.childCount, -1) || new AllSelection(doc)\n};\n\n// :: (Node, Object) → Selection\n// Deserialize the JSON representation of a selection. Must be\n// implemented for custom classes (as a static class method).\nSelection.fromJSON = function fromJSON (doc, json) {\n  if (!json || !json.type) { throw new RangeError(\"Invalid input for Selection.fromJSON\") }\n  var cls = classesById[json.type];\n  if (!cls) { throw new RangeError((\"No selection type \" + (json.type) + \" defined\")) }\n  return cls.fromJSON(doc, json)\n};\n\n// :: (string, constructor<Selection>)\n// To be able to deserialize selections from JSON, custom selection\n// classes must register themselves with an ID string, so that they\n// can be disambiguated. Try to pick something that's unlikely to\n// clash with classes from other modules.\nSelection.jsonID = function jsonID (id, selectionClass) {\n  if (id in classesById) { throw new RangeError(\"Duplicate use of selection JSON ID \" + id) }\n  classesById[id] = selectionClass;\n  selectionClass.prototype.jsonID = id;\n  return selectionClass\n};\n\n// :: () → SelectionBookmark\n// Get a [bookmark](#state.SelectionBookmark) for this selection,\n// which is a value that can be mapped without having access to a\n// current document, and later resolved to a real selection for a\n// given document again. (This is used mostly by the history to\n// track and restore old selections.) The default implementation of\n// this method just converts the selection to a text selection and\n// returns the bookmark for that.\nSelection.prototype.getBookmark = function getBookmark () {\n  return TextSelection.between(this.$anchor, this.$head).getBookmark()\n};\n\nObject.defineProperties( Selection.prototype, prototypeAccessors );\n\n// :: bool\n// Controls whether, when a selection of this type is active in the\n// browser, the selected range should be visible to the user. Defaults\n// to `true`.\nSelection.prototype.visible = true;\n\n// SelectionBookmark:: interface\n// A lightweight, document-independent representation of a selection.\n// You can define a custom bookmark type for a custom selection class\n// to make the history handle it well.\n//\n//   map:: (mapping: Mapping) → SelectionBookmark\n//   Map the bookmark through a set of changes.\n//\n//   resolve:: (doc: Node) → Selection\n//   Resolve the bookmark to a real selection again. This may need to\n//   do some error checking and may fall back to a default (usually\n//   [`TextSelection.between`](#state.TextSelection^between)) if\n//   mapping made the bookmark invalid.\n\n// ::- Represents a selected range in a document.\nvar SelectionRange = function SelectionRange($from, $to) {\n  // :: ResolvedPos\n  // The lower bound of the range.\n  this.$from = $from;\n  // :: ResolvedPos\n  // The upper bound of the range.\n  this.$to = $to;\n};\n\n// ::- A text selection represents a classical editor selection, with\n// a head (the moving side) and anchor (immobile side), both of which\n// point into textblock nodes. It can be empty (a regular cursor\n// position).\nvar TextSelection = /*@__PURE__*/(function (Selection) {\n  function TextSelection($anchor, $head) {\n    if ( $head === void 0 ) $head = $anchor;\n\n    Selection.call(this, $anchor, $head);\n  }\n\n  if ( Selection ) TextSelection.__proto__ = Selection;\n  TextSelection.prototype = Object.create( Selection && Selection.prototype );\n  TextSelection.prototype.constructor = TextSelection;\n\n  var prototypeAccessors$1 = { $cursor: { configurable: true } };\n\n  // :: ?ResolvedPos\n  // Returns a resolved position if this is a cursor selection (an\n  // empty text selection), and null otherwise.\n  prototypeAccessors$1.$cursor.get = function () { return this.$anchor.pos == this.$head.pos ? this.$head : null };\n\n  TextSelection.prototype.map = function map (doc, mapping) {\n    var $head = doc.resolve(mapping.map(this.head));\n    if (!$head.parent.inlineContent) { return Selection.near($head) }\n    var $anchor = doc.resolve(mapping.map(this.anchor));\n    return new TextSelection($anchor.parent.inlineContent ? $anchor : $head, $head)\n  };\n\n  TextSelection.prototype.replace = function replace (tr, content) {\n    if ( content === void 0 ) content = Slice.empty;\n\n    Selection.prototype.replace.call(this, tr, content);\n    if (content == Slice.empty) {\n      var marks = this.$from.marksAcross(this.$to);\n      if (marks) { tr.ensureMarks(marks); }\n    }\n  };\n\n  TextSelection.prototype.eq = function eq (other) {\n    return other instanceof TextSelection && other.anchor == this.anchor && other.head == this.head\n  };\n\n  TextSelection.prototype.getBookmark = function getBookmark () {\n    return new TextBookmark(this.anchor, this.head)\n  };\n\n  TextSelection.prototype.toJSON = function toJSON () {\n    return {type: \"text\", anchor: this.anchor, head: this.head}\n  };\n\n  TextSelection.fromJSON = function fromJSON (doc, json) {\n    if (typeof json.anchor != \"number\" || typeof json.head != \"number\")\n      { throw new RangeError(\"Invalid input for TextSelection.fromJSON\") }\n    return new TextSelection(doc.resolve(json.anchor), doc.resolve(json.head))\n  };\n\n  // :: (Node, number, ?number) → TextSelection\n  // Create a text selection from non-resolved positions.\n  TextSelection.create = function create (doc, anchor, head) {\n    if ( head === void 0 ) head = anchor;\n\n    var $anchor = doc.resolve(anchor);\n    return new this($anchor, head == anchor ? $anchor : doc.resolve(head))\n  };\n\n  // :: (ResolvedPos, ResolvedPos, ?number) → Selection\n  // Return a text selection that spans the given positions or, if\n  // they aren't text positions, find a text selection near them.\n  // `bias` determines whether the method searches forward (default)\n  // or backwards (negative number) first. Will fall back to calling\n  // [`Selection.near`](#state.Selection^near) when the document\n  // doesn't contain a valid text position.\n  TextSelection.between = function between ($anchor, $head, bias) {\n    var dPos = $anchor.pos - $head.pos;\n    if (!bias || dPos) { bias = dPos >= 0 ? 1 : -1; }\n    if (!$head.parent.inlineContent) {\n      var found = Selection.findFrom($head, bias, true) || Selection.findFrom($head, -bias, true);\n      if (found) { $head = found.$head; }\n      else { return Selection.near($head, bias) }\n    }\n    if (!$anchor.parent.inlineContent) {\n      if (dPos == 0) {\n        $anchor = $head;\n      } else {\n        $anchor = (Selection.findFrom($anchor, -bias, true) || Selection.findFrom($anchor, bias, true)).$anchor;\n        if (($anchor.pos < $head.pos) != (dPos < 0)) { $anchor = $head; }\n      }\n    }\n    return new TextSelection($anchor, $head)\n  };\n\n  Object.defineProperties( TextSelection.prototype, prototypeAccessors$1 );\n\n  return TextSelection;\n}(Selection));\n\nSelection.jsonID(\"text\", TextSelection);\n\nvar TextBookmark = function TextBookmark(anchor, head) {\n  this.anchor = anchor;\n  this.head = head;\n};\nTextBookmark.prototype.map = function map (mapping) {\n  return new TextBookmark(mapping.map(this.anchor), mapping.map(this.head))\n};\nTextBookmark.prototype.resolve = function resolve (doc) {\n  return TextSelection.between(doc.resolve(this.anchor), doc.resolve(this.head))\n};\n\n// ::- A node selection is a selection that points at a single node.\n// All nodes marked [selectable](#model.NodeSpec.selectable) can be\n// the target of a node selection. In such a selection, `from` and\n// `to` point directly before and after the selected node, `anchor`\n// equals `from`, and `head` equals `to`..\nvar NodeSelection = /*@__PURE__*/(function (Selection) {\n  function NodeSelection($pos) {\n    var node = $pos.nodeAfter;\n    var $end = $pos.node(0).resolve($pos.pos + node.nodeSize);\n    Selection.call(this, $pos, $end);\n    // :: Node The selected node.\n    this.node = node;\n  }\n\n  if ( Selection ) NodeSelection.__proto__ = Selection;\n  NodeSelection.prototype = Object.create( Selection && Selection.prototype );\n  NodeSelection.prototype.constructor = NodeSelection;\n\n  NodeSelection.prototype.map = function map (doc, mapping) {\n    var ref = mapping.mapResult(this.anchor);\n    var deleted = ref.deleted;\n    var pos = ref.pos;\n    var $pos = doc.resolve(pos);\n    if (deleted) { return Selection.near($pos) }\n    return new NodeSelection($pos)\n  };\n\n  NodeSelection.prototype.content = function content () {\n    return new Slice(Fragment.from(this.node), 0, 0)\n  };\n\n  NodeSelection.prototype.eq = function eq (other) {\n    return other instanceof NodeSelection && other.anchor == this.anchor\n  };\n\n  NodeSelection.prototype.toJSON = function toJSON () {\n    return {type: \"node\", anchor: this.anchor}\n  };\n\n  NodeSelection.prototype.getBookmark = function getBookmark () { return new NodeBookmark(this.anchor) };\n\n  NodeSelection.fromJSON = function fromJSON (doc, json) {\n    if (typeof json.anchor != \"number\")\n      { throw new RangeError(\"Invalid input for NodeSelection.fromJSON\") }\n    return new NodeSelection(doc.resolve(json.anchor))\n  };\n\n  // :: (Node, number) → NodeSelection\n  // Create a node selection from non-resolved positions.\n  NodeSelection.create = function create (doc, from) {\n    return new this(doc.resolve(from))\n  };\n\n  // :: (Node) → bool\n  // Determines whether the given node may be selected as a node\n  // selection.\n  NodeSelection.isSelectable = function isSelectable (node) {\n    return !node.isText && node.type.spec.selectable !== false\n  };\n\n  return NodeSelection;\n}(Selection));\n\nNodeSelection.prototype.visible = false;\n\nSelection.jsonID(\"node\", NodeSelection);\n\nvar NodeBookmark = function NodeBookmark(anchor) {\n  this.anchor = anchor;\n};\nNodeBookmark.prototype.map = function map (mapping) {\n  var ref = mapping.mapResult(this.anchor);\n    var deleted = ref.deleted;\n    var pos = ref.pos;\n  return deleted ? new TextBookmark(pos, pos) : new NodeBookmark(pos)\n};\nNodeBookmark.prototype.resolve = function resolve (doc) {\n  var $pos = doc.resolve(this.anchor), node = $pos.nodeAfter;\n  if (node && NodeSelection.isSelectable(node)) { return new NodeSelection($pos) }\n  return Selection.near($pos)\n};\n\n// ::- A selection type that represents selecting the whole document\n// (which can not necessarily be expressed with a text selection, when\n// there are for example leaf block nodes at the start or end of the\n// document).\nvar AllSelection = /*@__PURE__*/(function (Selection) {\n  function AllSelection(doc) {\n    Selection.call(this, doc.resolve(0), doc.resolve(doc.content.size));\n  }\n\n  if ( Selection ) AllSelection.__proto__ = Selection;\n  AllSelection.prototype = Object.create( Selection && Selection.prototype );\n  AllSelection.prototype.constructor = AllSelection;\n\n  AllSelection.prototype.replace = function replace (tr, content) {\n    if ( content === void 0 ) content = Slice.empty;\n\n    if (content == Slice.empty) {\n      tr.delete(0, tr.doc.content.size);\n      var sel = Selection.atStart(tr.doc);\n      if (!sel.eq(tr.selection)) { tr.setSelection(sel); }\n    } else {\n      Selection.prototype.replace.call(this, tr, content);\n    }\n  };\n\n  AllSelection.prototype.toJSON = function toJSON () { return {type: \"all\"} };\n\n  AllSelection.fromJSON = function fromJSON (doc) { return new AllSelection(doc) };\n\n  AllSelection.prototype.map = function map (doc) { return new AllSelection(doc) };\n\n  AllSelection.prototype.eq = function eq (other) { return other instanceof AllSelection };\n\n  AllSelection.prototype.getBookmark = function getBookmark () { return AllBookmark };\n\n  return AllSelection;\n}(Selection));\n\nSelection.jsonID(\"all\", AllSelection);\n\nvar AllBookmark = {\n  map: function map() { return this },\n  resolve: function resolve(doc) { return new AllSelection(doc) }\n};\n\n// FIXME we'll need some awareness of text direction when scanning for selections\n\n// Try to find a selection inside the given node. `pos` points at the\n// position where the search starts. When `text` is true, only return\n// text selections.\nfunction findSelectionIn(doc, node, pos, index, dir, text) {\n  if (node.inlineContent) { return TextSelection.create(doc, pos) }\n  for (var i = index - (dir > 0 ? 0 : 1); dir > 0 ? i < node.childCount : i >= 0; i += dir) {\n    var child = node.child(i);\n    if (!child.isAtom) {\n      var inner = findSelectionIn(doc, child, pos + dir, dir < 0 ? child.childCount : 0, dir, text);\n      if (inner) { return inner }\n    } else if (!text && NodeSelection.isSelectable(child)) {\n      return NodeSelection.create(doc, pos - (dir < 0 ? child.nodeSize : 0))\n    }\n    pos += child.nodeSize * dir;\n  }\n}\n\nfunction selectionToInsertionEnd(tr, startLen, bias) {\n  var last = tr.steps.length - 1;\n  if (last < startLen) { return }\n  var step = tr.steps[last];\n  if (!(step instanceof ReplaceStep || step instanceof ReplaceAroundStep)) { return }\n  var map = tr.mapping.maps[last], end;\n  map.forEach(function (_from, _to, _newFrom, newTo) { if (end == null) { end = newTo; } });\n  tr.setSelection(Selection.near(tr.doc.resolve(end), bias));\n}\n\nvar UPDATED_SEL = 1, UPDATED_MARKS = 2, UPDATED_SCROLL = 4;\n\n// ::- An editor state transaction, which can be applied to a state to\n// create an updated state. Use\n// [`EditorState.tr`](#state.EditorState.tr) to create an instance.\n//\n// Transactions track changes to the document (they are a subclass of\n// [`Transform`](#transform.Transform)), but also other state changes,\n// like selection updates and adjustments of the set of [stored\n// marks](#state.EditorState.storedMarks). In addition, you can store\n// metadata properties in a transaction, which are extra pieces of\n// information that client code or plugins can use to describe what a\n// transacion represents, so that they can update their [own\n// state](#state.StateField) accordingly.\n//\n// The [editor view](#view.EditorView) uses a few metadata properties:\n// it will attach a property `\"pointer\"` with the value `true` to\n// selection transactions directly caused by mouse or touch input, and\n// a `\"uiEvent\"` property of that may be `\"paste\"`, `\"cut\"`, or `\"drop\"`.\nvar Transaction = /*@__PURE__*/(function (Transform) {\n  function Transaction(state) {\n    Transform.call(this, state.doc);\n    // :: number\n    // The timestamp associated with this transaction, in the same\n    // format as `Date.now()`.\n    this.time = Date.now();\n    this.curSelection = state.selection;\n    // The step count for which the current selection is valid.\n    this.curSelectionFor = 0;\n    // :: ?[Mark]\n    // The stored marks set by this transaction, if any.\n    this.storedMarks = state.storedMarks;\n    // Bitfield to track which aspects of the state were updated by\n    // this transaction.\n    this.updated = 0;\n    // Object used to store metadata properties for the transaction.\n    this.meta = Object.create(null);\n  }\n\n  if ( Transform ) Transaction.__proto__ = Transform;\n  Transaction.prototype = Object.create( Transform && Transform.prototype );\n  Transaction.prototype.constructor = Transaction;\n\n  var prototypeAccessors = { selection: { configurable: true },selectionSet: { configurable: true },storedMarksSet: { configurable: true },isGeneric: { configurable: true },scrolledIntoView: { configurable: true } };\n\n  // :: Selection\n  // The transaction's current selection. This defaults to the editor\n  // selection [mapped](#state.Selection.map) through the steps in the\n  // transaction, but can be overwritten with\n  // [`setSelection`](#state.Transaction.setSelection).\n  prototypeAccessors.selection.get = function () {\n    if (this.curSelectionFor < this.steps.length) {\n      this.curSelection = this.curSelection.map(this.doc, this.mapping.slice(this.curSelectionFor));\n      this.curSelectionFor = this.steps.length;\n    }\n    return this.curSelection\n  };\n\n  // :: (Selection) → Transaction\n  // Update the transaction's current selection. Will determine the\n  // selection that the editor gets when the transaction is applied.\n  Transaction.prototype.setSelection = function setSelection (selection) {\n    if (selection.$from.doc != this.doc)\n      { throw new RangeError(\"Selection passed to setSelection must point at the current document\") }\n    this.curSelection = selection;\n    this.curSelectionFor = this.steps.length;\n    this.updated = (this.updated | UPDATED_SEL) & ~UPDATED_MARKS;\n    this.storedMarks = null;\n    return this\n  };\n\n  // :: bool\n  // Whether the selection was explicitly updated by this transaction.\n  prototypeAccessors.selectionSet.get = function () {\n    return (this.updated & UPDATED_SEL) > 0\n  };\n\n  // :: (?[Mark]) → Transaction\n  // Set the current stored marks.\n  Transaction.prototype.setStoredMarks = function setStoredMarks (marks) {\n    this.storedMarks = marks;\n    this.updated |= UPDATED_MARKS;\n    return this\n  };\n\n  // :: ([Mark]) → Transaction\n  // Make sure the current stored marks or, if that is null, the marks\n  // at the selection, match the given set of marks. Does nothing if\n  // this is already the case.\n  Transaction.prototype.ensureMarks = function ensureMarks (marks) {\n    if (!Mark.sameSet(this.storedMarks || this.selection.$from.marks(), marks))\n      { this.setStoredMarks(marks); }\n    return this\n  };\n\n  // :: (Mark) → Transaction\n  // Add a mark to the set of stored marks.\n  Transaction.prototype.addStoredMark = function addStoredMark (mark) {\n    return this.ensureMarks(mark.addToSet(this.storedMarks || this.selection.$head.marks()))\n  };\n\n  // :: (union<Mark, MarkType>) → Transaction\n  // Remove a mark or mark type from the set of stored marks.\n  Transaction.prototype.removeStoredMark = function removeStoredMark (mark) {\n    return this.ensureMarks(mark.removeFromSet(this.storedMarks || this.selection.$head.marks()))\n  };\n\n  // :: bool\n  // Whether the stored marks were explicitly set for this transaction.\n  prototypeAccessors.storedMarksSet.get = function () {\n    return (this.updated & UPDATED_MARKS) > 0\n  };\n\n  Transaction.prototype.addStep = function addStep (step, doc) {\n    Transform.prototype.addStep.call(this, step, doc);\n    this.updated = this.updated & ~UPDATED_MARKS;\n    this.storedMarks = null;\n  };\n\n  // :: (number) → Transaction\n  // Update the timestamp for the transaction.\n  Transaction.prototype.setTime = function setTime (time) {\n    this.time = time;\n    return this\n  };\n\n  // :: (Slice) → Transaction\n  // Replace the current selection with the given slice.\n  Transaction.prototype.replaceSelection = function replaceSelection (slice) {\n    this.selection.replace(this, slice);\n    return this\n  };\n\n  // :: (Node, ?bool) → Transaction\n  // Replace the selection with the given node. When `inheritMarks` is\n  // true and the content is inline, it inherits the marks from the\n  // place where it is inserted.\n  Transaction.prototype.replaceSelectionWith = function replaceSelectionWith (node, inheritMarks) {\n    var selection = this.selection;\n    if (inheritMarks !== false)\n      { node = node.mark(this.storedMarks || (selection.empty ? selection.$from.marks() : (selection.$from.marksAcross(selection.$to) || Mark.none))); }\n    selection.replaceWith(this, node);\n    return this\n  };\n\n  // :: () → Transaction\n  // Delete the selection.\n  Transaction.prototype.deleteSelection = function deleteSelection () {\n    this.selection.replace(this);\n    return this\n  };\n\n  // :: (string, from: ?number, to: ?number) → Transaction\n  // Replace the given range, or the selection if no range is given,\n  // with a text node containing the given string.\n  Transaction.prototype.insertText = function insertText (text, from, to) {\n    if ( to === void 0 ) to = from;\n\n    var schema = this.doc.type.schema;\n    if (from == null) {\n      if (!text) { return this.deleteSelection() }\n      return this.replaceSelectionWith(schema.text(text), true)\n    } else {\n      if (!text) { return this.deleteRange(from, to) }\n      var marks = this.storedMarks;\n      if (!marks) {\n        var $from = this.doc.resolve(from);\n        marks = to == from ? $from.marks() : $from.marksAcross(this.doc.resolve(to));\n      }\n      this.replaceRangeWith(from, to, schema.text(text, marks));\n      if (!this.selection.empty) { this.setSelection(Selection.near(this.selection.$to)); }\n      return this\n    }\n  };\n\n  // :: (union<string, Plugin, PluginKey>, any) → Transaction\n  // Store a metadata property in this transaction, keyed either by\n  // name or by plugin.\n  Transaction.prototype.setMeta = function setMeta (key, value) {\n    this.meta[typeof key == \"string\" ? key : key.key] = value;\n    return this\n  };\n\n  // :: (union<string, Plugin, PluginKey>) → any\n  // Retrieve a metadata property for a given name or plugin.\n  Transaction.prototype.getMeta = function getMeta (key) {\n    return this.meta[typeof key == \"string\" ? key : key.key]\n  };\n\n  // :: bool\n  // Returns true if this transaction doesn't contain any metadata,\n  // and can thus safely be extended.\n  prototypeAccessors.isGeneric.get = function () {\n    for (var _ in this.meta) { return false }\n    return true\n  };\n\n  // :: () → Transaction\n  // Indicate that the editor should scroll the selection into view\n  // when updated to the state produced by this transaction.\n  Transaction.prototype.scrollIntoView = function scrollIntoView () {\n    this.updated |= UPDATED_SCROLL;\n    return this\n  };\n\n  prototypeAccessors.scrolledIntoView.get = function () {\n    return (this.updated & UPDATED_SCROLL) > 0\n  };\n\n  Object.defineProperties( Transaction.prototype, prototypeAccessors );\n\n  return Transaction;\n}(Transform));\n\nfunction bind(f, self) {\n  return !self || !f ? f : f.bind(self)\n}\n\nvar FieldDesc = function FieldDesc(name, desc, self) {\n  this.name = name;\n  this.init = bind(desc.init, self);\n  this.apply = bind(desc.apply, self);\n};\n\nvar baseFields = [\n  new FieldDesc(\"doc\", {\n    init: function init(config) { return config.doc || config.schema.topNodeType.createAndFill() },\n    apply: function apply(tr) { return tr.doc }\n  }),\n\n  new FieldDesc(\"selection\", {\n    init: function init(config, instance) { return config.selection || Selection.atStart(instance.doc) },\n    apply: function apply(tr) { return tr.selection }\n  }),\n\n  new FieldDesc(\"storedMarks\", {\n    init: function init(config) { return config.storedMarks || null },\n    apply: function apply(tr, _marks, _old, state) { return state.selection.$cursor ? tr.storedMarks : null }\n  }),\n\n  new FieldDesc(\"scrollToSelection\", {\n    init: function init() { return 0 },\n    apply: function apply(tr, prev) { return tr.scrolledIntoView ? prev + 1 : prev }\n  })\n];\n\n// Object wrapping the part of a state object that stays the same\n// across transactions. Stored in the state's `config` property.\nvar Configuration = function Configuration(schema, plugins) {\n  var this$1 = this;\n\n  this.schema = schema;\n  this.fields = baseFields.concat();\n  this.plugins = [];\n  this.pluginsByKey = Object.create(null);\n  if (plugins) { plugins.forEach(function (plugin) {\n    if (this$1.pluginsByKey[plugin.key])\n      { throw new RangeError(\"Adding different instances of a keyed plugin (\" + plugin.key + \")\") }\n    this$1.plugins.push(plugin);\n    this$1.pluginsByKey[plugin.key] = plugin;\n    if (plugin.spec.state)\n      { this$1.fields.push(new FieldDesc(plugin.key, plugin.spec.state, plugin)); }\n  }); }\n};\n\n// ::- The state of a ProseMirror editor is represented by an object\n// of this type. A state is a persistent data structure—it isn't\n// updated, but rather a new state value is computed from an old one\n// using the [`apply`](#state.EditorState.apply) method.\n//\n// A state holds a number of built-in fields, and plugins can\n// [define](#state.PluginSpec.state) additional fields.\nvar EditorState = function EditorState(config) {\n  this.config = config;\n};\n\nvar prototypeAccessors$1 = { schema: { configurable: true },plugins: { configurable: true },tr: { configurable: true } };\n\n// doc:: Node\n// The current document.\n\n// selection:: Selection\n// The selection.\n\n// storedMarks:: ?[Mark]\n// A set of marks to apply to the next input. Will be null when\n// no explicit marks have been set.\n\n// :: Schema\n// The schema of the state's document.\nprototypeAccessors$1.schema.get = function () {\n  return this.config.schema\n};\n\n// :: [Plugin]\n// The plugins that are active in this state.\nprototypeAccessors$1.plugins.get = function () {\n  return this.config.plugins\n};\n\n// :: (Transaction) → EditorState\n// Apply the given transaction to produce a new state.\nEditorState.prototype.apply = function apply (tr) {\n  return this.applyTransaction(tr).state\n};\n\n// : (Transaction) → bool\nEditorState.prototype.filterTransaction = function filterTransaction (tr, ignore) {\n    if ( ignore === void 0 ) ignore = -1;\n\n  for (var i = 0; i < this.config.plugins.length; i++) { if (i != ignore) {\n    var plugin = this.config.plugins[i];\n    if (plugin.spec.filterTransaction && !plugin.spec.filterTransaction.call(plugin, tr, this))\n      { return false }\n  } }\n  return true\n};\n\n// :: (Transaction) → {state: EditorState, transactions: [Transaction]}\n// Verbose variant of [`apply`](#state.EditorState.apply) that\n// returns the precise transactions that were applied (which might\n// be influenced by the [transaction\n// hooks](#state.PluginSpec.filterTransaction) of\n// plugins) along with the new state.\nEditorState.prototype.applyTransaction = function applyTransaction (rootTr) {\n  if (!this.filterTransaction(rootTr)) { return {state: this, transactions: []} }\n\n  var trs = [rootTr], newState = this.applyInner(rootTr), seen = null;\n  // This loop repeatedly gives plugins a chance to respond to\n  // transactions as new transactions are added, making sure to only\n  // pass the transactions the plugin did not see before.\n   for (;;) {\n    var haveNew = false;\n    for (var i = 0; i < this.config.plugins.length; i++) {\n      var plugin = this.config.plugins[i];\n      if (plugin.spec.appendTransaction) {\n        var n = seen ? seen[i].n : 0, oldState = seen ? seen[i].state : this;\n        var tr = n < trs.length &&\n            plugin.spec.appendTransaction.call(plugin, n ? trs.slice(n) : trs, oldState, newState);\n        if (tr && newState.filterTransaction(tr, i)) {\n          tr.setMeta(\"appendedTransaction\", rootTr);\n          if (!seen) {\n            seen = [];\n            for (var j = 0; j < this.config.plugins.length; j++)\n              { seen.push(j < i ? {state: newState, n: trs.length} : {state: this, n: 0}); }\n          }\n          trs.push(tr);\n          newState = newState.applyInner(tr);\n          haveNew = true;\n        }\n        if (seen) { seen[i] = {state: newState, n: trs.length}; }\n      }\n    }\n    if (!haveNew) { return {state: newState, transactions: trs} }\n  }\n};\n\n// : (Transaction) → EditorState\nEditorState.prototype.applyInner = function applyInner (tr) {\n  if (!tr.before.eq(this.doc)) { throw new RangeError(\"Applying a mismatched transaction\") }\n  var newInstance = new EditorState(this.config), fields = this.config.fields;\n  for (var i = 0; i < fields.length; i++) {\n    var field = fields[i];\n    newInstance[field.name] = field.apply(tr, this[field.name], this, newInstance);\n  }\n  for (var i$1 = 0; i$1 < applyListeners.length; i$1++) { applyListeners[i$1](this, tr, newInstance); }\n  return newInstance\n};\n\n// :: Transaction\n// Start a [transaction](#state.Transaction) from this state.\nprototypeAccessors$1.tr.get = function () { return new Transaction(this) };\n\n// :: (Object) → EditorState\n// Create a new state.\n//\n// config::- Configuration options. Must contain `schema` or `doc` (or both).\n//\n//    schema:: ?Schema\n//    The schema to use (only relevant if no `doc` is specified).\n//\n//    doc:: ?Node\n//    The starting document.\n//\n//    selection:: ?Selection\n//    A valid selection in the document.\n//\n//    storedMarks:: ?[Mark]\n//    The initial set of [stored marks](#state.EditorState.storedMarks).\n//\n//    plugins:: ?[Plugin]\n//    The plugins that should be active in this state.\nEditorState.create = function create (config) {\n  var $config = new Configuration(config.doc ? config.doc.type.schema : config.schema, config.plugins);\n  var instance = new EditorState($config);\n  for (var i = 0; i < $config.fields.length; i++)\n    { instance[$config.fields[i].name] = $config.fields[i].init(config, instance); }\n  return instance\n};\n\n// :: (Object) → EditorState\n// Create a new state based on this one, but with an adjusted set of\n// active plugins. State fields that exist in both sets of plugins\n// are kept unchanged. Those that no longer exist are dropped, and\n// those that are new are initialized using their\n// [`init`](#state.StateField.init) method, passing in the new\n// configuration object..\n//\n// config::- configuration options\n//\n//   plugins:: [Plugin]\n//   New set of active plugins.\nEditorState.prototype.reconfigure = function reconfigure (config) {\n  var $config = new Configuration(this.schema, config.plugins);\n  var fields = $config.fields, instance = new EditorState($config);\n  for (var i = 0; i < fields.length; i++) {\n    var name = fields[i].name;\n    instance[name] = this.hasOwnProperty(name) ? this[name] : fields[i].init(config, instance);\n  }\n  return instance\n};\n\n// :: (?union<Object<Plugin>, string, number>) → Object\n// Serialize this state to JSON. If you want to serialize the state\n// of plugins, pass an object mapping property names to use in the\n// resulting JSON object to plugin objects. The argument may also be\n// a string or number, in which case it is ignored, to support the\n// way `JSON.stringify` calls `toString` methods.\nEditorState.prototype.toJSON = function toJSON (pluginFields) {\n  var result = {doc: this.doc.toJSON(), selection: this.selection.toJSON()};\n  if (this.storedMarks) { result.storedMarks = this.storedMarks.map(function (m) { return m.toJSON(); }); }\n  if (pluginFields && typeof pluginFields == 'object') { for (var prop in pluginFields) {\n    if (prop == \"doc\" || prop == \"selection\")\n      { throw new RangeError(\"The JSON fields `doc` and `selection` are reserved\") }\n    var plugin = pluginFields[prop], state = plugin.spec.state;\n    if (state && state.toJSON) { result[prop] = state.toJSON.call(plugin, this[plugin.key]); }\n  } }\n  return result\n};\n\n// :: (Object, Object, ?Object<Plugin>) → EditorState\n// Deserialize a JSON representation of a state. `config` should\n// have at least a `schema` field, and should contain array of\n// plugins to initialize the state with. `pluginFields` can be used\n// to deserialize the state of plugins, by associating plugin\n// instances with the property names they use in the JSON object.\n//\n// config::- configuration options\n//\n//   schema:: Schema\n//   The schema to use.\n//\n//   plugins:: ?[Plugin]\n//   The set of active plugins.\nEditorState.fromJSON = function fromJSON (config, json, pluginFields) {\n  if (!json) { throw new RangeError(\"Invalid input for EditorState.fromJSON\") }\n  if (!config.schema) { throw new RangeError(\"Required config field 'schema' missing\") }\n  var $config = new Configuration(config.schema, config.plugins);\n  var instance = new EditorState($config);\n  $config.fields.forEach(function (field) {\n    if (field.name == \"doc\") {\n      instance.doc = Node.fromJSON(config.schema, json.doc);\n    } else if (field.name == \"selection\") {\n      instance.selection = Selection.fromJSON(instance.doc, json.selection);\n    } else if (field.name == \"storedMarks\") {\n      if (json.storedMarks) { instance.storedMarks = json.storedMarks.map(config.schema.markFromJSON); }\n    } else {\n      if (pluginFields) { for (var prop in pluginFields) {\n        var plugin = pluginFields[prop], state = plugin.spec.state;\n        if (plugin.key == field.name && state && state.fromJSON &&\n            Object.prototype.hasOwnProperty.call(json, prop)) {\n          // This field belongs to a plugin mapped to a JSON field, read it from there.\n          instance[field.name] = state.fromJSON.call(plugin, config, json[prop], instance);\n          return\n        }\n      } }\n      instance[field.name] = field.init(config, instance);\n    }\n  });\n  return instance\n};\n\n// Kludge to allow the view to track mappings between different\n// instances of a state.\n//\n// FIXME this is no longer needed as of prosemirror-view 1.9.0,\n// though due to backwards-compat we should probably keep it around\n// for a while (if only as a no-op)\nEditorState.addApplyListener = function addApplyListener (f) {\n  applyListeners.push(f);\n};\nEditorState.removeApplyListener = function removeApplyListener (f) {\n  var found = applyListeners.indexOf(f);\n  if (found > -1) { applyListeners.splice(found, 1); }\n};\n\nObject.defineProperties( EditorState.prototype, prototypeAccessors$1 );\n\nvar applyListeners = [];\n\n// PluginSpec:: interface\n//\n// This is the type passed to the [`Plugin`](#state.Plugin)\n// constructor. It provides a definition for a plugin.\n//\n//   props:: ?EditorProps\n//   The [view props](#view.EditorProps) added by this plugin. Props\n//   that are functions will be bound to have the plugin instance as\n//   their `this` binding.\n//\n//   state:: ?StateField<any>\n//   Allows a plugin to define a [state field](#state.StateField), an\n//   extra slot in the state object in which it can keep its own data.\n//\n//   key:: ?PluginKey\n//   Can be used to make this a keyed plugin. You can have only one\n//   plugin with a given key in a given state, but it is possible to\n//   access the plugin's configuration and state through the key,\n//   without having access to the plugin instance object.\n//\n//   view:: ?(EditorView) → Object\n//   When the plugin needs to interact with the editor view, or\n//   set something up in the DOM, use this field. The function\n//   will be called when the plugin's state is associated with an\n//   editor view.\n//\n//     return::-\n//     Should return an object with the following optional\n//     properties:\n//\n//       update:: ?(view: EditorView, prevState: EditorState)\n//       Called whenever the view's state is updated.\n//\n//       destroy:: ?()\n//       Called when the view is destroyed or receives a state\n//       with different plugins.\n//\n//   filterTransaction:: ?(Transaction, EditorState) → bool\n//   When present, this will be called before a transaction is\n//   applied by the state, allowing the plugin to cancel it (by\n//   returning false).\n//\n//   appendTransaction:: ?(transactions: [Transaction], oldState: EditorState, newState: EditorState) → ?Transaction\n//   Allows the plugin to append another transaction to be applied\n//   after the given array of transactions. When another plugin\n//   appends a transaction after this was called, it is called again\n//   with the new state and new transactions—but only the new\n//   transactions, i.e. it won't be passed transactions that it\n//   already saw.\n\nfunction bindProps(obj, self, target) {\n  for (var prop in obj) {\n    var val = obj[prop];\n    if (val instanceof Function) { val = val.bind(self); }\n    else if (prop == \"handleDOMEvents\") { val = bindProps(val, self, {}); }\n    target[prop] = val;\n  }\n  return target\n}\n\n// ::- Plugins bundle functionality that can be added to an editor.\n// They are part of the [editor state](#state.EditorState) and\n// may influence that state and the view that contains it.\nvar Plugin = function Plugin(spec) {\n  // :: EditorProps\n  // The [props](#view.EditorProps) exported by this plugin.\n  this.props = {};\n  if (spec.props) { bindProps(spec.props, this, this.props); }\n  // :: Object\n  // The plugin's [spec object](#state.PluginSpec).\n  this.spec = spec;\n  this.key = spec.key ? spec.key.key : createKey(\"plugin\");\n};\n\n// :: (EditorState) → any\n// Extract the plugin's state field from an editor state.\nPlugin.prototype.getState = function getState (state) { return state[this.key] };\n\n// StateField:: interface<T>\n// A plugin spec may provide a state field (under its\n// [`state`](#state.PluginSpec.state) property) of this type, which\n// describes the state it wants to keep. Functions provided here are\n// always called with the plugin instance as their `this` binding.\n//\n//   init:: (config: Object, instance: EditorState) → T\n//   Initialize the value of the field. `config` will be the object\n//   passed to [`EditorState.create`](#state.EditorState^create). Note\n//   that `instance` is a half-initialized state instance, and will\n//   not have values for plugin fields initialized after this one.\n//\n//   apply:: (tr: Transaction, value: T, oldState: EditorState, newState: EditorState) → T\n//   Apply the given transaction to this state field, producing a new\n//   field value. Note that the `newState` argument is again a partially\n//   constructed state does not yet contain the state from plugins\n//   coming after this one.\n//\n//   toJSON:: ?(value: T) → *\n//   Convert this field to JSON. Optional, can be left off to disable\n//   JSON serialization for the field.\n//\n//   fromJSON:: ?(config: Object, value: *, state: EditorState) → T\n//   Deserialize the JSON representation of this field. Note that the\n//   `state` argument is again a half-initialized state.\n\nvar keys = Object.create(null);\n\nfunction createKey(name) {\n  if (name in keys) { return name + \"$\" + ++keys[name] }\n  keys[name] = 0;\n  return name + \"$\"\n}\n\n// ::- A key is used to [tag](#state.PluginSpec.key)\n// plugins in a way that makes it possible to find them, given an\n// editor state. Assigning a key does mean only one plugin of that\n// type can be active in a state.\nvar PluginKey = function PluginKey(name) {\nif ( name === void 0 ) name = \"key\";\n this.key = createKey(name); };\n\n// :: (EditorState) → ?Plugin\n// Get the active plugin with this key, if any, from an editor\n// state.\nPluginKey.prototype.get = function get (state) { return state.config.pluginsByKey[this.key] };\n\n// :: (EditorState) → ?any\n// Get the plugin's state from an editor state.\nPluginKey.prototype.getState = function getState (state) { return state[this.key] };\n\nexport { AllSelection, EditorState, NodeSelection, Plugin, PluginKey, Selection, SelectionRange, TextSelection, Transaction };\n//# sourceMappingURL=index.es.js.map\n","import { TextSelection, NodeSelection, Selection, AllSelection } from 'prosemirror-state';\nimport { DOMSerializer, Fragment, Mark, DOMParser, Slice } from 'prosemirror-model';\nimport { dropPoint } from 'prosemirror-transform';\n\nvar result = {};\n\nif (typeof navigator != \"undefined\" && typeof document != \"undefined\") {\n  var ie_edge = /Edge\\/(\\d+)/.exec(navigator.userAgent);\n  var ie_upto10 = /MSIE \\d/.test(navigator.userAgent);\n  var ie_11up = /Trident\\/(?:[7-9]|\\d{2,})\\..*rv:(\\d+)/.exec(navigator.userAgent);\n\n  var ie = result.ie = !!(ie_upto10 || ie_11up || ie_edge);\n  result.ie_version = ie_upto10 ? document.documentMode || 6 : ie_11up ? +ie_11up[1] : ie_edge ? +ie_edge[1] : null;\n  result.gecko = !ie && /gecko\\/(\\d+)/i.test(navigator.userAgent);\n  result.gecko_version = result.gecko && +(/Firefox\\/(\\d+)/.exec(navigator.userAgent) || [0, 0])[1];\n  var chrome = !ie && /Chrome\\/(\\d+)/.exec(navigator.userAgent);\n  result.chrome = !!chrome;\n  result.chrome_version = chrome && +chrome[1];\n  // Is true for both iOS and iPadOS for convenience\n  result.safari = !ie && /Apple Computer/.test(navigator.vendor);\n  result.ios = result.safari && (/Mobile\\/\\w+/.test(navigator.userAgent) || navigator.maxTouchPoints > 2);\n  result.mac = result.ios || /Mac/.test(navigator.platform);\n  result.android = /Android \\d/.test(navigator.userAgent);\n  result.webkit = \"webkitFontSmoothing\" in document.documentElement.style;\n  result.webkit_version = result.webkit && +(/\\bAppleWebKit\\/(\\d+)/.exec(navigator.userAgent) || [0, 0])[1];\n}\n\nvar domIndex = function(node) {\n  for (var index = 0;; index++) {\n    node = node.previousSibling;\n    if (!node) { return index }\n  }\n};\n\nvar parentNode = function(node) {\n  var parent = node.assignedSlot || node.parentNode;\n  return parent && parent.nodeType == 11 ? parent.host : parent\n};\n\nvar reusedRange = null;\n\n// Note that this will always return the same range, because DOM range\n// objects are every expensive, and keep slowing down subsequent DOM\n// updates, for some reason.\nvar textRange = function(node, from, to) {\n  var range = reusedRange || (reusedRange = document.createRange());\n  range.setEnd(node, to == null ? node.nodeValue.length : to);\n  range.setStart(node, from || 0);\n  return range\n};\n\n// Scans forward and backward through DOM positions equivalent to the\n// given one to see if the two are in the same place (i.e. after a\n// text node vs at the end of that text node)\nvar isEquivalentPosition = function(node, off, targetNode, targetOff) {\n  return targetNode && (scanFor(node, off, targetNode, targetOff, -1) ||\n                        scanFor(node, off, targetNode, targetOff, 1))\n};\n\nvar atomElements = /^(img|br|input|textarea|hr)$/i;\n\nfunction scanFor(node, off, targetNode, targetOff, dir) {\n  for (;;) {\n    if (node == targetNode && off == targetOff) { return true }\n    if (off == (dir < 0 ? 0 : nodeSize(node))) {\n      var parent = node.parentNode;\n      if (parent.nodeType != 1 || hasBlockDesc(node) || atomElements.test(node.nodeName) || node.contentEditable == \"false\")\n        { return false }\n      off = domIndex(node) + (dir < 0 ? 0 : 1);\n      node = parent;\n    } else if (node.nodeType == 1) {\n      node = node.childNodes[off + (dir < 0 ? -1 : 0)];\n      if (node.contentEditable == \"false\") { return false }\n      off = dir < 0 ? nodeSize(node) : 0;\n    } else {\n      return false\n    }\n  }\n}\n\nfunction nodeSize(node) {\n  return node.nodeType == 3 ? node.nodeValue.length : node.childNodes.length\n}\n\nfunction isOnEdge(node, offset, parent) {\n  for (var atStart = offset == 0, atEnd = offset == nodeSize(node); atStart || atEnd;) {\n    if (node == parent) { return true }\n    var index = domIndex(node);\n    node = node.parentNode;\n    if (!node) { return false }\n    atStart = atStart && index == 0;\n    atEnd = atEnd && index == nodeSize(node);\n  }\n}\n\nfunction hasBlockDesc(dom) {\n  var desc;\n  for (var cur = dom; cur; cur = cur.parentNode) { if (desc = cur.pmViewDesc) { break } }\n  return desc && desc.node && desc.node.isBlock && (desc.dom == dom || desc.contentDOM == dom)\n}\n\n// Work around Chrome issue https://bugs.chromium.org/p/chromium/issues/detail?id=447523\n// (isCollapsed inappropriately returns true in shadow dom)\nvar selectionCollapsed = function(domSel) {\n  var collapsed = domSel.isCollapsed;\n  if (collapsed && result.chrome && domSel.rangeCount && !domSel.getRangeAt(0).collapsed)\n    { collapsed = false; }\n  return collapsed\n};\n\nfunction keyEvent(keyCode, key) {\n  var event = document.createEvent(\"Event\");\n  event.initEvent(\"keydown\", true, true);\n  event.keyCode = keyCode;\n  event.key = event.code = key;\n  return event\n}\n\nfunction windowRect(doc) {\n  return {left: 0, right: doc.documentElement.clientWidth,\n          top: 0, bottom: doc.documentElement.clientHeight}\n}\n\nfunction getSide(value, side) {\n  return typeof value == \"number\" ? value : value[side]\n}\n\nfunction clientRect(node) {\n  var rect = node.getBoundingClientRect();\n  // Adjust for elements with style \"transform: scale()\"\n  var scaleX = (rect.width / node.offsetWidth) || 1;\n  var scaleY = (rect.height / node.offsetHeight) || 1;\n  // Make sure scrollbar width isn't included in the rectangle\n  return {left: rect.left, right: rect.left + node.clientWidth * scaleX,\n          top: rect.top, bottom: rect.top + node.clientHeight * scaleY}\n}\n\nfunction scrollRectIntoView(view, rect, startDOM) {\n  var scrollThreshold = view.someProp(\"scrollThreshold\") || 0, scrollMargin = view.someProp(\"scrollMargin\") || 5;\n  var doc = view.dom.ownerDocument;\n  for (var parent = startDOM || view.dom;; parent = parentNode(parent)) {\n    if (!parent) { break }\n    if (parent.nodeType != 1) { continue }\n    var atTop = parent == doc.body || parent.nodeType != 1;\n    var bounding = atTop ? windowRect(doc) : clientRect(parent);\n    var moveX = 0, moveY = 0;\n    if (rect.top < bounding.top + getSide(scrollThreshold, \"top\"))\n      { moveY = -(bounding.top - rect.top + getSide(scrollMargin, \"top\")); }\n    else if (rect.bottom > bounding.bottom - getSide(scrollThreshold, \"bottom\"))\n      { moveY = rect.bottom - bounding.bottom + getSide(scrollMargin, \"bottom\"); }\n    if (rect.left < bounding.left + getSide(scrollThreshold, \"left\"))\n      { moveX = -(bounding.left - rect.left + getSide(scrollMargin, \"left\")); }\n    else if (rect.right > bounding.right - getSide(scrollThreshold, \"right\"))\n      { moveX = rect.right - bounding.right + getSide(scrollMargin, \"right\"); }\n    if (moveX || moveY) {\n      if (atTop) {\n        doc.defaultView.scrollBy(moveX, moveY);\n      } else {\n        var startX = parent.scrollLeft, startY = parent.scrollTop;\n        if (moveY) { parent.scrollTop += moveY; }\n        if (moveX) { parent.scrollLeft += moveX; }\n        var dX = parent.scrollLeft - startX, dY = parent.scrollTop - startY;\n        rect = {left: rect.left - dX, top: rect.top - dY, right: rect.right - dX, bottom: rect.bottom - dY};\n      }\n    }\n    if (atTop) { break }\n  }\n}\n\n// Store the scroll position of the editor's parent nodes, along with\n// the top position of an element near the top of the editor, which\n// will be used to make sure the visible viewport remains stable even\n// when the size of the content above changes.\nfunction storeScrollPos(view) {\n  var rect = view.dom.getBoundingClientRect(), startY = Math.max(0, rect.top);\n  var refDOM, refTop;\n  for (var x = (rect.left + rect.right) / 2, y = startY + 1;\n       y < Math.min(innerHeight, rect.bottom); y += 5) {\n    var dom = view.root.elementFromPoint(x, y);\n    if (dom == view.dom || !view.dom.contains(dom)) { continue }\n    var localRect = dom.getBoundingClientRect();\n    if (localRect.top >= startY - 20) {\n      refDOM = dom;\n      refTop = localRect.top;\n      break\n    }\n  }\n  return {refDOM: refDOM, refTop: refTop, stack: scrollStack(view.dom)}\n}\n\nfunction scrollStack(dom) {\n  var stack = [], doc = dom.ownerDocument;\n  for (; dom; dom = parentNode(dom)) {\n    stack.push({dom: dom, top: dom.scrollTop, left: dom.scrollLeft});\n    if (dom == doc) { break }\n  }\n  return stack\n}\n\n// Reset the scroll position of the editor's parent nodes to that what\n// it was before, when storeScrollPos was called.\nfunction resetScrollPos(ref) {\n  var refDOM = ref.refDOM;\n  var refTop = ref.refTop;\n  var stack = ref.stack;\n\n  var newRefTop = refDOM ? refDOM.getBoundingClientRect().top : 0;\n  restoreScrollStack(stack, newRefTop == 0 ? 0 : newRefTop - refTop);\n}\n\nfunction restoreScrollStack(stack, dTop) {\n  for (var i = 0; i < stack.length; i++) {\n    var ref = stack[i];\n    var dom = ref.dom;\n    var top = ref.top;\n    var left = ref.left;\n    if (dom.scrollTop != top + dTop) { dom.scrollTop = top + dTop; }\n    if (dom.scrollLeft != left) { dom.scrollLeft = left; }\n  }\n}\n\nvar preventScrollSupported = null;\n// Feature-detects support for .focus({preventScroll: true}), and uses\n// a fallback kludge when not supported.\nfunction focusPreventScroll(dom) {\n  if (dom.setActive) { return dom.setActive() } // in IE\n  if (preventScrollSupported) { return dom.focus(preventScrollSupported) }\n\n  var stored = scrollStack(dom);\n  dom.focus(preventScrollSupported == null ? {\n    get preventScroll() {\n      preventScrollSupported = {preventScroll: true};\n      return true\n    }\n  } : undefined);\n  if (!preventScrollSupported) {\n    preventScrollSupported = false;\n    restoreScrollStack(stored, 0);\n  }\n}\n\nfunction findOffsetInNode(node, coords) {\n  var closest, dxClosest = 2e8, coordsClosest, offset = 0;\n  var rowBot = coords.top, rowTop = coords.top;\n  for (var child = node.firstChild, childIndex = 0; child; child = child.nextSibling, childIndex++) {\n    var rects = (void 0);\n    if (child.nodeType == 1) { rects = child.getClientRects(); }\n    else if (child.nodeType == 3) { rects = textRange(child).getClientRects(); }\n    else { continue }\n\n    for (var i = 0; i < rects.length; i++) {\n      var rect = rects[i];\n      if (rect.top <= rowBot && rect.bottom >= rowTop) {\n        rowBot = Math.max(rect.bottom, rowBot);\n        rowTop = Math.min(rect.top, rowTop);\n        var dx = rect.left > coords.left ? rect.left - coords.left\n            : rect.right < coords.left ? coords.left - rect.right : 0;\n        if (dx < dxClosest) {\n          closest = child;\n          dxClosest = dx;\n          coordsClosest = dx && closest.nodeType == 3 ? {left: rect.right < coords.left ? rect.right : rect.left, top: coords.top} : coords;\n          if (child.nodeType == 1 && dx)\n            { offset = childIndex + (coords.left >= (rect.left + rect.right) / 2 ? 1 : 0); }\n          continue\n        }\n      }\n      if (!closest && (coords.left >= rect.right && coords.top >= rect.top ||\n                       coords.left >= rect.left && coords.top >= rect.bottom))\n        { offset = childIndex + 1; }\n    }\n  }\n  if (closest && closest.nodeType == 3) { return findOffsetInText(closest, coordsClosest) }\n  if (!closest || (dxClosest && closest.nodeType == 1)) { return {node: node, offset: offset} }\n  return findOffsetInNode(closest, coordsClosest)\n}\n\nfunction findOffsetInText(node, coords) {\n  var len = node.nodeValue.length;\n  var range = document.createRange();\n  for (var i = 0; i < len; i++) {\n    range.setEnd(node, i + 1);\n    range.setStart(node, i);\n    var rect = singleRect(range, 1);\n    if (rect.top == rect.bottom) { continue }\n    if (inRect(coords, rect))\n      { return {node: node, offset: i + (coords.left >= (rect.left + rect.right) / 2 ? 1 : 0)} }\n  }\n  return {node: node, offset: 0}\n}\n\nfunction inRect(coords, rect) {\n  return coords.left >= rect.left - 1 && coords.left <= rect.right + 1&&\n    coords.top >= rect.top - 1 && coords.top <= rect.bottom + 1\n}\n\nfunction targetKludge(dom, coords) {\n  var parent = dom.parentNode;\n  if (parent && /^li$/i.test(parent.nodeName) && coords.left < dom.getBoundingClientRect().left)\n    { return parent }\n  return dom\n}\n\nfunction posFromElement(view, elt, coords) {\n  var ref = findOffsetInNode(elt, coords);\n  var node = ref.node;\n  var offset = ref.offset;\n  var bias = -1;\n  if (node.nodeType == 1 && !node.firstChild) {\n    var rect = node.getBoundingClientRect();\n    bias = rect.left != rect.right && coords.left > (rect.left + rect.right) / 2 ? 1 : -1;\n  }\n  return view.docView.posFromDOM(node, offset, bias)\n}\n\nfunction posFromCaret(view, node, offset, coords) {\n  // Browser (in caretPosition/RangeFromPoint) will agressively\n  // normalize towards nearby inline nodes. Since we are interested in\n  // positions between block nodes too, we first walk up the hierarchy\n  // of nodes to see if there are block nodes that the coordinates\n  // fall outside of. If so, we take the position before/after that\n  // block. If not, we call `posFromDOM` on the raw node/offset.\n  var outside = -1;\n  for (var cur = node;;) {\n    if (cur == view.dom) { break }\n    var desc = view.docView.nearestDesc(cur, true);\n    if (!desc) { return null }\n    if (desc.node.isBlock && desc.parent) {\n      var rect = desc.dom.getBoundingClientRect();\n      if (rect.left > coords.left || rect.top > coords.top) { outside = desc.posBefore; }\n      else if (rect.right < coords.left || rect.bottom < coords.top) { outside = desc.posAfter; }\n      else { break }\n    }\n    cur = desc.dom.parentNode;\n  }\n  return outside > -1 ? outside : view.docView.posFromDOM(node, offset)\n}\n\nfunction elementFromPoint(element, coords, box) {\n  var len = element.childNodes.length;\n  if (len && box.top < box.bottom) {\n    for (var startI = Math.max(0, Math.min(len - 1, Math.floor(len * (coords.top - box.top) / (box.bottom - box.top)) - 2)), i = startI;;) {\n      var child = element.childNodes[i];\n      if (child.nodeType == 1) {\n        var rects = child.getClientRects();\n        for (var j = 0; j < rects.length; j++) {\n          var rect = rects[j];\n          if (inRect(coords, rect)) { return elementFromPoint(child, coords, rect) }\n        }\n      }\n      if ((i = (i + 1) % len) == startI) { break }\n    }\n  }\n  return element\n}\n\n// Given an x,y position on the editor, get the position in the document.\nfunction posAtCoords(view, coords) {\n  var assign, assign$1;\n\n  var doc = view.dom.ownerDocument, node, offset;\n  if (doc.caretPositionFromPoint) {\n    try { // Firefox throws for this call in hard-to-predict circumstances (#994)\n      var pos$1 = doc.caretPositionFromPoint(coords.left, coords.top);\n      if (pos$1) { ((assign = pos$1, node = assign.offsetNode, offset = assign.offset)); }\n    } catch (_) {}\n  }\n  if (!node && doc.caretRangeFromPoint) {\n    var range = doc.caretRangeFromPoint(coords.left, coords.top);\n    if (range) { ((assign$1 = range, node = assign$1.startContainer, offset = assign$1.startOffset)); }\n  }\n\n  var elt = (view.root.elementFromPoint ? view.root : doc).elementFromPoint(coords.left, coords.top + 1), pos;\n  if (!elt || !view.dom.contains(elt.nodeType != 1 ? elt.parentNode : elt)) {\n    var box = view.dom.getBoundingClientRect();\n    if (!inRect(coords, box)) { return null }\n    elt = elementFromPoint(view.dom, coords, box);\n    if (!elt) { return null }\n  }\n  // Safari's caretRangeFromPoint returns nonsense when on a draggable element\n  if (result.safari) {\n    for (var p = elt; node && p; p = parentNode(p))\n      { if (p.draggable) { node = offset = null; } }\n  }\n  elt = targetKludge(elt, coords);\n  if (node) {\n    if (result.gecko && node.nodeType == 1) {\n      // Firefox will sometimes return offsets into <input> nodes, which\n      // have no actual children, from caretPositionFromPoint (#953)\n      offset = Math.min(offset, node.childNodes.length);\n      // It'll also move the returned position before image nodes,\n      // even if those are behind it.\n      if (offset < node.childNodes.length) {\n        var next = node.childNodes[offset], box$1;\n        if (next.nodeName == \"IMG\" && (box$1 = next.getBoundingClientRect()).right <= coords.left &&\n            box$1.bottom > coords.top)\n          { offset++; }\n      }\n    }\n    // Suspiciously specific kludge to work around caret*FromPoint\n    // never returning a position at the end of the document\n    if (node == view.dom && offset == node.childNodes.length - 1 && node.lastChild.nodeType == 1 &&\n        coords.top > node.lastChild.getBoundingClientRect().bottom)\n      { pos = view.state.doc.content.size; }\n    // Ignore positions directly after a BR, since caret*FromPoint\n    // 'round up' positions that would be more accurately placed\n    // before the BR node.\n    else if (offset == 0 || node.nodeType != 1 || node.childNodes[offset - 1].nodeName != \"BR\")\n      { pos = posFromCaret(view, node, offset, coords); }\n  }\n  if (pos == null) { pos = posFromElement(view, elt, coords); }\n\n  var desc = view.docView.nearestDesc(elt, true);\n  return {pos: pos, inside: desc ? desc.posAtStart - desc.border : -1}\n}\n\nfunction singleRect(object, bias) {\n  var rects = object.getClientRects();\n  return !rects.length ? object.getBoundingClientRect() : rects[bias < 0 ? 0 : rects.length - 1]\n}\n\nvar BIDI = /[\\u0590-\\u05f4\\u0600-\\u06ff\\u0700-\\u08ac]/;\n\n// : (EditorView, number, number) → {left: number, top: number, right: number, bottom: number}\n// Given a position in the document model, get a bounding box of the\n// character at that position, relative to the window.\nfunction coordsAtPos(view, pos, side) {\n  var ref = view.docView.domFromPos(pos, side < 0 ? -1 : 1);\n  var node = ref.node;\n  var offset = ref.offset;\n\n  var supportEmptyRange = result.webkit || result.gecko;\n  if (node.nodeType == 3) {\n    // These browsers support querying empty text ranges. Prefer that in\n    // bidi context or when at the end of a node.\n    if (supportEmptyRange && (BIDI.test(node.nodeValue) || (side < 0 ? !offset : offset == node.nodeValue.length))) {\n      var rect = singleRect(textRange(node, offset, offset), side);\n      // Firefox returns bad results (the position before the space)\n      // when querying a position directly after line-broken\n      // whitespace. Detect this situation and and kludge around it\n      if (result.gecko && offset && /\\s/.test(node.nodeValue[offset - 1]) && offset < node.nodeValue.length) {\n        var rectBefore = singleRect(textRange(node, offset - 1, offset - 1), -1);\n        if (rectBefore.top == rect.top) {\n          var rectAfter = singleRect(textRange(node, offset, offset + 1), -1);\n          if (rectAfter.top != rect.top)\n            { return flattenV(rectAfter, rectAfter.left < rectBefore.left) }\n        }\n      }\n      return rect\n    } else {\n      var from = offset, to = offset, takeSide = side < 0 ? 1 : -1;\n      if (side < 0 && !offset) { to++; takeSide = -1; }\n      else if (side >= 0 && offset == node.nodeValue.length) { from--; takeSide = 1; }\n      else if (side < 0) { from--; }\n      else { to ++; }\n      return flattenV(singleRect(textRange(node, from, to), takeSide), takeSide < 0)\n    }\n  }\n\n  // Return a horizontal line in block context\n  if (!view.state.doc.resolve(pos).parent.inlineContent) {\n    if (offset && (side < 0 || offset == nodeSize(node))) {\n      var before = node.childNodes[offset - 1];\n      if (before.nodeType == 1) { return flattenH(before.getBoundingClientRect(), false) }\n    }\n    if (offset < nodeSize(node)) {\n      var after = node.childNodes[offset];\n      if (after.nodeType == 1) { return flattenH(after.getBoundingClientRect(), true) }\n    }\n    return flattenH(node.getBoundingClientRect(), side >= 0)\n  }\n\n  // Inline, not in text node (this is not Bidi-safe)\n  if (offset && (side < 0 || offset == nodeSize(node))) {\n    var before$1 = node.childNodes[offset - 1];\n    var target = before$1.nodeType == 3 ? textRange(before$1, nodeSize(before$1) - (supportEmptyRange ? 0 : 1))\n        // BR nodes tend to only return the rectangle before them.\n        // Only use them if they are the last element in their parent\n        : before$1.nodeType == 1 && (before$1.nodeName != \"BR\" || !before$1.nextSibling) ? before$1 : null;\n    if (target) { return flattenV(singleRect(target, 1), false) }\n  }\n  if (offset < nodeSize(node)) {\n    var after$1 = node.childNodes[offset];\n    while (after$1.pmViewDesc && after$1.pmViewDesc.ignoreForCoords) { after$1 = after$1.nextSibling; }\n    var target$1 = !after$1 ? null : after$1.nodeType == 3 ? textRange(after$1, 0, (supportEmptyRange ? 0 : 1))\n        : after$1.nodeType == 1 ? after$1 : null;\n    if (target$1) { return flattenV(singleRect(target$1, -1), true) }\n  }\n  // All else failed, just try to get a rectangle for the target node\n  return flattenV(singleRect(node.nodeType == 3 ? textRange(node) : node, -side), side >= 0)\n}\n\nfunction flattenV(rect, left) {\n  if (rect.width == 0) { return rect }\n  var x = left ? rect.left : rect.right;\n  return {top: rect.top, bottom: rect.bottom, left: x, right: x}\n}\n\nfunction flattenH(rect, top) {\n  if (rect.height == 0) { return rect }\n  var y = top ? rect.top : rect.bottom;\n  return {top: y, bottom: y, left: rect.left, right: rect.right}\n}\n\nfunction withFlushedState(view, state, f) {\n  var viewState = view.state, active = view.root.activeElement;\n  if (viewState != state) { view.updateState(state); }\n  if (active != view.dom) { view.focus(); }\n  try {\n    return f()\n  } finally {\n    if (viewState != state) { view.updateState(viewState); }\n    if (active != view.dom && active) { active.focus(); }\n  }\n}\n\n// : (EditorView, number, number)\n// Whether vertical position motion in a given direction\n// from a position would leave a text block.\nfunction endOfTextblockVertical(view, state, dir) {\n  var sel = state.selection;\n  var $pos = dir == \"up\" ? sel.$from : sel.$to;\n  return withFlushedState(view, state, function () {\n    var ref = view.docView.domFromPos($pos.pos, dir == \"up\" ? -1 : 1);\n    var dom = ref.node;\n    for (;;) {\n      var nearest = view.docView.nearestDesc(dom, true);\n      if (!nearest) { break }\n      if (nearest.node.isBlock) { dom = nearest.dom; break }\n      dom = nearest.dom.parentNode;\n    }\n    var coords = coordsAtPos(view, $pos.pos, 1);\n    for (var child = dom.firstChild; child; child = child.nextSibling) {\n      var boxes = (void 0);\n      if (child.nodeType == 1) { boxes = child.getClientRects(); }\n      else if (child.nodeType == 3) { boxes = textRange(child, 0, child.nodeValue.length).getClientRects(); }\n      else { continue }\n      for (var i = 0; i < boxes.length; i++) {\n        var box = boxes[i];\n        if (box.bottom > box.top + 1 &&\n            (dir == \"up\" ? coords.top - box.top > (box.bottom - coords.top) * 2\n             : box.bottom - coords.bottom > (coords.bottom - box.top) * 2))\n          { return false }\n      }\n    }\n    return true\n  })\n}\n\nvar maybeRTL = /[\\u0590-\\u08ac]/;\n\nfunction endOfTextblockHorizontal(view, state, dir) {\n  var ref = state.selection;\n  var $head = ref.$head;\n  if (!$head.parent.isTextblock) { return false }\n  var offset = $head.parentOffset, atStart = !offset, atEnd = offset == $head.parent.content.size;\n  var sel = view.root.getSelection();\n  // If the textblock is all LTR, or the browser doesn't support\n  // Selection.modify (Edge), fall back to a primitive approach\n  if (!maybeRTL.test($head.parent.textContent) || !sel.modify)\n    { return dir == \"left\" || dir == \"backward\" ? atStart : atEnd }\n\n  return withFlushedState(view, state, function () {\n    // This is a huge hack, but appears to be the best we can\n    // currently do: use `Selection.modify` to move the selection by\n    // one character, and see if that moves the cursor out of the\n    // textblock (or doesn't move it at all, when at the start/end of\n    // the document).\n    var oldRange = sel.getRangeAt(0), oldNode = sel.focusNode, oldOff = sel.focusOffset;\n    var oldBidiLevel = sel.caretBidiLevel; // Only for Firefox\n    sel.modify(\"move\", dir, \"character\");\n    var parentDOM = $head.depth ? view.docView.domAfterPos($head.before()) : view.dom;\n    var result = !parentDOM.contains(sel.focusNode.nodeType == 1 ? sel.focusNode : sel.focusNode.parentNode) ||\n        (oldNode == sel.focusNode && oldOff == sel.focusOffset);\n    // Restore the previous selection\n    sel.removeAllRanges();\n    sel.addRange(oldRange);\n    if (oldBidiLevel != null) { sel.caretBidiLevel = oldBidiLevel; }\n    return result\n  })\n}\n\nvar cachedState = null, cachedDir = null, cachedResult = false;\nfunction endOfTextblock(view, state, dir) {\n  if (cachedState == state && cachedDir == dir) { return cachedResult }\n  cachedState = state; cachedDir = dir;\n  return cachedResult = dir == \"up\" || dir == \"down\"\n    ? endOfTextblockVertical(view, state, dir)\n    : endOfTextblockHorizontal(view, state, dir)\n}\n\n// NodeView:: interface\n//\n// By default, document nodes are rendered using the result of the\n// [`toDOM`](#model.NodeSpec.toDOM) method of their spec, and managed\n// entirely by the editor. For some use cases, such as embedded\n// node-specific editing interfaces, you want more control over\n// the behavior of a node's in-editor representation, and need to\n// [define](#view.EditorProps.nodeViews) a custom node view.\n//\n// Mark views only support `dom` and `contentDOM`, and don't support\n// any of the node view methods.\n//\n// Objects returned as node views must conform to this interface.\n//\n//   dom:: ?dom.Node\n//   The outer DOM node that represents the document node. When not\n//   given, the default strategy is used to create a DOM node.\n//\n//   contentDOM:: ?dom.Node\n//   The DOM node that should hold the node's content. Only meaningful\n//   if the node view also defines a `dom` property and if its node\n//   type is not a leaf node type. When this is present, ProseMirror\n//   will take care of rendering the node's children into it. When it\n//   is not present, the node view itself is responsible for rendering\n//   (or deciding not to render) its child nodes.\n//\n//   update:: ?(node: Node, decorations: [Decoration], innerDecorations: DecorationSource) → bool\n//   When given, this will be called when the view is updating itself.\n//   It will be given a node (possibly of a different type), an array\n//   of active decorations around the node (which are automatically\n//   drawn, and the node view may ignore if it isn't interested in\n//   them), and a [decoration source](#view.DecorationSource) that\n//   represents any decorations that apply to the content of the node\n//   (which again may be ignored). It should return true if it was\n//   able to update to that node, and false otherwise. If the node\n//   view has a `contentDOM` property (or no `dom` property), updating\n//   its child nodes will be handled by ProseMirror.\n//\n//   selectNode:: ?()\n//   Can be used to override the way the node's selected status (as a\n//   node selection) is displayed.\n//\n//   deselectNode:: ?()\n//   When defining a `selectNode` method, you should also provide a\n//   `deselectNode` method to remove the effect again.\n//\n//   setSelection:: ?(anchor: number, head: number, root: dom.Document)\n//   This will be called to handle setting the selection inside the\n//   node. The `anchor` and `head` positions are relative to the start\n//   of the node. By default, a DOM selection will be created between\n//   the DOM positions corresponding to those positions, but if you\n//   override it you can do something else.\n//\n//   stopEvent:: ?(event: dom.Event) → bool\n//   Can be used to prevent the editor view from trying to handle some\n//   or all DOM events that bubble up from the node view. Events for\n//   which this returns true are not handled by the editor.\n//\n//   ignoreMutation:: ?(dom.MutationRecord) → bool\n//   Called when a DOM\n//   [mutation](https://developer.mozilla.org/en-US/docs/Web/API/MutationObserver)\n//   or a selection change happens within the view. When the change is\n//   a selection change, the record will have a `type` property of\n//   `\"selection\"` (which doesn't occur for native mutation records).\n//   Return false if the editor should re-read the selection or\n//   re-parse the range around the mutation, true if it can safely be\n//   ignored.\n//\n//   destroy:: ?()\n//   Called when the node view is removed from the editor or the whole\n//   editor is destroyed. (Not available for marks.)\n\n// View descriptions are data structures that describe the DOM that is\n// used to represent the editor's content. They are used for:\n//\n// - Incremental redrawing when the document changes\n//\n// - Figuring out what part of the document a given DOM position\n//   corresponds to\n//\n// - Wiring in custom implementations of the editing interface for a\n//   given node\n//\n// They form a doubly-linked mutable tree, starting at `view.docView`.\n\nvar NOT_DIRTY = 0, CHILD_DIRTY = 1, CONTENT_DIRTY = 2, NODE_DIRTY = 3;\n\n// Superclass for the various kinds of descriptions. Defines their\n// basic structure and shared methods.\nvar ViewDesc = function ViewDesc(parent, children, dom, contentDOM) {\n  this.parent = parent;\n  this.children = children;\n  this.dom = dom;\n  // An expando property on the DOM node provides a link back to its\n  // description.\n  dom.pmViewDesc = this;\n  // This is the node that holds the child views. It may be null for\n  // descs that don't have children.\n  this.contentDOM = contentDOM;\n  this.dirty = NOT_DIRTY;\n};\n\nvar prototypeAccessors = { size: { configurable: true },border: { configurable: true },posBefore: { configurable: true },posAtStart: { configurable: true },posAfter: { configurable: true },posAtEnd: { configurable: true },contentLost: { configurable: true },domAtom: { configurable: true },ignoreForCoords: { configurable: true } };\n\n// Used to check whether a given description corresponds to a\n// widget/mark/node.\nViewDesc.prototype.matchesWidget = function matchesWidget () { return false };\nViewDesc.prototype.matchesMark = function matchesMark () { return false };\nViewDesc.prototype.matchesNode = function matchesNode () { return false };\nViewDesc.prototype.matchesHack = function matchesHack (_nodeName) { return false };\n\n// : () → ?ParseRule\n// When parsing in-editor content (in domchange.js), we allow\n// descriptions to determine the parse rules that should be used to\n// parse them.\nViewDesc.prototype.parseRule = function parseRule () { return null };\n\n// : (dom.Event) → bool\n// Used by the editor's event handler to ignore events that come\n// from certain descs.\nViewDesc.prototype.stopEvent = function stopEvent () { return false };\n\n// The size of the content represented by this desc.\nprototypeAccessors.size.get = function () {\n  var size = 0;\n  for (var i = 0; i < this.children.length; i++) { size += this.children[i].size; }\n  return size\n};\n\n// For block nodes, this represents the space taken up by their\n// start/end tokens.\nprototypeAccessors.border.get = function () { return 0 };\n\nViewDesc.prototype.destroy = function destroy () {\n  this.parent = null;\n  if (this.dom.pmViewDesc == this) { this.dom.pmViewDesc = null; }\n  for (var i = 0; i < this.children.length; i++)\n    { this.children[i].destroy(); }\n};\n\nViewDesc.prototype.posBeforeChild = function posBeforeChild (child) {\n  for (var i = 0, pos = this.posAtStart; i < this.children.length; i++) {\n    var cur = this.children[i];\n    if (cur == child) { return pos }\n    pos += cur.size;\n  }\n};\n\nprototypeAccessors.posBefore.get = function () {\n  return this.parent.posBeforeChild(this)\n};\n\nprototypeAccessors.posAtStart.get = function () {\n  return this.parent ? this.parent.posBeforeChild(this) + this.border : 0\n};\n\nprototypeAccessors.posAfter.get = function () {\n  return this.posBefore + this.size\n};\n\nprototypeAccessors.posAtEnd.get = function () {\n  return this.posAtStart + this.size - 2 * this.border\n};\n\n// : (dom.Node, number, ?number) → number\nViewDesc.prototype.localPosFromDOM = function localPosFromDOM (dom, offset, bias) {\n  // If the DOM position is in the content, use the child desc after\n  // it to figure out a position.\n  if (this.contentDOM && this.contentDOM.contains(dom.nodeType == 1 ? dom : dom.parentNode)) {\n    if (bias < 0) {\n      var domBefore, desc;\n      if (dom == this.contentDOM) {\n        domBefore = dom.childNodes[offset - 1];\n      } else {\n        while (dom.parentNode != this.contentDOM) { dom = dom.parentNode; }\n        domBefore = dom.previousSibling;\n      }\n      while (domBefore && !((desc = domBefore.pmViewDesc) && desc.parent == this)) { domBefore = domBefore.previousSibling; }\n      return domBefore ? this.posBeforeChild(desc) + desc.size : this.posAtStart\n    } else {\n      var domAfter, desc$1;\n      if (dom == this.contentDOM) {\n        domAfter = dom.childNodes[offset];\n      } else {\n        while (dom.parentNode != this.contentDOM) { dom = dom.parentNode; }\n        domAfter = dom.nextSibling;\n      }\n      while (domAfter && !((desc$1 = domAfter.pmViewDesc) && desc$1.parent == this)) { domAfter = domAfter.nextSibling; }\n      return domAfter ? this.posBeforeChild(desc$1) : this.posAtEnd\n    }\n  }\n  // Otherwise, use various heuristics, falling back on the bias\n  // parameter, to determine whether to return the position at the\n  // start or at the end of this view desc.\n  var atEnd;\n  if (dom == this.dom && this.contentDOM) {\n    atEnd = offset > domIndex(this.contentDOM);\n  } else if (this.contentDOM && this.contentDOM != this.dom && this.dom.contains(this.contentDOM)) {\n    atEnd = dom.compareDocumentPosition(this.contentDOM) & 2;\n  } else if (this.dom.firstChild) {\n    if (offset == 0) { for (var search = dom;; search = search.parentNode) {\n      if (search == this.dom) { atEnd = false; break }\n      if (search.parentNode.firstChild != search) { break }\n    } }\n    if (atEnd == null && offset == dom.childNodes.length) { for (var search$1 = dom;; search$1 = search$1.parentNode) {\n      if (search$1 == this.dom) { atEnd = true; break }\n      if (search$1.parentNode.lastChild != search$1) { break }\n    } }\n  }\n  return (atEnd == null ? bias > 0 : atEnd) ? this.posAtEnd : this.posAtStart\n};\n\n// Scan up the dom finding the first desc that is a descendant of\n// this one.\nViewDesc.prototype.nearestDesc = function nearestDesc (dom, onlyNodes) {\n  for (var first = true, cur = dom; cur; cur = cur.parentNode) {\n    var desc = this.getDesc(cur);\n    if (desc && (!onlyNodes || desc.node)) {\n      // If dom is outside of this desc's nodeDOM, don't count it.\n      if (first && desc.nodeDOM &&\n          !(desc.nodeDOM.nodeType == 1 ? desc.nodeDOM.contains(dom.nodeType == 1 ? dom : dom.parentNode) : desc.nodeDOM == dom))\n        { first = false; }\n      else\n        { return desc }\n    }\n  }\n};\n\nViewDesc.prototype.getDesc = function getDesc (dom) {\n  var desc = dom.pmViewDesc;\n  for (var cur = desc; cur; cur = cur.parent) { if (cur == this) { return desc } }\n};\n\nViewDesc.prototype.posFromDOM = function posFromDOM (dom, offset, bias) {\n  for (var scan = dom; scan; scan = scan.parentNode) {\n    var desc = this.getDesc(scan);\n    if (desc) { return desc.localPosFromDOM(dom, offset, bias) }\n  }\n  return -1\n};\n\n// : (number) → ?NodeViewDesc\n// Find the desc for the node after the given pos, if any. (When a\n// parent node overrode rendering, there might not be one.)\nViewDesc.prototype.descAt = function descAt (pos) {\n  for (var i = 0, offset = 0; i < this.children.length; i++) {\n    var child = this.children[i], end = offset + child.size;\n    if (offset == pos && end != offset) {\n      while (!child.border && child.children.length) { child = child.children[0]; }\n      return child\n    }\n    if (pos < end) { return child.descAt(pos - offset - child.border) }\n    offset = end;\n  }\n};\n\n// : (number, number) → {node: dom.Node, offset: number}\nViewDesc.prototype.domFromPos = function domFromPos (pos, side) {\n  if (!this.contentDOM) { return {node: this.dom, offset: 0} }\n  // First find the position in the child array\n  var i = 0, offset = 0;\n  for (var curPos = 0; i < this.children.length; i++) {\n    var child = this.children[i], end = curPos + child.size;\n    if (end > pos || child instanceof TrailingHackViewDesc) { offset = pos - curPos; break }\n    curPos = end;\n  }\n  // If this points into the middle of a child, call through\n  if (offset) { return this.children[i].domFromPos(offset - this.children[i].border, side) }\n  // Go back if there were any zero-length widgets with side >= 0 before this point\n  for (var prev = (void 0); i && !(prev = this.children[i - 1]).size && prev instanceof WidgetViewDesc && prev.widget.type.side >= 0; i--) {}\n  // Scan towards the first useable node\n  if (side <= 0) {\n    var prev$1, enter = true;\n    for (;; i--, enter = false) {\n      prev$1 = i ? this.children[i - 1] : null;\n      if (!prev$1 || prev$1.dom.parentNode == this.contentDOM) { break }\n    }\n    if (prev$1 && side && enter && !prev$1.border && !prev$1.domAtom) { return prev$1.domFromPos(prev$1.size, side) }\n    return {node: this.contentDOM, offset: prev$1 ? domIndex(prev$1.dom) + 1 : 0}\n  } else {\n    var next, enter$1 = true;\n    for (;; i++, enter$1 = false) {\n      next = i < this.children.length ? this.children[i] : null;\n      if (!next || next.dom.parentNode == this.contentDOM) { break }\n    }\n    if (next && enter$1 && !next.border && !next.domAtom) { return next.domFromPos(0, side) }\n    return {node: this.contentDOM, offset: next ? domIndex(next.dom) : this.contentDOM.childNodes.length}\n  }\n};\n\n// Used to find a DOM range in a single parent for a given changed\n// range.\nViewDesc.prototype.parseRange = function parseRange (from, to, base) {\n    if ( base === void 0 ) base = 0;\n\n  if (this.children.length == 0)\n    { return {node: this.contentDOM, from: from, to: to, fromOffset: 0, toOffset: this.contentDOM.childNodes.length} }\n\n  var fromOffset = -1, toOffset = -1;\n  for (var offset = base, i = 0;; i++) {\n    var child = this.children[i], end = offset + child.size;\n    if (fromOffset == -1 && from <= end) {\n      var childBase = offset + child.border;\n      // FIXME maybe descend mark views to parse a narrower range?\n      if (from >= childBase && to <= end - child.border && child.node &&\n          child.contentDOM && this.contentDOM.contains(child.contentDOM))\n        { return child.parseRange(from, to, childBase) }\n\n      from = offset;\n      for (var j = i; j > 0; j--) {\n        var prev = this.children[j - 1];\n        if (prev.size && prev.dom.parentNode == this.contentDOM && !prev.emptyChildAt(1)) {\n          fromOffset = domIndex(prev.dom) + 1;\n          break\n        }\n        from -= prev.size;\n      }\n      if (fromOffset == -1) { fromOffset = 0; }\n    }\n    if (fromOffset > -1 && (end > to || i == this.children.length - 1)) {\n      to = end;\n      for (var j$1 = i + 1; j$1 < this.children.length; j$1++) {\n        var next = this.children[j$1];\n        if (next.size && next.dom.parentNode == this.contentDOM && !next.emptyChildAt(-1)) {\n          toOffset = domIndex(next.dom);\n          break\n        }\n        to += next.size;\n      }\n      if (toOffset == -1) { toOffset = this.contentDOM.childNodes.length; }\n      break\n    }\n    offset = end;\n  }\n  return {node: this.contentDOM, from: from, to: to, fromOffset: fromOffset, toOffset: toOffset}\n};\n\nViewDesc.prototype.emptyChildAt = function emptyChildAt (side) {\n  if (this.border || !this.contentDOM || !this.children.length) { return false }\n  var child = this.children[side < 0 ? 0 : this.children.length - 1];\n  return child.size == 0 || child.emptyChildAt(side)\n};\n\n// : (number) → dom.Node\nViewDesc.prototype.domAfterPos = function domAfterPos (pos) {\n  var ref = this.domFromPos(pos, 0);\n    var node = ref.node;\n    var offset = ref.offset;\n  if (node.nodeType != 1 || offset == node.childNodes.length)\n    { throw new RangeError(\"No node after pos \" + pos) }\n  return node.childNodes[offset]\n};\n\n// : (number, number, dom.Document)\n// View descs are responsible for setting any selection that falls\n// entirely inside of them, so that custom implementations can do\n// custom things with the selection. Note that this falls apart when\n// a selection starts in such a node and ends in another, in which\n// case we just use whatever domFromPos produces as a best effort.\nViewDesc.prototype.setSelection = function setSelection (anchor, head, root, force) {\n  // If the selection falls entirely in a child, give it to that child\n  var from = Math.min(anchor, head), to = Math.max(anchor, head);\n  for (var i = 0, offset = 0; i < this.children.length; i++) {\n    var child = this.children[i], end = offset + child.size;\n    if (from > offset && to < end)\n      { return child.setSelection(anchor - offset - child.border, head - offset - child.border, root, force) }\n    offset = end;\n  }\n\n  var anchorDOM = this.domFromPos(anchor, anchor ? -1 : 1);\n  var headDOM = head == anchor ? anchorDOM : this.domFromPos(head, head ? -1 : 1);\n  var domSel = root.getSelection();\n\n  var brKludge = false;\n  // On Firefox, using Selection.collapse to put the cursor after a\n  // BR node for some reason doesn't always work (#1073). On Safari,\n  // the cursor sometimes inexplicable visually lags behind its\n  // reported position in such situations (#1092).\n  if ((result.gecko || result.safari) && anchor == head) {\n    var node = anchorDOM.node;\n      var offset$1 = anchorDOM.offset;\n    if (node.nodeType == 3) {\n      brKludge = offset$1 && node.nodeValue[offset$1 - 1] == \"\\n\";\n      // Issue #1128\n      if (brKludge && offset$1 == node.nodeValue.length) {\n        for (var scan = node, after = (void 0); scan; scan = scan.parentNode) {\n          if (after = scan.nextSibling) {\n            if (after.nodeName == \"BR\")\n              { anchorDOM = headDOM = {node: after.parentNode, offset: domIndex(after) + 1}; }\n            break\n          }\n          var desc = scan.pmViewDesc;\n          if (desc && desc.node && desc.node.isBlock) { break }\n        }\n      }\n    } else {\n      var prev = node.childNodes[offset$1 - 1];\n      brKludge = prev && (prev.nodeName == \"BR\" || prev.contentEditable == \"false\");\n    }\n  }\n  // Firefox can act strangely when the selection is in front of an\n  // uneditable node. See #1163 and https://bugzilla.mozilla.org/show_bug.cgi?id=1709536\n  if (result.gecko && domSel.focusNode && domSel.focusNode != headDOM.node && domSel.focusNode.nodeType == 1) {\n    var after$1 = domSel.focusNode.childNodes[domSel.focusOffset];\n    if (after$1 && after$1.contentEditable == \"false\") { force = true; }\n  }\n\n  if (!(force || brKludge && result.safari) &&\n      isEquivalentPosition(anchorDOM.node, anchorDOM.offset, domSel.anchorNode, domSel.anchorOffset) &&\n      isEquivalentPosition(headDOM.node, headDOM.offset, domSel.focusNode, domSel.focusOffset))\n    { return }\n\n  // Selection.extend can be used to create an 'inverted' selection\n  // (one where the focus is before the anchor), but not all\n  // browsers support it yet.\n  var domSelExtended = false;\n  if ((domSel.extend || anchor == head) && !brKludge) {\n    domSel.collapse(anchorDOM.node, anchorDOM.offset);\n    try {\n      if (anchor != head) { domSel.extend(headDOM.node, headDOM.offset); }\n      domSelExtended = true;\n    } catch (err) {\n      // In some cases with Chrome the selection is empty after calling\n      // collapse, even when it should be valid. This appears to be a bug, but\n      // it is difficult to isolate. If this happens fallback to the old path\n      // without using extend.\n      if (!(err instanceof DOMException)) { throw err }\n      // declare global: DOMException\n    }\n  }\n  if (!domSelExtended) {\n    if (anchor > head) { var tmp = anchorDOM; anchorDOM = headDOM; headDOM = tmp; }\n    var range = document.createRange();\n    range.setEnd(headDOM.node, headDOM.offset);\n    range.setStart(anchorDOM.node, anchorDOM.offset);\n    domSel.removeAllRanges();\n    domSel.addRange(range);\n  }\n};\n\n// : (dom.MutationRecord) → bool\nViewDesc.prototype.ignoreMutation = function ignoreMutation (mutation) {\n  return !this.contentDOM && mutation.type != \"selection\"\n};\n\nprototypeAccessors.contentLost.get = function () {\n  return this.contentDOM && this.contentDOM != this.dom && !this.dom.contains(this.contentDOM)\n};\n\n// Remove a subtree of the element tree that has been touched\n// by a DOM change, so that the next update will redraw it.\nViewDesc.prototype.markDirty = function markDirty (from, to) {\n  for (var offset = 0, i = 0; i < this.children.length; i++) {\n    var child = this.children[i], end = offset + child.size;\n    if (offset == end ? from <= end && to >= offset : from < end && to > offset) {\n      var startInside = offset + child.border, endInside = end - child.border;\n      if (from >= startInside && to <= endInside) {\n        this.dirty = from == offset || to == end ? CONTENT_DIRTY : CHILD_DIRTY;\n        if (from == startInside && to == endInside &&\n            (child.contentLost || child.dom.parentNode != this.contentDOM)) { child.dirty = NODE_DIRTY; }\n        else { child.markDirty(from - startInside, to - startInside); }\n        return\n      } else {\n        child.dirty = child.dom == child.contentDOM && child.dom.parentNode == this.contentDOM && !child.children.length\n          ? CONTENT_DIRTY : NODE_DIRTY;\n      }\n    }\n    offset = end;\n  }\n  this.dirty = CONTENT_DIRTY;\n};\n\nViewDesc.prototype.markParentsDirty = function markParentsDirty () {\n  var level = 1;\n  for (var node = this.parent; node; node = node.parent, level++) {\n    var dirty = level == 1 ? CONTENT_DIRTY : CHILD_DIRTY;\n    if (node.dirty < dirty) { node.dirty = dirty; }\n  }\n};\n\nprototypeAccessors.domAtom.get = function () { return false };\n\nprototypeAccessors.ignoreForCoords.get = function () { return false };\n\nObject.defineProperties( ViewDesc.prototype, prototypeAccessors );\n\n// Reused array to avoid allocating fresh arrays for things that will\n// stay empty anyway.\nvar nothing = [];\n\n// A widget desc represents a widget decoration, which is a DOM node\n// drawn between the document nodes.\nvar WidgetViewDesc = /*@__PURE__*/(function (ViewDesc) {\n  function WidgetViewDesc(parent, widget, view, pos) {\n    var self, dom = widget.type.toDOM;\n    if (typeof dom == \"function\") { dom = dom(view, function () {\n      if (!self) { return pos }\n      if (self.parent) { return self.parent.posBeforeChild(self) }\n    }); }\n    if (!widget.type.spec.raw) {\n      if (dom.nodeType != 1) {\n        var wrap = document.createElement(\"span\");\n        wrap.appendChild(dom);\n        dom = wrap;\n      }\n      dom.contentEditable = false;\n      dom.classList.add(\"ProseMirror-widget\");\n    }\n    ViewDesc.call(this, parent, nothing, dom, null);\n    this.widget = widget;\n    self = this;\n  }\n\n  if ( ViewDesc ) WidgetViewDesc.__proto__ = ViewDesc;\n  WidgetViewDesc.prototype = Object.create( ViewDesc && ViewDesc.prototype );\n  WidgetViewDesc.prototype.constructor = WidgetViewDesc;\n\n  var prototypeAccessors$1 = { domAtom: { configurable: true } };\n\n  WidgetViewDesc.prototype.matchesWidget = function matchesWidget (widget) {\n    return this.dirty == NOT_DIRTY && widget.type.eq(this.widget.type)\n  };\n\n  WidgetViewDesc.prototype.parseRule = function parseRule () { return {ignore: true} };\n\n  WidgetViewDesc.prototype.stopEvent = function stopEvent (event) {\n    var stop = this.widget.spec.stopEvent;\n    return stop ? stop(event) : false\n  };\n\n  WidgetViewDesc.prototype.ignoreMutation = function ignoreMutation (mutation) {\n    return mutation.type != \"selection\" || this.widget.spec.ignoreSelection\n  };\n\n  WidgetViewDesc.prototype.destroy = function destroy () {\n    this.widget.type.destroy(this.dom);\n    ViewDesc.prototype.destroy.call(this);\n  };\n\n  prototypeAccessors$1.domAtom.get = function () { return true };\n\n  Object.defineProperties( WidgetViewDesc.prototype, prototypeAccessors$1 );\n\n  return WidgetViewDesc;\n}(ViewDesc));\n\nvar CompositionViewDesc = /*@__PURE__*/(function (ViewDesc) {\n  function CompositionViewDesc(parent, dom, textDOM, text) {\n    ViewDesc.call(this, parent, nothing, dom, null);\n    this.textDOM = textDOM;\n    this.text = text;\n  }\n\n  if ( ViewDesc ) CompositionViewDesc.__proto__ = ViewDesc;\n  CompositionViewDesc.prototype = Object.create( ViewDesc && ViewDesc.prototype );\n  CompositionViewDesc.prototype.constructor = CompositionViewDesc;\n\n  var prototypeAccessors$2 = { size: { configurable: true } };\n\n  prototypeAccessors$2.size.get = function () { return this.text.length };\n\n  CompositionViewDesc.prototype.localPosFromDOM = function localPosFromDOM (dom, offset) {\n    if (dom != this.textDOM) { return this.posAtStart + (offset ? this.size : 0) }\n    return this.posAtStart + offset\n  };\n\n  CompositionViewDesc.prototype.domFromPos = function domFromPos (pos) {\n    return {node: this.textDOM, offset: pos}\n  };\n\n  CompositionViewDesc.prototype.ignoreMutation = function ignoreMutation (mut) {\n    return mut.type === 'characterData' && mut.target.nodeValue == mut.oldValue\n   };\n\n  Object.defineProperties( CompositionViewDesc.prototype, prototypeAccessors$2 );\n\n  return CompositionViewDesc;\n}(ViewDesc));\n\n// A mark desc represents a mark. May have multiple children,\n// depending on how the mark is split. Note that marks are drawn using\n// a fixed nesting order, for simplicity and predictability, so in\n// some cases they will be split more often than would appear\n// necessary.\nvar MarkViewDesc = /*@__PURE__*/(function (ViewDesc) {\n  function MarkViewDesc(parent, mark, dom, contentDOM) {\n    ViewDesc.call(this, parent, [], dom, contentDOM);\n    this.mark = mark;\n  }\n\n  if ( ViewDesc ) MarkViewDesc.__proto__ = ViewDesc;\n  MarkViewDesc.prototype = Object.create( ViewDesc && ViewDesc.prototype );\n  MarkViewDesc.prototype.constructor = MarkViewDesc;\n\n  MarkViewDesc.create = function create (parent, mark, inline, view) {\n    var custom = view.nodeViews[mark.type.name];\n    var spec = custom && custom(mark, view, inline);\n    if (!spec || !spec.dom)\n      { spec = DOMSerializer.renderSpec(document, mark.type.spec.toDOM(mark, inline)); }\n    return new MarkViewDesc(parent, mark, spec.dom, spec.contentDOM || spec.dom)\n  };\n\n  MarkViewDesc.prototype.parseRule = function parseRule () {\n    if ((this.dirty & NODE_DIRTY) || this.mark.type.spec.reparseInView) { return null }\n    return {mark: this.mark.type.name, attrs: this.mark.attrs, contentElement: this.contentDOM}\n  };\n\n  MarkViewDesc.prototype.matchesMark = function matchesMark (mark) { return this.dirty != NODE_DIRTY && this.mark.eq(mark) };\n\n  MarkViewDesc.prototype.markDirty = function markDirty (from, to) {\n    ViewDesc.prototype.markDirty.call(this, from, to);\n    // Move dirty info to nearest node view\n    if (this.dirty != NOT_DIRTY) {\n      var parent = this.parent;\n      while (!parent.node) { parent = parent.parent; }\n      if (parent.dirty < this.dirty) { parent.dirty = this.dirty; }\n      this.dirty = NOT_DIRTY;\n    }\n  };\n\n  MarkViewDesc.prototype.slice = function slice (from, to, view) {\n    var copy = MarkViewDesc.create(this.parent, this.mark, true, view);\n    var nodes = this.children, size = this.size;\n    if (to < size) { nodes = replaceNodes(nodes, to, size, view); }\n    if (from > 0) { nodes = replaceNodes(nodes, 0, from, view); }\n    for (var i = 0; i < nodes.length; i++) { nodes[i].parent = copy; }\n    copy.children = nodes;\n    return copy\n  };\n\n  return MarkViewDesc;\n}(ViewDesc));\n\n// Node view descs are the main, most common type of view desc, and\n// correspond to an actual node in the document. Unlike mark descs,\n// they populate their child array themselves.\nvar NodeViewDesc = /*@__PURE__*/(function (ViewDesc) {\n  function NodeViewDesc(parent, node, outerDeco, innerDeco, dom, contentDOM, nodeDOM, view, pos) {\n    ViewDesc.call(this, parent, node.isLeaf ? nothing : [], dom, contentDOM);\n    this.nodeDOM = nodeDOM;\n    this.node = node;\n    this.outerDeco = outerDeco;\n    this.innerDeco = innerDeco;\n    if (contentDOM) { this.updateChildren(view, pos); }\n  }\n\n  if ( ViewDesc ) NodeViewDesc.__proto__ = ViewDesc;\n  NodeViewDesc.prototype = Object.create( ViewDesc && ViewDesc.prototype );\n  NodeViewDesc.prototype.constructor = NodeViewDesc;\n\n  var prototypeAccessors$3 = { size: { configurable: true },border: { configurable: true },domAtom: { configurable: true } };\n\n  // By default, a node is rendered using the `toDOM` method from the\n  // node type spec. But client code can use the `nodeViews` spec to\n  // supply a custom node view, which can influence various aspects of\n  // the way the node works.\n  //\n  // (Using subclassing for this was intentionally decided against,\n  // since it'd require exposing a whole slew of finicky\n  // implementation details to the user code that they probably will\n  // never need.)\n  NodeViewDesc.create = function create (parent, node, outerDeco, innerDeco, view, pos) {\n    var assign;\n\n    var custom = view.nodeViews[node.type.name], descObj;\n    var spec = custom && custom(node, view, function () {\n      // (This is a function that allows the custom view to find its\n      // own position)\n      if (!descObj) { return pos }\n      if (descObj.parent) { return descObj.parent.posBeforeChild(descObj) }\n    }, outerDeco, innerDeco);\n\n    var dom = spec && spec.dom, contentDOM = spec && spec.contentDOM;\n    if (node.isText) {\n      if (!dom) { dom = document.createTextNode(node.text); }\n      else if (dom.nodeType != 3) { throw new RangeError(\"Text must be rendered as a DOM text node\") }\n    } else if (!dom) {\n((assign = DOMSerializer.renderSpec(document, node.type.spec.toDOM(node)), dom = assign.dom, contentDOM = assign.contentDOM));\n    }\n    if (!contentDOM && !node.isText && dom.nodeName != \"BR\") { // Chrome gets confused by <br contenteditable=false>\n      if (!dom.hasAttribute(\"contenteditable\")) { dom.contentEditable = false; }\n      if (node.type.spec.draggable) { dom.draggable = true; }\n    }\n\n    var nodeDOM = dom;\n    dom = applyOuterDeco(dom, outerDeco, node);\n\n    if (spec)\n      { return descObj = new CustomNodeViewDesc(parent, node, outerDeco, innerDeco, dom, contentDOM, nodeDOM,\n                                              spec, view, pos + 1) }\n    else if (node.isText)\n      { return new TextViewDesc(parent, node, outerDeco, innerDeco, dom, nodeDOM, view) }\n    else\n      { return new NodeViewDesc(parent, node, outerDeco, innerDeco, dom, contentDOM, nodeDOM, view, pos + 1) }\n  };\n\n  NodeViewDesc.prototype.parseRule = function parseRule () {\n    var this$1 = this;\n\n    // Experimental kludge to allow opt-in re-parsing of nodes\n    if (this.node.type.spec.reparseInView) { return null }\n    // FIXME the assumption that this can always return the current\n    // attrs means that if the user somehow manages to change the\n    // attrs in the dom, that won't be picked up. Not entirely sure\n    // whether this is a problem\n    var rule = {node: this.node.type.name, attrs: this.node.attrs};\n    if (this.node.type.whitespace == \"pre\") { rule.preserveWhitespace = \"full\"; }\n    if (this.contentDOM && !this.contentLost) { rule.contentElement = this.contentDOM; }\n    else { rule.getContent = function () { return this$1.contentDOM ? Fragment.empty : this$1.node.content; }; }\n    return rule\n  };\n\n  NodeViewDesc.prototype.matchesNode = function matchesNode (node, outerDeco, innerDeco) {\n    return this.dirty == NOT_DIRTY && node.eq(this.node) &&\n      sameOuterDeco(outerDeco, this.outerDeco) && innerDeco.eq(this.innerDeco)\n  };\n\n  prototypeAccessors$3.size.get = function () { return this.node.nodeSize };\n\n  prototypeAccessors$3.border.get = function () { return this.node.isLeaf ? 0 : 1 };\n\n  // Syncs `this.children` to match `this.node.content` and the local\n  // decorations, possibly introducing nesting for marks. Then, in a\n  // separate step, syncs the DOM inside `this.contentDOM` to\n  // `this.children`.\n  NodeViewDesc.prototype.updateChildren = function updateChildren (view, pos) {\n    var this$1 = this;\n\n    var inline = this.node.inlineContent, off = pos;\n    var composition = view.composing && this.localCompositionInfo(view, pos);\n    var localComposition = composition && composition.pos > -1 ? composition : null;\n    var compositionInChild = composition && composition.pos < 0;\n    var updater = new ViewTreeUpdater(this, localComposition && localComposition.node);\n    iterDeco(this.node, this.innerDeco, function (widget, i, insideNode) {\n      if (widget.spec.marks)\n        { updater.syncToMarks(widget.spec.marks, inline, view); }\n      else if (widget.type.side >= 0 && !insideNode)\n        { updater.syncToMarks(i == this$1.node.childCount ? Mark.none : this$1.node.child(i).marks, inline, view); }\n      // If the next node is a desc matching this widget, reuse it,\n      // otherwise insert the widget as a new view desc.\n      updater.placeWidget(widget, view, off);\n    }, function (child, outerDeco, innerDeco, i) {\n      // Make sure the wrapping mark descs match the node's marks.\n      updater.syncToMarks(child.marks, inline, view);\n      // Try several strategies for drawing this node\n      var compIndex;\n      if (updater.findNodeMatch(child, outerDeco, innerDeco, i)) ; else if (compositionInChild && view.state.selection.from > off &&\n                 view.state.selection.to < off + child.nodeSize &&\n                 (compIndex = updater.findIndexWithChild(composition.node)) > -1 &&\n                 updater.updateNodeAt(child, outerDeco, innerDeco, compIndex, view)) ; else if (updater.updateNextNode(child, outerDeco, innerDeco, view, i)) ; else {\n        // Add it as a new view\n        updater.addNode(child, outerDeco, innerDeco, view, off);\n      }\n      off += child.nodeSize;\n    });\n    // Drop all remaining descs after the current position.\n    updater.syncToMarks(nothing, inline, view);\n    if (this.node.isTextblock) { updater.addTextblockHacks(); }\n    updater.destroyRest();\n\n    // Sync the DOM if anything changed\n    if (updater.changed || this.dirty == CONTENT_DIRTY) {\n      // May have to protect focused DOM from being changed if a composition is active\n      if (localComposition) { this.protectLocalComposition(view, localComposition); }\n      renderDescs(this.contentDOM, this.children, view);\n      if (result.ios) { iosHacks(this.dom); }\n    }\n  };\n\n  NodeViewDesc.prototype.localCompositionInfo = function localCompositionInfo (view, pos) {\n    // Only do something if both the selection and a focused text node\n    // are inside of this node\n    var ref = view.state.selection;\n    var from = ref.from;\n    var to = ref.to;\n    if (!(view.state.selection instanceof TextSelection) || from < pos || to > pos + this.node.content.size) { return }\n    var sel = view.root.getSelection();\n    var textNode = nearbyTextNode(sel.focusNode, sel.focusOffset);\n    if (!textNode || !this.dom.contains(textNode.parentNode)) { return }\n\n    if (this.node.inlineContent) {\n      // Find the text in the focused node in the node, stop if it's not\n      // there (may have been modified through other means, in which\n      // case it should overwritten)\n      var text = textNode.nodeValue;\n      var textPos = findTextInFragment(this.node.content, text, from - pos, to - pos);\n      return textPos < 0 ? null : {node: textNode, pos: textPos, text: text}\n    } else {\n      return {node: textNode, pos: -1}\n    }\n  };\n\n  NodeViewDesc.prototype.protectLocalComposition = function protectLocalComposition (view, ref) {\n    var node = ref.node;\n    var pos = ref.pos;\n    var text = ref.text;\n\n    // The node is already part of a local view desc, leave it there\n    if (this.getDesc(node)) { return }\n\n    // Create a composition view for the orphaned nodes\n    var topNode = node;\n    for (;; topNode = topNode.parentNode) {\n      if (topNode.parentNode == this.contentDOM) { break }\n      while (topNode.previousSibling) { topNode.parentNode.removeChild(topNode.previousSibling); }\n      while (topNode.nextSibling) { topNode.parentNode.removeChild(topNode.nextSibling); }\n      if (topNode.pmViewDesc) { topNode.pmViewDesc = null; }\n    }\n    var desc = new CompositionViewDesc(this, topNode, node, text);\n    view.compositionNodes.push(desc);\n\n    // Patch up this.children to contain the composition view\n    this.children = replaceNodes(this.children, pos, pos + text.length, view, desc);\n  };\n\n  // : (Node, [Decoration], DecorationSource, EditorView) → bool\n  // If this desc be updated to match the given node decoration,\n  // do so and return true.\n  NodeViewDesc.prototype.update = function update (node, outerDeco, innerDeco, view) {\n    if (this.dirty == NODE_DIRTY ||\n        !node.sameMarkup(this.node)) { return false }\n    this.updateInner(node, outerDeco, innerDeco, view);\n    return true\n  };\n\n  NodeViewDesc.prototype.updateInner = function updateInner (node, outerDeco, innerDeco, view) {\n    this.updateOuterDeco(outerDeco);\n    this.node = node;\n    this.innerDeco = innerDeco;\n    if (this.contentDOM) { this.updateChildren(view, this.posAtStart); }\n    this.dirty = NOT_DIRTY;\n  };\n\n  NodeViewDesc.prototype.updateOuterDeco = function updateOuterDeco (outerDeco) {\n    if (sameOuterDeco(outerDeco, this.outerDeco)) { return }\n    var needsWrap = this.nodeDOM.nodeType != 1;\n    var oldDOM = this.dom;\n    this.dom = patchOuterDeco(this.dom, this.nodeDOM,\n                              computeOuterDeco(this.outerDeco, this.node, needsWrap),\n                              computeOuterDeco(outerDeco, this.node, needsWrap));\n    if (this.dom != oldDOM) {\n      oldDOM.pmViewDesc = null;\n      this.dom.pmViewDesc = this;\n    }\n    this.outerDeco = outerDeco;\n  };\n\n  // Mark this node as being the selected node.\n  NodeViewDesc.prototype.selectNode = function selectNode () {\n    this.nodeDOM.classList.add(\"ProseMirror-selectednode\");\n    if (this.contentDOM || !this.node.type.spec.draggable) { this.dom.draggable = true; }\n  };\n\n  // Remove selected node marking from this node.\n  NodeViewDesc.prototype.deselectNode = function deselectNode () {\n    this.nodeDOM.classList.remove(\"ProseMirror-selectednode\");\n    if (this.contentDOM || !this.node.type.spec.draggable) { this.dom.removeAttribute(\"draggable\"); }\n  };\n\n  prototypeAccessors$3.domAtom.get = function () { return this.node.isAtom };\n\n  Object.defineProperties( NodeViewDesc.prototype, prototypeAccessors$3 );\n\n  return NodeViewDesc;\n}(ViewDesc));\n\n// Create a view desc for the top-level document node, to be exported\n// and used by the view class.\nfunction docViewDesc(doc, outerDeco, innerDeco, dom, view) {\n  applyOuterDeco(dom, outerDeco, doc);\n  return new NodeViewDesc(null, doc, outerDeco, innerDeco, dom, dom, dom, view, 0)\n}\n\nvar TextViewDesc = /*@__PURE__*/(function (NodeViewDesc) {\n  function TextViewDesc(parent, node, outerDeco, innerDeco, dom, nodeDOM, view) {\n    NodeViewDesc.call(this, parent, node, outerDeco, innerDeco, dom, null, nodeDOM, view);\n  }\n\n  if ( NodeViewDesc ) TextViewDesc.__proto__ = NodeViewDesc;\n  TextViewDesc.prototype = Object.create( NodeViewDesc && NodeViewDesc.prototype );\n  TextViewDesc.prototype.constructor = TextViewDesc;\n\n  var prototypeAccessors$4 = { domAtom: { configurable: true } };\n\n  TextViewDesc.prototype.parseRule = function parseRule () {\n    var skip = this.nodeDOM.parentNode;\n    while (skip && skip != this.dom && !skip.pmIsDeco) { skip = skip.parentNode; }\n    return {skip: skip || true}\n  };\n\n  TextViewDesc.prototype.update = function update (node, outerDeco, _, view) {\n    if (this.dirty == NODE_DIRTY || (this.dirty != NOT_DIRTY && !this.inParent()) ||\n        !node.sameMarkup(this.node)) { return false }\n    this.updateOuterDeco(outerDeco);\n    if ((this.dirty != NOT_DIRTY || node.text != this.node.text) && node.text != this.nodeDOM.nodeValue) {\n      this.nodeDOM.nodeValue = node.text;\n      if (view.trackWrites == this.nodeDOM) { view.trackWrites = null; }\n    }\n    this.node = node;\n    this.dirty = NOT_DIRTY;\n    return true\n  };\n\n  TextViewDesc.prototype.inParent = function inParent () {\n    var parentDOM = this.parent.contentDOM;\n    for (var n = this.nodeDOM; n; n = n.parentNode) { if (n == parentDOM) { return true } }\n    return false\n  };\n\n  TextViewDesc.prototype.domFromPos = function domFromPos (pos) {\n    return {node: this.nodeDOM, offset: pos}\n  };\n\n  TextViewDesc.prototype.localPosFromDOM = function localPosFromDOM (dom, offset, bias) {\n    if (dom == this.nodeDOM) { return this.posAtStart + Math.min(offset, this.node.text.length) }\n    return NodeViewDesc.prototype.localPosFromDOM.call(this, dom, offset, bias)\n  };\n\n  TextViewDesc.prototype.ignoreMutation = function ignoreMutation (mutation) {\n    return mutation.type != \"characterData\" && mutation.type != \"selection\"\n  };\n\n  TextViewDesc.prototype.slice = function slice (from, to, view) {\n    var node = this.node.cut(from, to), dom = document.createTextNode(node.text);\n    return new TextViewDesc(this.parent, node, this.outerDeco, this.innerDeco, dom, dom, view)\n  };\n\n  TextViewDesc.prototype.markDirty = function markDirty (from, to) {\n    NodeViewDesc.prototype.markDirty.call(this, from, to);\n    if (this.dom != this.nodeDOM && (from == 0 || to == this.nodeDOM.nodeValue.length))\n      { this.dirty = NODE_DIRTY; }\n  };\n\n  prototypeAccessors$4.domAtom.get = function () { return false };\n\n  Object.defineProperties( TextViewDesc.prototype, prototypeAccessors$4 );\n\n  return TextViewDesc;\n}(NodeViewDesc));\n\n// A dummy desc used to tag trailing BR or IMG nodes created to work\n// around contentEditable terribleness.\nvar TrailingHackViewDesc = /*@__PURE__*/(function (ViewDesc) {\n  function TrailingHackViewDesc () {\n    ViewDesc.apply(this, arguments);\n  }\n\n  if ( ViewDesc ) TrailingHackViewDesc.__proto__ = ViewDesc;\n  TrailingHackViewDesc.prototype = Object.create( ViewDesc && ViewDesc.prototype );\n  TrailingHackViewDesc.prototype.constructor = TrailingHackViewDesc;\n\n  var prototypeAccessors$5 = { domAtom: { configurable: true },ignoreForCoords: { configurable: true } };\n\n  TrailingHackViewDesc.prototype.parseRule = function parseRule () { return {ignore: true} };\n  TrailingHackViewDesc.prototype.matchesHack = function matchesHack (nodeName) { return this.dirty == NOT_DIRTY && this.dom.nodeName == nodeName };\n  prototypeAccessors$5.domAtom.get = function () { return true };\n  prototypeAccessors$5.ignoreForCoords.get = function () { return this.dom.nodeName == \"IMG\" };\n\n  Object.defineProperties( TrailingHackViewDesc.prototype, prototypeAccessors$5 );\n\n  return TrailingHackViewDesc;\n}(ViewDesc));\n\n// A separate subclass is used for customized node views, so that the\n// extra checks only have to be made for nodes that are actually\n// customized.\nvar CustomNodeViewDesc = /*@__PURE__*/(function (NodeViewDesc) {\n  function CustomNodeViewDesc(parent, node, outerDeco, innerDeco, dom, contentDOM, nodeDOM, spec, view, pos) {\n    NodeViewDesc.call(this, parent, node, outerDeco, innerDeco, dom, contentDOM, nodeDOM, view, pos);\n    this.spec = spec;\n  }\n\n  if ( NodeViewDesc ) CustomNodeViewDesc.__proto__ = NodeViewDesc;\n  CustomNodeViewDesc.prototype = Object.create( NodeViewDesc && NodeViewDesc.prototype );\n  CustomNodeViewDesc.prototype.constructor = CustomNodeViewDesc;\n\n  // A custom `update` method gets to decide whether the update goes\n  // through. If it does, and there's a `contentDOM` node, our logic\n  // updates the children.\n  CustomNodeViewDesc.prototype.update = function update (node, outerDeco, innerDeco, view) {\n    if (this.dirty == NODE_DIRTY) { return false }\n    if (this.spec.update) {\n      var result = this.spec.update(node, outerDeco, innerDeco);\n      if (result) { this.updateInner(node, outerDeco, innerDeco, view); }\n      return result\n    } else if (!this.contentDOM && !node.isLeaf) {\n      return false\n    } else {\n      return NodeViewDesc.prototype.update.call(this, node, outerDeco, innerDeco, view)\n    }\n  };\n\n  CustomNodeViewDesc.prototype.selectNode = function selectNode () {\n    this.spec.selectNode ? this.spec.selectNode() : NodeViewDesc.prototype.selectNode.call(this);\n  };\n\n  CustomNodeViewDesc.prototype.deselectNode = function deselectNode () {\n    this.spec.deselectNode ? this.spec.deselectNode() : NodeViewDesc.prototype.deselectNode.call(this);\n  };\n\n  CustomNodeViewDesc.prototype.setSelection = function setSelection (anchor, head, root, force) {\n    this.spec.setSelection ? this.spec.setSelection(anchor, head, root)\n      : NodeViewDesc.prototype.setSelection.call(this, anchor, head, root, force);\n  };\n\n  CustomNodeViewDesc.prototype.destroy = function destroy () {\n    if (this.spec.destroy) { this.spec.destroy(); }\n    NodeViewDesc.prototype.destroy.call(this);\n  };\n\n  CustomNodeViewDesc.prototype.stopEvent = function stopEvent (event) {\n    return this.spec.stopEvent ? this.spec.stopEvent(event) : false\n  };\n\n  CustomNodeViewDesc.prototype.ignoreMutation = function ignoreMutation (mutation) {\n    return this.spec.ignoreMutation ? this.spec.ignoreMutation(mutation) : NodeViewDesc.prototype.ignoreMutation.call(this, mutation)\n  };\n\n  return CustomNodeViewDesc;\n}(NodeViewDesc));\n\n// : (dom.Node, [ViewDesc])\n// Sync the content of the given DOM node with the nodes associated\n// with the given array of view descs, recursing into mark descs\n// because this should sync the subtree for a whole node at a time.\nfunction renderDescs(parentDOM, descs, view) {\n  var dom = parentDOM.firstChild, written = false;\n  for (var i = 0; i < descs.length; i++) {\n    var desc = descs[i], childDOM = desc.dom;\n    if (childDOM.parentNode == parentDOM) {\n      while (childDOM != dom) { dom = rm(dom); written = true; }\n      dom = dom.nextSibling;\n    } else {\n      written = true;\n      parentDOM.insertBefore(childDOM, dom);\n    }\n    if (desc instanceof MarkViewDesc) {\n      var pos = dom ? dom.previousSibling : parentDOM.lastChild;\n      renderDescs(desc.contentDOM, desc.children, view);\n      dom = pos ? pos.nextSibling : parentDOM.firstChild;\n    }\n  }\n  while (dom) { dom = rm(dom); written = true; }\n  if (written && view.trackWrites == parentDOM) { view.trackWrites = null; }\n}\n\nfunction OuterDecoLevel(nodeName) {\n  if (nodeName) { this.nodeName = nodeName; }\n}\nOuterDecoLevel.prototype = Object.create(null);\n\nvar noDeco = [new OuterDecoLevel];\n\nfunction computeOuterDeco(outerDeco, node, needsWrap) {\n  if (outerDeco.length == 0) { return noDeco }\n\n  var top = needsWrap ? noDeco[0] : new OuterDecoLevel, result = [top];\n\n  for (var i = 0; i < outerDeco.length; i++) {\n    var attrs = outerDeco[i].type.attrs;\n    if (!attrs) { continue }\n    if (attrs.nodeName)\n      { result.push(top = new OuterDecoLevel(attrs.nodeName)); }\n\n    for (var name in attrs) {\n      var val = attrs[name];\n      if (val == null) { continue }\n      if (needsWrap && result.length == 1)\n        { result.push(top = new OuterDecoLevel(node.isInline ? \"span\" : \"div\")); }\n      if (name == \"class\") { top.class = (top.class ? top.class + \" \" : \"\") + val; }\n      else if (name == \"style\") { top.style = (top.style ? top.style + \";\" : \"\") + val; }\n      else if (name != \"nodeName\") { top[name] = val; }\n    }\n  }\n\n  return result\n}\n\nfunction patchOuterDeco(outerDOM, nodeDOM, prevComputed, curComputed) {\n  // Shortcut for trivial case\n  if (prevComputed == noDeco && curComputed == noDeco) { return nodeDOM }\n\n  var curDOM = nodeDOM;\n  for (var i = 0; i < curComputed.length; i++) {\n    var deco = curComputed[i], prev = prevComputed[i];\n    if (i) {\n      var parent = (void 0);\n      if (prev && prev.nodeName == deco.nodeName && curDOM != outerDOM &&\n          (parent = curDOM.parentNode) && parent.tagName.toLowerCase() == deco.nodeName) {\n        curDOM = parent;\n      } else {\n        parent = document.createElement(deco.nodeName);\n        parent.pmIsDeco = true;\n        parent.appendChild(curDOM);\n        prev = noDeco[0];\n        curDOM = parent;\n      }\n    }\n    patchAttributes(curDOM, prev || noDeco[0], deco);\n  }\n  return curDOM\n}\n\nfunction patchAttributes(dom, prev, cur) {\n  for (var name in prev)\n    { if (name != \"class\" && name != \"style\" && name != \"nodeName\" && !(name in cur))\n      { dom.removeAttribute(name); } }\n  for (var name$1 in cur)\n    { if (name$1 != \"class\" && name$1 != \"style\" && name$1 != \"nodeName\" && cur[name$1] != prev[name$1])\n      { dom.setAttribute(name$1, cur[name$1]); } }\n  if (prev.class != cur.class) {\n    var prevList = prev.class ? prev.class.split(\" \").filter(Boolean) : nothing;\n    var curList = cur.class ? cur.class.split(\" \").filter(Boolean) : nothing;\n    for (var i = 0; i < prevList.length; i++) { if (curList.indexOf(prevList[i]) == -1)\n      { dom.classList.remove(prevList[i]); } }\n    for (var i$1 = 0; i$1 < curList.length; i$1++) { if (prevList.indexOf(curList[i$1]) == -1)\n      { dom.classList.add(curList[i$1]); } }\n    if (dom.classList.length == 0)\n      { dom.removeAttribute(\"class\"); }\n  }\n  if (prev.style != cur.style) {\n    if (prev.style) {\n      var prop = /\\s*([\\w\\-\\xa1-\\uffff]+)\\s*:(?:\"(?:\\\\.|[^\"])*\"|'(?:\\\\.|[^'])*'|\\(.*?\\)|[^;])*/g, m;\n      while (m = prop.exec(prev.style))\n        { dom.style.removeProperty(m[1]); }\n    }\n    if (cur.style)\n      { dom.style.cssText += cur.style; }\n  }\n}\n\nfunction applyOuterDeco(dom, deco, node) {\n  return patchOuterDeco(dom, dom, noDeco, computeOuterDeco(deco, node, dom.nodeType != 1))\n}\n\n// : ([Decoration], [Decoration]) → bool\nfunction sameOuterDeco(a, b) {\n  if (a.length != b.length) { return false }\n  for (var i = 0; i < a.length; i++) { if (!a[i].type.eq(b[i].type)) { return false } }\n  return true\n}\n\n// Remove a DOM node and return its next sibling.\nfunction rm(dom) {\n  var next = dom.nextSibling;\n  dom.parentNode.removeChild(dom);\n  return next\n}\n\n// Helper class for incrementally updating a tree of mark descs and\n// the widget and node descs inside of them.\nvar ViewTreeUpdater = function ViewTreeUpdater(top, lockedNode) {\n  this.top = top;\n  this.lock = lockedNode;\n  // Index into `this.top`'s child array, represents the current\n  // update position.\n  this.index = 0;\n  // When entering a mark, the current top and index are pushed\n  // onto this.\n  this.stack = [];\n  // Tracks whether anything was changed\n  this.changed = false;\n\n  this.preMatch = preMatch(top.node.content, top);\n};\n\n// Destroy and remove the children between the given indices in\n// `this.top`.\nViewTreeUpdater.prototype.destroyBetween = function destroyBetween (start, end) {\n  if (start == end) { return }\n  for (var i = start; i < end; i++) { this.top.children[i].destroy(); }\n  this.top.children.splice(start, end - start);\n  this.changed = true;\n};\n\n// Destroy all remaining children in `this.top`.\nViewTreeUpdater.prototype.destroyRest = function destroyRest () {\n  this.destroyBetween(this.index, this.top.children.length);\n};\n\n// : ([Mark], EditorView)\n// Sync the current stack of mark descs with the given array of\n// marks, reusing existing mark descs when possible.\nViewTreeUpdater.prototype.syncToMarks = function syncToMarks (marks, inline, view) {\n  var keep = 0, depth = this.stack.length >> 1;\n  var maxKeep = Math.min(depth, marks.length);\n  while (keep < maxKeep &&\n         (keep == depth - 1 ? this.top : this.stack[(keep + 1) << 1]).matchesMark(marks[keep]) && marks[keep].type.spec.spanning !== false)\n    { keep++; }\n\n  while (keep < depth) {\n    this.destroyRest();\n    this.top.dirty = NOT_DIRTY;\n    this.index = this.stack.pop();\n    this.top = this.stack.pop();\n    depth--;\n  }\n  while (depth < marks.length) {\n    this.stack.push(this.top, this.index + 1);\n    var found = -1;\n    for (var i = this.index; i < Math.min(this.index + 3, this.top.children.length); i++) {\n      if (this.top.children[i].matchesMark(marks[depth])) { found = i; break }\n    }\n    if (found > -1) {\n      if (found > this.index) {\n        this.changed = true;\n        this.destroyBetween(this.index, found);\n      }\n      this.top = this.top.children[this.index];\n    } else {\n      var markDesc = MarkViewDesc.create(this.top, marks[depth], inline, view);\n      this.top.children.splice(this.index, 0, markDesc);\n      this.top = markDesc;\n      this.changed = true;\n    }\n    this.index = 0;\n    depth++;\n  }\n};\n\n// : (Node, [Decoration], DecorationSource) → bool\n// Try to find a node desc matching the given data. Skip over it and\n// return true when successful.\nViewTreeUpdater.prototype.findNodeMatch = function findNodeMatch (node, outerDeco, innerDeco, index) {\n  var found = -1, targetDesc;\n  if (index >= this.preMatch.index &&\n      (targetDesc = this.preMatch.matches[index - this.preMatch.index]).parent == this.top &&\n      targetDesc.matchesNode(node, outerDeco, innerDeco)) {\n    found = this.top.children.indexOf(targetDesc, this.index);\n  } else {\n    for (var i = this.index, e = Math.min(this.top.children.length, i + 5); i < e; i++) {\n      var child = this.top.children[i];\n      if (child.matchesNode(node, outerDeco, innerDeco) && !this.preMatch.matched.has(child)) {\n        found = i;\n        break\n      }\n    }\n  }\n  if (found < 0) { return false }\n  this.destroyBetween(this.index, found);\n  this.index++;\n  return true\n};\n\nViewTreeUpdater.prototype.updateNodeAt = function updateNodeAt (node, outerDeco, innerDeco, index, view) {\n  var child = this.top.children[index];\n  if (!child.update(node, outerDeco, innerDeco, view)) { return false }\n  this.destroyBetween(this.index, index);\n  this.index = index + 1;\n  return true\n};\n\nViewTreeUpdater.prototype.findIndexWithChild = function findIndexWithChild (domNode) {\n  for (;;) {\n    var parent = domNode.parentNode;\n    if (!parent) { return -1 }\n    if (parent == this.top.contentDOM) {\n      var desc = domNode.pmViewDesc;\n      if (desc) { for (var i = this.index; i < this.top.children.length; i++) {\n        if (this.top.children[i] == desc) { return i }\n      } }\n      return -1\n    }\n    domNode = parent;\n  }\n};\n\n// : (Node, [Decoration], DecorationSource, EditorView, Fragment, number) → bool\n// Try to update the next node, if any, to the given data. Checks\n// pre-matches to avoid overwriting nodes that could still be used.\nViewTreeUpdater.prototype.updateNextNode = function updateNextNode (node, outerDeco, innerDeco, view, index) {\n  for (var i = this.index; i < this.top.children.length; i++) {\n    var next = this.top.children[i];\n    if (next instanceof NodeViewDesc) {\n      var preMatch = this.preMatch.matched.get(next);\n      if (preMatch != null && preMatch != index) { return false }\n      var nextDOM = next.dom;\n\n      // Can't update if nextDOM is or contains this.lock, except if\n      // it's a text node whose content already matches the new text\n      // and whose decorations match the new ones.\n      var locked = this.lock && (nextDOM == this.lock || nextDOM.nodeType == 1 && nextDOM.contains(this.lock.parentNode)) &&\n          !(node.isText && next.node && next.node.isText && next.nodeDOM.nodeValue == node.text &&\n            next.dirty != NODE_DIRTY && sameOuterDeco(outerDeco, next.outerDeco));\n      if (!locked && next.update(node, outerDeco, innerDeco, view)) {\n        this.destroyBetween(this.index, i);\n        if (next.dom != nextDOM) { this.changed = true; }\n        this.index++;\n        return true\n      }\n      break\n    }\n  }\n  return false\n};\n\n// : (Node, [Decoration], DecorationSource, EditorView)\n// Insert the node as a newly created node desc.\nViewTreeUpdater.prototype.addNode = function addNode (node, outerDeco, innerDeco, view, pos) {\n  this.top.children.splice(this.index++, 0, NodeViewDesc.create(this.top, node, outerDeco, innerDeco, view, pos));\n  this.changed = true;\n};\n\nViewTreeUpdater.prototype.placeWidget = function placeWidget (widget, view, pos) {\n  var next = this.index < this.top.children.length ? this.top.children[this.index] : null;\n  if (next && next.matchesWidget(widget) && (widget == next.widget || !next.widget.type.toDOM.parentNode)) {\n    this.index++;\n  } else {\n    var desc = new WidgetViewDesc(this.top, widget, view, pos);\n    this.top.children.splice(this.index++, 0, desc);\n    this.changed = true;\n  }\n};\n\n// Make sure a textblock looks and behaves correctly in\n// contentEditable.\nViewTreeUpdater.prototype.addTextblockHacks = function addTextblockHacks () {\n  var lastChild = this.top.children[this.index - 1];\n  while (lastChild instanceof MarkViewDesc) { lastChild = lastChild.children[lastChild.children.length - 1]; }\n\n  if (!lastChild || // Empty textblock\n      !(lastChild instanceof TextViewDesc) ||\n      /\\n$/.test(lastChild.node.text)) {\n    // Avoid bugs in Safari's cursor drawing (#1165) and Chrome's mouse selection (#1152)\n    if ((result.safari || result.chrome) && lastChild && lastChild.dom.contentEditable == \"false\")\n      { this.addHackNode(\"IMG\"); }\n    this.addHackNode(\"BR\");\n  }\n};\n\nViewTreeUpdater.prototype.addHackNode = function addHackNode (nodeName) {\n  if (this.index < this.top.children.length && this.top.children[this.index].matchesHack(nodeName)) {\n    this.index++;\n  } else {\n    var dom = document.createElement(nodeName);\n    if (nodeName == \"IMG\") { dom.className = \"ProseMirror-separator\"; }\n    if (nodeName == \"BR\") { dom.className = \"ProseMirror-trailingBreak\"; }\n    this.top.children.splice(this.index++, 0, new TrailingHackViewDesc(this.top, nothing, dom, null));\n    this.changed = true;\n  }\n};\n\n// : (Fragment, [ViewDesc]) → {index: number, matched: Map<ViewDesc, number>, matches: ViewDesc[]}\n// Iterate from the end of the fragment and array of descs to find\n// directly matching ones, in order to avoid overeagerly reusing those\n// for other nodes. Returns the fragment index of the first node that\n// is part of the sequence of matched nodes at the end of the\n// fragment.\nfunction preMatch(frag, parentDesc) {\n  var curDesc = parentDesc, descI = curDesc.children.length;\n  var fI = frag.childCount, matched = new Map, matches = [];\n  outer: while (fI > 0) {\n    var desc = (void 0);\n    for (;;) {\n      if (descI) {\n        var next = curDesc.children[descI - 1];\n        if (next instanceof MarkViewDesc) {\n          curDesc = next;\n          descI = next.children.length;\n        } else {\n          desc = next;\n          descI--;\n          break\n        }\n      } else if (curDesc == parentDesc) {\n        break outer\n      } else {\n        // FIXME\n        descI = curDesc.parent.children.indexOf(curDesc);\n        curDesc = curDesc.parent;\n      }\n    }\n    var node = desc.node;\n    if (!node) { continue }\n    if (node != frag.child(fI - 1)) { break }\n    --fI;\n    matched.set(desc, fI);\n    matches.push(desc);\n  }\n  return {index: fI, matched: matched, matches: matches.reverse()}\n}\n\nfunction compareSide(a, b) { return a.type.side - b.type.side }\n\n// : (ViewDesc, DecorationSource, (Decoration, number), (Node, [Decoration], DecorationSource, number))\n// This function abstracts iterating over the nodes and decorations in\n// a fragment. Calls `onNode` for each node, with its local and child\n// decorations. Splits text nodes when there is a decoration starting\n// or ending inside of them. Calls `onWidget` for each widget.\nfunction iterDeco(parent, deco, onWidget, onNode) {\n  var locals = deco.locals(parent), offset = 0;\n  // Simple, cheap variant for when there are no local decorations\n  if (locals.length == 0) {\n    for (var i = 0; i < parent.childCount; i++) {\n      var child = parent.child(i);\n      onNode(child, locals, deco.forChild(offset, child), i);\n      offset += child.nodeSize;\n    }\n    return\n  }\n\n  var decoIndex = 0, active = [], restNode = null;\n  for (var parentIndex = 0;;) {\n    if (decoIndex < locals.length && locals[decoIndex].to == offset) {\n      var widget = locals[decoIndex++], widgets = (void 0);\n      while (decoIndex < locals.length && locals[decoIndex].to == offset)\n        { (widgets || (widgets = [widget])).push(locals[decoIndex++]); }\n      if (widgets) {\n        widgets.sort(compareSide);\n        for (var i$1 = 0; i$1 < widgets.length; i$1++) { onWidget(widgets[i$1], parentIndex, !!restNode); }\n      } else {\n        onWidget(widget, parentIndex, !!restNode);\n      }\n    }\n\n    var child$1 = (void 0), index = (void 0);\n    if (restNode) {\n      index = -1;\n      child$1 = restNode;\n      restNode = null;\n    } else if (parentIndex < parent.childCount) {\n      index = parentIndex;\n      child$1 = parent.child(parentIndex++);\n    } else {\n      break\n    }\n\n    for (var i$2 = 0; i$2 < active.length; i$2++) { if (active[i$2].to <= offset) { active.splice(i$2--, 1); } }\n    while (decoIndex < locals.length && locals[decoIndex].from <= offset && locals[decoIndex].to > offset)\n      { active.push(locals[decoIndex++]); }\n\n    var end = offset + child$1.nodeSize;\n    if (child$1.isText) {\n      var cutAt = end;\n      if (decoIndex < locals.length && locals[decoIndex].from < cutAt) { cutAt = locals[decoIndex].from; }\n      for (var i$3 = 0; i$3 < active.length; i$3++) { if (active[i$3].to < cutAt) { cutAt = active[i$3].to; } }\n      if (cutAt < end) {\n        restNode = child$1.cut(cutAt - offset);\n        child$1 = child$1.cut(0, cutAt - offset);\n        end = cutAt;\n        index = -1;\n      }\n    }\n\n    var outerDeco = !active.length ? nothing\n        : child$1.isInline && !child$1.isLeaf ? active.filter(function (d) { return !d.inline; })\n        : active.slice();\n    onNode(child$1, outerDeco, deco.forChild(offset, child$1), index);\n    offset = end;\n  }\n}\n\n// List markers in Mobile Safari will mysteriously disappear\n// sometimes. This works around that.\nfunction iosHacks(dom) {\n  if (dom.nodeName == \"UL\" || dom.nodeName == \"OL\") {\n    var oldCSS = dom.style.cssText;\n    dom.style.cssText = oldCSS + \"; list-style: square !important\";\n    window.getComputedStyle(dom).listStyle;\n    dom.style.cssText = oldCSS;\n  }\n}\n\nfunction nearbyTextNode(node, offset) {\n  for (;;) {\n    if (node.nodeType == 3) { return node }\n    if (node.nodeType == 1 && offset > 0) {\n      if (node.childNodes.length > offset && node.childNodes[offset].nodeType == 3)\n        { return node.childNodes[offset] }\n      node = node.childNodes[offset - 1];\n      offset = nodeSize(node);\n    } else if (node.nodeType == 1 && offset < node.childNodes.length) {\n      node = node.childNodes[offset];\n      offset = 0;\n    } else {\n      return null\n    }\n  }\n}\n\n// Find a piece of text in an inline fragment, overlapping from-to\nfunction findTextInFragment(frag, text, from, to) {\n  for (var i = 0, pos = 0; i < frag.childCount && pos <= to;) {\n    var child = frag.child(i++), childStart = pos;\n    pos += child.nodeSize;\n    if (!child.isText) { continue }\n    var str = child.text;\n    while (i < frag.childCount) {\n      var next = frag.child(i++);\n      pos += next.nodeSize;\n      if (!next.isText) { break }\n      str += next.text;\n    }\n    if (pos >= from && childStart < to) {\n      var found = str.lastIndexOf(text, to - childStart - 1);\n      if (found >= 0 && found + text.length + childStart >= from)\n        { return childStart + found }\n    }\n  }\n  return -1\n}\n\n// Replace range from-to in an array of view descs with replacement\n// (may be null to just delete). This goes very much against the grain\n// of the rest of this code, which tends to create nodes with the\n// right shape in one go, rather than messing with them after\n// creation, but is necessary in the composition hack.\nfunction replaceNodes(nodes, from, to, view, replacement) {\n  var result = [];\n  for (var i = 0, off = 0; i < nodes.length; i++) {\n    var child = nodes[i], start = off, end = off += child.size;\n    if (start >= to || end <= from) {\n      result.push(child);\n    } else {\n      if (start < from) { result.push(child.slice(0, from - start, view)); }\n      if (replacement) {\n        result.push(replacement);\n        replacement = null;\n      }\n      if (end > to) { result.push(child.slice(to - start, child.size, view)); }\n    }\n  }\n  return result\n}\n\nfunction selectionFromDOM(view, origin) {\n  var domSel = view.root.getSelection(), doc = view.state.doc;\n  if (!domSel.focusNode) { return null }\n  var nearestDesc = view.docView.nearestDesc(domSel.focusNode), inWidget = nearestDesc && nearestDesc.size == 0;\n  var head = view.docView.posFromDOM(domSel.focusNode, domSel.focusOffset);\n  if (head < 0) { return null }\n  var $head = doc.resolve(head), $anchor, selection;\n  if (selectionCollapsed(domSel)) {\n    $anchor = $head;\n    while (nearestDesc && !nearestDesc.node) { nearestDesc = nearestDesc.parent; }\n    if (nearestDesc && nearestDesc.node.isAtom && NodeSelection.isSelectable(nearestDesc.node) && nearestDesc.parent\n        && !(nearestDesc.node.isInline && isOnEdge(domSel.focusNode, domSel.focusOffset, nearestDesc.dom))) {\n      var pos = nearestDesc.posBefore;\n      selection = new NodeSelection(head == pos ? $head : doc.resolve(pos));\n    }\n  } else {\n    var anchor = view.docView.posFromDOM(domSel.anchorNode, domSel.anchorOffset);\n    if (anchor < 0) { return null }\n    $anchor = doc.resolve(anchor);\n  }\n\n  if (!selection) {\n    var bias = origin == \"pointer\" || (view.state.selection.head < $head.pos && !inWidget) ? 1 : -1;\n    selection = selectionBetween(view, $anchor, $head, bias);\n  }\n  return selection\n}\n\nfunction editorOwnsSelection(view) {\n  return view.editable ? view.hasFocus() :\n    hasSelection(view) && document.activeElement && document.activeElement.contains(view.dom)\n}\n\nfunction selectionToDOM(view, force) {\n  var sel = view.state.selection;\n  syncNodeSelection(view, sel);\n\n  if (!editorOwnsSelection(view)) { return }\n\n  // The delayed drag selection causes issues with Cell Selections\n  // in Safari. And the drag selection delay is to workarond issues\n  // which only present in Chrome.\n  if (!force && view.mouseDown && view.mouseDown.allowDefault && result.chrome) {\n    var domSel = view.root.getSelection(), curSel = view.domObserver.currentSelection;\n    if (domSel.anchorNode && isEquivalentPosition(domSel.anchorNode, domSel.anchorOffset,\n                                                  curSel.anchorNode, curSel.anchorOffset)) {\n      view.mouseDown.delayedSelectionSync = true;\n      view.domObserver.setCurSelection();\n      return\n    }\n  }\n\n  view.domObserver.disconnectSelection();\n\n  if (view.cursorWrapper) {\n    selectCursorWrapper(view);\n  } else {\n    var anchor = sel.anchor;\n    var head = sel.head;\n    var resetEditableFrom, resetEditableTo;\n    if (brokenSelectBetweenUneditable && !(sel instanceof TextSelection)) {\n      if (!sel.$from.parent.inlineContent)\n        { resetEditableFrom = temporarilyEditableNear(view, sel.from); }\n      if (!sel.empty && !sel.$from.parent.inlineContent)\n        { resetEditableTo = temporarilyEditableNear(view, sel.to); }\n    }\n    view.docView.setSelection(anchor, head, view.root, force);\n    if (brokenSelectBetweenUneditable) {\n      if (resetEditableFrom) { resetEditable(resetEditableFrom); }\n      if (resetEditableTo) { resetEditable(resetEditableTo); }\n    }\n    if (sel.visible) {\n      view.dom.classList.remove(\"ProseMirror-hideselection\");\n    } else {\n      view.dom.classList.add(\"ProseMirror-hideselection\");\n      if (\"onselectionchange\" in document) { removeClassOnSelectionChange(view); }\n    }\n  }\n\n  view.domObserver.setCurSelection();\n  view.domObserver.connectSelection();\n}\n\n// Kludge to work around Webkit not allowing a selection to start/end\n// between non-editable block nodes. We briefly make something\n// editable, set the selection, then set it uneditable again.\n\nvar brokenSelectBetweenUneditable = result.safari || result.chrome && result.chrome_version < 63;\n\nfunction temporarilyEditableNear(view, pos) {\n  var ref = view.docView.domFromPos(pos, 0);\n  var node = ref.node;\n  var offset = ref.offset;\n  var after = offset < node.childNodes.length ? node.childNodes[offset] : null;\n  var before = offset ? node.childNodes[offset - 1] : null;\n  if (result.safari && after && after.contentEditable == \"false\") { return setEditable(after) }\n  if ((!after || after.contentEditable == \"false\") && (!before || before.contentEditable == \"false\")) {\n    if (after) { return setEditable(after) }\n    else if (before) { return setEditable(before) }\n  }\n}\n\nfunction setEditable(element) {\n  element.contentEditable = \"true\";\n  if (result.safari && element.draggable) { element.draggable = false; element.wasDraggable = true; }\n  return element\n}\n\nfunction resetEditable(element) {\n  element.contentEditable = \"false\";\n  if (element.wasDraggable) { element.draggable = true; element.wasDraggable = null; }\n}\n\nfunction removeClassOnSelectionChange(view) {\n  var doc = view.dom.ownerDocument;\n  doc.removeEventListener(\"selectionchange\", view.hideSelectionGuard);\n  var domSel = view.root.getSelection();\n  var node = domSel.anchorNode, offset = domSel.anchorOffset;\n  doc.addEventListener(\"selectionchange\", view.hideSelectionGuard = function () {\n    if (domSel.anchorNode != node || domSel.anchorOffset != offset) {\n      doc.removeEventListener(\"selectionchange\", view.hideSelectionGuard);\n      setTimeout(function () {\n        if (!editorOwnsSelection(view) || view.state.selection.visible)\n          { view.dom.classList.remove(\"ProseMirror-hideselection\"); }\n      }, 20);\n    }\n  });\n}\n\nfunction selectCursorWrapper(view) {\n  var domSel = view.root.getSelection(), range = document.createRange();\n  var node = view.cursorWrapper.dom, img = node.nodeName == \"IMG\";\n  if (img) { range.setEnd(node.parentNode, domIndex(node) + 1); }\n  else { range.setEnd(node, 0); }\n  range.collapse(false);\n  domSel.removeAllRanges();\n  domSel.addRange(range);\n  // Kludge to kill 'control selection' in IE11 when selecting an\n  // invisible cursor wrapper, since that would result in those weird\n  // resize handles and a selection that considers the absolutely\n  // positioned wrapper, rather than the root editable node, the\n  // focused element.\n  if (!img && !view.state.selection.visible && result.ie && result.ie_version <= 11) {\n    node.disabled = true;\n    node.disabled = false;\n  }\n}\n\nfunction syncNodeSelection(view, sel) {\n  if (sel instanceof NodeSelection) {\n    var desc = view.docView.descAt(sel.from);\n    if (desc != view.lastSelectedViewDesc) {\n      clearNodeSelection(view);\n      if (desc) { desc.selectNode(); }\n      view.lastSelectedViewDesc = desc;\n    }\n  } else {\n    clearNodeSelection(view);\n  }\n}\n\n// Clear all DOM statefulness of the last node selection.\nfunction clearNodeSelection(view) {\n  if (view.lastSelectedViewDesc) {\n    if (view.lastSelectedViewDesc.parent)\n      { view.lastSelectedViewDesc.deselectNode(); }\n    view.lastSelectedViewDesc = null;\n  }\n}\n\nfunction selectionBetween(view, $anchor, $head, bias) {\n  return view.someProp(\"createSelectionBetween\", function (f) { return f(view, $anchor, $head); })\n    || TextSelection.between($anchor, $head, bias)\n}\n\nfunction hasFocusAndSelection(view) {\n  if (view.editable && view.root.activeElement != view.dom) { return false }\n  return hasSelection(view)\n}\n\nfunction hasSelection(view) {\n  var sel = view.root.getSelection();\n  if (!sel.anchorNode) { return false }\n  try {\n    // Firefox will raise 'permission denied' errors when accessing\n    // properties of `sel.anchorNode` when it's in a generated CSS\n    // element.\n    return view.dom.contains(sel.anchorNode.nodeType == 3 ? sel.anchorNode.parentNode : sel.anchorNode) &&\n      (view.editable || view.dom.contains(sel.focusNode.nodeType == 3 ? sel.focusNode.parentNode : sel.focusNode))\n  } catch(_) {\n    return false\n  }\n}\n\nfunction anchorInRightPlace(view) {\n  var anchorDOM = view.docView.domFromPos(view.state.selection.anchor, 0);\n  var domSel = view.root.getSelection();\n  return isEquivalentPosition(anchorDOM.node, anchorDOM.offset, domSel.anchorNode, domSel.anchorOffset)\n}\n\nfunction moveSelectionBlock(state, dir) {\n  var ref = state.selection;\n  var $anchor = ref.$anchor;\n  var $head = ref.$head;\n  var $side = dir > 0 ? $anchor.max($head) : $anchor.min($head);\n  var $start = !$side.parent.inlineContent ? $side : $side.depth ? state.doc.resolve(dir > 0 ? $side.after() : $side.before()) : null;\n  return $start && Selection.findFrom($start, dir)\n}\n\nfunction apply(view, sel) {\n  view.dispatch(view.state.tr.setSelection(sel).scrollIntoView());\n  return true\n}\n\nfunction selectHorizontally(view, dir, mods) {\n  var sel = view.state.selection;\n  if (sel instanceof TextSelection) {\n    if (!sel.empty || mods.indexOf(\"s\") > -1) {\n      return false\n    } else if (view.endOfTextblock(dir > 0 ? \"right\" : \"left\")) {\n      var next = moveSelectionBlock(view.state, dir);\n      if (next && (next instanceof NodeSelection)) { return apply(view, next) }\n      return false\n    } else if (!(result.mac && mods.indexOf(\"m\") > -1)) {\n      var $head = sel.$head, node = $head.textOffset ? null : dir < 0 ? $head.nodeBefore : $head.nodeAfter, desc;\n      if (!node || node.isText) { return false }\n      var nodePos = dir < 0 ? $head.pos - node.nodeSize : $head.pos;\n      if (!(node.isAtom || (desc = view.docView.descAt(nodePos)) && !desc.contentDOM)) { return false }\n      if (NodeSelection.isSelectable(node)) {\n        return apply(view, new NodeSelection(dir < 0 ? view.state.doc.resolve($head.pos - node.nodeSize) : $head))\n      } else if (result.webkit) {\n        // Chrome and Safari will introduce extra pointless cursor\n        // positions around inline uneditable nodes, so we have to\n        // take over and move the cursor past them (#937)\n        return apply(view, new TextSelection(view.state.doc.resolve(dir < 0 ? nodePos : nodePos + node.nodeSize)))\n      } else {\n        return false\n      }\n    }\n  } else if (sel instanceof NodeSelection && sel.node.isInline) {\n    return apply(view, new TextSelection(dir > 0 ? sel.$to : sel.$from))\n  } else {\n    var next$1 = moveSelectionBlock(view.state, dir);\n    if (next$1) { return apply(view, next$1) }\n    return false\n  }\n}\n\nfunction nodeLen(node) {\n  return node.nodeType == 3 ? node.nodeValue.length : node.childNodes.length\n}\n\nfunction isIgnorable(dom) {\n  var desc = dom.pmViewDesc;\n  return desc && desc.size == 0 && (dom.nextSibling || dom.nodeName != \"BR\")\n}\n\n// Make sure the cursor isn't directly after one or more ignored\n// nodes, which will confuse the browser's cursor motion logic.\nfunction skipIgnoredNodesLeft(view) {\n  var sel = view.root.getSelection();\n  var node = sel.focusNode, offset = sel.focusOffset;\n  if (!node) { return }\n  var moveNode, moveOffset, force = false;\n  // Gecko will do odd things when the selection is directly in front\n  // of a non-editable node, so in that case, move it into the next\n  // node if possible. Issue prosemirror/prosemirror#832.\n  if (result.gecko && node.nodeType == 1 && offset < nodeLen(node) && isIgnorable(node.childNodes[offset])) { force = true; }\n  for (;;) {\n    if (offset > 0) {\n      if (node.nodeType != 1) {\n        break\n      } else {\n        var before = node.childNodes[offset - 1];\n        if (isIgnorable(before)) {\n          moveNode = node;\n          moveOffset = --offset;\n        } else if (before.nodeType == 3) {\n          node = before;\n          offset = node.nodeValue.length;\n        } else { break }\n      }\n    } else if (isBlockNode(node)) {\n      break\n    } else {\n      var prev = node.previousSibling;\n      while (prev && isIgnorable(prev)) {\n        moveNode = node.parentNode;\n        moveOffset = domIndex(prev);\n        prev = prev.previousSibling;\n      }\n      if (!prev) {\n        node = node.parentNode;\n        if (node == view.dom) { break }\n        offset = 0;\n      } else {\n        node = prev;\n        offset = nodeLen(node);\n      }\n    }\n  }\n  if (force) { setSelFocus(view, sel, node, offset); }\n  else if (moveNode) { setSelFocus(view, sel, moveNode, moveOffset); }\n}\n\n// Make sure the cursor isn't directly before one or more ignored\n// nodes.\nfunction skipIgnoredNodesRight(view) {\n  var sel = view.root.getSelection();\n  var node = sel.focusNode, offset = sel.focusOffset;\n  if (!node) { return }\n  var len = nodeLen(node);\n  var moveNode, moveOffset;\n  for (;;) {\n    if (offset < len) {\n      if (node.nodeType != 1) { break }\n      var after = node.childNodes[offset];\n      if (isIgnorable(after)) {\n        moveNode = node;\n        moveOffset = ++offset;\n      }\n      else { break }\n    } else if (isBlockNode(node)) {\n      break\n    } else {\n      var next = node.nextSibling;\n      while (next && isIgnorable(next)) {\n        moveNode = next.parentNode;\n        moveOffset = domIndex(next) + 1;\n        next = next.nextSibling;\n      }\n      if (!next) {\n        node = node.parentNode;\n        if (node == view.dom) { break }\n        offset = len = 0;\n      } else {\n        node = next;\n        offset = 0;\n        len = nodeLen(node);\n      }\n    }\n  }\n  if (moveNode) { setSelFocus(view, sel, moveNode, moveOffset); }\n}\n\nfunction isBlockNode(dom) {\n  var desc = dom.pmViewDesc;\n  return desc && desc.node && desc.node.isBlock\n}\n\nfunction setSelFocus(view, sel, node, offset) {\n  if (selectionCollapsed(sel)) {\n    var range = document.createRange();\n    range.setEnd(node, offset);\n    range.setStart(node, offset);\n    sel.removeAllRanges();\n    sel.addRange(range);\n  } else if (sel.extend) {\n    sel.extend(node, offset);\n  }\n  view.domObserver.setCurSelection();\n  var state = view.state;\n  // If no state update ends up happening, reset the selection.\n  setTimeout(function () {\n    if (view.state == state) { selectionToDOM(view); }\n  }, 50);\n}\n\n// : (EditorState, number)\n// Check whether vertical selection motion would involve node\n// selections. If so, apply it (if not, the result is left to the\n// browser)\nfunction selectVertically(view, dir, mods) {\n  var sel = view.state.selection;\n  if (sel instanceof TextSelection && !sel.empty || mods.indexOf(\"s\") > -1) { return false }\n  if (result.mac && mods.indexOf(\"m\") > -1) { return false }\n  var $from = sel.$from;\n  var $to = sel.$to;\n\n  if (!$from.parent.inlineContent || view.endOfTextblock(dir < 0 ? \"up\" : \"down\")) {\n    var next = moveSelectionBlock(view.state, dir);\n    if (next && (next instanceof NodeSelection))\n      { return apply(view, next) }\n  }\n  if (!$from.parent.inlineContent) {\n    var side = dir < 0 ? $from : $to;\n    var beyond = sel instanceof AllSelection ? Selection.near(side, dir) : Selection.findFrom(side, dir);\n    return beyond ? apply(view, beyond) : false\n  }\n  return false\n}\n\nfunction stopNativeHorizontalDelete(view, dir) {\n  if (!(view.state.selection instanceof TextSelection)) { return true }\n  var ref = view.state.selection;\n  var $head = ref.$head;\n  var $anchor = ref.$anchor;\n  var empty = ref.empty;\n  if (!$head.sameParent($anchor)) { return true }\n  if (!empty) { return false }\n  if (view.endOfTextblock(dir > 0 ? \"forward\" : \"backward\")) { return true }\n  var nextNode = !$head.textOffset && (dir < 0 ? $head.nodeBefore : $head.nodeAfter);\n  if (nextNode && !nextNode.isText) {\n    var tr = view.state.tr;\n    if (dir < 0) { tr.delete($head.pos - nextNode.nodeSize, $head.pos); }\n    else { tr.delete($head.pos, $head.pos + nextNode.nodeSize); }\n    view.dispatch(tr);\n    return true\n  }\n  return false\n}\n\nfunction switchEditable(view, node, state) {\n  view.domObserver.stop();\n  node.contentEditable = state;\n  view.domObserver.start();\n}\n\n// Issue #867 / #1090 / https://bugs.chromium.org/p/chromium/issues/detail?id=903821\n// In which Safari (and at some point in the past, Chrome) does really\n// wrong things when the down arrow is pressed when the cursor is\n// directly at the start of a textblock and has an uneditable node\n// after it\nfunction safariDownArrowBug(view) {\n  if (!result.safari || view.state.selection.$head.parentOffset > 0) { return }\n  var ref = view.root.getSelection();\n  var focusNode = ref.focusNode;\n  var focusOffset = ref.focusOffset;\n  if (focusNode && focusNode.nodeType == 1 && focusOffset == 0 &&\n      focusNode.firstChild && focusNode.firstChild.contentEditable == \"false\") {\n    var child = focusNode.firstChild;\n    switchEditable(view, child, true);\n    setTimeout(function () { return switchEditable(view, child, false); }, 20);\n  }\n}\n\n// A backdrop key mapping used to make sure we always suppress keys\n// that have a dangerous default effect, even if the commands they are\n// bound to return false, and to make sure that cursor-motion keys\n// find a cursor (as opposed to a node selection) when pressed. For\n// cursor-motion keys, the code in the handlers also takes care of\n// block selections.\n\nfunction getMods(event) {\n  var result = \"\";\n  if (event.ctrlKey) { result += \"c\"; }\n  if (event.metaKey) { result += \"m\"; }\n  if (event.altKey) { result += \"a\"; }\n  if (event.shiftKey) { result += \"s\"; }\n  return result\n}\n\nfunction captureKeyDown(view, event) {\n  var code = event.keyCode, mods = getMods(event);\n  if (code == 8 || (result.mac && code == 72 && mods == \"c\")) { // Backspace, Ctrl-h on Mac\n    return stopNativeHorizontalDelete(view, -1) || skipIgnoredNodesLeft(view)\n  } else if (code == 46 || (result.mac && code == 68 && mods == \"c\")) { // Delete, Ctrl-d on Mac\n    return stopNativeHorizontalDelete(view, 1) || skipIgnoredNodesRight(view)\n  } else if (code == 13 || code == 27) { // Enter, Esc\n    return true\n  } else if (code == 37) { // Left arrow\n    return selectHorizontally(view, -1, mods) || skipIgnoredNodesLeft(view)\n  } else if (code == 39) { // Right arrow\n    return selectHorizontally(view, 1, mods) || skipIgnoredNodesRight(view)\n  } else if (code == 38) { // Up arrow\n    return selectVertically(view, -1, mods) || skipIgnoredNodesLeft(view)\n  } else if (code == 40) { // Down arrow\n    return safariDownArrowBug(view) || selectVertically(view, 1, mods) || skipIgnoredNodesRight(view)\n  } else if (mods == (result.mac ? \"m\" : \"c\") &&\n             (code == 66 || code == 73 || code == 89 || code == 90)) { // Mod-[biyz]\n    return true\n  }\n  return false\n}\n\n// Note that all referencing and parsing is done with the\n// start-of-operation selection and document, since that's the one\n// that the DOM represents. If any changes came in in the meantime,\n// the modification is mapped over those before it is applied, in\n// readDOMChange.\n\nfunction parseBetween(view, from_, to_) {\n  var ref = view.docView.parseRange(from_, to_);\n  var parent = ref.node;\n  var fromOffset = ref.fromOffset;\n  var toOffset = ref.toOffset;\n  var from = ref.from;\n  var to = ref.to;\n\n  var domSel = view.root.getSelection(), find = null, anchor = domSel.anchorNode;\n  if (anchor && view.dom.contains(anchor.nodeType == 1 ? anchor : anchor.parentNode)) {\n    find = [{node: anchor, offset: domSel.anchorOffset}];\n    if (!selectionCollapsed(domSel))\n      { find.push({node: domSel.focusNode, offset: domSel.focusOffset}); }\n  }\n  // Work around issue in Chrome where backspacing sometimes replaces\n  // the deleted content with a random BR node (issues #799, #831)\n  if (result.chrome && view.lastKeyCode === 8) {\n    for (var off = toOffset; off > fromOffset; off--) {\n      var node = parent.childNodes[off - 1], desc = node.pmViewDesc;\n      if (node.nodeName == \"BR\" && !desc) { toOffset = off; break }\n      if (!desc || desc.size) { break }\n    }\n  }\n  var startDoc = view.state.doc;\n  var parser = view.someProp(\"domParser\") || DOMParser.fromSchema(view.state.schema);\n  var $from = startDoc.resolve(from);\n\n  var sel = null, doc = parser.parse(parent, {\n    topNode: $from.parent,\n    topMatch: $from.parent.contentMatchAt($from.index()),\n    topOpen: true,\n    from: fromOffset,\n    to: toOffset,\n    preserveWhitespace: $from.parent.type.whitespace == \"pre\" ? \"full\" : true,\n    editableContent: true,\n    findPositions: find,\n    ruleFromNode: ruleFromNode,\n    context: $from\n  });\n  if (find && find[0].pos != null) {\n    var anchor$1 = find[0].pos, head = find[1] && find[1].pos;\n    if (head == null) { head = anchor$1; }\n    sel = {anchor: anchor$1 + from, head: head + from};\n  }\n  return {doc: doc, sel: sel, from: from, to: to}\n}\n\nfunction ruleFromNode(dom) {\n  var desc = dom.pmViewDesc;\n  if (desc) {\n    return desc.parseRule()\n  } else if (dom.nodeName == \"BR\" && dom.parentNode) {\n    // Safari replaces the list item or table cell with a BR\n    // directly in the list node (?!) if you delete the last\n    // character in a list item or table cell (#708, #862)\n    if (result.safari && /^(ul|ol)$/i.test(dom.parentNode.nodeName)) {\n      var skip = document.createElement(\"div\");\n      skip.appendChild(document.createElement(\"li\"));\n      return {skip: skip}\n    } else if (dom.parentNode.lastChild == dom || result.safari && /^(tr|table)$/i.test(dom.parentNode.nodeName)) {\n      return {ignore: true}\n    }\n  } else if (dom.nodeName == \"IMG\" && dom.getAttribute(\"mark-placeholder\")) {\n    return {ignore: true}\n  }\n}\n\nfunction readDOMChange(view, from, to, typeOver, addedNodes) {\n  if (from < 0) {\n    var origin = view.lastSelectionTime > Date.now() - 50 ? view.lastSelectionOrigin : null;\n    var newSel = selectionFromDOM(view, origin);\n    if (newSel && !view.state.selection.eq(newSel)) {\n      var tr$1 = view.state.tr.setSelection(newSel);\n      if (origin == \"pointer\") { tr$1.setMeta(\"pointer\", true); }\n      else if (origin == \"key\") { tr$1.scrollIntoView(); }\n      view.dispatch(tr$1);\n    }\n    return\n  }\n\n  var $before = view.state.doc.resolve(from);\n  var shared = $before.sharedDepth(to);\n  from = $before.before(shared + 1);\n  to = view.state.doc.resolve(to).after(shared + 1);\n\n  var sel = view.state.selection;\n  var parse = parseBetween(view, from, to);\n  // Chrome sometimes leaves the cursor before the inserted text when\n  // composing after a cursor wrapper. This moves it forward.\n  if (result.chrome && view.cursorWrapper && parse.sel && parse.sel.anchor == view.cursorWrapper.deco.from) {\n    var text = view.cursorWrapper.deco.type.toDOM.nextSibling;\n    var size = text && text.nodeValue ? text.nodeValue.length : 1;\n    parse.sel = {anchor: parse.sel.anchor + size, head: parse.sel.anchor + size};\n  }\n\n  var doc = view.state.doc, compare = doc.slice(parse.from, parse.to);\n  var preferredPos, preferredSide;\n  // Prefer anchoring to end when Backspace is pressed\n  if (view.lastKeyCode === 8 && Date.now() - 100 < view.lastKeyCodeTime) {\n    preferredPos = view.state.selection.to;\n    preferredSide = \"end\";\n  } else {\n    preferredPos = view.state.selection.from;\n    preferredSide = \"start\";\n  }\n  view.lastKeyCode = null;\n\n  var change = findDiff(compare.content, parse.doc.content, parse.from, preferredPos, preferredSide);\n  if (!change) {\n    if (typeOver && sel instanceof TextSelection && !sel.empty && sel.$head.sameParent(sel.$anchor) &&\n        !view.composing && !(parse.sel && parse.sel.anchor != parse.sel.head)) {\n      change = {start: sel.from, endA: sel.to, endB: sel.to};\n    } else if ((result.ios && view.lastIOSEnter > Date.now() - 225 || result.android) &&\n               addedNodes.some(function (n) { return n.nodeName == \"DIV\" || n.nodeName == \"P\"; }) &&\n               view.someProp(\"handleKeyDown\", function (f) { return f(view, keyEvent(13, \"Enter\")); })) {\n      view.lastIOSEnter = 0;\n      return\n    } else {\n      if (parse.sel) {\n        var sel$1 = resolveSelection(view, view.state.doc, parse.sel);\n        if (sel$1 && !sel$1.eq(view.state.selection)) { view.dispatch(view.state.tr.setSelection(sel$1)); }\n      }\n      return\n    }\n  }\n  view.domChangeCount++;\n  // Handle the case where overwriting a selection by typing matches\n  // the start or end of the selected content, creating a change\n  // that's smaller than what was actually overwritten.\n  if (view.state.selection.from < view.state.selection.to &&\n      change.start == change.endB &&\n      view.state.selection instanceof TextSelection) {\n    if (change.start > view.state.selection.from && change.start <= view.state.selection.from + 2) {\n      change.start = view.state.selection.from;\n    } else if (change.endA < view.state.selection.to && change.endA >= view.state.selection.to - 2) {\n      change.endB += (view.state.selection.to - change.endA);\n      change.endA = view.state.selection.to;\n    }\n  }\n\n  // IE11 will insert a non-breaking space _ahead_ of the space after\n  // the cursor space when adding a space before another space. When\n  // that happened, adjust the change to cover the space instead.\n  if (result.ie && result.ie_version <= 11 && change.endB == change.start + 1 &&\n      change.endA == change.start && change.start > parse.from &&\n      parse.doc.textBetween(change.start - parse.from - 1, change.start - parse.from + 1) == \" \\u00a0\") {\n    change.start--;\n    change.endA--;\n    change.endB--;\n  }\n\n  var $from = parse.doc.resolveNoCache(change.start - parse.from);\n  var $to = parse.doc.resolveNoCache(change.endB - parse.from);\n  var inlineChange = $from.sameParent($to) && $from.parent.inlineContent;\n  var nextSel;\n  // If this looks like the effect of pressing Enter (or was recorded\n  // as being an iOS enter press), just dispatch an Enter key instead.\n  if (((result.ios && view.lastIOSEnter > Date.now() - 225 &&\n        (!inlineChange || addedNodes.some(function (n) { return n.nodeName == \"DIV\" || n.nodeName == \"P\"; }))) ||\n       (!inlineChange && $from.pos < parse.doc.content.size &&\n        (nextSel = Selection.findFrom(parse.doc.resolve($from.pos + 1), 1, true)) &&\n        nextSel.head == $to.pos)) &&\n      view.someProp(\"handleKeyDown\", function (f) { return f(view, keyEvent(13, \"Enter\")); })) {\n    view.lastIOSEnter = 0;\n    return\n  }\n  // Same for backspace\n  if (view.state.selection.anchor > change.start &&\n      looksLikeJoin(doc, change.start, change.endA, $from, $to) &&\n      view.someProp(\"handleKeyDown\", function (f) { return f(view, keyEvent(8, \"Backspace\")); })) {\n    if (result.android && result.chrome) { view.domObserver.suppressSelectionUpdates(); } // #820\n    return\n  }\n\n  // Chrome Android will occasionally, during composition, delete the\n  // entire composition and then immediately insert it again. This is\n  // used to detect that situation.\n  if (result.chrome && result.android && change.toB == change.from)\n    { view.lastAndroidDelete = Date.now(); }\n\n  // This tries to detect Android virtual keyboard\n  // enter-and-pick-suggestion action. That sometimes (see issue\n  // #1059) first fires a DOM mutation, before moving the selection to\n  // the newly created block. And then, because ProseMirror cleans up\n  // the DOM selection, it gives up moving the selection entirely,\n  // leaving the cursor in the wrong place. When that happens, we drop\n  // the new paragraph from the initial change, and fire a simulated\n  // enter key afterwards.\n  if (result.android && !inlineChange && $from.start() != $to.start() && $to.parentOffset == 0 && $from.depth == $to.depth &&\n      parse.sel && parse.sel.anchor == parse.sel.head && parse.sel.head == change.endA) {\n    change.endB -= 2;\n    $to = parse.doc.resolveNoCache(change.endB - parse.from);\n    setTimeout(function () {\n      view.someProp(\"handleKeyDown\", function (f) { return f(view, keyEvent(13, \"Enter\")); });\n    }, 20);\n  }\n\n  var chFrom = change.start, chTo = change.endA;\n\n  var tr, storedMarks, markChange, $from1;\n  if (inlineChange) {\n    if ($from.pos == $to.pos) { // Deletion\n      // IE11 sometimes weirdly moves the DOM selection around after\n      // backspacing out the first element in a textblock\n      if (result.ie && result.ie_version <= 11 && $from.parentOffset == 0) {\n        view.domObserver.suppressSelectionUpdates();\n        setTimeout(function () { return selectionToDOM(view); }, 20);\n      }\n      tr = view.state.tr.delete(chFrom, chTo);\n      storedMarks = doc.resolve(change.start).marksAcross(doc.resolve(change.endA));\n    } else if ( // Adding or removing a mark\n      change.endA == change.endB && ($from1 = doc.resolve(change.start)) &&\n      (markChange = isMarkChange($from.parent.content.cut($from.parentOffset, $to.parentOffset),\n                                 $from1.parent.content.cut($from1.parentOffset, change.endA - $from1.start())))\n    ) {\n      tr = view.state.tr;\n      if (markChange.type == \"add\") { tr.addMark(chFrom, chTo, markChange.mark); }\n      else { tr.removeMark(chFrom, chTo, markChange.mark); }\n    } else if ($from.parent.child($from.index()).isText && $from.index() == $to.index() - ($to.textOffset ? 0 : 1)) {\n      // Both positions in the same text node -- simply insert text\n      var text$1 = $from.parent.textBetween($from.parentOffset, $to.parentOffset);\n      if (view.someProp(\"handleTextInput\", function (f) { return f(view, chFrom, chTo, text$1); })) { return }\n      tr = view.state.tr.insertText(text$1, chFrom, chTo);\n    }\n  }\n\n  if (!tr)\n    { tr = view.state.tr.replace(chFrom, chTo, parse.doc.slice(change.start - parse.from, change.endB - parse.from)); }\n  if (parse.sel) {\n    var sel$2 = resolveSelection(view, tr.doc, parse.sel);\n    // Chrome Android will sometimes, during composition, report the\n    // selection in the wrong place. If it looks like that is\n    // happening, don't update the selection.\n    // Edge just doesn't move the cursor forward when you start typing\n    // in an empty block or between br nodes.\n    if (sel$2 && !(result.chrome && result.android && view.composing && sel$2.empty &&\n                 (change.start != change.endB || view.lastAndroidDelete < Date.now() - 100) &&\n                 (sel$2.head == chFrom || sel$2.head == tr.mapping.map(chTo) - 1) ||\n                 result.ie && sel$2.empty && sel$2.head == chFrom))\n      { tr.setSelection(sel$2); }\n  }\n  if (storedMarks) { tr.ensureMarks(storedMarks); }\n  view.dispatch(tr.scrollIntoView());\n}\n\nfunction resolveSelection(view, doc, parsedSel) {\n  if (Math.max(parsedSel.anchor, parsedSel.head) > doc.content.size) { return null }\n  return selectionBetween(view, doc.resolve(parsedSel.anchor), doc.resolve(parsedSel.head))\n}\n\n// : (Fragment, Fragment) → ?{mark: Mark, type: string}\n// Given two same-length, non-empty fragments of inline content,\n// determine whether the first could be created from the second by\n// removing or adding a single mark type.\nfunction isMarkChange(cur, prev) {\n  var curMarks = cur.firstChild.marks, prevMarks = prev.firstChild.marks;\n  var added = curMarks, removed = prevMarks, type, mark, update;\n  for (var i = 0; i < prevMarks.length; i++) { added = prevMarks[i].removeFromSet(added); }\n  for (var i$1 = 0; i$1 < curMarks.length; i$1++) { removed = curMarks[i$1].removeFromSet(removed); }\n  if (added.length == 1 && removed.length == 0) {\n    mark = added[0];\n    type = \"add\";\n    update = function (node) { return node.mark(mark.addToSet(node.marks)); };\n  } else if (added.length == 0 && removed.length == 1) {\n    mark = removed[0];\n    type = \"remove\";\n    update = function (node) { return node.mark(mark.removeFromSet(node.marks)); };\n  } else {\n    return null\n  }\n  var updated = [];\n  for (var i$2 = 0; i$2 < prev.childCount; i$2++) { updated.push(update(prev.child(i$2))); }\n  if (Fragment.from(updated).eq(cur)) { return {mark: mark, type: type} }\n}\n\nfunction looksLikeJoin(old, start, end, $newStart, $newEnd) {\n  if (!$newStart.parent.isTextblock ||\n      // The content must have shrunk\n      end - start <= $newEnd.pos - $newStart.pos ||\n      // newEnd must point directly at or after the end of the block that newStart points into\n      skipClosingAndOpening($newStart, true, false) < $newEnd.pos)\n    { return false }\n\n  var $start = old.resolve(start);\n  // Start must be at the end of a block\n  if ($start.parentOffset < $start.parent.content.size || !$start.parent.isTextblock)\n    { return false }\n  var $next = old.resolve(skipClosingAndOpening($start, true, true));\n  // The next textblock must start before end and end near it\n  if (!$next.parent.isTextblock || $next.pos > end ||\n      skipClosingAndOpening($next, true, false) < end)\n    { return false }\n\n  // The fragments after the join point must match\n  return $newStart.parent.content.cut($newStart.parentOffset).eq($next.parent.content)\n}\n\nfunction skipClosingAndOpening($pos, fromEnd, mayOpen) {\n  var depth = $pos.depth, end = fromEnd ? $pos.end() : $pos.pos;\n  while (depth > 0 && (fromEnd || $pos.indexAfter(depth) == $pos.node(depth).childCount)) {\n    depth--;\n    end++;\n    fromEnd = false;\n  }\n  if (mayOpen) {\n    var next = $pos.node(depth).maybeChild($pos.indexAfter(depth));\n    while (next && !next.isLeaf) {\n      next = next.firstChild;\n      end++;\n    }\n  }\n  return end\n}\n\nfunction findDiff(a, b, pos, preferredPos, preferredSide) {\n  var start = a.findDiffStart(b, pos);\n  if (start == null) { return null }\n  var ref = a.findDiffEnd(b, pos + a.size, pos + b.size);\n  var endA = ref.a;\n  var endB = ref.b;\n  if (preferredSide == \"end\") {\n    var adjust = Math.max(0, start - Math.min(endA, endB));\n    preferredPos -= endA + adjust - start;\n  }\n  if (endA < start && a.size < b.size) {\n    var move = preferredPos <= start && preferredPos >= endA ? start - preferredPos : 0;\n    start -= move;\n    endB = start + (endB - endA);\n    endA = start;\n  } else if (endB < start) {\n    var move$1 = preferredPos <= start && preferredPos >= endB ? start - preferredPos : 0;\n    start -= move$1;\n    endA = start + (endA - endB);\n    endB = start;\n  }\n  return {start: start, endA: endA, endB: endB}\n}\n\nfunction serializeForClipboard(view, slice) {\n  var context = [];\n  var content = slice.content;\n  var openStart = slice.openStart;\n  var openEnd = slice.openEnd;\n  while (openStart > 1 && openEnd > 1 && content.childCount == 1 && content.firstChild.childCount == 1) {\n    openStart--;\n    openEnd--;\n    var node = content.firstChild;\n    context.push(node.type.name, node.attrs != node.type.defaultAttrs ? node.attrs : null);\n    content = node.content;\n  }\n\n  var serializer = view.someProp(\"clipboardSerializer\") || DOMSerializer.fromSchema(view.state.schema);\n  var doc = detachedDoc(), wrap = doc.createElement(\"div\");\n  wrap.appendChild(serializer.serializeFragment(content, {document: doc}));\n\n  var firstChild = wrap.firstChild, needsWrap;\n  while (firstChild && firstChild.nodeType == 1 && (needsWrap = wrapMap[firstChild.nodeName.toLowerCase()])) {\n    for (var i = needsWrap.length - 1; i >= 0; i--) {\n      var wrapper = doc.createElement(needsWrap[i]);\n      while (wrap.firstChild) { wrapper.appendChild(wrap.firstChild); }\n      wrap.appendChild(wrapper);\n      if (needsWrap[i] != \"tbody\") {\n        openStart++;\n        openEnd++;\n      }\n    }\n    firstChild = wrap.firstChild;\n  }\n\n  if (firstChild && firstChild.nodeType == 1)\n    { firstChild.setAttribute(\"data-pm-slice\", (openStart + \" \" + openEnd + \" \" + (JSON.stringify(context)))); }\n\n  var text = view.someProp(\"clipboardTextSerializer\", function (f) { return f(slice); }) ||\n      slice.content.textBetween(0, slice.content.size, \"\\n\\n\");\n\n  return {dom: wrap, text: text}\n}\n\n// : (EditorView, string, string, ?bool, ResolvedPos) → ?Slice\n// Read a slice of content from the clipboard (or drop data).\nfunction parseFromClipboard(view, text, html, plainText, $context) {\n  var dom, inCode = $context.parent.type.spec.code, slice;\n  if (!html && !text) { return null }\n  var asText = text && (plainText || inCode || !html);\n  if (asText) {\n    view.someProp(\"transformPastedText\", function (f) { text = f(text, inCode || plainText); });\n    if (inCode) { return text ? new Slice(Fragment.from(view.state.schema.text(text.replace(/\\r\\n?/g, \"\\n\"))), 0, 0) : Slice.empty }\n    var parsed = view.someProp(\"clipboardTextParser\", function (f) { return f(text, $context, plainText); });\n    if (parsed) {\n      slice = parsed;\n    } else {\n      var marks = $context.marks();\n      var ref = view.state;\n      var schema = ref.schema;\n      var serializer = DOMSerializer.fromSchema(schema);\n      dom = document.createElement(\"div\");\n      text.split(/(?:\\r\\n?|\\n)+/).forEach(function (block) {\n        var p = dom.appendChild(document.createElement(\"p\"));\n        if (block) { p.appendChild(serializer.serializeNode(schema.text(block, marks))); }\n      });\n    }\n  } else {\n    view.someProp(\"transformPastedHTML\", function (f) { html = f(html); });\n    dom = readHTML(html);\n    if (result.webkit) { restoreReplacedSpaces(dom); }\n  }\n\n  var contextNode = dom && dom.querySelector(\"[data-pm-slice]\");\n  var sliceData = contextNode && /^(\\d+) (\\d+) (.*)/.exec(contextNode.getAttribute(\"data-pm-slice\"));\n  if (!slice) {\n    var parser = view.someProp(\"clipboardParser\") || view.someProp(\"domParser\") || DOMParser.fromSchema(view.state.schema);\n    slice = parser.parseSlice(dom, {\n      preserveWhitespace: !!(asText || sliceData),\n      context: $context,\n      ruleFromNode: function ruleFromNode(dom) {\n        if (dom.nodeName == \"BR\" && !dom.nextSibling &&\n            dom.parentNode && !inlineParents.test(dom.parentNode.nodeName)) { return {ignore: true} }\n      }\n    });\n  }\n  if (sliceData) {\n    slice = addContext(closeSlice(slice, +sliceData[1], +sliceData[2]), sliceData[3]);\n  } else { // HTML wasn't created by ProseMirror. Make sure top-level siblings are coherent\n    slice = Slice.maxOpen(normalizeSiblings(slice.content, $context), true);\n    if (slice.openStart || slice.openEnd) {\n      var openStart = 0, openEnd = 0;\n      for (var node = slice.content.firstChild; openStart < slice.openStart && !node.type.spec.isolating;\n           openStart++, node = node.firstChild) {}\n      for (var node$1 = slice.content.lastChild; openEnd < slice.openEnd && !node$1.type.spec.isolating;\n           openEnd++, node$1 = node$1.lastChild) {}\n      slice = closeSlice(slice, openStart, openEnd);\n    }\n  }\n\n  view.someProp(\"transformPasted\", function (f) { slice = f(slice); });\n  return slice\n}\n\nvar inlineParents = /^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;\n\n// Takes a slice parsed with parseSlice, which means there hasn't been\n// any content-expression checking done on the top nodes, tries to\n// find a parent node in the current context that might fit the nodes,\n// and if successful, rebuilds the slice so that it fits into that parent.\n//\n// This addresses the problem that Transform.replace expects a\n// coherent slice, and will fail to place a set of siblings that don't\n// fit anywhere in the schema.\nfunction normalizeSiblings(fragment, $context) {\n  if (fragment.childCount < 2) { return fragment }\n  var loop = function ( d ) {\n    var parent = $context.node(d);\n    var match = parent.contentMatchAt($context.index(d));\n    var lastWrap = (void 0), result = [];\n    fragment.forEach(function (node) {\n      if (!result) { return }\n      var wrap = match.findWrapping(node.type), inLast;\n      if (!wrap) { return result = null }\n      if (inLast = result.length && lastWrap.length && addToSibling(wrap, lastWrap, node, result[result.length - 1], 0)) {\n        result[result.length - 1] = inLast;\n      } else {\n        if (result.length) { result[result.length - 1] = closeRight(result[result.length - 1], lastWrap.length); }\n        var wrapped = withWrappers(node, wrap);\n        result.push(wrapped);\n        match = match.matchType(wrapped.type, wrapped.attrs);\n        lastWrap = wrap;\n      }\n    });\n    if (result) { return { v: Fragment.from(result) } }\n  };\n\n  for (var d = $context.depth; d >= 0; d--) {\n    var returned = loop( d );\n\n    if ( returned ) return returned.v;\n  }\n  return fragment\n}\n\nfunction withWrappers(node, wrap, from) {\n  if ( from === void 0 ) from = 0;\n\n  for (var i = wrap.length - 1; i >= from; i--)\n    { node = wrap[i].create(null, Fragment.from(node)); }\n  return node\n}\n\n// Used to group adjacent nodes wrapped in similar parents by\n// normalizeSiblings into the same parent node\nfunction addToSibling(wrap, lastWrap, node, sibling, depth) {\n  if (depth < wrap.length && depth < lastWrap.length && wrap[depth] == lastWrap[depth]) {\n    var inner = addToSibling(wrap, lastWrap, node, sibling.lastChild, depth + 1);\n    if (inner) { return sibling.copy(sibling.content.replaceChild(sibling.childCount - 1, inner)) }\n    var match = sibling.contentMatchAt(sibling.childCount);\n    if (match.matchType(depth == wrap.length - 1 ? node.type : wrap[depth + 1]))\n      { return sibling.copy(sibling.content.append(Fragment.from(withWrappers(node, wrap, depth + 1)))) }\n  }\n}\n\nfunction closeRight(node, depth) {\n  if (depth == 0) { return node }\n  var fragment = node.content.replaceChild(node.childCount - 1, closeRight(node.lastChild, depth - 1));\n  var fill = node.contentMatchAt(node.childCount).fillBefore(Fragment.empty, true);\n  return node.copy(fragment.append(fill))\n}\n\nfunction closeRange(fragment, side, from, to, depth, openEnd) {\n  var node = side < 0 ? fragment.firstChild : fragment.lastChild, inner = node.content;\n  if (depth < to - 1) { inner = closeRange(inner, side, from, to, depth + 1, openEnd); }\n  if (depth >= from)\n    { inner = side < 0 ? node.contentMatchAt(0).fillBefore(inner, fragment.childCount > 1 || openEnd <= depth).append(inner)\n      : inner.append(node.contentMatchAt(node.childCount).fillBefore(Fragment.empty, true)); }\n  return fragment.replaceChild(side < 0 ? 0 : fragment.childCount - 1, node.copy(inner))\n}\n\nfunction closeSlice(slice, openStart, openEnd) {\n  if (openStart < slice.openStart)\n    { slice = new Slice(closeRange(slice.content, -1, openStart, slice.openStart, 0, slice.openEnd), openStart, slice.openEnd); }\n  if (openEnd < slice.openEnd)\n    { slice = new Slice(closeRange(slice.content, 1, openEnd, slice.openEnd, 0, 0), slice.openStart, openEnd); }\n  return slice\n}\n\n// Trick from jQuery -- some elements must be wrapped in other\n// elements for innerHTML to work. I.e. if you do `div.innerHTML =\n// \"<td>..</td>\"` the table cells are ignored.\nvar wrapMap = {\n  thead: [\"table\"],\n  tbody: [\"table\"],\n  tfoot: [\"table\"],\n  caption: [\"table\"],\n  colgroup: [\"table\"],\n  col: [\"table\", \"colgroup\"],\n  tr: [\"table\", \"tbody\"],\n  td: [\"table\", \"tbody\", \"tr\"],\n  th: [\"table\", \"tbody\", \"tr\"]\n};\n\nvar _detachedDoc = null;\nfunction detachedDoc() {\n  return _detachedDoc || (_detachedDoc = document.implementation.createHTMLDocument(\"title\"))\n}\n\nfunction readHTML(html) {\n  var metas = /^(\\s*<meta [^>]*>)*/.exec(html);\n  if (metas) { html = html.slice(metas[0].length); }\n  var elt = detachedDoc().createElement(\"div\");\n  var firstTag = /<([a-z][^>\\s]+)/i.exec(html), wrap;\n  if (wrap = firstTag && wrapMap[firstTag[1].toLowerCase()])\n    { html = wrap.map(function (n) { return \"<\" + n + \">\"; }).join(\"\") + html + wrap.map(function (n) { return \"</\" + n + \">\"; }).reverse().join(\"\"); }\n  elt.innerHTML = html;\n  if (wrap) { for (var i = 0; i < wrap.length; i++) { elt = elt.querySelector(wrap[i]) || elt; } }\n  return elt\n}\n\n// Webkit browsers do some hard-to-predict replacement of regular\n// spaces with non-breaking spaces when putting content on the\n// clipboard. This tries to convert such non-breaking spaces (which\n// will be wrapped in a plain span on Chrome, a span with class\n// Apple-converted-space on Safari) back to regular spaces.\nfunction restoreReplacedSpaces(dom) {\n  var nodes = dom.querySelectorAll(result.chrome ? \"span:not([class]):not([style])\" : \"span.Apple-converted-space\");\n  for (var i = 0; i < nodes.length; i++) {\n    var node = nodes[i];\n    if (node.childNodes.length == 1 && node.textContent == \"\\u00a0\" && node.parentNode)\n      { node.parentNode.replaceChild(dom.ownerDocument.createTextNode(\" \"), node); }\n  }\n}\n\nfunction addContext(slice, context) {\n  if (!slice.size) { return slice }\n  var schema = slice.content.firstChild.type.schema, array;\n  try { array = JSON.parse(context); }\n  catch(e) { return slice }\n  var content = slice.content;\n  var openStart = slice.openStart;\n  var openEnd = slice.openEnd;\n  for (var i = array.length - 2; i >= 0; i -= 2) {\n    var type = schema.nodes[array[i]];\n    if (!type || type.hasRequiredAttrs()) { break }\n    content = Fragment.from(type.create(array[i + 1], content));\n    openStart++; openEnd++;\n  }\n  return new Slice(content, openStart, openEnd)\n}\n\nvar observeOptions = {\n  childList: true,\n  characterData: true,\n  characterDataOldValue: true,\n  attributes: true,\n  attributeOldValue: true,\n  subtree: true\n};\n// IE11 has very broken mutation observers, so we also listen to DOMCharacterDataModified\nvar useCharData = result.ie && result.ie_version <= 11;\n\nvar SelectionState = function SelectionState() {\n  this.anchorNode = this.anchorOffset = this.focusNode = this.focusOffset = null;\n};\n\nSelectionState.prototype.set = function set (sel) {\n  this.anchorNode = sel.anchorNode; this.anchorOffset = sel.anchorOffset;\n  this.focusNode = sel.focusNode; this.focusOffset = sel.focusOffset;\n};\n\nSelectionState.prototype.eq = function eq (sel) {\n  return sel.anchorNode == this.anchorNode && sel.anchorOffset == this.anchorOffset &&\n    sel.focusNode == this.focusNode && sel.focusOffset == this.focusOffset\n};\n\nvar DOMObserver = function DOMObserver(view, handleDOMChange) {\n  var this$1 = this;\n\n  this.view = view;\n  this.handleDOMChange = handleDOMChange;\n  this.queue = [];\n  this.flushingSoon = -1;\n  this.observer = window.MutationObserver &&\n    new window.MutationObserver(function (mutations) {\n      for (var i = 0; i < mutations.length; i++) { this$1.queue.push(mutations[i]); }\n      // IE11 will sometimes (on backspacing out a single character\n      // text node after a BR node) call the observer callback\n      // before actually updating the DOM, which will cause\n      // ProseMirror to miss the change (see #930)\n      if (result.ie && result.ie_version <= 11 && mutations.some(\n        function (m) { return m.type == \"childList\" && m.removedNodes.length ||\n             m.type == \"characterData\" && m.oldValue.length > m.target.nodeValue.length; }))\n        { this$1.flushSoon(); }\n      else\n        { this$1.flush(); }\n    });\n  this.currentSelection = new SelectionState;\n  if (useCharData) {\n    this.onCharData = function (e) {\n      this$1.queue.push({target: e.target, type: \"characterData\", oldValue: e.prevValue});\n      this$1.flushSoon();\n    };\n  }\n  this.onSelectionChange = this.onSelectionChange.bind(this);\n  this.suppressingSelectionUpdates = false;\n};\n\nDOMObserver.prototype.flushSoon = function flushSoon () {\n    var this$1 = this;\n\n  if (this.flushingSoon < 0)\n    { this.flushingSoon = window.setTimeout(function () { this$1.flushingSoon = -1; this$1.flush(); }, 20); }\n};\n\nDOMObserver.prototype.forceFlush = function forceFlush () {\n  if (this.flushingSoon > -1) {\n    window.clearTimeout(this.flushingSoon);\n    this.flushingSoon = -1;\n    this.flush();\n  }\n};\n\nDOMObserver.prototype.start = function start () {\n  if (this.observer)\n    { this.observer.observe(this.view.dom, observeOptions); }\n  if (useCharData)\n    { this.view.dom.addEventListener(\"DOMCharacterDataModified\", this.onCharData); }\n  this.connectSelection();\n};\n\nDOMObserver.prototype.stop = function stop () {\n    var this$1 = this;\n\n  if (this.observer) {\n    var take = this.observer.takeRecords();\n    if (take.length) {\n      for (var i = 0; i < take.length; i++) { this.queue.push(take[i]); }\n      window.setTimeout(function () { return this$1.flush(); }, 20);\n    }\n    this.observer.disconnect();\n  }\n  if (useCharData) { this.view.dom.removeEventListener(\"DOMCharacterDataModified\", this.onCharData); }\n  this.disconnectSelection();\n};\n\nDOMObserver.prototype.connectSelection = function connectSelection () {\n  this.view.dom.ownerDocument.addEventListener(\"selectionchange\", this.onSelectionChange);\n};\n\nDOMObserver.prototype.disconnectSelection = function disconnectSelection () {\n  this.view.dom.ownerDocument.removeEventListener(\"selectionchange\", this.onSelectionChange);\n};\n\nDOMObserver.prototype.suppressSelectionUpdates = function suppressSelectionUpdates () {\n    var this$1 = this;\n\n  this.suppressingSelectionUpdates = true;\n  setTimeout(function () { return this$1.suppressingSelectionUpdates = false; }, 50);\n};\n\nDOMObserver.prototype.onSelectionChange = function onSelectionChange () {\n  if (!hasFocusAndSelection(this.view)) { return }\n  if (this.suppressingSelectionUpdates) { return selectionToDOM(this.view) }\n  // Deletions on IE11 fire their events in the wrong order, giving\n  // us a selection change event before the DOM changes are\n  // reported.\n  if (result.ie && result.ie_version <= 11 && !this.view.state.selection.empty) {\n    var sel = this.view.root.getSelection();\n    // Selection.isCollapsed isn't reliable on IE\n    if (sel.focusNode && isEquivalentPosition(sel.focusNode, sel.focusOffset, sel.anchorNode, sel.anchorOffset))\n      { return this.flushSoon() }\n  }\n  this.flush();\n};\n\nDOMObserver.prototype.setCurSelection = function setCurSelection () {\n  this.currentSelection.set(this.view.root.getSelection());\n};\n\nDOMObserver.prototype.ignoreSelectionChange = function ignoreSelectionChange (sel) {\n  if (sel.rangeCount == 0) { return true }\n  var container = sel.getRangeAt(0).commonAncestorContainer;\n  var desc = this.view.docView.nearestDesc(container);\n  if (desc && desc.ignoreMutation({type: \"selection\", target: container.nodeType == 3 ? container.parentNode : container})) {\n    this.setCurSelection();\n    return true\n  }\n};\n\nDOMObserver.prototype.flush = function flush () {\n  if (!this.view.docView || this.flushingSoon > -1) { return }\n  var mutations = this.observer ? this.observer.takeRecords() : [];\n  if (this.queue.length) {\n    mutations = this.queue.concat(mutations);\n    this.queue.length = 0;\n  }\n\n  var sel = this.view.root.getSelection();\n  var newSel = !this.suppressingSelectionUpdates && !this.currentSelection.eq(sel) && hasSelection(this.view) && !this.ignoreSelectionChange(sel);\n\n  var from = -1, to = -1, typeOver = false, added = [];\n  if (this.view.editable) {\n    for (var i = 0; i < mutations.length; i++) {\n      var result$1 = this.registerMutation(mutations[i], added);\n      if (result$1) {\n        from = from < 0 ? result$1.from : Math.min(result$1.from, from);\n        to = to < 0 ? result$1.to : Math.max(result$1.to, to);\n        if (result$1.typeOver) { typeOver = true; }\n      }\n    }\n  }\n\n  if (result.gecko && added.length > 1) {\n    var brs = added.filter(function (n) { return n.nodeName == \"BR\"; });\n    if (brs.length == 2) {\n      var a = brs[0];\n        var b = brs[1];\n      if (a.parentNode && a.parentNode.parentNode == b.parentNode) { b.remove(); }\n      else { a.remove(); }\n    }\n  }\n\n  if (from > -1 || newSel) {\n    if (from > -1) {\n      this.view.docView.markDirty(from, to);\n      checkCSS(this.view);\n    }\n    this.handleDOMChange(from, to, typeOver, added);\n    if (this.view.docView.dirty) { this.view.updateState(this.view.state); }\n    else if (!this.currentSelection.eq(sel)) { selectionToDOM(this.view); }\n    this.currentSelection.set(sel);\n  }\n};\n\nDOMObserver.prototype.registerMutation = function registerMutation (mut, added) {\n  // Ignore mutations inside nodes that were already noted as inserted\n  if (added.indexOf(mut.target) > -1) { return null }\n  var desc = this.view.docView.nearestDesc(mut.target);\n  if (mut.type == \"attributes\" &&\n      (desc == this.view.docView || mut.attributeName == \"contenteditable\" ||\n       // Firefox sometimes fires spurious events for null/empty styles\n       (mut.attributeName == \"style\" && !mut.oldValue && !mut.target.getAttribute(\"style\"))))\n    { return null }\n  if (!desc || desc.ignoreMutation(mut)) { return null }\n\n  if (mut.type == \"childList\") {\n    for (var i = 0; i < mut.addedNodes.length; i++) { added.push(mut.addedNodes[i]); }\n    if (desc.contentDOM && desc.contentDOM != desc.dom && !desc.contentDOM.contains(mut.target))\n      { return {from: desc.posBefore, to: desc.posAfter} }\n    var prev = mut.previousSibling, next = mut.nextSibling;\n    if (result.ie && result.ie_version <= 11 && mut.addedNodes.length) {\n      // IE11 gives us incorrect next/prev siblings for some\n      // insertions, so if there are added nodes, recompute those\n      for (var i$1 = 0; i$1 < mut.addedNodes.length; i$1++) {\n        var ref = mut.addedNodes[i$1];\n          var previousSibling = ref.previousSibling;\n          var nextSibling = ref.nextSibling;\n        if (!previousSibling || Array.prototype.indexOf.call(mut.addedNodes, previousSibling) < 0) { prev = previousSibling; }\n        if (!nextSibling || Array.prototype.indexOf.call(mut.addedNodes, nextSibling) < 0) { next = nextSibling; }\n      }\n    }\n    var fromOffset = prev && prev.parentNode == mut.target\n        ? domIndex(prev) + 1 : 0;\n    var from = desc.localPosFromDOM(mut.target, fromOffset, -1);\n    var toOffset = next && next.parentNode == mut.target\n        ? domIndex(next) : mut.target.childNodes.length;\n    var to = desc.localPosFromDOM(mut.target, toOffset, 1);\n    return {from: from, to: to}\n  } else if (mut.type == \"attributes\") {\n    return {from: desc.posAtStart - desc.border, to: desc.posAtEnd + desc.border}\n  } else { // \"characterData\"\n    return {\n      from: desc.posAtStart,\n      to: desc.posAtEnd,\n      // An event was generated for a text change that didn't change\n      // any text. Mark the dom change to fall back to assuming the\n      // selection was typed over with an identical value if it can't\n      // find another change.\n      typeOver: mut.target.nodeValue == mut.oldValue\n    }\n  }\n};\n\nvar cssChecked = false;\n\nfunction checkCSS(view) {\n  if (cssChecked) { return }\n  cssChecked = true;\n  if (getComputedStyle(view.dom).whiteSpace == \"normal\")\n    { console[\"warn\"](\"ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package.\"); }\n}\n\n// A collection of DOM events that occur within the editor, and callback functions\n// to invoke when the event fires.\nvar handlers = {}, editHandlers = {};\n\nfunction initInput(view) {\n  view.shiftKey = false;\n  view.mouseDown = null;\n  view.lastKeyCode = null;\n  view.lastKeyCodeTime = 0;\n  view.lastClick = {time: 0, x: 0, y: 0, type: \"\"};\n  view.lastSelectionOrigin = null;\n  view.lastSelectionTime = 0;\n\n  view.lastIOSEnter = 0;\n  view.lastIOSEnterFallbackTimeout = null;\n  view.lastAndroidDelete = 0;\n\n  view.composing = false;\n  view.composingTimeout = null;\n  view.compositionNodes = [];\n  view.compositionEndedAt = -2e8;\n\n  view.domObserver = new DOMObserver(view, function (from, to, typeOver, added) { return readDOMChange(view, from, to, typeOver, added); });\n  view.domObserver.start();\n  // Used by hacks like the beforeinput handler to check whether anything happened in the DOM\n  view.domChangeCount = 0;\n\n  view.eventHandlers = Object.create(null);\n  var loop = function ( event ) {\n    var handler = handlers[event];\n    view.dom.addEventListener(event, view.eventHandlers[event] = function (event) {\n      if (eventBelongsToView(view, event) && !runCustomHandler(view, event) &&\n          (view.editable || !(event.type in editHandlers)))\n        { handler(view, event); }\n    });\n  };\n\n  for (var event in handlers) loop( event );\n  // On Safari, for reasons beyond my understanding, adding an input\n  // event handler makes an issue where the composition vanishes when\n  // you press enter go away.\n  if (result.safari) { view.dom.addEventListener(\"input\", function () { return null; }); }\n\n  ensureListeners(view);\n}\n\nfunction setSelectionOrigin(view, origin) {\n  view.lastSelectionOrigin = origin;\n  view.lastSelectionTime = Date.now();\n}\n\nfunction destroyInput(view) {\n  view.domObserver.stop();\n  for (var type in view.eventHandlers)\n    { view.dom.removeEventListener(type, view.eventHandlers[type]); }\n  clearTimeout(view.composingTimeout);\n  clearTimeout(view.lastIOSEnterFallbackTimeout);\n}\n\nfunction ensureListeners(view) {\n  view.someProp(\"handleDOMEvents\", function (currentHandlers) {\n    for (var type in currentHandlers) { if (!view.eventHandlers[type])\n      { view.dom.addEventListener(type, view.eventHandlers[type] = function (event) { return runCustomHandler(view, event); }); } }\n  });\n}\n\nfunction runCustomHandler(view, event) {\n  return view.someProp(\"handleDOMEvents\", function (handlers) {\n    var handler = handlers[event.type];\n    return handler ? handler(view, event) || event.defaultPrevented : false\n  })\n}\n\nfunction eventBelongsToView(view, event) {\n  if (!event.bubbles) { return true }\n  if (event.defaultPrevented) { return false }\n  for (var node = event.target; node != view.dom; node = node.parentNode)\n    { if (!node || node.nodeType == 11 ||\n        (node.pmViewDesc && node.pmViewDesc.stopEvent(event)))\n      { return false } }\n  return true\n}\n\nfunction dispatchEvent(view, event) {\n  if (!runCustomHandler(view, event) && handlers[event.type] &&\n      (view.editable || !(event.type in editHandlers)))\n    { handlers[event.type](view, event); }\n}\n\neditHandlers.keydown = function (view, event) {\n  view.shiftKey = event.keyCode == 16 || event.shiftKey;\n  if (inOrNearComposition(view, event)) { return }\n  view.lastKeyCode = event.keyCode;\n  view.lastKeyCodeTime = Date.now();\n  // Suppress enter key events on Chrome Android, because those tend\n  // to be part of a confused sequence of composition events fired,\n  // and handling them eagerly tends to corrupt the input.\n  if (result.android && result.chrome && event.keyCode == 13) { return }\n  if (event.keyCode != 229) { view.domObserver.forceFlush(); }\n\n  // On iOS, if we preventDefault enter key presses, the virtual\n  // keyboard gets confused. So the hack here is to set a flag that\n  // makes the DOM change code recognize that what just happens should\n  // be replaced by whatever the Enter key handlers do.\n  if (result.ios && event.keyCode == 13 && !event.ctrlKey && !event.altKey && !event.metaKey) {\n    var now = Date.now();\n    view.lastIOSEnter = now;\n    view.lastIOSEnterFallbackTimeout = setTimeout(function () {\n      if (view.lastIOSEnter == now) {\n        view.someProp(\"handleKeyDown\", function (f) { return f(view, keyEvent(13, \"Enter\")); });\n        view.lastIOSEnter = 0;\n      }\n    }, 200);\n  } else if (view.someProp(\"handleKeyDown\", function (f) { return f(view, event); }) || captureKeyDown(view, event)) {\n    event.preventDefault();\n  } else {\n    setSelectionOrigin(view, \"key\");\n  }\n};\n\neditHandlers.keyup = function (view, e) {\n  if (e.keyCode == 16) { view.shiftKey = false; }\n};\n\neditHandlers.keypress = function (view, event) {\n  if (inOrNearComposition(view, event) || !event.charCode ||\n      event.ctrlKey && !event.altKey || result.mac && event.metaKey) { return }\n\n  if (view.someProp(\"handleKeyPress\", function (f) { return f(view, event); })) {\n    event.preventDefault();\n    return\n  }\n\n  var sel = view.state.selection;\n  if (!(sel instanceof TextSelection) || !sel.$from.sameParent(sel.$to)) {\n    var text = String.fromCharCode(event.charCode);\n    if (!view.someProp(\"handleTextInput\", function (f) { return f(view, sel.$from.pos, sel.$to.pos, text); }))\n      { view.dispatch(view.state.tr.insertText(text).scrollIntoView()); }\n    event.preventDefault();\n  }\n};\n\nfunction eventCoords(event) { return {left: event.clientX, top: event.clientY} }\n\nfunction isNear(event, click) {\n  var dx = click.x - event.clientX, dy = click.y - event.clientY;\n  return dx * dx + dy * dy < 100\n}\n\nfunction runHandlerOnContext(view, propName, pos, inside, event) {\n  if (inside == -1) { return false }\n  var $pos = view.state.doc.resolve(inside);\n  var loop = function ( i ) {\n    if (view.someProp(propName, function (f) { return i > $pos.depth ? f(view, pos, $pos.nodeAfter, $pos.before(i), event, true)\n                                                    : f(view, pos, $pos.node(i), $pos.before(i), event, false); }))\n      { return { v: true } }\n  };\n\n  for (var i = $pos.depth + 1; i > 0; i--) {\n    var returned = loop( i );\n\n    if ( returned ) return returned.v;\n  }\n  return false\n}\n\nfunction updateSelection(view, selection, origin) {\n  if (!view.focused) { view.focus(); }\n  var tr = view.state.tr.setSelection(selection);\n  if (origin == \"pointer\") { tr.setMeta(\"pointer\", true); }\n  view.dispatch(tr);\n}\n\nfunction selectClickedLeaf(view, inside) {\n  if (inside == -1) { return false }\n  var $pos = view.state.doc.resolve(inside), node = $pos.nodeAfter;\n  if (node && node.isAtom && NodeSelection.isSelectable(node)) {\n    updateSelection(view, new NodeSelection($pos), \"pointer\");\n    return true\n  }\n  return false\n}\n\nfunction selectClickedNode(view, inside) {\n  if (inside == -1) { return false }\n  var sel = view.state.selection, selectedNode, selectAt;\n  if (sel instanceof NodeSelection) { selectedNode = sel.node; }\n\n  var $pos = view.state.doc.resolve(inside);\n  for (var i = $pos.depth + 1; i > 0; i--) {\n    var node = i > $pos.depth ? $pos.nodeAfter : $pos.node(i);\n    if (NodeSelection.isSelectable(node)) {\n      if (selectedNode && sel.$from.depth > 0 &&\n          i >= sel.$from.depth && $pos.before(sel.$from.depth + 1) == sel.$from.pos)\n        { selectAt = $pos.before(sel.$from.depth); }\n      else\n        { selectAt = $pos.before(i); }\n      break\n    }\n  }\n\n  if (selectAt != null) {\n    updateSelection(view, NodeSelection.create(view.state.doc, selectAt), \"pointer\");\n    return true\n  } else {\n    return false\n  }\n}\n\nfunction handleSingleClick(view, pos, inside, event, selectNode) {\n  return runHandlerOnContext(view, \"handleClickOn\", pos, inside, event) ||\n    view.someProp(\"handleClick\", function (f) { return f(view, pos, event); }) ||\n    (selectNode ? selectClickedNode(view, inside) : selectClickedLeaf(view, inside))\n}\n\nfunction handleDoubleClick(view, pos, inside, event) {\n  return runHandlerOnContext(view, \"handleDoubleClickOn\", pos, inside, event) ||\n    view.someProp(\"handleDoubleClick\", function (f) { return f(view, pos, event); })\n}\n\nfunction handleTripleClick(view, pos, inside, event) {\n  return runHandlerOnContext(view, \"handleTripleClickOn\", pos, inside, event) ||\n    view.someProp(\"handleTripleClick\", function (f) { return f(view, pos, event); }) ||\n    defaultTripleClick(view, inside, event)\n}\n\nfunction defaultTripleClick(view, inside, event) {\n  if (event.button != 0) { return false }\n  var doc = view.state.doc;\n  if (inside == -1) {\n    if (doc.inlineContent) {\n      updateSelection(view, TextSelection.create(doc, 0, doc.content.size), \"pointer\");\n      return true\n    }\n    return false\n  }\n\n  var $pos = doc.resolve(inside);\n  for (var i = $pos.depth + 1; i > 0; i--) {\n    var node = i > $pos.depth ? $pos.nodeAfter : $pos.node(i);\n    var nodePos = $pos.before(i);\n    if (node.inlineContent)\n      { updateSelection(view, TextSelection.create(doc, nodePos + 1, nodePos + 1 + node.content.size), \"pointer\"); }\n    else if (NodeSelection.isSelectable(node))\n      { updateSelection(view, NodeSelection.create(doc, nodePos), \"pointer\"); }\n    else\n      { continue }\n    return true\n  }\n}\n\nfunction forceDOMFlush(view) {\n  return endComposition(view)\n}\n\nvar selectNodeModifier = result.mac ? \"metaKey\" : \"ctrlKey\";\n\nhandlers.mousedown = function (view, event) {\n  view.shiftKey = event.shiftKey;\n  var flushed = forceDOMFlush(view);\n  var now = Date.now(), type = \"singleClick\";\n  if (now - view.lastClick.time < 500 && isNear(event, view.lastClick) && !event[selectNodeModifier]) {\n    if (view.lastClick.type == \"singleClick\") { type = \"doubleClick\"; }\n    else if (view.lastClick.type == \"doubleClick\") { type = \"tripleClick\"; }\n  }\n  view.lastClick = {time: now, x: event.clientX, y: event.clientY, type: type};\n\n  var pos = view.posAtCoords(eventCoords(event));\n  if (!pos) { return }\n\n  if (type == \"singleClick\") {\n    if (view.mouseDown) { view.mouseDown.done(); }\n    view.mouseDown = new MouseDown(view, pos, event, flushed);\n  } else if ((type == \"doubleClick\" ? handleDoubleClick : handleTripleClick)(view, pos.pos, pos.inside, event)) {\n    event.preventDefault();\n  } else {\n    setSelectionOrigin(view, \"pointer\");\n  }\n};\n\nvar MouseDown = function MouseDown(view, pos, event, flushed) {\n  var this$1 = this;\n\n  this.view = view;\n  this.startDoc = view.state.doc;\n  this.pos = pos;\n  this.event = event;\n  this.flushed = flushed;\n  this.selectNode = event[selectNodeModifier];\n  this.allowDefault = event.shiftKey;\n  this.delayedSelectionSync = false;\n\n  var targetNode, targetPos;\n  if (pos.inside > -1) {\n    targetNode = view.state.doc.nodeAt(pos.inside);\n    targetPos = pos.inside;\n  } else {\n    var $pos = view.state.doc.resolve(pos.pos);\n    targetNode = $pos.parent;\n    targetPos = $pos.depth ? $pos.before() : 0;\n  }\n\n  this.mightDrag = null;\n\n  var target = flushed ? null : event.target;\n  var targetDesc = target ? view.docView.nearestDesc(target, true) : null;\n  this.target = targetDesc ? targetDesc.dom : null;\n\n  var ref = view.state;\n  var selection = ref.selection;\n  if (event.button == 0 &&\n      targetNode.type.spec.draggable && targetNode.type.spec.selectable !== false ||\n      selection instanceof NodeSelection && selection.from <= targetPos && selection.to > targetPos)\n    { this.mightDrag = {node: targetNode,\n                      pos: targetPos,\n                      addAttr: this.target && !this.target.draggable,\n                      setUneditable: this.target && result.gecko && !this.target.hasAttribute(\"contentEditable\")}; }\n\n  if (this.target && this.mightDrag && (this.mightDrag.addAttr || this.mightDrag.setUneditable)) {\n    this.view.domObserver.stop();\n    if (this.mightDrag.addAttr) { this.target.draggable = true; }\n    if (this.mightDrag.setUneditable)\n      { setTimeout(function () {\n        if (this$1.view.mouseDown == this$1) { this$1.target.setAttribute(\"contentEditable\", \"false\"); }\n      }, 20); }\n    this.view.domObserver.start();\n  }\n\n  view.root.addEventListener(\"mouseup\", this.up = this.up.bind(this));\n  view.root.addEventListener(\"mousemove\", this.move = this.move.bind(this));\n  setSelectionOrigin(view, \"pointer\");\n};\n\nMouseDown.prototype.done = function done () {\n    var this$1 = this;\n\n  this.view.root.removeEventListener(\"mouseup\", this.up);\n  this.view.root.removeEventListener(\"mousemove\", this.move);\n  if (this.mightDrag && this.target) {\n    this.view.domObserver.stop();\n    if (this.mightDrag.addAttr) { this.target.removeAttribute(\"draggable\"); }\n    if (this.mightDrag.setUneditable) { this.target.removeAttribute(\"contentEditable\"); }\n    this.view.domObserver.start();\n  }\n  if (this.delayedSelectionSync) { setTimeout(function () { return selectionToDOM(this$1.view); }); }\n  this.view.mouseDown = null;\n};\n\nMouseDown.prototype.up = function up (event) {\n  this.done();\n\n  if (!this.view.dom.contains(event.target.nodeType == 3 ? event.target.parentNode : event.target))\n    { return }\n\n  var pos = this.pos;\n  if (this.view.state.doc != this.startDoc) { pos = this.view.posAtCoords(eventCoords(event)); }\n\n  if (this.allowDefault || !pos) {\n    setSelectionOrigin(this.view, \"pointer\");\n  } else if (handleSingleClick(this.view, pos.pos, pos.inside, event, this.selectNode)) {\n    event.preventDefault();\n  } else if (event.button == 0 &&\n             (this.flushed ||\n              // Safari ignores clicks on draggable elements\n              (result.safari && this.mightDrag && !this.mightDrag.node.isAtom) ||\n              // Chrome will sometimes treat a node selection as a\n              // cursor, but still report that the node is selected\n              // when asked through getSelection. You'll then get a\n              // situation where clicking at the point where that\n              // (hidden) cursor is doesn't change the selection, and\n              // thus doesn't get a reaction from ProseMirror. This\n              // works around that.\n              (result.chrome && !(this.view.state.selection instanceof TextSelection) &&\n               Math.min(Math.abs(pos.pos - this.view.state.selection.from),\n                        Math.abs(pos.pos - this.view.state.selection.to)) <= 2))) {\n    updateSelection(this.view, Selection.near(this.view.state.doc.resolve(pos.pos)), \"pointer\");\n    event.preventDefault();\n  } else {\n    setSelectionOrigin(this.view, \"pointer\");\n  }\n};\n\nMouseDown.prototype.move = function move (event) {\n  if (!this.allowDefault && (Math.abs(this.event.x - event.clientX) > 4 ||\n                             Math.abs(this.event.y - event.clientY) > 4))\n    { this.allowDefault = true; }\n  setSelectionOrigin(this.view, \"pointer\");\n  if (event.buttons == 0) { this.done(); }\n};\n\nhandlers.touchdown = function (view) {\n  forceDOMFlush(view);\n  setSelectionOrigin(view, \"pointer\");\n};\n\nhandlers.contextmenu = function (view) { return forceDOMFlush(view); };\n\nfunction inOrNearComposition(view, event) {\n  if (view.composing) { return true }\n  // See https://www.stum.de/2016/06/24/handling-ime-events-in-javascript/.\n  // On Japanese input method editors (IMEs), the Enter key is used to confirm character\n  // selection. On Safari, when Enter is pressed, compositionend and keydown events are\n  // emitted. The keydown event triggers newline insertion, which we don't want.\n  // This method returns true if the keydown event should be ignored.\n  // We only ignore it once, as pressing Enter a second time *should* insert a newline.\n  // Furthermore, the keydown event timestamp must be close to the compositionEndedAt timestamp.\n  // This guards against the case where compositionend is triggered without the keyboard\n  // (e.g. character confirmation may be done with the mouse), and keydown is triggered\n  // afterwards- we wouldn't want to ignore the keydown event in this case.\n  if (result.safari && Math.abs(event.timeStamp - view.compositionEndedAt) < 500) {\n    view.compositionEndedAt = -2e8;\n    return true\n  }\n  return false\n}\n\n// Drop active composition after 5 seconds of inactivity on Android\nvar timeoutComposition = result.android ? 5000 : -1;\n\neditHandlers.compositionstart = editHandlers.compositionupdate = function (view) {\n  if (!view.composing) {\n    view.domObserver.flush();\n    var state = view.state;\n    var $pos = state.selection.$from;\n    if (state.selection.empty &&\n        (state.storedMarks ||\n         (!$pos.textOffset && $pos.parentOffset && $pos.nodeBefore.marks.some(function (m) { return m.type.spec.inclusive === false; })))) {\n      // Need to wrap the cursor in mark nodes different from the ones in the DOM context\n      view.markCursor = view.state.storedMarks || $pos.marks();\n      endComposition(view, true);\n      view.markCursor = null;\n    } else {\n      endComposition(view);\n      // In firefox, if the cursor is after but outside a marked node,\n      // the inserted text won't inherit the marks. So this moves it\n      // inside if necessary.\n      if (result.gecko && state.selection.empty && $pos.parentOffset && !$pos.textOffset && $pos.nodeBefore.marks.length) {\n        var sel = view.root.getSelection();\n        for (var node = sel.focusNode, offset = sel.focusOffset; node && node.nodeType == 1 && offset != 0;) {\n          var before = offset < 0 ? node.lastChild : node.childNodes[offset - 1];\n          if (!before) { break }\n          if (before.nodeType == 3) {\n            sel.collapse(before, before.nodeValue.length);\n            break\n          } else {\n            node = before;\n            offset = -1;\n          }\n        }\n      }\n    }\n    view.composing = true;\n  }\n  scheduleComposeEnd(view, timeoutComposition);\n};\n\neditHandlers.compositionend = function (view, event) {\n  if (view.composing) {\n    view.composing = false;\n    view.compositionEndedAt = event.timeStamp;\n    scheduleComposeEnd(view, 20);\n  }\n};\n\nfunction scheduleComposeEnd(view, delay) {\n  clearTimeout(view.composingTimeout);\n  if (delay > -1) { view.composingTimeout = setTimeout(function () { return endComposition(view); }, delay); }\n}\n\nfunction clearComposition(view) {\n  if (view.composing) {\n    view.composing = false;\n    view.compositionEndedAt = timestampFromCustomEvent();\n  }\n  while (view.compositionNodes.length > 0) { view.compositionNodes.pop().markParentsDirty(); }\n}\n\nfunction timestampFromCustomEvent() {\n  var event = document.createEvent(\"Event\");\n  event.initEvent(\"event\", true, true);\n  return event.timeStamp\n}\n\nfunction endComposition(view, forceUpdate) {\n  if (result.android && view.domObserver.flushingSoon >= 0) { return }\n  view.domObserver.forceFlush();\n  clearComposition(view);\n  if (forceUpdate || view.docView.dirty) {\n    var sel = selectionFromDOM(view);\n    if (sel && !sel.eq(view.state.selection)) { view.dispatch(view.state.tr.setSelection(sel)); }\n    else { view.updateState(view.state); }\n    return true\n  }\n  return false\n}\n\nfunction captureCopy(view, dom) {\n  // The extra wrapper is somehow necessary on IE/Edge to prevent the\n  // content from being mangled when it is put onto the clipboard\n  if (!view.dom.parentNode) { return }\n  var wrap = view.dom.parentNode.appendChild(document.createElement(\"div\"));\n  wrap.appendChild(dom);\n  wrap.style.cssText = \"position: fixed; left: -10000px; top: 10px\";\n  var sel = getSelection(), range = document.createRange();\n  range.selectNodeContents(dom);\n  // Done because IE will fire a selectionchange moving the selection\n  // to its start when removeAllRanges is called and the editor still\n  // has focus (which will mess up the editor's selection state).\n  view.dom.blur();\n  sel.removeAllRanges();\n  sel.addRange(range);\n  setTimeout(function () {\n    if (wrap.parentNode) { wrap.parentNode.removeChild(wrap); }\n    view.focus();\n  }, 50);\n}\n\n// This is very crude, but unfortunately both these browsers _pretend_\n// that they have a clipboard API—all the objects and methods are\n// there, they just don't work, and they are hard to test.\nvar brokenClipboardAPI = (result.ie && result.ie_version < 15) ||\n      (result.ios && result.webkit_version < 604);\n\nhandlers.copy = editHandlers.cut = function (view, e) {\n  var sel = view.state.selection, cut = e.type == \"cut\";\n  if (sel.empty) { return }\n\n  // IE and Edge's clipboard interface is completely broken\n  var data = brokenClipboardAPI ? null : e.clipboardData;\n  var slice = sel.content();\n  var ref = serializeForClipboard(view, slice);\n  var dom = ref.dom;\n  var text = ref.text;\n  if (data) {\n    e.preventDefault();\n    data.clearData();\n    data.setData(\"text/html\", dom.innerHTML);\n    data.setData(\"text/plain\", text);\n  } else {\n    captureCopy(view, dom);\n  }\n  if (cut) { view.dispatch(view.state.tr.deleteSelection().scrollIntoView().setMeta(\"uiEvent\", \"cut\")); }\n};\n\nfunction sliceSingleNode(slice) {\n  return slice.openStart == 0 && slice.openEnd == 0 && slice.content.childCount == 1 ? slice.content.firstChild : null\n}\n\nfunction capturePaste(view, e) {\n  if (!view.dom.parentNode) { return }\n  var plainText = view.shiftKey || view.state.selection.$from.parent.type.spec.code;\n  var target = view.dom.parentNode.appendChild(document.createElement(plainText ? \"textarea\" : \"div\"));\n  if (!plainText) { target.contentEditable = \"true\"; }\n  target.style.cssText = \"position: fixed; left: -10000px; top: 10px\";\n  target.focus();\n  setTimeout(function () {\n    view.focus();\n    if (target.parentNode) { target.parentNode.removeChild(target); }\n    if (plainText) { doPaste(view, target.value, null, e); }\n    else { doPaste(view, target.textContent, target.innerHTML, e); }\n  }, 50);\n}\n\nfunction doPaste(view, text, html, e) {\n  var slice = parseFromClipboard(view, text, html, view.shiftKey, view.state.selection.$from);\n  if (view.someProp(\"handlePaste\", function (f) { return f(view, e, slice || Slice.empty); })) { return true }\n  if (!slice) { return false }\n\n  var singleNode = sliceSingleNode(slice);\n  var tr = singleNode ? view.state.tr.replaceSelectionWith(singleNode, view.shiftKey) : view.state.tr.replaceSelection(slice);\n  view.dispatch(tr.scrollIntoView().setMeta(\"paste\", true).setMeta(\"uiEvent\", \"paste\"));\n  return true\n}\n\neditHandlers.paste = function (view, e) {\n  // Handling paste from JavaScript during composition is very poorly\n  // handled by browsers, so as a dodgy but preferable kludge, we just\n  // let the browser do its native thing there, except on Android,\n  // where the editor is almost always composing.\n  if (view.composing && !result.android) { return }\n  var data = brokenClipboardAPI ? null : e.clipboardData;\n  if (data && doPaste(view, data.getData(\"text/plain\"), data.getData(\"text/html\"), e)) { e.preventDefault(); }\n  else { capturePaste(view, e); }\n};\n\nvar Dragging = function Dragging(slice, move) {\n  this.slice = slice;\n  this.move = move;\n};\n\nvar dragCopyModifier = result.mac ? \"altKey\" : \"ctrlKey\";\n\nhandlers.dragstart = function (view, e) {\n  var mouseDown = view.mouseDown;\n  if (mouseDown) { mouseDown.done(); }\n  if (!e.dataTransfer) { return }\n\n  var sel = view.state.selection;\n  var pos = sel.empty ? null : view.posAtCoords(eventCoords(e));\n  if (pos && pos.pos >= sel.from && pos.pos <= (sel instanceof NodeSelection ? sel.to - 1: sel.to)) ; else if (mouseDown && mouseDown.mightDrag) {\n    view.dispatch(view.state.tr.setSelection(NodeSelection.create(view.state.doc, mouseDown.mightDrag.pos)));\n  } else if (e.target && e.target.nodeType == 1) {\n    var desc = view.docView.nearestDesc(e.target, true);\n    if (desc && desc.node.type.spec.draggable && desc != view.docView)\n      { view.dispatch(view.state.tr.setSelection(NodeSelection.create(view.state.doc, desc.posBefore))); }\n  }\n  var slice = view.state.selection.content();\n  var ref = serializeForClipboard(view, slice);\n  var dom = ref.dom;\n  var text = ref.text;\n  e.dataTransfer.clearData();\n  e.dataTransfer.setData(brokenClipboardAPI ? \"Text\" : \"text/html\", dom.innerHTML);\n  // See https://github.com/ProseMirror/prosemirror/issues/1156\n  e.dataTransfer.effectAllowed = \"copyMove\";\n  if (!brokenClipboardAPI) { e.dataTransfer.setData(\"text/plain\", text); }\n  view.dragging = new Dragging(slice, !e[dragCopyModifier]);\n};\n\nhandlers.dragend = function (view) {\n  var dragging = view.dragging;\n  window.setTimeout(function () {\n    if (view.dragging == dragging)  { view.dragging = null; }\n  }, 50);\n};\n\neditHandlers.dragover = editHandlers.dragenter = function (_, e) { return e.preventDefault(); };\n\neditHandlers.drop = function (view, e) {\n  var dragging = view.dragging;\n  view.dragging = null;\n\n  if (!e.dataTransfer) { return }\n\n  var eventPos = view.posAtCoords(eventCoords(e));\n  if (!eventPos) { return }\n  var $mouse = view.state.doc.resolve(eventPos.pos);\n  if (!$mouse) { return }\n  var slice = dragging && dragging.slice;\n  if (slice) {\n    view.someProp(\"transformPasted\", function (f) { slice = f(slice); });\n  } else {\n    slice = parseFromClipboard(view, e.dataTransfer.getData(brokenClipboardAPI ? \"Text\" : \"text/plain\"),\n                               brokenClipboardAPI ? null : e.dataTransfer.getData(\"text/html\"), false, $mouse);\n  }\n  var move = dragging && !e[dragCopyModifier];\n  if (view.someProp(\"handleDrop\", function (f) { return f(view, e, slice || Slice.empty, move); })) {\n    e.preventDefault();\n    return\n  }\n  if (!slice) { return }\n\n  e.preventDefault();\n  var insertPos = slice ? dropPoint(view.state.doc, $mouse.pos, slice) : $mouse.pos;\n  if (insertPos == null) { insertPos = $mouse.pos; }\n\n  var tr = view.state.tr;\n  if (move) { tr.deleteSelection(); }\n\n  var pos = tr.mapping.map(insertPos);\n  var isNode = slice.openStart == 0 && slice.openEnd == 0 && slice.content.childCount == 1;\n  var beforeInsert = tr.doc;\n  if (isNode)\n    { tr.replaceRangeWith(pos, pos, slice.content.firstChild); }\n  else\n    { tr.replaceRange(pos, pos, slice); }\n  if (tr.doc.eq(beforeInsert)) { return }\n\n  var $pos = tr.doc.resolve(pos);\n  if (isNode && NodeSelection.isSelectable(slice.content.firstChild) &&\n      $pos.nodeAfter && $pos.nodeAfter.sameMarkup(slice.content.firstChild)) {\n    tr.setSelection(new NodeSelection($pos));\n  } else {\n    var end = tr.mapping.map(insertPos);\n    tr.mapping.maps[tr.mapping.maps.length - 1].forEach(function (_from, _to, _newFrom, newTo) { return end = newTo; });\n    tr.setSelection(selectionBetween(view, $pos, tr.doc.resolve(end)));\n  }\n  view.focus();\n  view.dispatch(tr.setMeta(\"uiEvent\", \"drop\"));\n};\n\nhandlers.focus = function (view) {\n  if (!view.focused) {\n    view.domObserver.stop();\n    view.dom.classList.add(\"ProseMirror-focused\");\n    view.domObserver.start();\n    view.focused = true;\n    setTimeout(function () {\n      if (view.docView && view.hasFocus() && !view.domObserver.currentSelection.eq(view.root.getSelection()))\n        { selectionToDOM(view); }\n    }, 20);\n  }\n};\n\nhandlers.blur = function (view, e) {\n  if (view.focused) {\n    view.domObserver.stop();\n    view.dom.classList.remove(\"ProseMirror-focused\");\n    view.domObserver.start();\n    if (e.relatedTarget && view.dom.contains(e.relatedTarget))\n      { view.domObserver.currentSelection.set({}); }\n    view.focused = false;\n  }\n};\n\nhandlers.beforeinput = function (view, event) {\n  // We should probably do more with beforeinput events, but support\n  // is so spotty that I'm still waiting to see where they are going.\n\n  // Very specific hack to deal with backspace sometimes failing on\n  // Chrome Android when after an uneditable node.\n  if (result.chrome && result.android && event.inputType == \"deleteContentBackward\") {\n    view.domObserver.flushSoon();\n    var domChangeCount = view.domChangeCount;\n    setTimeout(function () {\n      if (view.domChangeCount != domChangeCount) { return } // Event already had some effect\n      // This bug tends to close the virtual keyboard, so we refocus\n      view.dom.blur();\n      view.focus();\n      if (view.someProp(\"handleKeyDown\", function (f) { return f(view, keyEvent(8, \"Backspace\")); })) { return }\n      var ref = view.state.selection;\n      var $cursor = ref.$cursor;\n      // Crude approximation of backspace behavior when no command handled it\n      if ($cursor && $cursor.pos > 0) { view.dispatch(view.state.tr.delete($cursor.pos - 1, $cursor.pos).scrollIntoView()); }\n    }, 50);\n  }\n};\n\n// Make sure all handlers get registered\nfor (var prop in editHandlers) { handlers[prop] = editHandlers[prop]; }\n\nfunction compareObjs(a, b) {\n  if (a == b) { return true }\n  for (var p in a) { if (a[p] !== b[p]) { return false } }\n  for (var p$1 in b) { if (!(p$1 in a)) { return false } }\n  return true\n}\n\nvar WidgetType = function WidgetType(toDOM, spec) {\n  this.spec = spec || noSpec;\n  this.side = this.spec.side || 0;\n  this.toDOM = toDOM;\n};\n\nWidgetType.prototype.map = function map (mapping, span, offset, oldOffset) {\n  var ref = mapping.mapResult(span.from + oldOffset, this.side < 0 ? -1 : 1);\n    var pos = ref.pos;\n    var deleted = ref.deleted;\n  return deleted ? null : new Decoration(pos - offset, pos - offset, this)\n};\n\nWidgetType.prototype.valid = function valid () { return true };\n\nWidgetType.prototype.eq = function eq (other) {\n  return this == other ||\n    (other instanceof WidgetType &&\n     (this.spec.key && this.spec.key == other.spec.key ||\n      this.toDOM == other.toDOM && compareObjs(this.spec, other.spec)))\n};\n\nWidgetType.prototype.destroy = function destroy (node) {\n  if (this.spec.destroy) { this.spec.destroy(node); }\n};\n\nvar InlineType = function InlineType(attrs, spec) {\n  this.spec = spec || noSpec;\n  this.attrs = attrs;\n};\n\nInlineType.prototype.map = function map (mapping, span, offset, oldOffset) {\n  var from = mapping.map(span.from + oldOffset, this.spec.inclusiveStart ? -1 : 1) - offset;\n  var to = mapping.map(span.to + oldOffset, this.spec.inclusiveEnd ? 1 : -1) - offset;\n  return from >= to ? null : new Decoration(from, to, this)\n};\n\nInlineType.prototype.valid = function valid (_, span) { return span.from < span.to };\n\nInlineType.prototype.eq = function eq (other) {\n  return this == other ||\n    (other instanceof InlineType && compareObjs(this.attrs, other.attrs) &&\n     compareObjs(this.spec, other.spec))\n};\n\nInlineType.is = function is (span) { return span.type instanceof InlineType };\n\nvar NodeType = function NodeType(attrs, spec) {\n  this.spec = spec || noSpec;\n  this.attrs = attrs;\n};\n\nNodeType.prototype.map = function map (mapping, span, offset, oldOffset) {\n  var from = mapping.mapResult(span.from + oldOffset, 1);\n  if (from.deleted) { return null }\n  var to = mapping.mapResult(span.to + oldOffset, -1);\n  if (to.deleted || to.pos <= from.pos) { return null }\n  return new Decoration(from.pos - offset, to.pos - offset, this)\n};\n\nNodeType.prototype.valid = function valid (node, span) {\n  var ref = node.content.findIndex(span.from);\n    var index = ref.index;\n    var offset = ref.offset;\n    var child;\n  return offset == span.from && !(child = node.child(index)).isText && offset + child.nodeSize == span.to\n};\n\nNodeType.prototype.eq = function eq (other) {\n  return this == other ||\n    (other instanceof NodeType && compareObjs(this.attrs, other.attrs) &&\n     compareObjs(this.spec, other.spec))\n};\n\n// ::- Decoration objects can be provided to the view through the\n// [`decorations` prop](#view.EditorProps.decorations). They come in\n// several variants—see the static members of this class for details.\nvar Decoration = function Decoration(from, to, type) {\n  // :: number\n  // The start position of the decoration.\n  this.from = from;\n  // :: number\n  // The end position. Will be the same as `from` for [widget\n  // decorations](#view.Decoration^widget).\n  this.to = to;\n  this.type = type;\n};\n\nvar prototypeAccessors$1 = { spec: { configurable: true },inline: { configurable: true } };\n\nDecoration.prototype.copy = function copy (from, to) {\n  return new Decoration(from, to, this.type)\n};\n\nDecoration.prototype.eq = function eq (other, offset) {\n    if ( offset === void 0 ) offset = 0;\n\n  return this.type.eq(other.type) && this.from + offset == other.from && this.to + offset == other.to\n};\n\nDecoration.prototype.map = function map (mapping, offset, oldOffset) {\n  return this.type.map(mapping, this, offset, oldOffset)\n};\n\n// :: (number, union<(view: EditorView, getPos: () → number) → dom.Node, dom.Node>, ?Object) → Decoration\n// Creates a widget decoration, which is a DOM node that's shown in\n// the document at the given position. It is recommended that you\n// delay rendering the widget by passing a function that will be\n// called when the widget is actually drawn in a view, but you can\n// also directly pass a DOM node. `getPos` can be used to find the\n// widget's current document position.\n//\n// spec::- These options are supported:\n//\n//   side:: ?number\n//   Controls which side of the document position this widget is\n//   associated with. When negative, it is drawn before a cursor\n//   at its position, and content inserted at that position ends\n//   up after the widget. When zero (the default) or positive, the\n//   widget is drawn after the cursor and content inserted there\n//   ends up before the widget.\n//\n//   When there are multiple widgets at a given position, their\n//   `side` values determine the order in which they appear. Those\n//   with lower values appear first. The ordering of widgets with\n//   the same `side` value is unspecified.\n//\n//   When `marks` is null, `side` also determines the marks that\n//   the widget is wrapped in—those of the node before when\n//   negative, those of the node after when positive.\n//\n//   marks:: ?[Mark]\n//   The precise set of marks to draw around the widget.\n//\n//   stopEvent:: ?(event: dom.Event) → bool\n//   Can be used to control which DOM events, when they bubble out\n//   of this widget, the editor view should ignore.\n//\n//   ignoreSelection:: ?bool\n//   When set (defaults to false), selection changes inside the\n//   widget are ignored, and don't cause ProseMirror to try and\n//   re-sync the selection with its selection state.\n//\n//   key:: ?string\n//   When comparing decorations of this type (in order to decide\n//   whether it needs to be redrawn), ProseMirror will by default\n//   compare the widget DOM node by identity. If you pass a key,\n//   that key will be compared instead, which can be useful when\n//   you generate decorations on the fly and don't want to store\n//   and reuse DOM nodes. Make sure that any widgets with the same\n//   key are interchangeable—if widgets differ in, for example,\n//   the behavior of some event handler, they should get\n//   different keys.\n//\n//   destroy:: ?(node: dom.Node)\n//   Called when the widget decoration is removed as a result of\n//   mapping\nDecoration.widget = function widget (pos, toDOM, spec) {\n  return new Decoration(pos, pos, new WidgetType(toDOM, spec))\n};\n\n// :: (number, number, DecorationAttrs, ?Object) → Decoration\n// Creates an inline decoration, which adds the given attributes to\n// each inline node between `from` and `to`.\n//\n// spec::- These options are recognized:\n//\n//   inclusiveStart:: ?bool\n//   Determines how the left side of the decoration is\n//   [mapped](#transform.Position_Mapping) when content is\n//   inserted directly at that position. By default, the decoration\n//   won't include the new content, but you can set this to `true`\n//   to make it inclusive.\n//\n//   inclusiveEnd:: ?bool\n//   Determines how the right side of the decoration is mapped.\n//   See\n//   [`inclusiveStart`](#view.Decoration^inline^spec.inclusiveStart).\nDecoration.inline = function inline (from, to, attrs, spec) {\n  return new Decoration(from, to, new InlineType(attrs, spec))\n};\n\n// :: (number, number, DecorationAttrs, ?Object) → Decoration\n// Creates a node decoration. `from` and `to` should point precisely\n// before and after a node in the document. That node, and only that\n// node, will receive the given attributes.\n//\n// spec::-\n//\n// Optional information to store with the decoration. It\n// is also used when comparing decorators for equality.\nDecoration.node = function node (from, to, attrs, spec) {\n  return new Decoration(from, to, new NodeType(attrs, spec))\n};\n\n// :: Object\n// The spec provided when creating this decoration. Can be useful\n// if you've stored extra information in that object.\nprototypeAccessors$1.spec.get = function () { return this.type.spec };\n\nprototypeAccessors$1.inline.get = function () { return this.type instanceof InlineType };\n\nObject.defineProperties( Decoration.prototype, prototypeAccessors$1 );\n\n// DecorationAttrs:: interface\n// A set of attributes to add to a decorated node. Most properties\n// simply directly correspond to DOM attributes of the same name,\n// which will be set to the property's value. These are exceptions:\n//\n//   class:: ?string\n//   A CSS class name or a space-separated set of class names to be\n//   _added_ to the classes that the node already had.\n//\n//   style:: ?string\n//   A string of CSS to be _added_ to the node's existing `style` property.\n//\n//   nodeName:: ?string\n//   When non-null, the target node is wrapped in a DOM element of\n//   this type (and the other attributes are applied to this element).\n\nvar none = [], noSpec = {};\n\n// :: class extends DecorationSource\n// A collection of [decorations](#view.Decoration), organized in\n// such a way that the drawing algorithm can efficiently use and\n// compare them. This is a persistent data structure—it is not\n// modified, updates create a new value.\nvar DecorationSet = function DecorationSet(local, children) {\n  this.local = local && local.length ? local : none;\n  this.children = children && children.length ? children : none;\n};\n\n// :: (Node, [Decoration]) → DecorationSet\n// Create a set of decorations, using the structure of the given\n// document.\nDecorationSet.create = function create (doc, decorations) {\n  return decorations.length ? buildTree(decorations, doc, 0, noSpec) : empty\n};\n\n// :: (?number, ?number, ?(spec: Object) → bool) → [Decoration]\n// Find all decorations in this set which touch the given range\n// (including decorations that start or end directly at the\n// boundaries) and match the given predicate on their spec. When\n// `start` and `end` are omitted, all decorations in the set are\n// considered. When `predicate` isn't given, all decorations are\n// assumed to match.\nDecorationSet.prototype.find = function find (start, end, predicate) {\n  var result = [];\n  this.findInner(start == null ? 0 : start, end == null ? 1e9 : end, result, 0, predicate);\n  return result\n};\n\nDecorationSet.prototype.findInner = function findInner (start, end, result, offset, predicate) {\n  for (var i = 0; i < this.local.length; i++) {\n    var span = this.local[i];\n    if (span.from <= end && span.to >= start && (!predicate || predicate(span.spec)))\n      { result.push(span.copy(span.from + offset, span.to + offset)); }\n  }\n  for (var i$1 = 0; i$1 < this.children.length; i$1 += 3) {\n    if (this.children[i$1] < end && this.children[i$1 + 1] > start) {\n      var childOff = this.children[i$1] + 1;\n      this.children[i$1 + 2].findInner(start - childOff, end - childOff, result, offset + childOff, predicate);\n    }\n  }\n};\n\n// :: (Mapping, Node, ?Object) → DecorationSet\n// Map the set of decorations in response to a change in the\n// document.\n//\n// options::- An optional set of options.\n//\n//   onRemove:: ?(decorationSpec: Object)\n//   When given, this function will be called for each decoration\n//   that gets dropped as a result of the mapping, passing the\n//   spec of that decoration.\nDecorationSet.prototype.map = function map (mapping, doc, options) {\n  if (this == empty || mapping.maps.length == 0) { return this }\n  return this.mapInner(mapping, doc, 0, 0, options || noSpec)\n};\n\nDecorationSet.prototype.mapInner = function mapInner (mapping, node, offset, oldOffset, options) {\n  var newLocal;\n  for (var i = 0; i < this.local.length; i++) {\n    var mapped = this.local[i].map(mapping, offset, oldOffset);\n    if (mapped && mapped.type.valid(node, mapped)) { (newLocal || (newLocal = [])).push(mapped); }\n    else if (options.onRemove) { options.onRemove(this.local[i].spec); }\n  }\n\n  if (this.children.length)\n    { return mapChildren(this.children, newLocal, mapping, node, offset, oldOffset, options) }\n  else\n    { return newLocal ? new DecorationSet(newLocal.sort(byPos)) : empty }\n};\n\n// :: (Node, [Decoration]) → DecorationSet\n// Add the given array of decorations to the ones in the set,\n// producing a new set. Needs access to the current document to\n// create the appropriate tree structure.\nDecorationSet.prototype.add = function add (doc, decorations) {\n  if (!decorations.length) { return this }\n  if (this == empty) { return DecorationSet.create(doc, decorations) }\n  return this.addInner(doc, decorations, 0)\n};\n\nDecorationSet.prototype.addInner = function addInner (doc, decorations, offset) {\n    var this$1 = this;\n\n  var children, childIndex = 0;\n  doc.forEach(function (childNode, childOffset) {\n    var baseOffset = childOffset + offset, found;\n    if (!(found = takeSpansForNode(decorations, childNode, baseOffset))) { return }\n\n    if (!children) { children = this$1.children.slice(); }\n    while (childIndex < children.length && children[childIndex] < childOffset) { childIndex += 3; }\n    if (children[childIndex] == childOffset)\n      { children[childIndex + 2] = children[childIndex + 2].addInner(childNode, found, baseOffset + 1); }\n    else\n      { children.splice(childIndex, 0, childOffset, childOffset + childNode.nodeSize, buildTree(found, childNode, baseOffset + 1, noSpec)); }\n    childIndex += 3;\n  });\n\n  var local = moveSpans(childIndex ? withoutNulls(decorations) : decorations, -offset);\n  for (var i = 0; i < local.length; i++) { if (!local[i].type.valid(doc, local[i])) { local.splice(i--, 1); } }\n\n  return new DecorationSet(local.length ? this.local.concat(local).sort(byPos) : this.local,\n                           children || this.children)\n};\n\n// :: ([Decoration]) → DecorationSet\n// Create a new set that contains the decorations in this set, minus\n// the ones in the given array.\nDecorationSet.prototype.remove = function remove (decorations) {\n  if (decorations.length == 0 || this == empty) { return this }\n  return this.removeInner(decorations, 0)\n};\n\nDecorationSet.prototype.removeInner = function removeInner (decorations, offset) {\n  var children = this.children, local = this.local;\n  for (var i = 0; i < children.length; i += 3) {\n    var found = (void 0), from = children[i] + offset, to = children[i + 1] + offset;\n    for (var j = 0, span = (void 0); j < decorations.length; j++) { if (span = decorations[j]) {\n      if (span.from > from && span.to < to) {\n        decorations[j] = null\n        ;(found || (found = [])).push(span);\n      }\n    } }\n    if (!found) { continue }\n    if (children == this.children) { children = this.children.slice(); }\n    var removed = children[i + 2].removeInner(found, from + 1);\n    if (removed != empty) {\n      children[i + 2] = removed;\n    } else {\n      children.splice(i, 3);\n      i -= 3;\n    }\n  }\n  if (local.length) { for (var i$1 = 0, span$1 = (void 0); i$1 < decorations.length; i$1++) { if (span$1 = decorations[i$1]) {\n    for (var j$1 = 0; j$1 < local.length; j$1++) { if (local[j$1].eq(span$1, offset)) {\n      if (local == this.local) { local = this.local.slice(); }\n      local.splice(j$1--, 1);\n    } }\n  } } }\n  if (children == this.children && local == this.local) { return this }\n  return local.length || children.length ? new DecorationSet(local, children) : empty\n};\n\nDecorationSet.prototype.forChild = function forChild (offset, node) {\n  if (this == empty) { return this }\n  if (node.isLeaf) { return DecorationSet.empty }\n\n  var child, local;\n  for (var i = 0; i < this.children.length; i += 3) { if (this.children[i] >= offset) {\n    if (this.children[i] == offset) { child = this.children[i + 2]; }\n    break\n  } }\n  var start = offset + 1, end = start + node.content.size;\n  for (var i$1 = 0; i$1 < this.local.length; i$1++) {\n    var dec = this.local[i$1];\n    if (dec.from < end && dec.to > start && (dec.type instanceof InlineType)) {\n      var from = Math.max(start, dec.from) - start, to = Math.min(end, dec.to) - start;\n      if (from < to) { (local || (local = [])).push(dec.copy(from, to)); }\n    }\n  }\n  if (local) {\n    var localSet = new DecorationSet(local.sort(byPos));\n    return child ? new DecorationGroup([localSet, child]) : localSet\n  }\n  return child || empty\n};\n\nDecorationSet.prototype.eq = function eq (other) {\n  if (this == other) { return true }\n  if (!(other instanceof DecorationSet) ||\n      this.local.length != other.local.length ||\n      this.children.length != other.children.length) { return false }\n  for (var i = 0; i < this.local.length; i++)\n    { if (!this.local[i].eq(other.local[i])) { return false } }\n  for (var i$1 = 0; i$1 < this.children.length; i$1 += 3)\n    { if (this.children[i$1] != other.children[i$1] ||\n        this.children[i$1 + 1] != other.children[i$1 + 1] ||\n        !this.children[i$1 + 2].eq(other.children[i$1 + 2])) { return false } }\n  return true\n};\n\nDecorationSet.prototype.locals = function locals (node) {\n  return removeOverlap(this.localsInner(node))\n};\n\nDecorationSet.prototype.localsInner = function localsInner (node) {\n  if (this == empty) { return none }\n  if (node.inlineContent || !this.local.some(InlineType.is)) { return this.local }\n  var result = [];\n  for (var i = 0; i < this.local.length; i++) {\n    if (!(this.local[i].type instanceof InlineType))\n      { result.push(this.local[i]); }\n  }\n  return result\n};\n\n// DecorationSource:: interface\n// An object that can [provide](#view.EditorProps.decorations)\n// decorations. Implemented by [`DecorationSet`](#view.DecorationSet),\n// and passed to [node views](#view.EditorProps.nodeViews).\n//\n//   map:: (Mapping, Node) → DecorationSource\n//   Map the set of decorations in response to a change in the\n//   document.\n\nvar empty = new DecorationSet();\n\n// :: DecorationSet\n// The empty set of decorations.\nDecorationSet.empty = empty;\n\nDecorationSet.removeOverlap = removeOverlap;\n\n// :- An abstraction that allows the code dealing with decorations to\n// treat multiple DecorationSet objects as if it were a single object\n// with (a subset of) the same interface.\nvar DecorationGroup = function DecorationGroup(members) {\n  this.members = members;\n};\n\nDecorationGroup.prototype.map = function map (mapping, doc) {\n  var mappedDecos = this.members.map(\n    function (member) { return member.map(mapping, doc, noSpec); }\n  );\n  return DecorationGroup.from(mappedDecos)\n};\n\nDecorationGroup.prototype.forChild = function forChild (offset, child) {\n  if (child.isLeaf) { return DecorationSet.empty }\n  var found = [];\n  for (var i = 0; i < this.members.length; i++) {\n    var result = this.members[i].forChild(offset, child);\n    if (result == empty) { continue }\n    if (result instanceof DecorationGroup) { found = found.concat(result.members); }\n    else { found.push(result); }\n  }\n  return DecorationGroup.from(found)\n};\n\nDecorationGroup.prototype.eq = function eq (other) {\n  if (!(other instanceof DecorationGroup) ||\n      other.members.length != this.members.length) { return false }\n  for (var i = 0; i < this.members.length; i++)\n    { if (!this.members[i].eq(other.members[i])) { return false } }\n  return true\n};\n\nDecorationGroup.prototype.locals = function locals (node) {\n  var result, sorted = true;\n  for (var i = 0; i < this.members.length; i++) {\n    var locals = this.members[i].localsInner(node);\n    if (!locals.length) { continue }\n    if (!result) {\n      result = locals;\n    } else {\n      if (sorted) {\n        result = result.slice();\n        sorted = false;\n      }\n      for (var j = 0; j < locals.length; j++) { result.push(locals[j]); }\n    }\n  }\n  return result ? removeOverlap(sorted ? result : result.sort(byPos)) : none\n};\n\n// : ([DecorationSet]) → union<DecorationSet, DecorationGroup>\n// Create a group for the given array of decoration sets, or return\n// a single set when possible.\nDecorationGroup.from = function from (members) {\n  switch (members.length) {\n    case 0: return empty\n    case 1: return members[0]\n    default: return new DecorationGroup(members)\n  }\n};\n\nfunction mapChildren(oldChildren, newLocal, mapping, node, offset, oldOffset, options) {\n  var children = oldChildren.slice();\n\n  // Mark the children that are directly touched by changes, and\n  // move those that are after the changes.\n  var shift = function (oldStart, oldEnd, newStart, newEnd) {\n    for (var i = 0; i < children.length; i += 3) {\n      var end = children[i + 1], dSize = (void 0);\n      if (end == -1 || oldStart > end + oldOffset) { continue }\n      if (oldEnd >= children[i] + oldOffset) {\n        children[i + 1] = -1;\n      } else if (newStart >= offset && (dSize = (newEnd - newStart) - (oldEnd - oldStart))) {\n        children[i] += dSize;\n        children[i + 1] += dSize;\n      }\n    }\n  };\n  for (var i = 0; i < mapping.maps.length; i++) { mapping.maps[i].forEach(shift); }\n\n  // Find the child nodes that still correspond to a single node,\n  // recursively call mapInner on them and update their positions.\n  var mustRebuild = false;\n  for (var i$1 = 0; i$1 < children.length; i$1 += 3) { if (children[i$1 + 1] == -1) { // Touched nodes\n    var from = mapping.map(oldChildren[i$1] + oldOffset), fromLocal = from - offset;\n    if (fromLocal < 0 || fromLocal >= node.content.size) {\n      mustRebuild = true;\n      continue\n    }\n    // Must read oldChildren because children was tagged with -1\n    var to = mapping.map(oldChildren[i$1 + 1] + oldOffset, -1), toLocal = to - offset;\n    var ref = node.content.findIndex(fromLocal);\n    var index = ref.index;\n    var childOffset = ref.offset;\n    var childNode = node.maybeChild(index);\n    if (childNode && childOffset == fromLocal && childOffset + childNode.nodeSize == toLocal) {\n      var mapped = children[i$1 + 2].mapInner(mapping, childNode, from + 1, oldChildren[i$1] + oldOffset + 1, options);\n      if (mapped != empty) {\n        children[i$1] = fromLocal;\n        children[i$1 + 1] = toLocal;\n        children[i$1 + 2] = mapped;\n      } else {\n        children[i$1 + 1] = -2;\n        mustRebuild = true;\n      }\n    } else {\n      mustRebuild = true;\n    }\n  } }\n\n  // Remaining children must be collected and rebuilt into the appropriate structure\n  if (mustRebuild) {\n    var decorations = mapAndGatherRemainingDecorations(children, oldChildren, newLocal || [], mapping,\n                                                       offset, oldOffset, options);\n    var built = buildTree(decorations, node, 0, options);\n    newLocal = built.local;\n    for (var i$2 = 0; i$2 < children.length; i$2 += 3) { if (children[i$2 + 1] < 0) {\n      children.splice(i$2, 3);\n      i$2 -= 3;\n    } }\n    for (var i$3 = 0, j = 0; i$3 < built.children.length; i$3 += 3) {\n      var from$1 = built.children[i$3];\n      while (j < children.length && children[j] < from$1) { j += 3; }\n      children.splice(j, 0, built.children[i$3], built.children[i$3 + 1], built.children[i$3 + 2]);\n    }\n  }\n\n  return new DecorationSet(newLocal && newLocal.sort(byPos), children)\n}\n\nfunction moveSpans(spans, offset) {\n  if (!offset || !spans.length) { return spans }\n  var result = [];\n  for (var i = 0; i < spans.length; i++) {\n    var span = spans[i];\n    result.push(new Decoration(span.from + offset, span.to + offset, span.type));\n  }\n  return result\n}\n\nfunction mapAndGatherRemainingDecorations(children, oldChildren, decorations, mapping, offset, oldOffset, options) {\n  // Gather all decorations from the remaining marked children\n  function gather(set, oldOffset) {\n    for (var i = 0; i < set.local.length; i++) {\n      var mapped = set.local[i].map(mapping, offset, oldOffset);\n      if (mapped) { decorations.push(mapped); }\n      else if (options.onRemove) { options.onRemove(set.local[i].spec); }\n    }\n    for (var i$1 = 0; i$1 < set.children.length; i$1 += 3)\n      { gather(set.children[i$1 + 2], set.children[i$1] + oldOffset + 1); }\n  }\n  for (var i = 0; i < children.length; i += 3) { if (children[i + 1] == -1)\n    { gather(children[i + 2], oldChildren[i] + oldOffset + 1); } }\n\n  return decorations\n}\n\nfunction takeSpansForNode(spans, node, offset) {\n  if (node.isLeaf) { return null }\n  var end = offset + node.nodeSize, found = null;\n  for (var i = 0, span = (void 0); i < spans.length; i++) {\n    if ((span = spans[i]) && span.from > offset && span.to < end) {\n(found || (found = [])).push(span);\n      spans[i] = null;\n    }\n  }\n  return found\n}\n\nfunction withoutNulls(array) {\n  var result = [];\n  for (var i = 0; i < array.length; i++)\n    { if (array[i] != null) { result.push(array[i]); } }\n  return result\n}\n\n// : ([Decoration], Node, number) → DecorationSet\n// Build up a tree that corresponds to a set of decorations. `offset`\n// is a base offset that should be subtracted from the `from` and `to`\n// positions in the spans (so that we don't have to allocate new spans\n// for recursive calls).\nfunction buildTree(spans, node, offset, options) {\n  var children = [], hasNulls = false;\n  node.forEach(function (childNode, localStart) {\n    var found = takeSpansForNode(spans, childNode, localStart + offset);\n    if (found) {\n      hasNulls = true;\n      var subtree = buildTree(found, childNode, offset + localStart + 1, options);\n      if (subtree != empty)\n        { children.push(localStart, localStart + childNode.nodeSize, subtree); }\n    }\n  });\n  var locals = moveSpans(hasNulls ? withoutNulls(spans) : spans, -offset).sort(byPos);\n  for (var i = 0; i < locals.length; i++) { if (!locals[i].type.valid(node, locals[i])) {\n    if (options.onRemove) { options.onRemove(locals[i].spec); }\n    locals.splice(i--, 1);\n  } }\n  return locals.length || children.length ? new DecorationSet(locals, children) : empty\n}\n\n// : (Decoration, Decoration) → number\n// Used to sort decorations so that ones with a low start position\n// come first, and within a set with the same start position, those\n// with an smaller end position come first.\nfunction byPos(a, b) {\n  return a.from - b.from || a.to - b.to\n}\n\n// : ([Decoration]) → [Decoration]\n// Scan a sorted array of decorations for partially overlapping spans,\n// and split those so that only fully overlapping spans are left (to\n// make subsequent rendering easier). Will return the input array if\n// no partially overlapping spans are found (the common case).\nfunction removeOverlap(spans) {\n  var working = spans;\n  for (var i = 0; i < working.length - 1; i++) {\n    var span = working[i];\n    if (span.from != span.to) { for (var j = i + 1; j < working.length; j++) {\n      var next = working[j];\n      if (next.from == span.from) {\n        if (next.to != span.to) {\n          if (working == spans) { working = spans.slice(); }\n          // Followed by a partially overlapping larger span. Split that\n          // span.\n          working[j] = next.copy(next.from, span.to);\n          insertAhead(working, j + 1, next.copy(span.to, next.to));\n        }\n        continue\n      } else {\n        if (next.from < span.to) {\n          if (working == spans) { working = spans.slice(); }\n          // The end of this one overlaps with a subsequent span. Split\n          // this one.\n          working[i] = span.copy(span.from, next.from);\n          insertAhead(working, j, span.copy(next.from, span.to));\n        }\n        break\n      }\n    } }\n  }\n  return working\n}\n\nfunction insertAhead(array, i, deco) {\n  while (i < array.length && byPos(deco, array[i]) > 0) { i++; }\n  array.splice(i, 0, deco);\n}\n\n// : (EditorView) → union<DecorationSet, DecorationGroup>\n// Get the decorations associated with the current props of a view.\nfunction viewDecorations(view) {\n  var found = [];\n  view.someProp(\"decorations\", function (f) {\n    var result = f(view.state);\n    if (result && result != empty) { found.push(result); }\n  });\n  if (view.cursorWrapper)\n    { found.push(DecorationSet.create(view.state.doc, [view.cursorWrapper.deco])); }\n  return DecorationGroup.from(found)\n}\n\n// ::- An editor view manages the DOM structure that represents an\n// editable document. Its state and behavior are determined by its\n// [props](#view.DirectEditorProps).\nvar EditorView = function EditorView(place, props) {\n  this._props = props;\n  // :: EditorState\n  // The view's current [state](#state.EditorState).\n  this.state = props.state;\n\n  this.directPlugins = props.plugins || [];\n  this.directPlugins.forEach(checkStateComponent);\n\n  this.dispatch = this.dispatch.bind(this);\n\n  this._root = null;\n  this.focused = false;\n  // Kludge used to work around a Chrome bug\n  this.trackWrites = null;\n\n  // :: dom.Element\n  // An editable DOM node containing the document. (You probably\n  // should not directly interfere with its content.)\n  this.dom = (place && place.mount) || document.createElement(\"div\");\n  if (place) {\n    if (place.appendChild) { place.appendChild(this.dom); }\n    else if (place.apply) { place(this.dom); }\n    else if (place.mount) { this.mounted = true; }\n  }\n\n  // :: bool\n  // Indicates whether the editor is currently [editable](#view.EditorProps.editable).\n  this.editable = getEditable(this);\n  this.markCursor = null;\n  this.cursorWrapper = null;\n  updateCursorWrapper(this);\n  this.nodeViews = buildNodeViews(this);\n  this.docView = docViewDesc(this.state.doc, computeDocDeco(this), viewDecorations(this), this.dom, this);\n\n  this.lastSelectedViewDesc = null;\n  // :: ?{slice: Slice, move: bool}\n  // When editor content is being dragged, this object contains\n  // information about the dragged slice and whether it is being\n  // copied or moved. At any other time, it is null.\n  this.dragging = null;\n\n  initInput(this);\n\n  this.prevDirectPlugins = [];\n  this.pluginViews = [];\n  this.updatePluginViews();\n};\n\nvar prototypeAccessors$2 = { props: { configurable: true },root: { configurable: true },isDestroyed: { configurable: true } };\n\n// composing:: boolean\n// Holds `true` when a\n// [composition](https://developer.mozilla.org/en-US/docs/Mozilla/IME_handling_guide)\n// is active.\n\n// :: DirectEditorProps\n// The view's current [props](#view.EditorProps).\nprototypeAccessors$2.props.get = function () {\n  if (this._props.state != this.state) {\n    var prev = this._props;\n    this._props = {};\n    for (var name in prev) { this._props[name] = prev[name]; }\n    this._props.state = this.state;\n  }\n  return this._props\n};\n\n// :: (DirectEditorProps)\n// Update the view's props. Will immediately cause an update to\n// the DOM.\nEditorView.prototype.update = function update (props) {\n  if (props.handleDOMEvents != this._props.handleDOMEvents) { ensureListeners(this); }\n  this._props = props;\n  if (props.plugins) {\n    props.plugins.forEach(checkStateComponent);\n    this.directPlugins = props.plugins;\n  }\n  this.updateStateInner(props.state, true);\n};\n\n// :: (DirectEditorProps)\n// Update the view by updating existing props object with the object\n// given as argument. Equivalent to `view.update(Object.assign({},\n// view.props, props))`.\nEditorView.prototype.setProps = function setProps (props) {\n  var updated = {};\n  for (var name in this._props) { updated[name] = this._props[name]; }\n  updated.state = this.state;\n  for (var name$1 in props) { updated[name$1] = props[name$1]; }\n  this.update(updated);\n};\n\n// :: (EditorState)\n// Update the editor's `state` prop, without touching any of the\n// other props.\nEditorView.prototype.updateState = function updateState (state) {\n  this.updateStateInner(state, this.state.plugins != state.plugins);\n};\n\nEditorView.prototype.updateStateInner = function updateStateInner (state, reconfigured) {\n    var this$1 = this;\n\n  var prev = this.state, redraw = false, updateSel = false;\n  // When stored marks are added, stop composition, so that they can\n  // be displayed.\n  if (state.storedMarks && this.composing) {\n    clearComposition(this);\n    updateSel = true;\n  }\n  this.state = state;\n  if (reconfigured) {\n    var nodeViews = buildNodeViews(this);\n    if (changedNodeViews(nodeViews, this.nodeViews)) {\n      this.nodeViews = nodeViews;\n      redraw = true;\n    }\n    ensureListeners(this);\n  }\n\n  this.editable = getEditable(this);\n  updateCursorWrapper(this);\n  var innerDeco = viewDecorations(this), outerDeco = computeDocDeco(this);\n\n  var scroll = reconfigured ? \"reset\"\n      : state.scrollToSelection > prev.scrollToSelection ? \"to selection\" : \"preserve\";\n  var updateDoc = redraw || !this.docView.matchesNode(state.doc, outerDeco, innerDeco);\n  if (updateDoc || !state.selection.eq(prev.selection)) { updateSel = true; }\n  var oldScrollPos = scroll == \"preserve\" && updateSel && this.dom.style.overflowAnchor == null && storeScrollPos(this);\n\n  if (updateSel) {\n    this.domObserver.stop();\n    // Work around an issue in Chrome, IE, and Edge where changing\n    // the DOM around an active selection puts it into a broken\n    // state where the thing the user sees differs from the\n    // selection reported by the Selection object (#710, #973,\n    // #1011, #1013, #1035).\n    var forceSelUpdate = updateDoc && (result.ie || result.chrome) && !this.composing &&\n        !prev.selection.empty && !state.selection.empty && selectionContextChanged(prev.selection, state.selection);\n    if (updateDoc) {\n      // If the node that the selection points into is written to,\n      // Chrome sometimes starts misreporting the selection, so this\n      // tracks that and forces a selection reset when our update\n      // did write to the node.\n      var chromeKludge = result.chrome ? (this.trackWrites = this.root.getSelection().focusNode) : null;\n      if (redraw || !this.docView.update(state.doc, outerDeco, innerDeco, this)) {\n        this.docView.updateOuterDeco([]);\n        this.docView.destroy();\n        this.docView = docViewDesc(state.doc, outerDeco, innerDeco, this.dom, this);\n      }\n      if (chromeKludge && !this.trackWrites) { forceSelUpdate = true; }\n    }\n    // Work around for an issue where an update arriving right between\n    // a DOM selection change and the \"selectionchange\" event for it\n    // can cause a spurious DOM selection update, disrupting mouse\n    // drag selection.\n    if (forceSelUpdate ||\n        !(this.mouseDown && this.domObserver.currentSelection.eq(this.root.getSelection()) && anchorInRightPlace(this))) {\n      selectionToDOM(this, forceSelUpdate);\n    } else {\n      syncNodeSelection(this, state.selection);\n      this.domObserver.setCurSelection();\n    }\n    this.domObserver.start();\n  }\n\n  this.updatePluginViews(prev);\n\n  if (scroll == \"reset\") {\n    this.dom.scrollTop = 0;\n  } else if (scroll == \"to selection\") {\n    var startDOM = this.root.getSelection().focusNode;\n    if (this.someProp(\"handleScrollToSelection\", function (f) { return f(this$1); }))\n      ; // Handled\n    else if (state.selection instanceof NodeSelection)\n      { scrollRectIntoView(this, this.docView.domAfterPos(state.selection.from).getBoundingClientRect(), startDOM); }\n    else\n      { scrollRectIntoView(this, this.coordsAtPos(state.selection.head, 1), startDOM); }\n  } else if (oldScrollPos) {\n    resetScrollPos(oldScrollPos);\n  }\n};\n\nEditorView.prototype.destroyPluginViews = function destroyPluginViews () {\n  var view;\n  while (view = this.pluginViews.pop()) { if (view.destroy) { view.destroy(); } }\n};\n\nEditorView.prototype.updatePluginViews = function updatePluginViews (prevState) {\n  if (!prevState || prevState.plugins != this.state.plugins || this.directPlugins != this.prevDirectPlugins) {\n    this.prevDirectPlugins = this.directPlugins;\n    this.destroyPluginViews();\n    for (var i = 0; i < this.directPlugins.length; i++) {\n      var plugin = this.directPlugins[i];\n      if (plugin.spec.view) { this.pluginViews.push(plugin.spec.view(this)); }\n    }\n    for (var i$1 = 0; i$1 < this.state.plugins.length; i$1++) {\n      var plugin$1 = this.state.plugins[i$1];\n      if (plugin$1.spec.view) { this.pluginViews.push(plugin$1.spec.view(this)); }\n    }\n  } else {\n    for (var i$2 = 0; i$2 < this.pluginViews.length; i$2++) {\n      var pluginView = this.pluginViews[i$2];\n      if (pluginView.update) { pluginView.update(this, prevState); }\n    }\n  }\n};\n\n// :: (string, ?(prop: *) → *) → *\n// Goes over the values of a prop, first those provided directly,\n// then those from plugins given to the view, then from plugins in\n// the state (in order), and calls `f` every time a non-undefined\n// value is found. When `f` returns a truthy value, that is\n// immediately returned. When `f` isn't provided, it is treated as\n// the identity function (the prop value is returned directly).\nEditorView.prototype.someProp = function someProp (propName, f) {\n  var prop = this._props && this._props[propName], value;\n  if (prop != null && (value = f ? f(prop) : prop)) { return value }\n  for (var i = 0; i < this.directPlugins.length; i++) {\n    var prop$1 = this.directPlugins[i].props[propName];\n    if (prop$1 != null && (value = f ? f(prop$1) : prop$1)) { return value }\n  }\n  var plugins = this.state.plugins;\n  if (plugins) { for (var i$1 = 0; i$1 < plugins.length; i$1++) {\n    var prop$2 = plugins[i$1].props[propName];\n    if (prop$2 != null && (value = f ? f(prop$2) : prop$2)) { return value }\n  } }\n};\n\n// :: () → bool\n// Query whether the view has focus.\nEditorView.prototype.hasFocus = function hasFocus () {\n  return this.root.activeElement == this.dom\n};\n\n// :: ()\n// Focus the editor.\nEditorView.prototype.focus = function focus () {\n  this.domObserver.stop();\n  if (this.editable) { focusPreventScroll(this.dom); }\n  selectionToDOM(this);\n  this.domObserver.start();\n};\n\n// :: union<dom.Document, dom.DocumentFragment>\n// Get the document root in which the editor exists. This will\n// usually be the top-level `document`, but might be a [shadow\n// DOM](https://developer.mozilla.org/en-US/docs/Web/Web_Components/Shadow_DOM)\n// root if the editor is inside one.\nprototypeAccessors$2.root.get = function () {\n  var cached = this._root;\n  if (cached == null) { for (var search = this.dom.parentNode; search; search = search.parentNode) {\n    if (search.nodeType == 9 || (search.nodeType == 11 && search.host)) {\n      if (!search.getSelection) { Object.getPrototypeOf(search).getSelection = function () { return document.getSelection(); }; }\n      return this._root = search\n    }\n  } }\n  return cached || document\n};\n\n// :: ({left: number, top: number}) → ?{pos: number, inside: number}\n// Given a pair of viewport coordinates, return the document\n// position that corresponds to them. May return null if the given\n// coordinates aren't inside of the editor. When an object is\n// returned, its `pos` property is the position nearest to the\n// coordinates, and its `inside` property holds the position of the\n// inner node that the position falls inside of, or -1 if it is at\n// the top level, not in any node.\nEditorView.prototype.posAtCoords = function posAtCoords$1 (coords) {\n  return posAtCoords(this, coords)\n};\n\n// :: (number, number) → {left: number, right: number, top: number, bottom: number}\n// Returns the viewport rectangle at a given document position.\n// `left` and `right` will be the same number, as this returns a\n// flat cursor-ish rectangle. If the position is between two things\n// that aren't directly adjacent, `side` determines which element is\n// used. When < 0, the element before the position is used,\n// otherwise the element after.\nEditorView.prototype.coordsAtPos = function coordsAtPos$1 (pos, side) {\n    if ( side === void 0 ) side = 1;\n\n  return coordsAtPos(this, pos, side)\n};\n\n// :: (number, number) → {node: dom.Node, offset: number}\n// Find the DOM position that corresponds to the given document\n// position. When `side` is negative, find the position as close as\n// possible to the content before the position. When positive,\n// prefer positions close to the content after the position. When\n// zero, prefer as shallow a position as possible.\n//\n// Note that you should **not** mutate the editor's internal DOM,\n// only inspect it (and even that is usually not necessary).\nEditorView.prototype.domAtPos = function domAtPos (pos, side) {\n    if ( side === void 0 ) side = 0;\n\n  return this.docView.domFromPos(pos, side)\n};\n\n// :: (number) → ?dom.Node\n// Find the DOM node that represents the document node after the\n// given position. May return `null` when the position doesn't point\n// in front of a node or if the node is inside an opaque node view.\n//\n// This is intended to be able to call things like\n// `getBoundingClientRect` on that DOM node. Do **not** mutate the\n// editor DOM directly, or add styling this way, since that will be\n// immediately overriden by the editor as it redraws the node.\nEditorView.prototype.nodeDOM = function nodeDOM (pos) {\n  var desc = this.docView.descAt(pos);\n  return desc ? desc.nodeDOM : null\n};\n\n// :: (dom.Node, number, ?number) → number\n// Find the document position that corresponds to a given DOM\n// position. (Whenever possible, it is preferable to inspect the\n// document structure directly, rather than poking around in the\n// DOM, but sometimes—for example when interpreting an event\n// target—you don't have a choice.)\n//\n// The `bias` parameter can be used to influence which side of a DOM\n// node to use when the position is inside a leaf node.\nEditorView.prototype.posAtDOM = function posAtDOM (node, offset, bias) {\n    if ( bias === void 0 ) bias = -1;\n\n  var pos = this.docView.posFromDOM(node, offset, bias);\n  if (pos == null) { throw new RangeError(\"DOM position not inside the editor\") }\n  return pos\n};\n\n// :: (union<\"up\", \"down\", \"left\", \"right\", \"forward\", \"backward\">, ?EditorState) → bool\n// Find out whether the selection is at the end of a textblock when\n// moving in a given direction. When, for example, given `\"left\"`,\n// it will return true if moving left from the current cursor\n// position would leave that position's parent textblock. Will apply\n// to the view's current state by default, but it is possible to\n// pass a different state.\nEditorView.prototype.endOfTextblock = function endOfTextblock$1 (dir, state) {\n  return endOfTextblock(this, state || this.state, dir)\n};\n\n// :: ()\n// Removes the editor from the DOM and destroys all [node\n// views](#view.NodeView).\nEditorView.prototype.destroy = function destroy () {\n  if (!this.docView) { return }\n  destroyInput(this);\n  this.destroyPluginViews();\n  if (this.mounted) {\n    this.docView.update(this.state.doc, [], viewDecorations(this), this);\n    this.dom.textContent = \"\";\n  } else if (this.dom.parentNode) {\n    this.dom.parentNode.removeChild(this.dom);\n  }\n  this.docView.destroy();\n  this.docView = null;\n};\n\n// :: boolean\n// This is true when the view has been\n// [destroyed](#view.EditorView.destroy) (and thus should not be\n// used anymore).\nprototypeAccessors$2.isDestroyed.get = function () {\n  return this.docView == null\n};\n\n// Used for testing.\nEditorView.prototype.dispatchEvent = function dispatchEvent$1 (event) {\n  return dispatchEvent(this, event)\n};\n\n// :: (Transaction)\n// Dispatch a transaction. Will call\n// [`dispatchTransaction`](#view.DirectEditorProps.dispatchTransaction)\n// when given, and otherwise defaults to applying the transaction to\n// the current state and calling\n// [`updateState`](#view.EditorView.updateState) with the result.\n// This method is bound to the view instance, so that it can be\n// easily passed around.\nEditorView.prototype.dispatch = function dispatch (tr) {\n  var dispatchTransaction = this._props.dispatchTransaction;\n  if (dispatchTransaction) { dispatchTransaction.call(this, tr); }\n  else { this.updateState(this.state.apply(tr)); }\n};\n\nObject.defineProperties( EditorView.prototype, prototypeAccessors$2 );\n\nfunction computeDocDeco(view) {\n  var attrs = Object.create(null);\n  attrs.class = \"ProseMirror\";\n  attrs.contenteditable = String(view.editable);\n  attrs.translate = \"no\";\n\n  view.someProp(\"attributes\", function (value) {\n    if (typeof value == \"function\") { value = value(view.state); }\n    if (value) { for (var attr in value) {\n      if (attr == \"class\")\n        { attrs.class += \" \" + value[attr]; }\n      if (attr == \"style\") {\n        attrs.style = (attrs.style ? attrs.style + \";\" : \"\") + value[attr];\n      }\n      else if (!attrs[attr] && attr != \"contenteditable\" && attr != \"nodeName\")\n        { attrs[attr] = String(value[attr]); }\n    } }\n  });\n\n  return [Decoration.node(0, view.state.doc.content.size, attrs)]\n}\n\nfunction updateCursorWrapper(view) {\n  if (view.markCursor) {\n    var dom = document.createElement(\"img\");\n    dom.className = \"ProseMirror-separator\";\n    dom.setAttribute(\"mark-placeholder\", \"true\");\n    view.cursorWrapper = {dom: dom, deco: Decoration.widget(view.state.selection.head, dom, {raw: true, marks: view.markCursor})};\n  } else {\n    view.cursorWrapper = null;\n  }\n}\n\nfunction getEditable(view) {\n  return !view.someProp(\"editable\", function (value) { return value(view.state) === false; })\n}\n\nfunction selectionContextChanged(sel1, sel2) {\n  var depth = Math.min(sel1.$anchor.sharedDepth(sel1.head), sel2.$anchor.sharedDepth(sel2.head));\n  return sel1.$anchor.start(depth) != sel2.$anchor.start(depth)\n}\n\nfunction buildNodeViews(view) {\n  var result = {};\n  view.someProp(\"nodeViews\", function (obj) {\n    for (var prop in obj) { if (!Object.prototype.hasOwnProperty.call(result, prop))\n      { result[prop] = obj[prop]; } }\n  });\n  return result\n}\n\nfunction changedNodeViews(a, b) {\n  var nA = 0, nB = 0;\n  for (var prop in a) {\n    if (a[prop] != b[prop]) { return true }\n    nA++;\n  }\n  for (var _ in b) { nB++; }\n  return nA != nB\n}\n\nfunction checkStateComponent(plugin) {\n  if (plugin.spec.state || plugin.spec.filterTransaction || plugin.spec.appendTransaction)\n    { throw new RangeError(\"Plugins passed directly to the view must not have a state component\") }\n}\n\n// EditorProps:: interface\n//\n// Props are configuration values that can be passed to an editor view\n// or included in a plugin. This interface lists the supported props.\n//\n// The various event-handling functions may all return `true` to\n// indicate that they handled the given event. The view will then take\n// care to call `preventDefault` on the event, except with\n// `handleDOMEvents`, where the handler itself is responsible for that.\n//\n// How a prop is resolved depends on the prop. Handler functions are\n// called one at a time, starting with the base props and then\n// searching through the plugins (in order of appearance) until one of\n// them returns true. For some props, the first plugin that yields a\n// value gets precedence.\n//\n//   handleDOMEvents:: ?Object<(view: EditorView, event: dom.Event) → bool>\n//   Can be an object mapping DOM event type names to functions that\n//   handle them. Such functions will be called before any handling\n//   ProseMirror does of events fired on the editable DOM element.\n//   Contrary to the other event handling props, when returning true\n//   from such a function, you are responsible for calling\n//   `preventDefault` yourself (or not, if you want to allow the\n//   default behavior).\n//\n//   handleKeyDown:: ?(view: EditorView, event: dom.KeyboardEvent) → bool\n//   Called when the editor receives a `keydown` event.\n//\n//   handleKeyPress:: ?(view: EditorView, event: dom.KeyboardEvent) → bool\n//   Handler for `keypress` events.\n//\n//   handleTextInput:: ?(view: EditorView, from: number, to: number, text: string) → bool\n//   Whenever the user directly input text, this handler is called\n//   before the input is applied. If it returns `true`, the default\n//   behavior of actually inserting the text is suppressed.\n//\n//   handleClickOn:: ?(view: EditorView, pos: number, node: Node, nodePos: number, event: dom.MouseEvent, direct: bool) → bool\n//   Called for each node around a click, from the inside out. The\n//   `direct` flag will be true for the inner node.\n//\n//   handleClick:: ?(view: EditorView, pos: number, event: dom.MouseEvent) → bool\n//   Called when the editor is clicked, after `handleClickOn` handlers\n//   have been called.\n//\n//   handleDoubleClickOn:: ?(view: EditorView, pos: number, node: Node, nodePos: number, event: dom.MouseEvent, direct: bool) → bool\n//   Called for each node around a double click.\n//\n//   handleDoubleClick:: ?(view: EditorView, pos: number, event: dom.MouseEvent) → bool\n//   Called when the editor is double-clicked, after `handleDoubleClickOn`.\n//\n//   handleTripleClickOn:: ?(view: EditorView, pos: number, node: Node, nodePos: number, event: dom.MouseEvent, direct: bool) → bool\n//   Called for each node around a triple click.\n//\n//   handleTripleClick:: ?(view: EditorView, pos: number, event: dom.MouseEvent) → bool\n//   Called when the editor is triple-clicked, after `handleTripleClickOn`.\n//\n//   handlePaste:: ?(view: EditorView, event: dom.ClipboardEvent, slice: Slice) → bool\n//   Can be used to override the behavior of pasting. `slice` is the\n//   pasted content parsed by the editor, but you can directly access\n//   the event to get at the raw content.\n//\n//   handleDrop:: ?(view: EditorView, event: dom.Event, slice: Slice, moved: bool) → bool\n//   Called when something is dropped on the editor. `moved` will be\n//   true if this drop moves from the current selection (which should\n//   thus be deleted).\n//\n//   handleScrollToSelection:: ?(view: EditorView) → bool\n//   Called when the view, after updating its state, tries to scroll\n//   the selection into view. A handler function may return false to\n//   indicate that it did not handle the scrolling and further\n//   handlers or the default behavior should be tried.\n//\n//   createSelectionBetween:: ?(view: EditorView, anchor: ResolvedPos, head: ResolvedPos) → ?Selection\n//   Can be used to override the way a selection is created when\n//   reading a DOM selection between the given anchor and head.\n//\n//   domParser:: ?DOMParser\n//   The [parser](#model.DOMParser) to use when reading editor changes\n//   from the DOM. Defaults to calling\n//   [`DOMParser.fromSchema`](#model.DOMParser^fromSchema) on the\n//   editor's schema.\n//\n//   transformPastedHTML:: ?(html: string) → string\n//   Can be used to transform pasted HTML text, _before_ it is parsed,\n//   for example to clean it up.\n//\n//   clipboardParser:: ?DOMParser\n//   The [parser](#model.DOMParser) to use when reading content from\n//   the clipboard. When not given, the value of the\n//   [`domParser`](#view.EditorProps.domParser) prop is used.\n//\n//   transformPastedText:: ?(text: string, plain: bool) → string\n//   Transform pasted plain text. The `plain` flag will be true when\n//   the text is pasted as plain text.\n//\n//   clipboardTextParser:: ?(text: string, $context: ResolvedPos, plain: bool) → Slice\n//   A function to parse text from the clipboard into a document\n//   slice. Called after\n//   [`transformPastedText`](#view.EditorProps.transformPastedText).\n//   The default behavior is to split the text into lines, wrap them\n//   in `<p>` tags, and call\n//   [`clipboardParser`](#view.EditorProps.clipboardParser) on it.\n//   The `plain` flag will be true when the text is pasted as plain text.\n//\n//   transformPasted:: ?(Slice) → Slice\n//   Can be used to transform pasted content before it is applied to\n//   the document.\n//\n//   nodeViews:: ?Object<(node: Node, view: EditorView, getPos: () → number, decorations: [Decoration], innerDecorations: DecorationSource) → NodeView>\n//   Allows you to pass custom rendering and behavior logic for nodes\n//   and marks. Should map node and mark names to constructor\n//   functions that produce a [`NodeView`](#view.NodeView) object\n//   implementing the node's display behavior. For nodes, the third\n//   argument `getPos` is a function that can be called to get the\n//   node's current position, which can be useful when creating\n//   transactions to update it. For marks, the third argument is a\n//   boolean that indicates whether the mark's content is inline.\n//\n//   `decorations` is an array of node or inline decorations that are\n//   active around the node. They are automatically drawn in the\n//   normal way, and you will usually just want to ignore this, but\n//   they can also be used as a way to provide context information to\n//   the node view without adding it to the document itself.\n//\n//   `innerDecorations` holds the decorations for the node's content.\n//   You can safely ignore this if your view has no content or a\n//   `contentDOM` property, since the editor will draw the decorations\n//   on the content. But if you, for example, want to create a nested\n//   editor with the content, it may make sense to provide it with the\n//   inner decorations.\n//\n//   clipboardSerializer:: ?DOMSerializer\n//   The DOM serializer to use when putting content onto the\n//   clipboard. If not given, the result of\n//   [`DOMSerializer.fromSchema`](#model.DOMSerializer^fromSchema)\n//   will be used.\n//\n//   clipboardTextSerializer:: ?(Slice) → string\n//   A function that will be called to get the text for the current\n//   selection when copying text to the clipboard. By default, the\n//   editor will use [`textBetween`](#model.Node.textBetween) on the\n//   selected range.\n//\n//   decorations:: ?(state: EditorState) → ?DecorationSource\n//   A set of [document decorations](#view.Decoration) to show in the\n//   view.\n//\n//   editable:: ?(state: EditorState) → bool\n//   When this returns false, the content of the view is not directly\n//   editable.\n//\n//   attributes:: ?union<Object<string>, (EditorState) → ?Object<string>>\n//   Control the DOM attributes of the editable element. May be either\n//   an object or a function going from an editor state to an object.\n//   By default, the element will get a class `\"ProseMirror\"`, and\n//   will have its `contentEditable` attribute determined by the\n//   [`editable` prop](#view.EditorProps.editable). Additional classes\n//   provided here will be added to the class. For other attributes,\n//   the value provided first (as in\n//   [`someProp`](#view.EditorView.someProp)) will be used.\n//\n//   scrollThreshold:: ?union<number, {top: number, right: number, bottom: number, left: number}>\n//   Determines the distance (in pixels) between the cursor and the\n//   end of the visible viewport at which point, when scrolling the\n//   cursor into view, scrolling takes place. Defaults to 0.\n//\n//   scrollMargin:: ?union<number, {top: number, right: number, bottom: number, left: number}>\n//   Determines the extra space (in pixels) that is left above or\n//   below the cursor when it is scrolled into view. Defaults to 5.\n\n// DirectEditorProps:: interface extends EditorProps\n//\n// The props object given directly to the editor view supports two\n// fields that can't be used in plugins:\n//\n//   state:: EditorState\n//   The current state of the editor.\n//\n//   plugins:: [Plugin]\n//   A set of plugins to use in the view, applying their [plugin\n//   view](#state.PluginSpec.view) and\n//   [props](#state.PluginSpec.props). Passing plugins with a state\n//   component (a [state field](#state.PluginSpec.state) field or a\n//   [transaction](#state.PluginSpec.filterTransaction) filter or\n//   appender) will result in an error, since such plugins must be\n//   present in the state to work.\n//\n//   dispatchTransaction:: ?(tr: Transaction)\n//   The callback over which to send transactions (state updates)\n//   produced by the view. If you specify this, you probably want to\n//   make sure this ends up calling the view's\n//   [`updateState`](#view.EditorView.updateState) method with a new\n//   state that has the transaction\n//   [applied](#state.EditorState.apply). The callback will be bound to have\n//   the view instance as its `this` binding.\n\nexport { Decoration, DecorationSet, EditorView, endComposition as __endComposition, parseFromClipboard as __parseFromClipboard, serializeForClipboard as __serializeForClipboard };\n//# sourceMappingURL=index.es.js.map\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _ImageZoom = require('./ImageZoom');\n\nvar _ImageZoom2 = _interopRequireDefault(_ImageZoom);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = _ImageZoom2.default;","'use strict';\nvar $ = require('../internals/export');\nvar IS_PURE = require('../internals/is-pure');\nvar collectionDeleteAll = require('../internals/collection-delete-all');\n\n// `WeakMap.prototype.deleteAll` method\n// https://github.com/tc39/proposal-collection-methods\n$({ target: 'WeakMap', proto: true, real: true, forced: IS_PURE }, {\n  deleteAll: function deleteAll(/* ...elements */) {\n    return collectionDeleteAll.apply(this, arguments);\n  }\n});\n",";(function (root, factory) {\n\tif (typeof exports === \"object\") {\n\t\t// CommonJS\n\t\tmodule.exports = exports = factory(require(\"./core\"));\n\t}\n\telse if (typeof define === \"function\" && define.amd) {\n\t\t// AMD\n\t\tdefine([\"./core\"], factory);\n\t}\n\telse {\n\t\t// Global (browser)\n\t\tfactory(root.CryptoJS);\n\t}\n}(this, function (CryptoJS) {\n\n\t(function (Math) {\n\t    // Shortcuts\n\t    var C = CryptoJS;\n\t    var C_lib = C.lib;\n\t    var WordArray = C_lib.WordArray;\n\t    var Hasher = C_lib.Hasher;\n\t    var C_algo = C.algo;\n\n\t    // Constants table\n\t    var T = [];\n\n\t    // Compute constants\n\t    (function () {\n\t        for (var i = 0; i < 64; i++) {\n\t            T[i] = (Math.abs(Math.sin(i + 1)) * 0x100000000) | 0;\n\t        }\n\t    }());\n\n\t    /**\n\t     * MD5 hash algorithm.\n\t     */\n\t    var MD5 = C_algo.MD5 = Hasher.extend({\n\t        _doReset: function () {\n\t            this._hash = new WordArray.init([\n\t                0x67452301, 0xefcdab89,\n\t                0x98badcfe, 0x10325476\n\t            ]);\n\t        },\n\n\t        _doProcessBlock: function (M, offset) {\n\t            // Swap endian\n\t            for (var i = 0; i < 16; i++) {\n\t                // Shortcuts\n\t                var offset_i = offset + i;\n\t                var M_offset_i = M[offset_i];\n\n\t                M[offset_i] = (\n\t                    (((M_offset_i << 8)  | (M_offset_i >>> 24)) & 0x00ff00ff) |\n\t                    (((M_offset_i << 24) | (M_offset_i >>> 8))  & 0xff00ff00)\n\t                );\n\t            }\n\n\t            // Shortcuts\n\t            var H = this._hash.words;\n\n\t            var M_offset_0  = M[offset + 0];\n\t            var M_offset_1  = M[offset + 1];\n\t            var M_offset_2  = M[offset + 2];\n\t            var M_offset_3  = M[offset + 3];\n\t            var M_offset_4  = M[offset + 4];\n\t            var M_offset_5  = M[offset + 5];\n\t            var M_offset_6  = M[offset + 6];\n\t            var M_offset_7  = M[offset + 7];\n\t            var M_offset_8  = M[offset + 8];\n\t            var M_offset_9  = M[offset + 9];\n\t            var M_offset_10 = M[offset + 10];\n\t            var M_offset_11 = M[offset + 11];\n\t            var M_offset_12 = M[offset + 12];\n\t            var M_offset_13 = M[offset + 13];\n\t            var M_offset_14 = M[offset + 14];\n\t            var M_offset_15 = M[offset + 15];\n\n\t            // Working varialbes\n\t            var a = H[0];\n\t            var b = H[1];\n\t            var c = H[2];\n\t            var d = H[3];\n\n\t            // Computation\n\t            a = FF(a, b, c, d, M_offset_0,  7,  T[0]);\n\t            d = FF(d, a, b, c, M_offset_1,  12, T[1]);\n\t            c = FF(c, d, a, b, M_offset_2,  17, T[2]);\n\t            b = FF(b, c, d, a, M_offset_3,  22, T[3]);\n\t            a = FF(a, b, c, d, M_offset_4,  7,  T[4]);\n\t            d = FF(d, a, b, c, M_offset_5,  12, T[5]);\n\t            c = FF(c, d, a, b, M_offset_6,  17, T[6]);\n\t            b = FF(b, c, d, a, M_offset_7,  22, T[7]);\n\t            a = FF(a, b, c, d, M_offset_8,  7,  T[8]);\n\t            d = FF(d, a, b, c, M_offset_9,  12, T[9]);\n\t            c = FF(c, d, a, b, M_offset_10, 17, T[10]);\n\t            b = FF(b, c, d, a, M_offset_11, 22, T[11]);\n\t            a = FF(a, b, c, d, M_offset_12, 7,  T[12]);\n\t            d = FF(d, a, b, c, M_offset_13, 12, T[13]);\n\t            c = FF(c, d, a, b, M_offset_14, 17, T[14]);\n\t            b = FF(b, c, d, a, M_offset_15, 22, T[15]);\n\n\t            a = GG(a, b, c, d, M_offset_1,  5,  T[16]);\n\t            d = GG(d, a, b, c, M_offset_6,  9,  T[17]);\n\t            c = GG(c, d, a, b, M_offset_11, 14, T[18]);\n\t            b = GG(b, c, d, a, M_offset_0,  20, T[19]);\n\t            a = GG(a, b, c, d, M_offset_5,  5,  T[20]);\n\t            d = GG(d, a, b, c, M_offset_10, 9,  T[21]);\n\t            c = GG(c, d, a, b, M_offset_15, 14, T[22]);\n\t            b = GG(b, c, d, a, M_offset_4,  20, T[23]);\n\t            a = GG(a, b, c, d, M_offset_9,  5,  T[24]);\n\t            d = GG(d, a, b, c, M_offset_14, 9,  T[25]);\n\t            c = GG(c, d, a, b, M_offset_3,  14, T[26]);\n\t            b = GG(b, c, d, a, M_offset_8,  20, T[27]);\n\t            a = GG(a, b, c, d, M_offset_13, 5,  T[28]);\n\t            d = GG(d, a, b, c, M_offset_2,  9,  T[29]);\n\t            c = GG(c, d, a, b, M_offset_7,  14, T[30]);\n\t            b = GG(b, c, d, a, M_offset_12, 20, T[31]);\n\n\t            a = HH(a, b, c, d, M_offset_5,  4,  T[32]);\n\t            d = HH(d, a, b, c, M_offset_8,  11, T[33]);\n\t            c = HH(c, d, a, b, M_offset_11, 16, T[34]);\n\t            b = HH(b, c, d, a, M_offset_14, 23, T[35]);\n\t            a = HH(a, b, c, d, M_offset_1,  4,  T[36]);\n\t            d = HH(d, a, b, c, M_offset_4,  11, T[37]);\n\t            c = HH(c, d, a, b, M_offset_7,  16, T[38]);\n\t            b = HH(b, c, d, a, M_offset_10, 23, T[39]);\n\t            a = HH(a, b, c, d, M_offset_13, 4,  T[40]);\n\t            d = HH(d, a, b, c, M_offset_0,  11, T[41]);\n\t            c = HH(c, d, a, b, M_offset_3,  16, T[42]);\n\t            b = HH(b, c, d, a, M_offset_6,  23, T[43]);\n\t            a = HH(a, b, c, d, M_offset_9,  4,  T[44]);\n\t            d = HH(d, a, b, c, M_offset_12, 11, T[45]);\n\t            c = HH(c, d, a, b, M_offset_15, 16, T[46]);\n\t            b = HH(b, c, d, a, M_offset_2,  23, T[47]);\n\n\t            a = II(a, b, c, d, M_offset_0,  6,  T[48]);\n\t            d = II(d, a, b, c, M_offset_7,  10, T[49]);\n\t            c = II(c, d, a, b, M_offset_14, 15, T[50]);\n\t            b = II(b, c, d, a, M_offset_5,  21, T[51]);\n\t            a = II(a, b, c, d, M_offset_12, 6,  T[52]);\n\t            d = II(d, a, b, c, M_offset_3,  10, T[53]);\n\t            c = II(c, d, a, b, M_offset_10, 15, T[54]);\n\t            b = II(b, c, d, a, M_offset_1,  21, T[55]);\n\t            a = II(a, b, c, d, M_offset_8,  6,  T[56]);\n\t            d = II(d, a, b, c, M_offset_15, 10, T[57]);\n\t            c = II(c, d, a, b, M_offset_6,  15, T[58]);\n\t            b = II(b, c, d, a, M_offset_13, 21, T[59]);\n\t            a = II(a, b, c, d, M_offset_4,  6,  T[60]);\n\t            d = II(d, a, b, c, M_offset_11, 10, T[61]);\n\t            c = II(c, d, a, b, M_offset_2,  15, T[62]);\n\t            b = II(b, c, d, a, M_offset_9,  21, T[63]);\n\n\t            // Intermediate hash value\n\t            H[0] = (H[0] + a) | 0;\n\t            H[1] = (H[1] + b) | 0;\n\t            H[2] = (H[2] + c) | 0;\n\t            H[3] = (H[3] + d) | 0;\n\t        },\n\n\t        _doFinalize: function () {\n\t            // Shortcuts\n\t            var data = this._data;\n\t            var dataWords = data.words;\n\n\t            var nBitsTotal = this._nDataBytes * 8;\n\t            var nBitsLeft = data.sigBytes * 8;\n\n\t            // Add padding\n\t            dataWords[nBitsLeft >>> 5] |= 0x80 << (24 - nBitsLeft % 32);\n\n\t            var nBitsTotalH = Math.floor(nBitsTotal / 0x100000000);\n\t            var nBitsTotalL = nBitsTotal;\n\t            dataWords[(((nBitsLeft + 64) >>> 9) << 4) + 15] = (\n\t                (((nBitsTotalH << 8)  | (nBitsTotalH >>> 24)) & 0x00ff00ff) |\n\t                (((nBitsTotalH << 24) | (nBitsTotalH >>> 8))  & 0xff00ff00)\n\t            );\n\t            dataWords[(((nBitsLeft + 64) >>> 9) << 4) + 14] = (\n\t                (((nBitsTotalL << 8)  | (nBitsTotalL >>> 24)) & 0x00ff00ff) |\n\t                (((nBitsTotalL << 24) | (nBitsTotalL >>> 8))  & 0xff00ff00)\n\t            );\n\n\t            data.sigBytes = (dataWords.length + 1) * 4;\n\n\t            // Hash final blocks\n\t            this._process();\n\n\t            // Shortcuts\n\t            var hash = this._hash;\n\t            var H = hash.words;\n\n\t            // Swap endian\n\t            for (var i = 0; i < 4; i++) {\n\t                // Shortcut\n\t                var H_i = H[i];\n\n\t                H[i] = (((H_i << 8)  | (H_i >>> 24)) & 0x00ff00ff) |\n\t                       (((H_i << 24) | (H_i >>> 8))  & 0xff00ff00);\n\t            }\n\n\t            // Return final computed hash\n\t            return hash;\n\t        },\n\n\t        clone: function () {\n\t            var clone = Hasher.clone.call(this);\n\t            clone._hash = this._hash.clone();\n\n\t            return clone;\n\t        }\n\t    });\n\n\t    function FF(a, b, c, d, x, s, t) {\n\t        var n = a + ((b & c) | (~b & d)) + x + t;\n\t        return ((n << s) | (n >>> (32 - s))) + b;\n\t    }\n\n\t    function GG(a, b, c, d, x, s, t) {\n\t        var n = a + ((b & d) | (c & ~d)) + x + t;\n\t        return ((n << s) | (n >>> (32 - s))) + b;\n\t    }\n\n\t    function HH(a, b, c, d, x, s, t) {\n\t        var n = a + (b ^ c ^ d) + x + t;\n\t        return ((n << s) | (n >>> (32 - s))) + b;\n\t    }\n\n\t    function II(a, b, c, d, x, s, t) {\n\t        var n = a + (c ^ (b | ~d)) + x + t;\n\t        return ((n << s) | (n >>> (32 - s))) + b;\n\t    }\n\n\t    /**\n\t     * Shortcut function to the hasher's object interface.\n\t     *\n\t     * @param {WordArray|string} message The message to hash.\n\t     *\n\t     * @return {WordArray} The hash.\n\t     *\n\t     * @static\n\t     *\n\t     * @example\n\t     *\n\t     *     var hash = CryptoJS.MD5('message');\n\t     *     var hash = CryptoJS.MD5(wordArray);\n\t     */\n\t    C.MD5 = Hasher._createHelper(MD5);\n\n\t    /**\n\t     * Shortcut function to the HMAC's object interface.\n\t     *\n\t     * @param {WordArray|string} message The message to hash.\n\t     * @param {WordArray|string} key The secret key.\n\t     *\n\t     * @return {WordArray} The HMAC.\n\t     *\n\t     * @static\n\t     *\n\t     * @example\n\t     *\n\t     *     var hmac = CryptoJS.HmacMD5(message, key);\n\t     */\n\t    C.HmacMD5 = Hasher._createHmacHelper(MD5);\n\t}(Math));\n\n\n\treturn CryptoJS.MD5;\n\n}));","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _reactDom = require('react-dom');\n\nvar _propTypes = require('prop-types');\n\nvar _defaults = require('./defaults');\n\nvar _defaults2 = _interopRequireDefault(_defaults);\n\nvar _helpers = require('./helpers');\n\nvar _keyboardEvents = require('./keyboardEvents');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar EventsWrapper = function (_Component) {\n  _inherits(EventsWrapper, _Component);\n\n  function EventsWrapper() {\n    _classCallCheck(this, EventsWrapper);\n\n    var _this = _possibleConstructorReturn(this, (EventsWrapper.__proto__ || Object.getPrototypeOf(EventsWrapper)).call(this));\n\n    _this.portal = (0, _helpers.createPortalContainer)('div');\n    _this.unzoom = _this.unzoom.bind(_this);\n    _this._handleScroll = _this._handleScroll.bind(_this);\n    _this._handleKeyDown = _this._handleKeyDown.bind(_this);\n    _this._handleResize = _this._handleResize.bind(_this);\n    _this._handleTouchStart = _this._handleTouchStart.bind(_this);\n    _this._handleTouchMove = _this._handleTouchMove.bind(_this);\n    _this._handleTouchEnd = _this._handleTouchEnd.bind(_this);\n    return _this;\n  }\n\n  _createClass(EventsWrapper, [{\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      this.pageYOffset = window.pageYOffset;\n      this.loadTimeout = setTimeout(function () {\n        window.addEventListener('scroll', _this2._handleScroll);\n        window.addEventListener('keydown', _this2._handleKeyDown);\n        window.addEventListener('ontouchstart', _this2._handleTouchStart);\n        window.addEventListener('ontouchmove', _this2._handleTouchMove);\n        window.addEventListener('ontouchend', _this2._handleTouchEnd);\n        window.addEventListener('ontouchcancel', _this2._handleTouchEnd);\n        window.addEventListener('resize', _this2._handleResize);\n      }, _defaults2.default.transitionDuration);\n    }\n  }, {\n    key: 'componentWillUnmount',\n    value: function componentWillUnmount() {\n      clearTimeout(this.loadTimeout);\n      window.removeEventListener('scroll', this._handleScroll);\n      window.removeEventListener('keydown', this._handleKeyDown);\n      window.removeEventListener('ontouchstart', this._handleTouchStart);\n      window.removeEventListener('ontouchmove', this._handleTouchMove);\n      window.removeEventListener('ontouchend', this._handleTouchEnd);\n      window.removeEventListener('ontouchcancel', this._handleTouchEnd);\n      window.removeEventListener('resize', this._handleResize);\n      (0, _helpers.removePortalContainer)(this.portal);\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      return this.portal ? (0, _reactDom.createPortal)(_react2.default.createElement(\n        'div',\n        { onClick: this.unzoom },\n        this._cloneChild()\n      ), this.portal) : null;\n    }\n  }, {\n    key: 'unzoom',\n    value: function unzoom() {\n      var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n          force = _ref.force,\n          allowRefocus = _ref.allowRefocus;\n\n      if (this.props.controlledEventFn && !force) {\n        return this.props.controlledEventFn();\n      }\n\n      return this.child.unzoom(allowRefocus);\n    }\n  }, {\n    key: '_cloneChild',\n    value: function _cloneChild() {\n      var _this3 = this;\n\n      return _react2.default.cloneElement(_react2.default.Children.only(this.props.children), {\n        ref: function ref(child) {\n          _this3.child = child;\n        }\n      });\n    }\n  }, {\n    key: '_handleKeyDown',\n    value: function _handleKeyDown(e) {\n      if ((0, _keyboardEvents.isTabKey)(e)) {\n        e.preventDefault(); // prevent in-behind controls from grabbing focus\n        return;\n      }\n\n      var allowAccessibilityClose = this.props.allowAccessibilityClose;\n\n      var unzoomForEnterOrSpace = allowAccessibilityClose && (0, _keyboardEvents.isEnterOrSpaceBarKey)(e);\n      var unzoomForEscape = (0, _keyboardEvents.isEscapeKey)(e);\n\n      if (unzoomForEnterOrSpace) {\n        e.preventDefault(); // prevent space bar from scrolling\n      }\n\n      if (unzoomForEnterOrSpace || unzoomForEscape) {\n        this.unzoom({ allowRefocus: true });\n      }\n    }\n  }, {\n    key: '_handleResize',\n    value: function _handleResize() {\n      this.forceUpdate();\n    }\n  }, {\n    key: '_handleScroll',\n    value: function _handleScroll() {\n      this.forceUpdate();\n      var scrollChange = Math.abs(window.pageYOffset - this.pageYOffset);\n      if (scrollChange > 10) {\n        this.unzoom();\n      }\n    }\n  }, {\n    key: '_handleTouchStart',\n    value: function _handleTouchStart(e) {\n      this.yTouchPosition = e.touches[0].clientY;\n    }\n  }, {\n    key: '_handleTouchMove',\n    value: function _handleTouchMove(e) {\n      this.forceUpdate();\n      var touchChange = Math.abs(e.touches[0].clientY - this.yTouchPosition);\n      if (touchChange > 10) {\n        this.unzoom();\n      }\n    }\n  }, {\n    key: '_handleTouchEnd',\n    value: function _handleTouchEnd() {\n      delete this.yTouchPosition;\n    }\n  }]);\n\n  return EventsWrapper;\n}(_react.Component);\n\nexports.default = EventsWrapper;\n\n\nEventsWrapper.propTypes = {\n  children: _propTypes.element.isRequired,\n  getControlledEventFn: _propTypes.func\n};","var defineWellKnownSymbol = require('../internals/define-well-known-symbol');\n\n// `Symbol.replace` well-known symbol\n// https://tc39.es/ecma262/#sec-symbol.replace\ndefineWellKnownSymbol('replace');\n","'use strict';\nvar $ = require('../internals/export');\nvar IS_PURE = require('../internals/is-pure');\nvar NativePromise = require('../internals/native-promise-constructor');\nvar fails = require('../internals/fails');\nvar getBuiltIn = require('../internals/get-built-in');\nvar speciesConstructor = require('../internals/species-constructor');\nvar promiseResolve = require('../internals/promise-resolve');\nvar redefine = require('../internals/redefine');\n\n// Safari bug https://bugs.webkit.org/show_bug.cgi?id=200829\nvar NON_GENERIC = !!NativePromise && fails(function () {\n  NativePromise.prototype['finally'].call({ then: function () { /* empty */ } }, function () { /* empty */ });\n});\n\n// `Promise.prototype.finally` method\n// https://tc39.es/ecma262/#sec-promise.prototype.finally\n$({ target: 'Promise', proto: true, real: true, forced: NON_GENERIC }, {\n  'finally': function (onFinally) {\n    var C = speciesConstructor(this, getBuiltIn('Promise'));\n    var isFunction = typeof onFinally == 'function';\n    return this.then(\n      isFunction ? function (x) {\n        return promiseResolve(C, onFinally()).then(function () { return x; });\n      } : onFinally,\n      isFunction ? function (e) {\n        return promiseResolve(C, onFinally()).then(function () { throw e; });\n      } : onFinally\n    );\n  }\n});\n\n// patch native Promise.prototype for native async functions\nif (!IS_PURE && typeof NativePromise == 'function' && !NativePromise.prototype['finally']) {\n  redefine(NativePromise.prototype, 'finally', getBuiltIn('Promise').prototype['finally']);\n}\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar createPortalContainer = exports.createPortalContainer = function createPortalContainer(tag) {\n  var portal = document.createElement(tag);\n  document.body.appendChild(portal);\n  return portal;\n};\n\nvar removePortalContainer = exports.removePortalContainer = function removePortalContainer(portal) {\n  document.body.removeChild(portal);\n};\n\nvar fetchImage = exports.fetchImage = function fetchImage(image, cb) {\n  var src = image.src,\n      srcSet = image.srcSet,\n      sizes = image.sizes;\n\n  var img = new Image();\n  var onLoad = function onLoad() {\n    cb(img);\n\n    /**\n     * If using srcset, future resize events can trigger\n     * additional onload events to fire.\n     * Remove listener after first load\n     */\n    img.removeEventListener('load', onLoad);\n  };\n  img.addEventListener('load', onLoad);\n  img.src = src;\n  if (srcSet) img.srcset = srcSet;\n  if (sizes) img.sizes = sizes;\n};\n\n/**\n * Figure out how much to scale based\n * solely on no maxing out the browser\n */\nvar getScale = exports.getScale = function getScale(_ref) {\n  var width = _ref.width,\n      height = _ref.height,\n      zoomMargin = _ref.zoomMargin;\n\n  var scaleX = window.innerWidth / (width + zoomMargin);\n  var scaleY = window.innerHeight / (height + zoomMargin);\n  return Math.min(scaleX, scaleY);\n};\n\n/**\n * Figure out how much to scale so you're\n * not larger than the original image\n */\nvar getMaxDimensionScale = exports.getMaxDimensionScale = function getMaxDimensionScale(_ref2) {\n  var width = _ref2.width,\n      height = _ref2.height,\n      naturalWidth = _ref2.naturalWidth,\n      naturalHeight = _ref2.naturalHeight,\n      zoomMargin = _ref2.zoomMargin;\n\n  var scale = getScale({\n    width: naturalWidth,\n    height: naturalHeight,\n    zoomMargin: zoomMargin\n  });\n  var ratio = naturalWidth > naturalHeight ? naturalWidth / width : naturalHeight / height;\n  return scale > 1 ? ratio : scale * ratio;\n};\n\nvar isMaxDimension = exports.isMaxDimension = function isMaxDimension(img) {\n  return img.clientWidth >= img.naturalWidth || img.clientHeight >= img.naturalHeight;\n};","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require('prop-types');\n\nvar _defaults = require('./defaults');\n\nvar _defaults2 = _interopRequireDefault(_defaults);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar Overlay = function (_PureComponent) {\n  _inherits(Overlay, _PureComponent);\n\n  function Overlay(props) {\n    _classCallCheck(this, Overlay);\n\n    var _this = _possibleConstructorReturn(this, (Overlay.__proto__ || Object.getPrototypeOf(Overlay)).call(this, props));\n\n    _this.state = {\n      isMounted: false\n    };\n    return _this;\n  }\n\n  _createClass(Overlay, [{\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      this.setState({ isMounted: true });\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      return _react2.default.createElement('div', { style: this._getStyle() });\n    }\n  }, {\n    key: '_getStyle',\n    value: function _getStyle() {\n      var isVisible = this.state.isMounted && this.props.isVisible;\n      var opacity = isVisible & 1; // bitwise and; converts bool to 0 or 1\n      return _extends({}, _defaults2.default.styles.overlay, { opacity: opacity }, this.props.defaultStyles.overlay);\n    }\n  }]);\n\n  return Overlay;\n}(_react.PureComponent);\n\nexports.default = Overlay;\n\n\nOverlay.propTypes = {\n  isVisible: _propTypes.bool.isRequired,\n  defaultStyles: _propTypes.object.isRequired\n};","'use strict';\nvar redefineAll = require('../internals/redefine-all');\nvar getWeakData = require('../internals/internal-metadata').getWeakData;\nvar anObject = require('../internals/an-object');\nvar isObject = require('../internals/is-object');\nvar anInstance = require('../internals/an-instance');\nvar iterate = require('../internals/iterate');\nvar ArrayIterationModule = require('../internals/array-iteration');\nvar $has = require('../internals/has');\nvar InternalStateModule = require('../internals/internal-state');\n\nvar setInternalState = InternalStateModule.set;\nvar internalStateGetterFor = InternalStateModule.getterFor;\nvar find = ArrayIterationModule.find;\nvar findIndex = ArrayIterationModule.findIndex;\nvar id = 0;\n\n// fallback for uncaught frozen keys\nvar uncaughtFrozenStore = function (store) {\n  return store.frozen || (store.frozen = new UncaughtFrozenStore());\n};\n\nvar UncaughtFrozenStore = function () {\n  this.entries = [];\n};\n\nvar findUncaughtFrozen = function (store, key) {\n  return find(store.entries, function (it) {\n    return it[0] === key;\n  });\n};\n\nUncaughtFrozenStore.prototype = {\n  get: function (key) {\n    var entry = findUncaughtFrozen(this, key);\n    if (entry) return entry[1];\n  },\n  has: function (key) {\n    return !!findUncaughtFrozen(this, key);\n  },\n  set: function (key, value) {\n    var entry = findUncaughtFrozen(this, key);\n    if (entry) entry[1] = value;\n    else this.entries.push([key, value]);\n  },\n  'delete': function (key) {\n    var index = findIndex(this.entries, function (it) {\n      return it[0] === key;\n    });\n    if (~index) this.entries.splice(index, 1);\n    return !!~index;\n  }\n};\n\nmodule.exports = {\n  getConstructor: function (wrapper, CONSTRUCTOR_NAME, IS_MAP, ADDER) {\n    var C = wrapper(function (that, iterable) {\n      anInstance(that, C, CONSTRUCTOR_NAME);\n      setInternalState(that, {\n        type: CONSTRUCTOR_NAME,\n        id: id++,\n        frozen: undefined\n      });\n      if (iterable != undefined) iterate(iterable, that[ADDER], { that: that, AS_ENTRIES: IS_MAP });\n    });\n\n    var getInternalState = internalStateGetterFor(CONSTRUCTOR_NAME);\n\n    var define = function (that, key, value) {\n      var state = getInternalState(that);\n      var data = getWeakData(anObject(key), true);\n      if (data === true) uncaughtFrozenStore(state).set(key, value);\n      else data[state.id] = value;\n      return that;\n    };\n\n    redefineAll(C.prototype, {\n      // 23.3.3.2 WeakMap.prototype.delete(key)\n      // 23.4.3.3 WeakSet.prototype.delete(value)\n      'delete': function (key) {\n        var state = getInternalState(this);\n        if (!isObject(key)) return false;\n        var data = getWeakData(key);\n        if (data === true) return uncaughtFrozenStore(state)['delete'](key);\n        return data && $has(data, state.id) && delete data[state.id];\n      },\n      // 23.3.3.4 WeakMap.prototype.has(key)\n      // 23.4.3.4 WeakSet.prototype.has(value)\n      has: function has(key) {\n        var state = getInternalState(this);\n        if (!isObject(key)) return false;\n        var data = getWeakData(key);\n        if (data === true) return uncaughtFrozenStore(state).has(key);\n        return data && $has(data, state.id);\n      }\n    });\n\n    redefineAll(C.prototype, IS_MAP ? {\n      // 23.3.3.3 WeakMap.prototype.get(key)\n      get: function get(key) {\n        var state = getInternalState(this);\n        if (isObject(key)) {\n          var data = getWeakData(key);\n          if (data === true) return uncaughtFrozenStore(state).get(key);\n          return data ? data[state.id] : undefined;\n        }\n      },\n      // 23.3.3.5 WeakMap.prototype.set(key, value)\n      set: function set(key, value) {\n        return define(this, key, value);\n      }\n    } : {\n      // 23.4.3.1 WeakSet.prototype.add(value)\n      add: function add(value) {\n        return define(this, value, true);\n      }\n    });\n\n    return C;\n  }\n};\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar enterKey = {\n  keys: ['Enter'],\n  keyCode: 13\n};\n\nvar tabKey = {\n  keys: ['Tab'],\n  keyCode: 9\n};\n\nvar spaceBarKey = {\n  keys: [' '],\n  keyCode: 32\n};\n\nvar escapeKey = {\n  keys: ['Escape', 'Esc'],\n  keyCode: 27\n\n  /**\n   * Per the MDN, KeyboardEvent.keyCode and KeyboardEvent.which\n   * are deprecated. KeyboardEvent.code is not to be used to\n   * determine what character corresponds with a key event\n   * and is also not supported on Edge. KeyboardEvent.key is the\n   * preferred method, but seems less reliable than keyCode given\n   * it returns different strings for different browsers; ex: \"Escape\"\n   * in Chrome, but \"Esc\" in Edge. This function future proofs\n   * against deprecation, while still giving preference to the more\n   * reliable keyCode.\n   * https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/keyCode\n   * https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/code\n   * https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key\n   * https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/which\n   *\n   * KeyMap : { keyCode: Number, keys: [ String ] }\n   * isKey : KeyMap -> KeyboardEvent -> Boolean\n   */\n};var isKey = function isKey(_ref) {\n  var keyCode = _ref.keyCode,\n      keys = _ref.keys;\n  return function (e) {\n    return e.keyCode ? e.keyCode === keyCode : keys.indexOf(e.key) !== -1;\n  };\n};\n\n// is<X>Key : KeyboardEvent -> Boolean\nvar isEnterOrSpaceBarKey = exports.isEnterOrSpaceBarKey = function isEnterOrSpaceBarKey(e) {\n  return isKey(enterKey)(e) || isSpaceBarKey(e);\n};\nvar isTabKey = exports.isTabKey = isKey(tabKey);\nvar isSpaceBarKey = exports.isSpaceBarKey = isKey(spaceBarKey);\nvar isEscapeKey = exports.isEscapeKey = isKey(escapeKey);","var $ = require('../internals/export');\nvar lastIndexOf = require('../internals/array-last-index-of');\n\n// `Array.prototype.lastIndexOf` method\n// https://tc39.es/ecma262/#sec-array.prototype.lastindexof\n// eslint-disable-next-line es/no-array-prototype-lastindexof -- required for testing\n$({ target: 'Array', proto: true, forced: lastIndexOf !== [].lastIndexOf }, {\n  lastIndexOf: lastIndexOf\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar createHTML = require('../internals/create-html');\nvar forcedStringHTMLMethod = require('../internals/string-html-forced');\n\n// `String.prototype.fixed` method\n// https://tc39.es/ecma262/#sec-string.prototype.fixed\n$({ target: 'String', proto: true, forced: forcedStringHTMLMethod('fixed') }, {\n  fixed: function fixed() {\n    return createHTML(this, 'tt', '', '');\n  }\n});\n"],"sourceRoot":""}